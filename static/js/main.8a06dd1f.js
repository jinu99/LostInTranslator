/*! For license information please see main.8a06dd1f.js.LICENSE.txt */
(()=>{"use strict";var e={463:(e,t,n)=>{var r=n(791),i=n(296);function a(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var s=new Set,o={};function u(e,t){l(e,t),l(e+"Capture",t)}function l(e,t){for(o[e]=t,e=0;e<t.length;e++)s.add(t[e])}var c=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),d=Object.prototype.hasOwnProperty,h=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,f={},p={};function _(e,t,n,r,i,a,s){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=a,this.removeEmptyString=s}var v={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(e){v[e]=new _(e,0,!1,e,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(e){var t=e[0];v[t]=new _(t,1,!1,e[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(e){v[e]=new _(e,2,!1,e.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(e){v[e]=new _(e,2,!1,e,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(e){v[e]=new _(e,3,!1,e.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(e){v[e]=new _(e,3,!0,e,null,!1,!1)})),["capture","download"].forEach((function(e){v[e]=new _(e,4,!1,e,null,!1,!1)})),["cols","rows","size","span"].forEach((function(e){v[e]=new _(e,6,!1,e,null,!1,!1)})),["rowSpan","start"].forEach((function(e){v[e]=new _(e,5,!1,e.toLowerCase(),null,!1,!1)}));var m=/[\-:]([a-z])/g;function g(e){return e[1].toUpperCase()}function y(e,t,n,r){var i=v.hasOwnProperty(t)?v[t]:null;(null!==i?0!==i.type:r||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,n,r){if(null===t||"undefined"===typeof t||function(e,t,n,r){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!r&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,r))return!0;if(r)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,i,r)&&(n=null),r||null===i?function(e){return!!d.call(p,e)||!d.call(f,e)&&(h.test(e)?p[e]=!0:(f[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):i.mustUseProperty?e[i.propertyName]=null===n?3!==i.type&&"":n:(t=i.attributeName,r=i.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(i=i.type)||4===i&&!0===n?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(e){var t=e.replace(m,g);v[t]=new _(t,1,!1,e,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(e){var t=e.replace(m,g);v[t]=new _(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(e){var t=e.replace(m,g);v[t]=new _(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(e){v[e]=new _(e,1,!1,e.toLowerCase(),null,!1,!1)})),v.xlinkHref=new _("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(e){v[e]=new _(e,1,!1,e.toLowerCase(),null,!0,!0)}));var E=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,b=Symbol.for("react.element"),C=Symbol.for("react.portal"),w=Symbol.for("react.fragment"),S=Symbol.for("react.strict_mode"),T=Symbol.for("react.profiler"),I=Symbol.for("react.provider"),N=Symbol.for("react.context"),A=Symbol.for("react.forward_ref"),k=Symbol.for("react.suspense"),M=Symbol.for("react.suspense_list"),U=Symbol.for("react.memo"),O=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var D=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var L=Symbol.iterator;function R(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=L&&e[L]||e["@@iterator"])?e:null}var x,P=Object.assign;function F(e){if(void 0===x)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);x=t&&t[1]||""}return"\n"+x+e}var z=!1;function H(e,t){if(!e||z)return"";z=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(l){var r=l}Reflect.construct(e,[],t)}else{try{t.call()}catch(l){r=l}e.call(t.prototype)}else{try{throw Error()}catch(l){r=l}e()}}catch(l){if(l&&r&&"string"===typeof l.stack){for(var i=l.stack.split("\n"),a=r.stack.split("\n"),s=i.length-1,o=a.length-1;1<=s&&0<=o&&i[s]!==a[o];)o--;for(;1<=s&&0<=o;s--,o--)if(i[s]!==a[o]){if(1!==s||1!==o)do{if(s--,0>--o||i[s]!==a[o]){var u="\n"+i[s].replace(" at new "," at ");return e.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",e.displayName)),u}}while(1<=s&&0<=o);break}}}finally{z=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?F(e):""}function q(e){switch(e.tag){case 5:return F(e.type);case 16:return F("Lazy");case 13:return F("Suspense");case 19:return F("SuspenseList");case 0:case 2:case 15:return e=H(e.type,!1);case 11:return e=H(e.type.render,!1);case 1:return e=H(e.type,!0);default:return""}}function V(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case w:return"Fragment";case C:return"Portal";case T:return"Profiler";case S:return"StrictMode";case k:return"Suspense";case M:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case N:return(e.displayName||"Context")+".Consumer";case I:return(e._context.displayName||"Context")+".Provider";case A:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case U:return null!==(t=e.displayName||null)?t:V(e.type)||"Memo";case O:t=e._payload,e=e._init;try{return V(e(t))}catch(n){}}return null}function G(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return V(t);case 8:return t===S?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t}return null}function B(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function j(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function Q(e){e._valueTracker||(e._valueTracker=function(e){var t=j(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var i=n.get,a=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(e){r=""+e,a.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(e){r=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function K(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=j(e)?e.checked?"true":"false":e.value),(e=r)!==n&&(t.setValue(e),!0)}function W(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function Y(e,t){var n=t.checked;return P({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function Z(e,t){var n=null==t.defaultValue?"":t.defaultValue,r=null!=t.checked?t.checked:t.defaultChecked;n=B(null!=t.value?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function J(e,t){null!=(t=t.checked)&&y(e,"checked",t,!1)}function X(e,t){J(e,t);var n=B(t.value),r=t.type;if(null!=n)"number"===r?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===r||"reset"===r)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,n):t.hasOwnProperty("defaultValue")&&ee(e,t.type,B(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function $(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!("submit"!==r&&"reset"!==r||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function ee(e,t,n){"number"===t&&W(e.ownerDocument)===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var te=Array.isArray;function ne(e,t,n,r){if(e=e.options,t){t={};for(var i=0;i<n.length;i++)t["$"+n[i]]=!0;for(n=0;n<e.length;n++)i=t.hasOwnProperty("$"+e[n].value),e[n].selected!==i&&(e[n].selected=i),i&&r&&(e[n].defaultSelected=!0)}else{for(n=""+B(n),t=null,i=0;i<e.length;i++){if(e[i].value===n)return e[i].selected=!0,void(r&&(e[i].defaultSelected=!0));null!==t||e[i].disabled||(t=e[i])}null!==t&&(t.selected=!0)}}function re(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(a(91));return P({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function ie(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(a(92));if(te(n)){if(1<n.length)throw Error(a(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:B(n)}}function ae(e,t){var n=B(t.value),r=B(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=r&&(e.defaultValue=""+r)}function se(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function oe(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function ue(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?oe(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var le,ce,de=(ce=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((le=le||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=le.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,n,r){MSApp.execUnsafeLocalFunction((function(){return ce(e,t)}))}:ce);function he(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var fe={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},pe=["Webkit","ms","Moz","O"];function _e(e,t,n){return null==t||"boolean"===typeof t||""===t?"":n||"number"!==typeof t||0===t||fe.hasOwnProperty(e)&&fe[e]?(""+t).trim():t+"px"}function ve(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var r=0===n.indexOf("--"),i=_e(n,t[n],r);"float"===n&&(n="cssFloat"),r?e.setProperty(n,i):e[n]=i}}Object.keys(fe).forEach((function(e){pe.forEach((function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),fe[t]=fe[e]}))}));var me=P({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ge(e,t){if(t){if(me[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(a(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(a(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(a(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(a(62))}}function ye(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ee=null;function be(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var Ce=null,we=null,Se=null;function Te(e){if(e=yi(e)){if("function"!==typeof Ce)throw Error(a(280));var t=e.stateNode;t&&(t=bi(t),Ce(e.stateNode,e.type,t))}}function Ie(e){we?Se?Se.push(e):Se=[e]:we=e}function Ne(){if(we){var e=we,t=Se;if(Se=we=null,Te(e),t)for(e=0;e<t.length;e++)Te(t[e])}}function Ae(e,t){return e(t)}function ke(){}var Me=!1;function Ue(e,t,n){if(Me)return e(t,n);Me=!0;try{return Ae(e,t,n)}finally{Me=!1,(null!==we||null!==Se)&&(ke(),Ne())}}function Oe(e,t){var n=e.stateNode;if(null===n)return null;var r=bi(n);if(null===r)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!r;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error(a(231,t,typeof n));return n}var De=!1;if(c)try{var Le={};Object.defineProperty(Le,"passive",{get:function(){De=!0}}),window.addEventListener("test",Le,Le),window.removeEventListener("test",Le,Le)}catch(ce){De=!1}function Re(e,t,n,r,i,a,s,o,u){var l=Array.prototype.slice.call(arguments,3);try{t.apply(n,l)}catch(c){this.onError(c)}}var xe=!1,Pe=null,Fe=!1,ze=null,He={onError:function(e){xe=!0,Pe=e}};function qe(e,t,n,r,i,a,s,o,u){xe=!1,Pe=null,Re.apply(He,arguments)}function Ve(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function Ge(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function Be(e){if(Ve(e)!==e)throw Error(a(188))}function je(e){return null!==(e=function(e){var t=e.alternate;if(!t){if(null===(t=Ve(e)))throw Error(a(188));return t!==e?null:e}for(var n=e,r=t;;){var i=n.return;if(null===i)break;var s=i.alternate;if(null===s){if(null!==(r=i.return)){n=r;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===n)return Be(i),e;if(s===r)return Be(i),t;s=s.sibling}throw Error(a(188))}if(n.return!==r.return)n=i,r=s;else{for(var o=!1,u=i.child;u;){if(u===n){o=!0,n=i,r=s;break}if(u===r){o=!0,r=i,n=s;break}u=u.sibling}if(!o){for(u=s.child;u;){if(u===n){o=!0,n=s,r=i;break}if(u===r){o=!0,r=s,n=i;break}u=u.sibling}if(!o)throw Error(a(189))}}if(n.alternate!==r)throw Error(a(190))}if(3!==n.tag)throw Error(a(188));return n.stateNode.current===n?e:t}(e))?Qe(e):null}function Qe(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=Qe(e);if(null!==t)return t;e=e.sibling}return null}var Ke=i.unstable_scheduleCallback,We=i.unstable_cancelCallback,Ye=i.unstable_shouldYield,Ze=i.unstable_requestPaint,Je=i.unstable_now,Xe=i.unstable_getCurrentPriorityLevel,$e=i.unstable_ImmediatePriority,et=i.unstable_UserBlockingPriority,tt=i.unstable_NormalPriority,nt=i.unstable_LowPriority,rt=i.unstable_IdlePriority,it=null,at=null;var st=Math.clz32?Math.clz32:function(e){return e>>>=0,0===e?32:31-(ot(e)/ut|0)|0},ot=Math.log,ut=Math.LN2;var lt=64,ct=4194304;function dt(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function ht(e,t){var n=e.pendingLanes;if(0===n)return 0;var r=0,i=e.suspendedLanes,a=e.pingedLanes,s=268435455&n;if(0!==s){var o=s&~i;0!==o?r=dt(o):0!==(a&=s)&&(r=dt(a))}else 0!==(s=n&~i)?r=dt(s):0!==a&&(r=dt(a));if(0===r)return 0;if(0!==t&&t!==r&&0===(t&i)&&((i=r&-r)>=(a=t&-t)||16===i&&0!==(4194240&a)))return t;if(0!==(4&r)&&(r|=16&n),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=r;0<t;)i=1<<(n=31-st(t)),r|=e[n],t&=~i;return r}function ft(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function pt(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function _t(){var e=lt;return 0===(4194240&(lt<<=1))&&(lt=64),e}function vt(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function mt(e,t,n){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-st(t)]=n}function gt(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-st(n),i=1<<r;i&t|e[r]&t&&(e[r]|=t),n&=~i}}var yt=0;function Et(e){return 1<(e&=-e)?4<e?0!==(268435455&e)?16:536870912:4:1}var bt,Ct,wt,St,Tt,It=!1,Nt=[],At=null,kt=null,Mt=null,Ut=new Map,Ot=new Map,Dt=[],Lt="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Rt(e,t){switch(e){case"focusin":case"focusout":At=null;break;case"dragenter":case"dragleave":kt=null;break;case"mouseover":case"mouseout":Mt=null;break;case"pointerover":case"pointerout":Ut.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ot.delete(t.pointerId)}}function xt(e,t,n,r,i,a){return null===e||e.nativeEvent!==a?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:a,targetContainers:[i]},null!==t&&(null!==(t=yi(t))&&Ct(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,null!==i&&-1===t.indexOf(i)&&t.push(i),e)}function Pt(e){var t=gi(e.target);if(null!==t){var n=Ve(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=Ge(n)))return e.blockedOn=t,void Tt(e.priority,(function(){wt(n)}))}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function Ft(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=Yt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n)return null!==(t=yi(n))&&Ct(t),e.blockedOn=n,!1;var r=new(n=e.nativeEvent).constructor(n.type,n);Ee=r,n.target.dispatchEvent(r),Ee=null,t.shift()}return!0}function zt(e,t,n){Ft(e)&&n.delete(t)}function Ht(){It=!1,null!==At&&Ft(At)&&(At=null),null!==kt&&Ft(kt)&&(kt=null),null!==Mt&&Ft(Mt)&&(Mt=null),Ut.forEach(zt),Ot.forEach(zt)}function qt(e,t){e.blockedOn===t&&(e.blockedOn=null,It||(It=!0,i.unstable_scheduleCallback(i.unstable_NormalPriority,Ht)))}function Vt(e){function t(t){return qt(t,e)}if(0<Nt.length){qt(Nt[0],e);for(var n=1;n<Nt.length;n++){var r=Nt[n];r.blockedOn===e&&(r.blockedOn=null)}}for(null!==At&&qt(At,e),null!==kt&&qt(kt,e),null!==Mt&&qt(Mt,e),Ut.forEach(t),Ot.forEach(t),n=0;n<Dt.length;n++)(r=Dt[n]).blockedOn===e&&(r.blockedOn=null);for(;0<Dt.length&&null===(n=Dt[0]).blockedOn;)Pt(n),null===n.blockedOn&&Dt.shift()}var Gt=E.ReactCurrentBatchConfig,Bt=!0;function jt(e,t,n,r){var i=yt,a=Gt.transition;Gt.transition=null;try{yt=1,Kt(e,t,n,r)}finally{yt=i,Gt.transition=a}}function Qt(e,t,n,r){var i=yt,a=Gt.transition;Gt.transition=null;try{yt=4,Kt(e,t,n,r)}finally{yt=i,Gt.transition=a}}function Kt(e,t,n,r){if(Bt){var i=Yt(e,t,n,r);if(null===i)Br(e,t,r,Wt,n),Rt(e,r);else if(function(e,t,n,r,i){switch(t){case"focusin":return At=xt(At,e,t,n,r,i),!0;case"dragenter":return kt=xt(kt,e,t,n,r,i),!0;case"mouseover":return Mt=xt(Mt,e,t,n,r,i),!0;case"pointerover":var a=i.pointerId;return Ut.set(a,xt(Ut.get(a)||null,e,t,n,r,i)),!0;case"gotpointercapture":return a=i.pointerId,Ot.set(a,xt(Ot.get(a)||null,e,t,n,r,i)),!0}return!1}(i,e,t,n,r))r.stopPropagation();else if(Rt(e,r),4&t&&-1<Lt.indexOf(e)){for(;null!==i;){var a=yi(i);if(null!==a&&bt(a),null===(a=Yt(e,t,n,r))&&Br(e,t,r,Wt,n),a===i)break;i=a}null!==i&&r.stopPropagation()}else Br(e,t,r,null,n)}}var Wt=null;function Yt(e,t,n,r){if(Wt=null,null!==(e=gi(e=be(r))))if(null===(t=Ve(e)))e=null;else if(13===(n=t.tag)){if(null!==(e=Ge(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Wt=e,null}function Zt(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Xe()){case $e:return 1;case et:return 4;case tt:case nt:return 16;case rt:return 536870912;default:return 16}default:return 16}}var Jt=null,Xt=null,$t=null;function en(){if($t)return $t;var e,t,n=Xt,r=n.length,i="value"in Jt?Jt.value:Jt.textContent,a=i.length;for(e=0;e<r&&n[e]===i[e];e++);var s=r-e;for(t=1;t<=s&&n[r-t]===i[a-t];t++);return $t=i.slice(e,1<t?1-t:void 0)}function tn(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function nn(){return!0}function rn(){return!1}function an(e){function t(t,n,r,i,a){for(var s in this._reactName=t,this._targetInst=r,this.type=n,this.nativeEvent=i,this.target=a,this.currentTarget=null,e)e.hasOwnProperty(s)&&(t=e[s],this[s]=t?t(i):i[s]);return this.isDefaultPrevented=(null!=i.defaultPrevented?i.defaultPrevented:!1===i.returnValue)?nn:rn,this.isPropagationStopped=rn,this}return P(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=nn)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=nn)},persist:function(){},isPersistent:nn}),t}var sn,on,un,ln={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},cn=an(ln),dn=P({},ln,{view:0,detail:0}),hn=an(dn),fn=P({},dn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Tn,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==un&&(un&&"mousemove"===e.type?(sn=e.screenX-un.screenX,on=e.screenY-un.screenY):on=sn=0,un=e),sn)},movementY:function(e){return"movementY"in e?e.movementY:on}}),pn=an(fn),_n=an(P({},fn,{dataTransfer:0})),vn=an(P({},dn,{relatedTarget:0})),mn=an(P({},ln,{animationName:0,elapsedTime:0,pseudoElement:0})),gn=P({},ln,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),yn=an(gn),En=an(P({},ln,{data:0})),bn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Cn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},wn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Sn(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=wn[e])&&!!t[e]}function Tn(){return Sn}var In=P({},dn,{key:function(e){if(e.key){var t=bn[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=tn(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?Cn[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Tn,charCode:function(e){return"keypress"===e.type?tn(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?tn(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),Nn=an(In),An=an(P({},fn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),kn=an(P({},dn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Tn})),Mn=an(P({},ln,{propertyName:0,elapsedTime:0,pseudoElement:0})),Un=P({},fn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),On=an(Un),Dn=[9,13,27,32],Ln=c&&"CompositionEvent"in window,Rn=null;c&&"documentMode"in document&&(Rn=document.documentMode);var xn=c&&"TextEvent"in window&&!Rn,Pn=c&&(!Ln||Rn&&8<Rn&&11>=Rn),Fn=String.fromCharCode(32),zn=!1;function Hn(e,t){switch(e){case"keyup":return-1!==Dn.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function qn(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var Vn=!1;var Gn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Bn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Gn[e.type]:"textarea"===t}function jn(e,t,n,r){Ie(r),0<(t=Qr(t,"onChange")).length&&(n=new cn("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Qn=null,Kn=null;function Wn(e){Fr(e,0)}function Yn(e){if(K(Ei(e)))return e}function Zn(e,t){if("change"===e)return t}var Jn=!1;if(c){var Xn;if(c){var $n="oninput"in document;if(!$n){var er=document.createElement("div");er.setAttribute("oninput","return;"),$n="function"===typeof er.oninput}Xn=$n}else Xn=!1;Jn=Xn&&(!document.documentMode||9<document.documentMode)}function tr(){Qn&&(Qn.detachEvent("onpropertychange",nr),Kn=Qn=null)}function nr(e){if("value"===e.propertyName&&Yn(Kn)){var t=[];jn(t,Kn,e,be(e)),Ue(Wn,t)}}function rr(e,t,n){"focusin"===e?(tr(),Kn=n,(Qn=t).attachEvent("onpropertychange",nr)):"focusout"===e&&tr()}function ir(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Yn(Kn)}function ar(e,t){if("click"===e)return Yn(t)}function sr(e,t){if("input"===e||"change"===e)return Yn(t)}var or="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function ur(e,t){if(or(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!d.call(t,i)||!or(e[i],t[i]))return!1}return!0}function lr(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function cr(e,t){var n,r=lr(e);for(e=0;r;){if(3===r.nodeType){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=lr(r)}}function dr(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?dr(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function hr(){for(var e=window,t=W();t instanceof e.HTMLIFrameElement;){try{var n="string"===typeof t.contentWindow.location.href}catch(r){n=!1}if(!n)break;t=W((e=t.contentWindow).document)}return t}function fr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function pr(e){var t=hr(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&dr(n.ownerDocument.documentElement,n)){if(null!==r&&fr(n))if(t=r.start,void 0===(e=r.end)&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if((e=(t=n.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var i=n.textContent.length,a=Math.min(r.start,i);r=void 0===r.end?a:Math.min(r.end,i),!e.extend&&a>r&&(i=r,r=a,a=i),i=cr(n,a);var s=cr(n,r);i&&s&&(1!==e.rangeCount||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==s.node||e.focusOffset!==s.offset)&&((t=t.createRange()).setStart(i.node,i.offset),e.removeAllRanges(),a>r?(e.addRange(t),e.extend(s.node,s.offset)):(t.setEnd(s.node,s.offset),e.addRange(t)))}for(t=[],e=n;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"===typeof n.focus&&n.focus(),n=0;n<t.length;n++)(e=t[n]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var _r=c&&"documentMode"in document&&11>=document.documentMode,vr=null,mr=null,gr=null,yr=!1;function Er(e,t,n){var r=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;yr||null==vr||vr!==W(r)||("selectionStart"in(r=vr)&&fr(r)?r={start:r.selectionStart,end:r.selectionEnd}:r={anchorNode:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset},gr&&ur(gr,r)||(gr=r,0<(r=Qr(mr,"onSelect")).length&&(t=new cn("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=vr)))}function br(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var Cr={animationend:br("Animation","AnimationEnd"),animationiteration:br("Animation","AnimationIteration"),animationstart:br("Animation","AnimationStart"),transitionend:br("Transition","TransitionEnd")},wr={},Sr={};function Tr(e){if(wr[e])return wr[e];if(!Cr[e])return e;var t,n=Cr[e];for(t in n)if(n.hasOwnProperty(t)&&t in Sr)return wr[e]=n[t];return e}c&&(Sr=document.createElement("div").style,"AnimationEvent"in window||(delete Cr.animationend.animation,delete Cr.animationiteration.animation,delete Cr.animationstart.animation),"TransitionEvent"in window||delete Cr.transitionend.transition);var Ir=Tr("animationend"),Nr=Tr("animationiteration"),Ar=Tr("animationstart"),kr=Tr("transitionend"),Mr=new Map,Ur="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Or(e,t){Mr.set(e,t),u(t,[e])}for(var Dr=0;Dr<Ur.length;Dr++){var Lr=Ur[Dr];Or(Lr.toLowerCase(),"on"+(Lr[0].toUpperCase()+Lr.slice(1)))}Or(Ir,"onAnimationEnd"),Or(Nr,"onAnimationIteration"),Or(Ar,"onAnimationStart"),Or("dblclick","onDoubleClick"),Or("focusin","onFocus"),Or("focusout","onBlur"),Or(kr,"onTransitionEnd"),l("onMouseEnter",["mouseout","mouseover"]),l("onMouseLeave",["mouseout","mouseover"]),l("onPointerEnter",["pointerout","pointerover"]),l("onPointerLeave",["pointerout","pointerover"]),u("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),u("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),u("onBeforeInput",["compositionend","keypress","textInput","paste"]),u("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),u("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),u("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Rr="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),xr=new Set("cancel close invalid load scroll toggle".split(" ").concat(Rr));function Pr(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,function(e,t,n,r,i,s,o,u,l){if(qe.apply(this,arguments),xe){if(!xe)throw Error(a(198));var c=Pe;xe=!1,Pe=null,Fe||(Fe=!0,ze=c)}}(r,t,void 0,e),e.currentTarget=null}function Fr(e,t){t=0!==(4&t);for(var n=0;n<e.length;n++){var r=e[n],i=r.event;r=r.listeners;e:{var a=void 0;if(t)for(var s=r.length-1;0<=s;s--){var o=r[s],u=o.instance,l=o.currentTarget;if(o=o.listener,u!==a&&i.isPropagationStopped())break e;Pr(i,o,l),a=u}else for(s=0;s<r.length;s++){if(u=(o=r[s]).instance,l=o.currentTarget,o=o.listener,u!==a&&i.isPropagationStopped())break e;Pr(i,o,l),a=u}}}if(Fe)throw e=ze,Fe=!1,ze=null,e}function zr(e,t){var n=t[_i];void 0===n&&(n=t[_i]=new Set);var r=e+"__bubble";n.has(r)||(Gr(t,e,2,!1),n.add(r))}function Hr(e,t,n){var r=0;t&&(r|=4),Gr(n,e,r,t)}var qr="_reactListening"+Math.random().toString(36).slice(2);function Vr(e){if(!e[qr]){e[qr]=!0,s.forEach((function(t){"selectionchange"!==t&&(xr.has(t)||Hr(t,!1,e),Hr(t,!0,e))}));var t=9===e.nodeType?e:e.ownerDocument;null===t||t[qr]||(t[qr]=!0,Hr("selectionchange",!1,t))}}function Gr(e,t,n,r){switch(Zt(t)){case 1:var i=jt;break;case 4:i=Qt;break;default:i=Kt}n=i.bind(null,t,n,e),i=void 0,!De||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(i=!0),r?void 0!==i?e.addEventListener(t,n,{capture:!0,passive:i}):e.addEventListener(t,n,!0):void 0!==i?e.addEventListener(t,n,{passive:i}):e.addEventListener(t,n,!1)}function Br(e,t,n,r,i){var a=r;if(0===(1&t)&&0===(2&t)&&null!==r)e:for(;;){if(null===r)return;var s=r.tag;if(3===s||4===s){var o=r.stateNode.containerInfo;if(o===i||8===o.nodeType&&o.parentNode===i)break;if(4===s)for(s=r.return;null!==s;){var u=s.tag;if((3===u||4===u)&&((u=s.stateNode.containerInfo)===i||8===u.nodeType&&u.parentNode===i))return;s=s.return}for(;null!==o;){if(null===(s=gi(o)))return;if(5===(u=s.tag)||6===u){r=a=s;continue e}o=o.parentNode}}r=r.return}Ue((function(){var r=a,i=be(n),s=[];e:{var o=Mr.get(e);if(void 0!==o){var u=cn,l=e;switch(e){case"keypress":if(0===tn(n))break e;case"keydown":case"keyup":u=Nn;break;case"focusin":l="focus",u=vn;break;case"focusout":l="blur",u=vn;break;case"beforeblur":case"afterblur":u=vn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":u=pn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":u=_n;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":u=kn;break;case Ir:case Nr:case Ar:u=mn;break;case kr:u=Mn;break;case"scroll":u=hn;break;case"wheel":u=On;break;case"copy":case"cut":case"paste":u=yn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":u=An}var c=0!==(4&t),d=!c&&"scroll"===e,h=c?null!==o?o+"Capture":null:o;c=[];for(var f,p=r;null!==p;){var _=(f=p).stateNode;if(5===f.tag&&null!==_&&(f=_,null!==h&&(null!=(_=Oe(p,h))&&c.push(jr(p,_,f)))),d)break;p=p.return}0<c.length&&(o=new u(o,l,null,n,i),s.push({event:o,listeners:c}))}}if(0===(7&t)){if(u="mouseout"===e||"pointerout"===e,(!(o="mouseover"===e||"pointerover"===e)||n===Ee||!(l=n.relatedTarget||n.fromElement)||!gi(l)&&!l[pi])&&(u||o)&&(o=i.window===i?i:(o=i.ownerDocument)?o.defaultView||o.parentWindow:window,u?(u=r,null!==(l=(l=n.relatedTarget||n.toElement)?gi(l):null)&&(l!==(d=Ve(l))||5!==l.tag&&6!==l.tag)&&(l=null)):(u=null,l=r),u!==l)){if(c=pn,_="onMouseLeave",h="onMouseEnter",p="mouse","pointerout"!==e&&"pointerover"!==e||(c=An,_="onPointerLeave",h="onPointerEnter",p="pointer"),d=null==u?o:Ei(u),f=null==l?o:Ei(l),(o=new c(_,p+"leave",u,n,i)).target=d,o.relatedTarget=f,_=null,gi(i)===r&&((c=new c(h,p+"enter",l,n,i)).target=f,c.relatedTarget=d,_=c),d=_,u&&l)e:{for(h=l,p=0,f=c=u;f;f=Kr(f))p++;for(f=0,_=h;_;_=Kr(_))f++;for(;0<p-f;)c=Kr(c),p--;for(;0<f-p;)h=Kr(h),f--;for(;p--;){if(c===h||null!==h&&c===h.alternate)break e;c=Kr(c),h=Kr(h)}c=null}else c=null;null!==u&&Wr(s,o,u,c,!1),null!==l&&null!==d&&Wr(s,d,l,c,!0)}if("select"===(u=(o=r?Ei(r):window).nodeName&&o.nodeName.toLowerCase())||"input"===u&&"file"===o.type)var v=Zn;else if(Bn(o))if(Jn)v=sr;else{v=ir;var m=rr}else(u=o.nodeName)&&"input"===u.toLowerCase()&&("checkbox"===o.type||"radio"===o.type)&&(v=ar);switch(v&&(v=v(e,r))?jn(s,v,n,i):(m&&m(e,o,r),"focusout"===e&&(m=o._wrapperState)&&m.controlled&&"number"===o.type&&ee(o,"number",o.value)),m=r?Ei(r):window,e){case"focusin":(Bn(m)||"true"===m.contentEditable)&&(vr=m,mr=r,gr=null);break;case"focusout":gr=mr=vr=null;break;case"mousedown":yr=!0;break;case"contextmenu":case"mouseup":case"dragend":yr=!1,Er(s,n,i);break;case"selectionchange":if(_r)break;case"keydown":case"keyup":Er(s,n,i)}var g;if(Ln)e:{switch(e){case"compositionstart":var y="onCompositionStart";break e;case"compositionend":y="onCompositionEnd";break e;case"compositionupdate":y="onCompositionUpdate";break e}y=void 0}else Vn?Hn(e,n)&&(y="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(y="onCompositionStart");y&&(Pn&&"ko"!==n.locale&&(Vn||"onCompositionStart"!==y?"onCompositionEnd"===y&&Vn&&(g=en()):(Xt="value"in(Jt=i)?Jt.value:Jt.textContent,Vn=!0)),0<(m=Qr(r,y)).length&&(y=new En(y,e,null,n,i),s.push({event:y,listeners:m}),g?y.data=g:null!==(g=qn(n))&&(y.data=g))),(g=xn?function(e,t){switch(e){case"compositionend":return qn(t);case"keypress":return 32!==t.which?null:(zn=!0,Fn);case"textInput":return(e=t.data)===Fn&&zn?null:e;default:return null}}(e,n):function(e,t){if(Vn)return"compositionend"===e||!Ln&&Hn(e,t)?(e=en(),$t=Xt=Jt=null,Vn=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Pn&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(r=Qr(r,"onBeforeInput")).length&&(i=new En("onBeforeInput","beforeinput",null,n,i),s.push({event:i,listeners:r}),i.data=g))}Fr(s,t)}))}function jr(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Qr(e,t){for(var n=t+"Capture",r=[];null!==e;){var i=e,a=i.stateNode;5===i.tag&&null!==a&&(i=a,null!=(a=Oe(e,n))&&r.unshift(jr(e,a,i)),null!=(a=Oe(e,t))&&r.push(jr(e,a,i))),e=e.return}return r}function Kr(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Wr(e,t,n,r,i){for(var a=t._reactName,s=[];null!==n&&n!==r;){var o=n,u=o.alternate,l=o.stateNode;if(null!==u&&u===r)break;5===o.tag&&null!==l&&(o=l,i?null!=(u=Oe(n,a))&&s.unshift(jr(n,u,o)):i||null!=(u=Oe(n,a))&&s.push(jr(n,u,o))),n=n.return}0!==s.length&&e.push({event:t,listeners:s})}var Yr=/\r\n?/g,Zr=/\u0000|\uFFFD/g;function Jr(e){return("string"===typeof e?e:""+e).replace(Yr,"\n").replace(Zr,"")}function Xr(e,t,n){if(t=Jr(t),Jr(e)!==t&&n)throw Error(a(425))}function $r(){}var ei=null,ti=null;function ni(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var ri="function"===typeof setTimeout?setTimeout:void 0,ii="function"===typeof clearTimeout?clearTimeout:void 0,ai="function"===typeof Promise?Promise:void 0,si="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof ai?function(e){return ai.resolve(null).then(e).catch(oi)}:ri;function oi(e){setTimeout((function(){throw e}))}function ui(e,t){var n=t,r=0;do{var i=n.nextSibling;if(e.removeChild(n),i&&8===i.nodeType)if("/$"===(n=i.data)){if(0===r)return e.removeChild(i),void Vt(t);r--}else"$"!==n&&"$?"!==n&&"$!"!==n||r++;n=i}while(n);Vt(t)}function li(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function ci(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}var di=Math.random().toString(36).slice(2),hi="__reactFiber$"+di,fi="__reactProps$"+di,pi="__reactContainer$"+di,_i="__reactEvents$"+di,vi="__reactListeners$"+di,mi="__reactHandles$"+di;function gi(e){var t=e[hi];if(t)return t;for(var n=e.parentNode;n;){if(t=n[pi]||n[hi]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=ci(e);null!==e;){if(n=e[hi])return n;e=ci(e)}return t}n=(e=n).parentNode}return null}function yi(e){return!(e=e[hi]||e[pi])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function Ei(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(a(33))}function bi(e){return e[fi]||null}var Ci=[],wi=-1;function Si(e){return{current:e}}function Ti(e){0>wi||(e.current=Ci[wi],Ci[wi]=null,wi--)}function Ii(e,t){wi++,Ci[wi]=e.current,e.current=t}var Ni={},Ai=Si(Ni),ki=Si(!1),Mi=Ni;function Ui(e,t){var n=e.type.contextTypes;if(!n)return Ni;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var i,a={};for(i in n)a[i]=t[i];return r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=a),a}function Oi(e){return null!==(e=e.childContextTypes)&&void 0!==e}function Di(){Ti(ki),Ti(Ai)}function Li(e,t,n){if(Ai.current!==Ni)throw Error(a(168));Ii(Ai,t),Ii(ki,n)}function Ri(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,"function"!==typeof r.getChildContext)return n;for(var i in r=r.getChildContext())if(!(i in t))throw Error(a(108,G(e)||"Unknown",i));return P({},n,r)}function xi(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Ni,Mi=Ai.current,Ii(Ai,e),Ii(ki,ki.current),!0}function Pi(e,t,n){var r=e.stateNode;if(!r)throw Error(a(169));n?(e=Ri(e,t,Mi),r.__reactInternalMemoizedMergedChildContext=e,Ti(ki),Ti(Ai),Ii(Ai,e)):Ti(ki),Ii(ki,n)}var Fi=null,zi=!1,Hi=!1;function qi(e){null===Fi?Fi=[e]:Fi.push(e)}function Vi(){if(!Hi&&null!==Fi){Hi=!0;var e=0,t=yt;try{var n=Fi;for(yt=1;e<n.length;e++){var r=n[e];do{r=r(!0)}while(null!==r)}Fi=null,zi=!1}catch(i){throw null!==Fi&&(Fi=Fi.slice(e+1)),Ke($e,Vi),i}finally{yt=t,Hi=!1}}return null}var Gi=[],Bi=0,ji=null,Qi=0,Ki=[],Wi=0,Yi=null,Zi=1,Ji="";function Xi(e,t){Gi[Bi++]=Qi,Gi[Bi++]=ji,ji=e,Qi=t}function $i(e,t,n){Ki[Wi++]=Zi,Ki[Wi++]=Ji,Ki[Wi++]=Yi,Yi=e;var r=Zi;e=Ji;var i=32-st(r)-1;r&=~(1<<i),n+=1;var a=32-st(t)+i;if(30<a){var s=i-i%5;a=(r&(1<<s)-1).toString(32),r>>=s,i-=s,Zi=1<<32-st(t)+i|n<<i|r,Ji=a+e}else Zi=1<<a|n<<i|r,Ji=e}function ea(e){null!==e.return&&(Xi(e,1),$i(e,1,0))}function ta(e){for(;e===ji;)ji=Gi[--Bi],Gi[Bi]=null,Qi=Gi[--Bi],Gi[Bi]=null;for(;e===Yi;)Yi=Ki[--Wi],Ki[Wi]=null,Ji=Ki[--Wi],Ki[Wi]=null,Zi=Ki[--Wi],Ki[Wi]=null}var na=null,ra=null,ia=!1,aa=null;function sa(e,t){var n=Ol(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,null===(t=e.deletions)?(e.deletions=[n],e.flags|=16):t.push(n)}function oa(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,na=e,ra=li(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,na=e,ra=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(n=null!==Yi?{id:Zi,overflow:Ji}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},(n=Ol(18,null,null,0)).stateNode=t,n.return=e,e.child=n,na=e,ra=null,!0);default:return!1}}function ua(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function la(e){if(ia){var t=ra;if(t){var n=t;if(!oa(e,t)){if(ua(e))throw Error(a(418));t=li(n.nextSibling);var r=na;t&&oa(e,t)?sa(r,n):(e.flags=-4097&e.flags|2,ia=!1,na=e)}}else{if(ua(e))throw Error(a(418));e.flags=-4097&e.flags|2,ia=!1,na=e}}}function ca(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;na=e}function da(e){if(e!==na)return!1;if(!ia)return ca(e),ia=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!ni(e.type,e.memoizedProps)),t&&(t=ra)){if(ua(e))throw ha(),Error(a(418));for(;t;)sa(e,t),t=li(t.nextSibling)}if(ca(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(a(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n){if(0===t){ra=li(e.nextSibling);break e}t--}else"$"!==n&&"$!"!==n&&"$?"!==n||t++}e=e.nextSibling}ra=null}}else ra=na?li(e.stateNode.nextSibling):null;return!0}function ha(){for(var e=ra;e;)e=li(e.nextSibling)}function fa(){ra=na=null,ia=!1}function pa(e){null===aa?aa=[e]:aa.push(e)}var _a=E.ReactCurrentBatchConfig;function va(e,t){if(e&&e.defaultProps){for(var n in t=P({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}var ma=Si(null),ga=null,ya=null,Ea=null;function ba(){Ea=ya=ga=null}function Ca(e){var t=ma.current;Ti(ma),e._currentValue=t}function wa(e,t,n){for(;null!==e;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==r&&(r.childLanes|=t)):null!==r&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function Sa(e,t){ga=e,Ea=ya=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(Eo=!0),e.firstContext=null)}function Ta(e){var t=e._currentValue;if(Ea!==e)if(e={context:e,memoizedValue:t,next:null},null===ya){if(null===ga)throw Error(a(308));ya=e,ga.dependencies={lanes:0,firstContext:e}}else ya=ya.next=e;return t}var Ia=null;function Na(e){null===Ia?Ia=[e]:Ia.push(e)}function Aa(e,t,n,r){var i=t.interleaved;return null===i?(n.next=n,Na(t)):(n.next=i.next,i.next=n),t.interleaved=n,ka(e,r)}function ka(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}var Ma=!1;function Ua(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Oa(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Da(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function La(e,t,n){var r=e.updateQueue;if(null===r)return null;if(r=r.shared,0!==(2&ku)){var i=r.pending;return null===i?t.next=t:(t.next=i.next,i.next=t),r.pending=t,ka(e,n)}return null===(i=r.interleaved)?(t.next=t,Na(r)):(t.next=i.next,i.next=t),r.interleaved=t,ka(e,n)}function Ra(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194240&n))){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,gt(e,n)}}function xa(e,t){var n=e.updateQueue,r=e.alternate;if(null!==r&&n===(r=r.updateQueue)){var i=null,a=null;if(null!==(n=n.firstBaseUpdate)){do{var s={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===a?i=a=s:a=a.next=s,n=n.next}while(null!==n);null===a?i=a=t:a=a.next=t}else i=a=t;return n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:a,shared:r.shared,effects:r.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Pa(e,t,n,r){var i=e.updateQueue;Ma=!1;var a=i.firstBaseUpdate,s=i.lastBaseUpdate,o=i.shared.pending;if(null!==o){i.shared.pending=null;var u=o,l=u.next;u.next=null,null===s?a=l:s.next=l,s=u;var c=e.alternate;null!==c&&((o=(c=c.updateQueue).lastBaseUpdate)!==s&&(null===o?c.firstBaseUpdate=l:o.next=l,c.lastBaseUpdate=u))}if(null!==a){var d=i.baseState;for(s=0,c=l=u=null,o=a;;){var h=o.lane,f=o.eventTime;if((r&h)===h){null!==c&&(c=c.next={eventTime:f,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var p=e,_=o;switch(h=t,f=n,_.tag){case 1:if("function"===typeof(p=_.payload)){d=p.call(f,d,h);break e}d=p;break e;case 3:p.flags=-65537&p.flags|128;case 0:if(null===(h="function"===typeof(p=_.payload)?p.call(f,d,h):p)||void 0===h)break e;d=P({},d,h);break e;case 2:Ma=!0}}null!==o.callback&&0!==o.lane&&(e.flags|=64,null===(h=i.effects)?i.effects=[o]:h.push(o))}else f={eventTime:f,lane:h,tag:o.tag,payload:o.payload,callback:o.callback,next:null},null===c?(l=c=f,u=d):c=c.next=f,s|=h;if(null===(o=o.next)){if(null===(o=i.shared.pending))break;o=(h=o).next,h.next=null,i.lastBaseUpdate=h,i.shared.pending=null}}if(null===c&&(u=d),i.baseState=u,i.firstBaseUpdate=l,i.lastBaseUpdate=c,null!==(t=i.shared.interleaved)){i=t;do{s|=i.lane,i=i.next}while(i!==t)}else null===a&&(i.shared.lanes=0);Pu|=s,e.lanes=s,e.memoizedState=d}}function Fa(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var r=e[t],i=r.callback;if(null!==i){if(r.callback=null,r=n,"function"!==typeof i)throw Error(a(191,i));i.call(r)}}}var za=(new r.Component).refs;function Ha(e,t,n,r){n=null===(n=n(r,t=e.memoizedState))||void 0===n?t:P({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var qa={isMounted:function(e){return!!(e=e._reactInternals)&&Ve(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=tl(),i=nl(e),a=Da(r,i);a.payload=t,void 0!==n&&null!==n&&(a.callback=n),null!==(t=La(e,a,i))&&(rl(t,e,i,r),Ra(t,e,i))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=tl(),i=nl(e),a=Da(r,i);a.tag=1,a.payload=t,void 0!==n&&null!==n&&(a.callback=n),null!==(t=La(e,a,i))&&(rl(t,e,i,r),Ra(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=tl(),r=nl(e),i=Da(n,r);i.tag=2,void 0!==t&&null!==t&&(i.callback=t),null!==(t=La(e,i,r))&&(rl(t,e,r,n),Ra(t,e,r))}};function Va(e,t,n,r,i,a,s){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,a,s):!t.prototype||!t.prototype.isPureReactComponent||(!ur(n,r)||!ur(i,a))}function Ga(e,t,n){var r=!1,i=Ni,a=t.contextType;return"object"===typeof a&&null!==a?a=Ta(a):(i=Oi(t)?Mi:Ai.current,a=(r=null!==(r=t.contextTypes)&&void 0!==r)?Ui(e,i):Ni),t=new t(n,a),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=qa,e.stateNode=t,t._reactInternals=e,r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=a),t}function Ba(e,t,n,r){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&qa.enqueueReplaceState(t,t.state,null)}function ja(e,t,n,r){var i=e.stateNode;i.props=n,i.state=e.memoizedState,i.refs=za,Ua(e);var a=t.contextType;"object"===typeof a&&null!==a?i.context=Ta(a):(a=Oi(t)?Mi:Ai.current,i.context=Ui(e,a)),i.state=e.memoizedState,"function"===typeof(a=t.getDerivedStateFromProps)&&(Ha(e,t,a,n),i.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof i.getSnapshotBeforeUpdate||"function"!==typeof i.UNSAFE_componentWillMount&&"function"!==typeof i.componentWillMount||(t=i.state,"function"===typeof i.componentWillMount&&i.componentWillMount(),"function"===typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount(),t!==i.state&&qa.enqueueReplaceState(i,i.state,null),Pa(e,n,i,r),i.state=e.memoizedState),"function"===typeof i.componentDidMount&&(e.flags|=4194308)}function Qa(e,t,n){if(null!==(e=n.ref)&&"function"!==typeof e&&"object"!==typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(a(309));var r=n.stateNode}if(!r)throw Error(a(147,e));var i=r,s=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===s?t.ref:(t=function(e){var t=i.refs;t===za&&(t=i.refs={}),null===e?delete t[s]:t[s]=e},t._stringRef=s,t)}if("string"!==typeof e)throw Error(a(284));if(!n._owner)throw Error(a(290,e))}return e}function Ka(e,t){throw e=Object.prototype.toString.call(t),Error(a(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Wa(e){return(0,e._init)(e._payload)}function Ya(e){function t(t,n){if(e){var r=t.deletions;null===r?(t.deletions=[n],t.flags|=16):r.push(n)}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function r(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function i(e,t){return(e=Ll(e,t)).index=0,e.sibling=null,e}function s(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.flags|=2,n):r:(t.flags|=2,n):(t.flags|=1048576,n)}function o(t){return e&&null===t.alternate&&(t.flags|=2),t}function u(e,t,n,r){return null===t||6!==t.tag?((t=Fl(n,e.mode,r)).return=e,t):((t=i(t,n)).return=e,t)}function l(e,t,n,r){var a=n.type;return a===w?d(e,t,n.props.children,r,n.key):null!==t&&(t.elementType===a||"object"===typeof a&&null!==a&&a.$$typeof===O&&Wa(a)===t.type)?((r=i(t,n.props)).ref=Qa(e,t,n),r.return=e,r):((r=Rl(n.type,n.key,n.props,null,e.mode,r)).ref=Qa(e,t,n),r.return=e,r)}function c(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=zl(n,e.mode,r)).return=e,t):((t=i(t,n.children||[])).return=e,t)}function d(e,t,n,r,a){return null===t||7!==t.tag?((t=xl(n,e.mode,r,a)).return=e,t):((t=i(t,n)).return=e,t)}function h(e,t,n){if("string"===typeof t&&""!==t||"number"===typeof t)return(t=Fl(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case b:return(n=Rl(t.type,t.key,t.props,null,e.mode,n)).ref=Qa(e,null,t),n.return=e,n;case C:return(t=zl(t,e.mode,n)).return=e,t;case O:return h(e,(0,t._init)(t._payload),n)}if(te(t)||R(t))return(t=xl(t,e.mode,n,null)).return=e,t;Ka(e,t)}return null}function f(e,t,n,r){var i=null!==t?t.key:null;if("string"===typeof n&&""!==n||"number"===typeof n)return null!==i?null:u(e,t,""+n,r);if("object"===typeof n&&null!==n){switch(n.$$typeof){case b:return n.key===i?l(e,t,n,r):null;case C:return n.key===i?c(e,t,n,r):null;case O:return f(e,t,(i=n._init)(n._payload),r)}if(te(n)||R(n))return null!==i?null:d(e,t,n,r,null);Ka(e,n)}return null}function p(e,t,n,r,i){if("string"===typeof r&&""!==r||"number"===typeof r)return u(t,e=e.get(n)||null,""+r,i);if("object"===typeof r&&null!==r){switch(r.$$typeof){case b:return l(t,e=e.get(null===r.key?n:r.key)||null,r,i);case C:return c(t,e=e.get(null===r.key?n:r.key)||null,r,i);case O:return p(e,t,n,(0,r._init)(r._payload),i)}if(te(r)||R(r))return d(t,e=e.get(n)||null,r,i,null);Ka(t,r)}return null}function _(i,a,o,u){for(var l=null,c=null,d=a,_=a=0,v=null;null!==d&&_<o.length;_++){d.index>_?(v=d,d=null):v=d.sibling;var m=f(i,d,o[_],u);if(null===m){null===d&&(d=v);break}e&&d&&null===m.alternate&&t(i,d),a=s(m,a,_),null===c?l=m:c.sibling=m,c=m,d=v}if(_===o.length)return n(i,d),ia&&Xi(i,_),l;if(null===d){for(;_<o.length;_++)null!==(d=h(i,o[_],u))&&(a=s(d,a,_),null===c?l=d:c.sibling=d,c=d);return ia&&Xi(i,_),l}for(d=r(i,d);_<o.length;_++)null!==(v=p(d,i,_,o[_],u))&&(e&&null!==v.alternate&&d.delete(null===v.key?_:v.key),a=s(v,a,_),null===c?l=v:c.sibling=v,c=v);return e&&d.forEach((function(e){return t(i,e)})),ia&&Xi(i,_),l}function v(i,o,u,l){var c=R(u);if("function"!==typeof c)throw Error(a(150));if(null==(u=c.call(u)))throw Error(a(151));for(var d=c=null,_=o,v=o=0,m=null,g=u.next();null!==_&&!g.done;v++,g=u.next()){_.index>v?(m=_,_=null):m=_.sibling;var y=f(i,_,g.value,l);if(null===y){null===_&&(_=m);break}e&&_&&null===y.alternate&&t(i,_),o=s(y,o,v),null===d?c=y:d.sibling=y,d=y,_=m}if(g.done)return n(i,_),ia&&Xi(i,v),c;if(null===_){for(;!g.done;v++,g=u.next())null!==(g=h(i,g.value,l))&&(o=s(g,o,v),null===d?c=g:d.sibling=g,d=g);return ia&&Xi(i,v),c}for(_=r(i,_);!g.done;v++,g=u.next())null!==(g=p(_,i,v,g.value,l))&&(e&&null!==g.alternate&&_.delete(null===g.key?v:g.key),o=s(g,o,v),null===d?c=g:d.sibling=g,d=g);return e&&_.forEach((function(e){return t(i,e)})),ia&&Xi(i,v),c}return function e(r,a,s,u){if("object"===typeof s&&null!==s&&s.type===w&&null===s.key&&(s=s.props.children),"object"===typeof s&&null!==s){switch(s.$$typeof){case b:e:{for(var l=s.key,c=a;null!==c;){if(c.key===l){if((l=s.type)===w){if(7===c.tag){n(r,c.sibling),(a=i(c,s.props.children)).return=r,r=a;break e}}else if(c.elementType===l||"object"===typeof l&&null!==l&&l.$$typeof===O&&Wa(l)===c.type){n(r,c.sibling),(a=i(c,s.props)).ref=Qa(r,c,s),a.return=r,r=a;break e}n(r,c);break}t(r,c),c=c.sibling}s.type===w?((a=xl(s.props.children,r.mode,u,s.key)).return=r,r=a):((u=Rl(s.type,s.key,s.props,null,r.mode,u)).ref=Qa(r,a,s),u.return=r,r=u)}return o(r);case C:e:{for(c=s.key;null!==a;){if(a.key===c){if(4===a.tag&&a.stateNode.containerInfo===s.containerInfo&&a.stateNode.implementation===s.implementation){n(r,a.sibling),(a=i(a,s.children||[])).return=r,r=a;break e}n(r,a);break}t(r,a),a=a.sibling}(a=zl(s,r.mode,u)).return=r,r=a}return o(r);case O:return e(r,a,(c=s._init)(s._payload),u)}if(te(s))return _(r,a,s,u);if(R(s))return v(r,a,s,u);Ka(r,s)}return"string"===typeof s&&""!==s||"number"===typeof s?(s=""+s,null!==a&&6===a.tag?(n(r,a.sibling),(a=i(a,s)).return=r,r=a):(n(r,a),(a=Fl(s,r.mode,u)).return=r,r=a),o(r)):n(r,a)}}var Za=Ya(!0),Ja=Ya(!1),Xa={},$a=Si(Xa),es=Si(Xa),ts=Si(Xa);function ns(e){if(e===Xa)throw Error(a(174));return e}function rs(e,t){switch(Ii(ts,t),Ii(es,e),Ii($a,Xa),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:ue(null,"");break;default:t=ue(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}Ti($a),Ii($a,t)}function is(){Ti($a),Ti(es),Ti(ts)}function as(e){ns(ts.current);var t=ns($a.current),n=ue(t,e.type);t!==n&&(Ii(es,e),Ii($a,n))}function ss(e){es.current===e&&(Ti($a),Ti(es))}var os=Si(0);function us(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var ls=[];function cs(){for(var e=0;e<ls.length;e++)ls[e]._workInProgressVersionPrimary=null;ls.length=0}var ds=E.ReactCurrentDispatcher,hs=E.ReactCurrentBatchConfig,fs=0,ps=null,_s=null,vs=null,ms=!1,gs=!1,ys=0,Es=0;function bs(){throw Error(a(321))}function Cs(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!or(e[n],t[n]))return!1;return!0}function ws(e,t,n,r,i,s){if(fs=s,ps=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,ds.current=null===e||null===e.memoizedState?so:oo,e=n(r,i),gs){s=0;do{if(gs=!1,ys=0,25<=s)throw Error(a(301));s+=1,vs=_s=null,t.updateQueue=null,ds.current=uo,e=n(r,i)}while(gs)}if(ds.current=ao,t=null!==_s&&null!==_s.next,fs=0,vs=_s=ps=null,ms=!1,t)throw Error(a(300));return e}function Ss(){var e=0!==ys;return ys=0,e}function Ts(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===vs?ps.memoizedState=vs=e:vs=vs.next=e,vs}function Is(){if(null===_s){var e=ps.alternate;e=null!==e?e.memoizedState:null}else e=_s.next;var t=null===vs?ps.memoizedState:vs.next;if(null!==t)vs=t,_s=e;else{if(null===e)throw Error(a(310));e={memoizedState:(_s=e).memoizedState,baseState:_s.baseState,baseQueue:_s.baseQueue,queue:_s.queue,next:null},null===vs?ps.memoizedState=vs=e:vs=vs.next=e}return vs}function Ns(e,t){return"function"===typeof t?t(e):t}function As(e){var t=Is(),n=t.queue;if(null===n)throw Error(a(311));n.lastRenderedReducer=e;var r=_s,i=r.baseQueue,s=n.pending;if(null!==s){if(null!==i){var o=i.next;i.next=s.next,s.next=o}r.baseQueue=i=s,n.pending=null}if(null!==i){s=i.next,r=r.baseState;var u=o=null,l=null,c=s;do{var d=c.lane;if((fs&d)===d)null!==l&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),r=c.hasEagerState?c.eagerState:e(r,c.action);else{var h={lane:d,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};null===l?(u=l=h,o=r):l=l.next=h,ps.lanes|=d,Pu|=d}c=c.next}while(null!==c&&c!==s);null===l?o=r:l.next=u,or(r,t.memoizedState)||(Eo=!0),t.memoizedState=r,t.baseState=o,t.baseQueue=l,n.lastRenderedState=r}if(null!==(e=n.interleaved)){i=e;do{s=i.lane,ps.lanes|=s,Pu|=s,i=i.next}while(i!==e)}else null===i&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function ks(e){var t=Is(),n=t.queue;if(null===n)throw Error(a(311));n.lastRenderedReducer=e;var r=n.dispatch,i=n.pending,s=t.memoizedState;if(null!==i){n.pending=null;var o=i=i.next;do{s=e(s,o.action),o=o.next}while(o!==i);or(s,t.memoizedState)||(Eo=!0),t.memoizedState=s,null===t.baseQueue&&(t.baseState=s),n.lastRenderedState=s}return[s,r]}function Ms(){}function Us(e,t){var n=ps,r=Is(),i=t(),s=!or(r.memoizedState,i);if(s&&(r.memoizedState=i,Eo=!0),r=r.queue,Gs(Ls.bind(null,n,r,e),[e]),r.getSnapshot!==t||s||null!==vs&&1&vs.memoizedState.tag){if(n.flags|=2048,Fs(9,Ds.bind(null,n,r,i,t),void 0,null),null===Mu)throw Error(a(349));0!==(30&fs)||Os(n,t,i)}return i}function Os(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=ps.updateQueue)?(t={lastEffect:null,stores:null},ps.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function Ds(e,t,n,r){t.value=n,t.getSnapshot=r,Rs(t)&&xs(e)}function Ls(e,t,n){return n((function(){Rs(t)&&xs(e)}))}function Rs(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!or(e,n)}catch(r){return!0}}function xs(e){var t=ka(e,1);null!==t&&rl(t,e,1,-1)}function Ps(e){var t=Ts();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ns,lastRenderedState:e},t.queue=e,e=e.dispatch=to.bind(null,ps,e),[t.memoizedState,e]}function Fs(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},null===(t=ps.updateQueue)?(t={lastEffect:null,stores:null},ps.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function zs(){return Is().memoizedState}function Hs(e,t,n,r){var i=Ts();ps.flags|=e,i.memoizedState=Fs(1|t,n,void 0,void 0===r?null:r)}function qs(e,t,n,r){var i=Is();r=void 0===r?null:r;var a=void 0;if(null!==_s){var s=_s.memoizedState;if(a=s.destroy,null!==r&&Cs(r,s.deps))return void(i.memoizedState=Fs(t,n,a,r))}ps.flags|=e,i.memoizedState=Fs(1|t,n,a,r)}function Vs(e,t){return Hs(8390656,8,e,t)}function Gs(e,t){return qs(2048,8,e,t)}function Bs(e,t){return qs(4,2,e,t)}function js(e,t){return qs(4,4,e,t)}function Qs(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function Ks(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,qs(4,4,Qs.bind(null,t,e),n)}function Ws(){}function Ys(e,t){var n=Is();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&Cs(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function Zs(e,t){var n=Is();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&Cs(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function Js(e,t,n){return 0===(21&fs)?(e.baseState&&(e.baseState=!1,Eo=!0),e.memoizedState=n):(or(n,t)||(n=_t(),ps.lanes|=n,Pu|=n,e.baseState=!0),t)}function Xs(e,t){var n=yt;yt=0!==n&&4>n?n:4,e(!0);var r=hs.transition;hs.transition={};try{e(!1),t()}finally{yt=n,hs.transition=r}}function $s(){return Is().memoizedState}function eo(e,t,n){var r=nl(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},no(e))ro(t,n);else if(null!==(n=Aa(e,t,n,r))){rl(n,e,r,tl()),io(n,t,r)}}function to(e,t,n){var r=nl(e),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(no(e))ro(t,i);else{var a=e.alternate;if(0===e.lanes&&(null===a||0===a.lanes)&&null!==(a=t.lastRenderedReducer))try{var s=t.lastRenderedState,o=a(s,n);if(i.hasEagerState=!0,i.eagerState=o,or(o,s)){var u=t.interleaved;return null===u?(i.next=i,Na(t)):(i.next=u.next,u.next=i),void(t.interleaved=i)}}catch(l){}null!==(n=Aa(e,t,i,r))&&(rl(n,e,r,i=tl()),io(n,t,r))}}function no(e){var t=e.alternate;return e===ps||null!==t&&t===ps}function ro(e,t){gs=ms=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function io(e,t,n){if(0!==(4194240&n)){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,gt(e,n)}}var ao={readContext:Ta,useCallback:bs,useContext:bs,useEffect:bs,useImperativeHandle:bs,useInsertionEffect:bs,useLayoutEffect:bs,useMemo:bs,useReducer:bs,useRef:bs,useState:bs,useDebugValue:bs,useDeferredValue:bs,useTransition:bs,useMutableSource:bs,useSyncExternalStore:bs,useId:bs,unstable_isNewReconciler:!1},so={readContext:Ta,useCallback:function(e,t){return Ts().memoizedState=[e,void 0===t?null:t],e},useContext:Ta,useEffect:Vs,useImperativeHandle:function(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Hs(4194308,4,Qs.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Hs(4194308,4,e,t)},useInsertionEffect:function(e,t){return Hs(4,2,e,t)},useMemo:function(e,t){var n=Ts();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=Ts();return t=void 0!==n?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=eo.bind(null,ps,e),[r.memoizedState,e]},useRef:function(e){return e={current:e},Ts().memoizedState=e},useState:Ps,useDebugValue:Ws,useDeferredValue:function(e){return Ts().memoizedState=e},useTransition:function(){var e=Ps(!1),t=e[0];return e=Xs.bind(null,e[1]),Ts().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=ps,i=Ts();if(ia){if(void 0===n)throw Error(a(407));n=n()}else{if(n=t(),null===Mu)throw Error(a(349));0!==(30&fs)||Os(r,t,n)}i.memoizedState=n;var s={value:n,getSnapshot:t};return i.queue=s,Vs(Ls.bind(null,r,s,e),[e]),r.flags|=2048,Fs(9,Ds.bind(null,r,s,n,t),void 0,null),n},useId:function(){var e=Ts(),t=Mu.identifierPrefix;if(ia){var n=Ji;t=":"+t+"R"+(n=(Zi&~(1<<32-st(Zi)-1)).toString(32)+n),0<(n=ys++)&&(t+="H"+n.toString(32)),t+=":"}else t=":"+t+"r"+(n=Es++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},oo={readContext:Ta,useCallback:Ys,useContext:Ta,useEffect:Gs,useImperativeHandle:Ks,useInsertionEffect:Bs,useLayoutEffect:js,useMemo:Zs,useReducer:As,useRef:zs,useState:function(){return As(Ns)},useDebugValue:Ws,useDeferredValue:function(e){return Js(Is(),_s.memoizedState,e)},useTransition:function(){return[As(Ns)[0],Is().memoizedState]},useMutableSource:Ms,useSyncExternalStore:Us,useId:$s,unstable_isNewReconciler:!1},uo={readContext:Ta,useCallback:Ys,useContext:Ta,useEffect:Gs,useImperativeHandle:Ks,useInsertionEffect:Bs,useLayoutEffect:js,useMemo:Zs,useReducer:ks,useRef:zs,useState:function(){return ks(Ns)},useDebugValue:Ws,useDeferredValue:function(e){var t=Is();return null===_s?t.memoizedState=e:Js(t,_s.memoizedState,e)},useTransition:function(){return[ks(Ns)[0],Is().memoizedState]},useMutableSource:Ms,useSyncExternalStore:Us,useId:$s,unstable_isNewReconciler:!1};function lo(e,t){try{var n="",r=t;do{n+=q(r),r=r.return}while(r);var i=n}catch(a){i="\nError generating stack: "+a.message+"\n"+a.stack}return{value:e,source:t,stack:i,digest:null}}function co(e,t,n){return{value:e,source:null,stack:null!=n?n:null,digest:null!=t?t:null}}function ho(e,t){try{console.error(t.value)}catch(n){setTimeout((function(){throw n}))}}var fo="function"===typeof WeakMap?WeakMap:Map;function po(e,t,n){(n=Da(-1,n)).tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){ju||(ju=!0,Qu=r),ho(0,t)},n}function _o(e,t,n){(n=Da(-1,n)).tag=3;var r=e.type.getDerivedStateFromError;if("function"===typeof r){var i=t.value;n.payload=function(){return r(i)},n.callback=function(){ho(0,t)}}var a=e.stateNode;return null!==a&&"function"===typeof a.componentDidCatch&&(n.callback=function(){ho(0,t),"function"!==typeof r&&(null===Ku?Ku=new Set([this]):Ku.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}function vo(e,t,n){var r=e.pingCache;if(null===r){r=e.pingCache=new fo;var i=new Set;r.set(t,i)}else void 0===(i=r.get(t))&&(i=new Set,r.set(t,i));i.has(n)||(i.add(n),e=Il.bind(null,e,t,n),t.then(e,e))}function mo(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function go(e,t,n,r,i){return 0===(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,1===n.tag&&(null===n.alternate?n.tag=17:((t=Da(-1,1)).tag=2,La(n,t,1))),n.lanes|=1),e):(e.flags|=65536,e.lanes=i,e)}var yo=E.ReactCurrentOwner,Eo=!1;function bo(e,t,n,r){t.child=null===e?Ja(t,null,n,r):Za(t,e.child,n,r)}function Co(e,t,n,r,i){n=n.render;var a=t.ref;return Sa(t,i),r=ws(e,t,n,r,a,i),n=Ss(),null===e||Eo?(ia&&n&&ea(t),t.flags|=1,bo(e,t,r,i),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,jo(e,t,i))}function wo(e,t,n,r,i){if(null===e){var a=n.type;return"function"!==typeof a||Dl(a)||void 0!==a.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=Rl(n.type,null,r,t,t.mode,i)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=a,So(e,t,a,r,i))}if(a=e.child,0===(e.lanes&i)){var s=a.memoizedProps;if((n=null!==(n=n.compare)?n:ur)(s,r)&&e.ref===t.ref)return jo(e,t,i)}return t.flags|=1,(e=Ll(a,r)).ref=t.ref,e.return=t,t.child=e}function So(e,t,n,r,i){if(null!==e){var a=e.memoizedProps;if(ur(a,r)&&e.ref===t.ref){if(Eo=!1,t.pendingProps=r=a,0===(e.lanes&i))return t.lanes=e.lanes,jo(e,t,i);0!==(131072&e.flags)&&(Eo=!0)}}return No(e,t,n,r,i)}function To(e,t,n){var r=t.pendingProps,i=r.children,a=null!==e?e.memoizedState:null;if("hidden"===r.mode)if(0===(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ii(Lu,Du),Du|=n;else{if(0===(1073741824&n))return e=null!==a?a.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Ii(Lu,Du),Du|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=null!==a?a.baseLanes:n,Ii(Lu,Du),Du|=r}else null!==a?(r=a.baseLanes|n,t.memoizedState=null):r=n,Ii(Lu,Du),Du|=r;return bo(e,t,i,n),t.child}function Io(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function No(e,t,n,r,i){var a=Oi(n)?Mi:Ai.current;return a=Ui(t,a),Sa(t,i),n=ws(e,t,n,r,a,i),r=Ss(),null===e||Eo?(ia&&r&&ea(t),t.flags|=1,bo(e,t,n,i),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,jo(e,t,i))}function Ao(e,t,n,r,i){if(Oi(n)){var a=!0;xi(t)}else a=!1;if(Sa(t,i),null===t.stateNode)Bo(e,t),Ga(t,n,r),ja(t,n,r,i),r=!0;else if(null===e){var s=t.stateNode,o=t.memoizedProps;s.props=o;var u=s.context,l=n.contextType;"object"===typeof l&&null!==l?l=Ta(l):l=Ui(t,l=Oi(n)?Mi:Ai.current);var c=n.getDerivedStateFromProps,d="function"===typeof c||"function"===typeof s.getSnapshotBeforeUpdate;d||"function"!==typeof s.UNSAFE_componentWillReceiveProps&&"function"!==typeof s.componentWillReceiveProps||(o!==r||u!==l)&&Ba(t,s,r,l),Ma=!1;var h=t.memoizedState;s.state=h,Pa(t,r,s,i),u=t.memoizedState,o!==r||h!==u||ki.current||Ma?("function"===typeof c&&(Ha(t,n,c,r),u=t.memoizedState),(o=Ma||Va(t,n,o,r,h,u,l))?(d||"function"!==typeof s.UNSAFE_componentWillMount&&"function"!==typeof s.componentWillMount||("function"===typeof s.componentWillMount&&s.componentWillMount(),"function"===typeof s.UNSAFE_componentWillMount&&s.UNSAFE_componentWillMount()),"function"===typeof s.componentDidMount&&(t.flags|=4194308)):("function"===typeof s.componentDidMount&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=u),s.props=r,s.state=u,s.context=l,r=o):("function"===typeof s.componentDidMount&&(t.flags|=4194308),r=!1)}else{s=t.stateNode,Oa(e,t),o=t.memoizedProps,l=t.type===t.elementType?o:va(t.type,o),s.props=l,d=t.pendingProps,h=s.context,"object"===typeof(u=n.contextType)&&null!==u?u=Ta(u):u=Ui(t,u=Oi(n)?Mi:Ai.current);var f=n.getDerivedStateFromProps;(c="function"===typeof f||"function"===typeof s.getSnapshotBeforeUpdate)||"function"!==typeof s.UNSAFE_componentWillReceiveProps&&"function"!==typeof s.componentWillReceiveProps||(o!==d||h!==u)&&Ba(t,s,r,u),Ma=!1,h=t.memoizedState,s.state=h,Pa(t,r,s,i);var p=t.memoizedState;o!==d||h!==p||ki.current||Ma?("function"===typeof f&&(Ha(t,n,f,r),p=t.memoizedState),(l=Ma||Va(t,n,l,r,h,p,u)||!1)?(c||"function"!==typeof s.UNSAFE_componentWillUpdate&&"function"!==typeof s.componentWillUpdate||("function"===typeof s.componentWillUpdate&&s.componentWillUpdate(r,p,u),"function"===typeof s.UNSAFE_componentWillUpdate&&s.UNSAFE_componentWillUpdate(r,p,u)),"function"===typeof s.componentDidUpdate&&(t.flags|=4),"function"===typeof s.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof s.componentDidUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof s.getSnapshotBeforeUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=p),s.props=r,s.state=p,s.context=u,r=l):("function"!==typeof s.componentDidUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof s.getSnapshotBeforeUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),r=!1)}return ko(e,t,n,r,a,i)}function ko(e,t,n,r,i,a){Io(e,t);var s=0!==(128&t.flags);if(!r&&!s)return i&&Pi(t,n,!1),jo(e,t,a);r=t.stateNode,yo.current=t;var o=s&&"function"!==typeof n.getDerivedStateFromError?null:r.render();return t.flags|=1,null!==e&&s?(t.child=Za(t,e.child,null,a),t.child=Za(t,null,o,a)):bo(e,t,o,a),t.memoizedState=r.state,i&&Pi(t,n,!0),t.child}function Mo(e){var t=e.stateNode;t.pendingContext?Li(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Li(0,t.context,!1),rs(e,t.containerInfo)}function Uo(e,t,n,r,i){return fa(),pa(i),t.flags|=256,bo(e,t,n,r),t.child}var Oo,Do,Lo,Ro,xo={dehydrated:null,treeContext:null,retryLane:0};function Po(e){return{baseLanes:e,cachePool:null,transitions:null}}function Fo(e,t,n){var r,i=t.pendingProps,s=os.current,o=!1,u=0!==(128&t.flags);if((r=u)||(r=(null===e||null!==e.memoizedState)&&0!==(2&s)),r?(o=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(s|=1),Ii(os,1&s),null===e)return la(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0===(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(u=i.children,e=i.fallback,o?(i=t.mode,o=t.child,u={mode:"hidden",children:u},0===(1&i)&&null!==o?(o.childLanes=0,o.pendingProps=u):o=Pl(u,i,0,null),e=xl(e,i,n,null),o.return=t,e.return=t,o.sibling=e,t.child=o,t.child.memoizedState=Po(n),t.memoizedState=xo,e):zo(t,u));if(null!==(s=e.memoizedState)&&null!==(r=s.dehydrated))return function(e,t,n,r,i,s,o){if(n)return 256&t.flags?(t.flags&=-257,Ho(e,t,o,r=co(Error(a(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(s=r.fallback,i=t.mode,r=Pl({mode:"visible",children:r.children},i,0,null),(s=xl(s,i,o,null)).flags|=2,r.return=t,s.return=t,r.sibling=s,t.child=r,0!==(1&t.mode)&&Za(t,e.child,null,o),t.child.memoizedState=Po(o),t.memoizedState=xo,s);if(0===(1&t.mode))return Ho(e,t,o,null);if("$!"===i.data){if(r=i.nextSibling&&i.nextSibling.dataset)var u=r.dgst;return r=u,Ho(e,t,o,r=co(s=Error(a(419)),r,void 0))}if(u=0!==(o&e.childLanes),Eo||u){if(null!==(r=Mu)){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}0!==(i=0!==(i&(r.suspendedLanes|o))?0:i)&&i!==s.retryLane&&(s.retryLane=i,ka(e,i),rl(r,e,i,-1))}return vl(),Ho(e,t,o,r=co(Error(a(421))))}return"$?"===i.data?(t.flags|=128,t.child=e.child,t=Al.bind(null,e),i._reactRetry=t,null):(e=s.treeContext,ra=li(i.nextSibling),na=t,ia=!0,aa=null,null!==e&&(Ki[Wi++]=Zi,Ki[Wi++]=Ji,Ki[Wi++]=Yi,Zi=e.id,Ji=e.overflow,Yi=t),t=zo(t,r.children),t.flags|=4096,t)}(e,t,u,i,r,s,n);if(o){o=i.fallback,u=t.mode,r=(s=e.child).sibling;var l={mode:"hidden",children:i.children};return 0===(1&u)&&t.child!==s?((i=t.child).childLanes=0,i.pendingProps=l,t.deletions=null):(i=Ll(s,l)).subtreeFlags=14680064&s.subtreeFlags,null!==r?o=Ll(r,o):(o=xl(o,u,n,null)).flags|=2,o.return=t,i.return=t,i.sibling=o,t.child=i,i=o,o=t.child,u=null===(u=e.child.memoizedState)?Po(n):{baseLanes:u.baseLanes|n,cachePool:null,transitions:u.transitions},o.memoizedState=u,o.childLanes=e.childLanes&~n,t.memoizedState=xo,i}return e=(o=e.child).sibling,i=Ll(o,{mode:"visible",children:i.children}),0===(1&t.mode)&&(i.lanes=n),i.return=t,i.sibling=null,null!==e&&(null===(n=t.deletions)?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=i,t.memoizedState=null,i}function zo(e,t){return(t=Pl({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function Ho(e,t,n,r){return null!==r&&pa(r),Za(t,e.child,null,n),(e=zo(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function qo(e,t,n){e.lanes|=t;var r=e.alternate;null!==r&&(r.lanes|=t),wa(e.return,t,n)}function Vo(e,t,n,r,i){var a=e.memoizedState;null===a?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(a.isBackwards=t,a.rendering=null,a.renderingStartTime=0,a.last=r,a.tail=n,a.tailMode=i)}function Go(e,t,n){var r=t.pendingProps,i=r.revealOrder,a=r.tail;if(bo(e,t,r.children,n),0!==(2&(r=os.current)))r=1&r|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&qo(e,n,t);else if(19===e.tag)qo(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(Ii(os,r),0===(1&t.mode))t.memoizedState=null;else switch(i){case"forwards":for(n=t.child,i=null;null!==n;)null!==(e=n.alternate)&&null===us(e)&&(i=n),n=n.sibling;null===(n=i)?(i=t.child,t.child=null):(i=n.sibling,n.sibling=null),Vo(t,!1,i,n,a);break;case"backwards":for(n=null,i=t.child,t.child=null;null!==i;){if(null!==(e=i.alternate)&&null===us(e)){t.child=i;break}e=i.sibling,i.sibling=n,n=i,i=e}Vo(t,!0,n,null,a);break;case"together":Vo(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Bo(e,t){0===(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function jo(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),Pu|=t.lanes,0===(n&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(a(153));if(null!==t.child){for(n=Ll(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Ll(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function Qo(e,t){if(!ia)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function Ko(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,r=0;if(t)for(var i=e.child;null!==i;)n|=i.lanes|i.childLanes,r|=14680064&i.subtreeFlags,r|=14680064&i.flags,i.return=e,i=i.sibling;else for(i=e.child;null!==i;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function Wo(e,t,n){var r=t.pendingProps;switch(ta(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ko(t),null;case 1:case 17:return Oi(t.type)&&Di(),Ko(t),null;case 3:return r=t.stateNode,is(),Ti(ki),Ti(Ai),cs(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),null!==e&&null!==e.child||(da(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==aa&&(ol(aa),aa=null))),Do(e,t),Ko(t),null;case 5:ss(t);var i=ns(ts.current);if(n=t.type,null!==e&&null!=t.stateNode)Lo(e,t,n,r,i),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(null===t.stateNode)throw Error(a(166));return Ko(t),null}if(e=ns($a.current),da(t)){r=t.stateNode,n=t.type;var s=t.memoizedProps;switch(r[hi]=t,r[fi]=s,e=0!==(1&t.mode),n){case"dialog":zr("cancel",r),zr("close",r);break;case"iframe":case"object":case"embed":zr("load",r);break;case"video":case"audio":for(i=0;i<Rr.length;i++)zr(Rr[i],r);break;case"source":zr("error",r);break;case"img":case"image":case"link":zr("error",r),zr("load",r);break;case"details":zr("toggle",r);break;case"input":Z(r,s),zr("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},zr("invalid",r);break;case"textarea":ie(r,s),zr("invalid",r)}for(var u in ge(n,s),i=null,s)if(s.hasOwnProperty(u)){var l=s[u];"children"===u?"string"===typeof l?r.textContent!==l&&(!0!==s.suppressHydrationWarning&&Xr(r.textContent,l,e),i=["children",l]):"number"===typeof l&&r.textContent!==""+l&&(!0!==s.suppressHydrationWarning&&Xr(r.textContent,l,e),i=["children",""+l]):o.hasOwnProperty(u)&&null!=l&&"onScroll"===u&&zr("scroll",r)}switch(n){case"input":Q(r),$(r,s,!0);break;case"textarea":Q(r),se(r);break;case"select":case"option":break;default:"function"===typeof s.onClick&&(r.onclick=$r)}r=i,t.updateQueue=r,null!==r&&(t.flags|=4)}else{u=9===i.nodeType?i:i.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=oe(n)),"http://www.w3.org/1999/xhtml"===e?"script"===n?((e=u.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof r.is?e=u.createElement(n,{is:r.is}):(e=u.createElement(n),"select"===n&&(u=e,r.multiple?u.multiple=!0:r.size&&(u.size=r.size))):e=u.createElementNS(e,n),e[hi]=t,e[fi]=r,Oo(e,t,!1,!1),t.stateNode=e;e:{switch(u=ye(n,r),n){case"dialog":zr("cancel",e),zr("close",e),i=r;break;case"iframe":case"object":case"embed":zr("load",e),i=r;break;case"video":case"audio":for(i=0;i<Rr.length;i++)zr(Rr[i],e);i=r;break;case"source":zr("error",e),i=r;break;case"img":case"image":case"link":zr("error",e),zr("load",e),i=r;break;case"details":zr("toggle",e),i=r;break;case"input":Z(e,r),i=Y(e,r),zr("invalid",e);break;case"option":default:i=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},i=P({},r,{value:void 0}),zr("invalid",e);break;case"textarea":ie(e,r),i=re(e,r),zr("invalid",e)}for(s in ge(n,i),l=i)if(l.hasOwnProperty(s)){var c=l[s];"style"===s?ve(e,c):"dangerouslySetInnerHTML"===s?null!=(c=c?c.__html:void 0)&&de(e,c):"children"===s?"string"===typeof c?("textarea"!==n||""!==c)&&he(e,c):"number"===typeof c&&he(e,""+c):"suppressContentEditableWarning"!==s&&"suppressHydrationWarning"!==s&&"autoFocus"!==s&&(o.hasOwnProperty(s)?null!=c&&"onScroll"===s&&zr("scroll",e):null!=c&&y(e,s,c,u))}switch(n){case"input":Q(e),$(e,r,!1);break;case"textarea":Q(e),se(e);break;case"option":null!=r.value&&e.setAttribute("value",""+B(r.value));break;case"select":e.multiple=!!r.multiple,null!=(s=r.value)?ne(e,!!r.multiple,s,!1):null!=r.defaultValue&&ne(e,!!r.multiple,r.defaultValue,!0);break;default:"function"===typeof i.onClick&&(e.onclick=$r)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return Ko(t),null;case 6:if(e&&null!=t.stateNode)Ro(e,t,e.memoizedProps,r);else{if("string"!==typeof r&&null===t.stateNode)throw Error(a(166));if(n=ns(ts.current),ns($a.current),da(t)){if(r=t.stateNode,n=t.memoizedProps,r[hi]=t,(s=r.nodeValue!==n)&&null!==(e=na))switch(e.tag){case 3:Xr(r.nodeValue,n,0!==(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&Xr(r.nodeValue,n,0!==(1&e.mode))}s&&(t.flags|=4)}else(r=(9===n.nodeType?n:n.ownerDocument).createTextNode(r))[hi]=t,t.stateNode=r}return Ko(t),null;case 13:if(Ti(os),r=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(ia&&null!==ra&&0!==(1&t.mode)&&0===(128&t.flags))ha(),fa(),t.flags|=98560,s=!1;else if(s=da(t),null!==r&&null!==r.dehydrated){if(null===e){if(!s)throw Error(a(318));if(!(s=null!==(s=t.memoizedState)?s.dehydrated:null))throw Error(a(317));s[hi]=t}else fa(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;Ko(t),s=!1}else null!==aa&&(ol(aa),aa=null),s=!0;if(!s)return 65536&t.flags?t:null}return 0!==(128&t.flags)?(t.lanes=n,t):((r=null!==r)!==(null!==e&&null!==e.memoizedState)&&r&&(t.child.flags|=8192,0!==(1&t.mode)&&(null===e||0!==(1&os.current)?0===Ru&&(Ru=3):vl())),null!==t.updateQueue&&(t.flags|=4),Ko(t),null);case 4:return is(),Do(e,t),null===e&&Vr(t.stateNode.containerInfo),Ko(t),null;case 10:return Ca(t.type._context),Ko(t),null;case 19:if(Ti(os),null===(s=t.memoizedState))return Ko(t),null;if(r=0!==(128&t.flags),null===(u=s.rendering))if(r)Qo(s,!1);else{if(0!==Ru||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(u=us(e))){for(t.flags|=128,Qo(s,!1),null!==(r=u.updateQueue)&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;null!==n;)e=r,(s=n).flags&=14680066,null===(u=s.alternate)?(s.childLanes=0,s.lanes=e,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=u.childLanes,s.lanes=u.lanes,s.child=u.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=u.memoizedProps,s.memoizedState=u.memoizedState,s.updateQueue=u.updateQueue,s.type=u.type,e=u.dependencies,s.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Ii(os,1&os.current|2),t.child}e=e.sibling}null!==s.tail&&Je()>Gu&&(t.flags|=128,r=!0,Qo(s,!1),t.lanes=4194304)}else{if(!r)if(null!==(e=us(u))){if(t.flags|=128,r=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.flags|=4),Qo(s,!0),null===s.tail&&"hidden"===s.tailMode&&!u.alternate&&!ia)return Ko(t),null}else 2*Je()-s.renderingStartTime>Gu&&1073741824!==n&&(t.flags|=128,r=!0,Qo(s,!1),t.lanes=4194304);s.isBackwards?(u.sibling=t.child,t.child=u):(null!==(n=s.last)?n.sibling=u:t.child=u,s.last=u)}return null!==s.tail?(t=s.tail,s.rendering=t,s.tail=t.sibling,s.renderingStartTime=Je(),t.sibling=null,n=os.current,Ii(os,r?1&n|2:1&n),t):(Ko(t),null);case 22:case 23:return hl(),r=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==r&&(t.flags|=8192),r&&0!==(1&t.mode)?0!==(1073741824&Du)&&(Ko(t),6&t.subtreeFlags&&(t.flags|=8192)):Ko(t),null;case 24:case 25:return null}throw Error(a(156,t.tag))}function Yo(e,t){switch(ta(t),t.tag){case 1:return Oi(t.type)&&Di(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return is(),Ti(ki),Ti(Ai),cs(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 5:return ss(t),null;case 13:if(Ti(os),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(a(340));fa()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return Ti(os),null;case 4:return is(),null;case 10:return Ca(t.type._context),null;case 22:case 23:return hl(),null;default:return null}}Oo=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Do=function(){},Lo=function(e,t,n,r){var i=e.memoizedProps;if(i!==r){e=t.stateNode,ns($a.current);var a,s=null;switch(n){case"input":i=Y(e,i),r=Y(e,r),s=[];break;case"select":i=P({},i,{value:void 0}),r=P({},r,{value:void 0}),s=[];break;case"textarea":i=re(e,i),r=re(e,r),s=[];break;default:"function"!==typeof i.onClick&&"function"===typeof r.onClick&&(e.onclick=$r)}for(c in ge(n,r),n=null,i)if(!r.hasOwnProperty(c)&&i.hasOwnProperty(c)&&null!=i[c])if("style"===c){var u=i[c];for(a in u)u.hasOwnProperty(a)&&(n||(n={}),n[a]="")}else"dangerouslySetInnerHTML"!==c&&"children"!==c&&"suppressContentEditableWarning"!==c&&"suppressHydrationWarning"!==c&&"autoFocus"!==c&&(o.hasOwnProperty(c)?s||(s=[]):(s=s||[]).push(c,null));for(c in r){var l=r[c];if(u=null!=i?i[c]:void 0,r.hasOwnProperty(c)&&l!==u&&(null!=l||null!=u))if("style"===c)if(u){for(a in u)!u.hasOwnProperty(a)||l&&l.hasOwnProperty(a)||(n||(n={}),n[a]="");for(a in l)l.hasOwnProperty(a)&&u[a]!==l[a]&&(n||(n={}),n[a]=l[a])}else n||(s||(s=[]),s.push(c,n)),n=l;else"dangerouslySetInnerHTML"===c?(l=l?l.__html:void 0,u=u?u.__html:void 0,null!=l&&u!==l&&(s=s||[]).push(c,l)):"children"===c?"string"!==typeof l&&"number"!==typeof l||(s=s||[]).push(c,""+l):"suppressContentEditableWarning"!==c&&"suppressHydrationWarning"!==c&&(o.hasOwnProperty(c)?(null!=l&&"onScroll"===c&&zr("scroll",e),s||u===l||(s=[])):(s=s||[]).push(c,l))}n&&(s=s||[]).push("style",n);var c=s;(t.updateQueue=c)&&(t.flags|=4)}},Ro=function(e,t,n,r){n!==r&&(t.flags|=4)};var Zo=!1,Jo=!1,Xo="function"===typeof WeakSet?WeakSet:Set,$o=null;function eu(e,t){var n=e.ref;if(null!==n)if("function"===typeof n)try{n(null)}catch(r){Tl(e,t,r)}else n.current=null}function tu(e,t,n){try{n()}catch(r){Tl(e,t,r)}}var nu=!1;function ru(e,t,n){var r=t.updateQueue;if(null!==(r=null!==r?r.lastEffect:null)){var i=r=r.next;do{if((i.tag&e)===e){var a=i.destroy;i.destroy=void 0,void 0!==a&&tu(t,n,a)}i=i.next}while(i!==r)}}function iu(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function au(e){var t=e.ref;if(null!==t){var n=e.stateNode;e.tag,e=n,"function"===typeof t?t(e):t.current=e}}function su(e){var t=e.alternate;null!==t&&(e.alternate=null,su(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[hi],delete t[fi],delete t[_i],delete t[vi],delete t[mi])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function ou(e){return 5===e.tag||3===e.tag||4===e.tag}function uu(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||ou(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function lu(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!==(n=n._reactRootContainer)&&void 0!==n||null!==t.onclick||(t.onclick=$r));else if(4!==r&&null!==(e=e.child))for(lu(e,t,n),e=e.sibling;null!==e;)lu(e,t,n),e=e.sibling}function cu(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==r&&null!==(e=e.child))for(cu(e,t,n),e=e.sibling;null!==e;)cu(e,t,n),e=e.sibling}var du=null,hu=!1;function fu(e,t,n){for(n=n.child;null!==n;)pu(e,t,n),n=n.sibling}function pu(e,t,n){if(at&&"function"===typeof at.onCommitFiberUnmount)try{at.onCommitFiberUnmount(it,n)}catch(o){}switch(n.tag){case 5:Jo||eu(n,t);case 6:var r=du,i=hu;du=null,fu(e,t,n),hu=i,null!==(du=r)&&(hu?(e=du,n=n.stateNode,8===e.nodeType?e.parentNode.removeChild(n):e.removeChild(n)):du.removeChild(n.stateNode));break;case 18:null!==du&&(hu?(e=du,n=n.stateNode,8===e.nodeType?ui(e.parentNode,n):1===e.nodeType&&ui(e,n),Vt(e)):ui(du,n.stateNode));break;case 4:r=du,i=hu,du=n.stateNode.containerInfo,hu=!0,fu(e,t,n),du=r,hu=i;break;case 0:case 11:case 14:case 15:if(!Jo&&(null!==(r=n.updateQueue)&&null!==(r=r.lastEffect))){i=r=r.next;do{var a=i,s=a.destroy;a=a.tag,void 0!==s&&(0!==(2&a)||0!==(4&a))&&tu(n,t,s),i=i.next}while(i!==r)}fu(e,t,n);break;case 1:if(!Jo&&(eu(n,t),"function"===typeof(r=n.stateNode).componentWillUnmount))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(o){Tl(n,t,o)}fu(e,t,n);break;case 21:fu(e,t,n);break;case 22:1&n.mode?(Jo=(r=Jo)||null!==n.memoizedState,fu(e,t,n),Jo=r):fu(e,t,n);break;default:fu(e,t,n)}}function _u(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new Xo),t.forEach((function(t){var r=kl.bind(null,e,t);n.has(t)||(n.add(t),t.then(r,r))}))}}function vu(e,t){var n=t.deletions;if(null!==n)for(var r=0;r<n.length;r++){var i=n[r];try{var s=e,o=t,u=o;e:for(;null!==u;){switch(u.tag){case 5:du=u.stateNode,hu=!1;break e;case 3:case 4:du=u.stateNode.containerInfo,hu=!0;break e}u=u.return}if(null===du)throw Error(a(160));pu(s,o,i),du=null,hu=!1;var l=i.alternate;null!==l&&(l.return=null),i.return=null}catch(c){Tl(i,t,c)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)mu(t,e),t=t.sibling}function mu(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(vu(t,e),gu(e),4&r){try{ru(3,e,e.return),iu(3,e)}catch(v){Tl(e,e.return,v)}try{ru(5,e,e.return)}catch(v){Tl(e,e.return,v)}}break;case 1:vu(t,e),gu(e),512&r&&null!==n&&eu(n,n.return);break;case 5:if(vu(t,e),gu(e),512&r&&null!==n&&eu(n,n.return),32&e.flags){var i=e.stateNode;try{he(i,"")}catch(v){Tl(e,e.return,v)}}if(4&r&&null!=(i=e.stateNode)){var s=e.memoizedProps,o=null!==n?n.memoizedProps:s,u=e.type,l=e.updateQueue;if(e.updateQueue=null,null!==l)try{"input"===u&&"radio"===s.type&&null!=s.name&&J(i,s),ye(u,o);var c=ye(u,s);for(o=0;o<l.length;o+=2){var d=l[o],h=l[o+1];"style"===d?ve(i,h):"dangerouslySetInnerHTML"===d?de(i,h):"children"===d?he(i,h):y(i,d,h,c)}switch(u){case"input":X(i,s);break;case"textarea":ae(i,s);break;case"select":var f=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var p=s.value;null!=p?ne(i,!!s.multiple,p,!1):f!==!!s.multiple&&(null!=s.defaultValue?ne(i,!!s.multiple,s.defaultValue,!0):ne(i,!!s.multiple,s.multiple?[]:"",!1))}i[fi]=s}catch(v){Tl(e,e.return,v)}}break;case 6:if(vu(t,e),gu(e),4&r){if(null===e.stateNode)throw Error(a(162));i=e.stateNode,s=e.memoizedProps;try{i.nodeValue=s}catch(v){Tl(e,e.return,v)}}break;case 3:if(vu(t,e),gu(e),4&r&&null!==n&&n.memoizedState.isDehydrated)try{Vt(t.containerInfo)}catch(v){Tl(e,e.return,v)}break;case 4:default:vu(t,e),gu(e);break;case 13:vu(t,e),gu(e),8192&(i=e.child).flags&&(s=null!==i.memoizedState,i.stateNode.isHidden=s,!s||null!==i.alternate&&null!==i.alternate.memoizedState||(Vu=Je())),4&r&&_u(e);break;case 22:if(d=null!==n&&null!==n.memoizedState,1&e.mode?(Jo=(c=Jo)||d,vu(t,e),Jo=c):vu(t,e),gu(e),8192&r){if(c=null!==e.memoizedState,(e.stateNode.isHidden=c)&&!d&&0!==(1&e.mode))for($o=e,d=e.child;null!==d;){for(h=$o=d;null!==$o;){switch(p=(f=$o).child,f.tag){case 0:case 11:case 14:case 15:ru(4,f,f.return);break;case 1:eu(f,f.return);var _=f.stateNode;if("function"===typeof _.componentWillUnmount){r=f,n=f.return;try{t=r,_.props=t.memoizedProps,_.state=t.memoizedState,_.componentWillUnmount()}catch(v){Tl(r,n,v)}}break;case 5:eu(f,f.return);break;case 22:if(null!==f.memoizedState){Cu(h);continue}}null!==p?(p.return=f,$o=p):Cu(h)}d=d.sibling}e:for(d=null,h=e;;){if(5===h.tag){if(null===d){d=h;try{i=h.stateNode,c?"function"===typeof(s=i.style).setProperty?s.setProperty("display","none","important"):s.display="none":(u=h.stateNode,o=void 0!==(l=h.memoizedProps.style)&&null!==l&&l.hasOwnProperty("display")?l.display:null,u.style.display=_e("display",o))}catch(v){Tl(e,e.return,v)}}}else if(6===h.tag){if(null===d)try{h.stateNode.nodeValue=c?"":h.memoizedProps}catch(v){Tl(e,e.return,v)}}else if((22!==h.tag&&23!==h.tag||null===h.memoizedState||h===e)&&null!==h.child){h.child.return=h,h=h.child;continue}if(h===e)break e;for(;null===h.sibling;){if(null===h.return||h.return===e)break e;d===h&&(d=null),h=h.return}d===h&&(d=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:vu(t,e),gu(e),4&r&&_u(e);case 21:}}function gu(e){var t=e.flags;if(2&t){try{e:{for(var n=e.return;null!==n;){if(ou(n)){var r=n;break e}n=n.return}throw Error(a(160))}switch(r.tag){case 5:var i=r.stateNode;32&r.flags&&(he(i,""),r.flags&=-33),cu(e,uu(e),i);break;case 3:case 4:var s=r.stateNode.containerInfo;lu(e,uu(e),s);break;default:throw Error(a(161))}}catch(o){Tl(e,e.return,o)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function yu(e,t,n){$o=e,Eu(e,t,n)}function Eu(e,t,n){for(var r=0!==(1&e.mode);null!==$o;){var i=$o,a=i.child;if(22===i.tag&&r){var s=null!==i.memoizedState||Zo;if(!s){var o=i.alternate,u=null!==o&&null!==o.memoizedState||Jo;o=Zo;var l=Jo;if(Zo=s,(Jo=u)&&!l)for($o=i;null!==$o;)u=(s=$o).child,22===s.tag&&null!==s.memoizedState?wu(i):null!==u?(u.return=s,$o=u):wu(i);for(;null!==a;)$o=a,Eu(a,t,n),a=a.sibling;$o=i,Zo=o,Jo=l}bu(e)}else 0!==(8772&i.subtreeFlags)&&null!==a?(a.return=i,$o=a):bu(e)}}function bu(e){for(;null!==$o;){var t=$o;if(0!==(8772&t.flags)){var n=t.alternate;try{if(0!==(8772&t.flags))switch(t.tag){case 0:case 11:case 15:Jo||iu(5,t);break;case 1:var r=t.stateNode;if(4&t.flags&&!Jo)if(null===n)r.componentDidMount();else{var i=t.elementType===t.type?n.memoizedProps:va(t.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=t.updateQueue;null!==s&&Fa(t,s,r);break;case 3:var o=t.updateQueue;if(null!==o){if(n=null,null!==t.child)switch(t.child.tag){case 5:case 1:n=t.child.stateNode}Fa(t,o,n)}break;case 5:var u=t.stateNode;if(null===n&&4&t.flags){n=u;var l=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var c=t.alternate;if(null!==c){var d=c.memoizedState;if(null!==d){var h=d.dehydrated;null!==h&&Vt(h)}}}break;default:throw Error(a(163))}Jo||512&t.flags&&au(t)}catch(f){Tl(t,t.return,f)}}if(t===e){$o=null;break}if(null!==(n=t.sibling)){n.return=t.return,$o=n;break}$o=t.return}}function Cu(e){for(;null!==$o;){var t=$o;if(t===e){$o=null;break}var n=t.sibling;if(null!==n){n.return=t.return,$o=n;break}$o=t.return}}function wu(e){for(;null!==$o;){var t=$o;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{iu(4,t)}catch(u){Tl(t,n,u)}break;case 1:var r=t.stateNode;if("function"===typeof r.componentDidMount){var i=t.return;try{r.componentDidMount()}catch(u){Tl(t,i,u)}}var a=t.return;try{au(t)}catch(u){Tl(t,a,u)}break;case 5:var s=t.return;try{au(t)}catch(u){Tl(t,s,u)}}}catch(u){Tl(t,t.return,u)}if(t===e){$o=null;break}var o=t.sibling;if(null!==o){o.return=t.return,$o=o;break}$o=t.return}}var Su,Tu=Math.ceil,Iu=E.ReactCurrentDispatcher,Nu=E.ReactCurrentOwner,Au=E.ReactCurrentBatchConfig,ku=0,Mu=null,Uu=null,Ou=0,Du=0,Lu=Si(0),Ru=0,xu=null,Pu=0,Fu=0,zu=0,Hu=null,qu=null,Vu=0,Gu=1/0,Bu=null,ju=!1,Qu=null,Ku=null,Wu=!1,Yu=null,Zu=0,Ju=0,Xu=null,$u=-1,el=0;function tl(){return 0!==(6&ku)?Je():-1!==$u?$u:$u=Je()}function nl(e){return 0===(1&e.mode)?1:0!==(2&ku)&&0!==Ou?Ou&-Ou:null!==_a.transition?(0===el&&(el=_t()),el):0!==(e=yt)?e:e=void 0===(e=window.event)?16:Zt(e.type)}function rl(e,t,n,r){if(50<Ju)throw Ju=0,Xu=null,Error(a(185));mt(e,n,r),0!==(2&ku)&&e===Mu||(e===Mu&&(0===(2&ku)&&(Fu|=n),4===Ru&&ul(e,Ou)),il(e,r),1===n&&0===ku&&0===(1&t.mode)&&(Gu=Je()+500,zi&&Vi()))}function il(e,t){var n=e.callbackNode;!function(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,i=e.expirationTimes,a=e.pendingLanes;0<a;){var s=31-st(a),o=1<<s,u=i[s];-1===u?0!==(o&n)&&0===(o&r)||(i[s]=ft(o,t)):u<=t&&(e.expiredLanes|=o),a&=~o}}(e,t);var r=ht(e,e===Mu?Ou:0);if(0===r)null!==n&&We(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(null!=n&&We(n),1===t)0===e.tag?function(e){zi=!0,qi(e)}(ll.bind(null,e)):qi(ll.bind(null,e)),si((function(){0===(6&ku)&&Vi()})),n=null;else{switch(Et(r)){case 1:n=$e;break;case 4:n=et;break;case 16:default:n=tt;break;case 536870912:n=rt}n=Ml(n,al.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function al(e,t){if($u=-1,el=0,0!==(6&ku))throw Error(a(327));var n=e.callbackNode;if(wl()&&e.callbackNode!==n)return null;var r=ht(e,e===Mu?Ou:0);if(0===r)return null;if(0!==(30&r)||0!==(r&e.expiredLanes)||t)t=ml(e,r);else{t=r;var i=ku;ku|=2;var s=_l();for(Mu===e&&Ou===t||(Bu=null,Gu=Je()+500,fl(e,t));;)try{yl();break}catch(u){pl(e,u)}ba(),Iu.current=s,ku=i,null!==Uu?t=0:(Mu=null,Ou=0,t=Ru)}if(0!==t){if(2===t&&(0!==(i=pt(e))&&(r=i,t=sl(e,i))),1===t)throw n=xu,fl(e,0),ul(e,r),il(e,Je()),n;if(6===t)ul(e,r);else{if(i=e.current.alternate,0===(30&r)&&!function(e){for(var t=e;;){if(16384&t.flags){var n=t.updateQueue;if(null!==n&&null!==(n=n.stores))for(var r=0;r<n.length;r++){var i=n[r],a=i.getSnapshot;i=i.value;try{if(!or(a(),i))return!1}catch(o){return!1}}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(i)&&(2===(t=ml(e,r))&&(0!==(s=pt(e))&&(r=s,t=sl(e,s))),1===t))throw n=xu,fl(e,0),ul(e,r),il(e,Je()),n;switch(e.finishedWork=i,e.finishedLanes=r,t){case 0:case 1:throw Error(a(345));case 2:case 5:Cl(e,qu,Bu);break;case 3:if(ul(e,r),(130023424&r)===r&&10<(t=Vu+500-Je())){if(0!==ht(e,0))break;if(((i=e.suspendedLanes)&r)!==r){tl(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=ri(Cl.bind(null,e,qu,Bu),t);break}Cl(e,qu,Bu);break;case 4:if(ul(e,r),(4194240&r)===r)break;for(t=e.eventTimes,i=-1;0<r;){var o=31-st(r);s=1<<o,(o=t[o])>i&&(i=o),r&=~s}if(r=i,10<(r=(120>(r=Je()-r)?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*Tu(r/1960))-r)){e.timeoutHandle=ri(Cl.bind(null,e,qu,Bu),r);break}Cl(e,qu,Bu);break;default:throw Error(a(329))}}}return il(e,Je()),e.callbackNode===n?al.bind(null,e):null}function sl(e,t){var n=Hu;return e.current.memoizedState.isDehydrated&&(fl(e,t).flags|=256),2!==(e=ml(e,t))&&(t=qu,qu=n,null!==t&&ol(t)),e}function ol(e){null===qu?qu=e:qu.push.apply(qu,e)}function ul(e,t){for(t&=~zu,t&=~Fu,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-st(t),r=1<<n;e[n]=-1,t&=~r}}function ll(e){if(0!==(6&ku))throw Error(a(327));wl();var t=ht(e,0);if(0===(1&t))return il(e,Je()),null;var n=ml(e,t);if(0!==e.tag&&2===n){var r=pt(e);0!==r&&(t=r,n=sl(e,r))}if(1===n)throw n=xu,fl(e,0),ul(e,t),il(e,Je()),n;if(6===n)throw Error(a(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Cl(e,qu,Bu),il(e,Je()),null}function cl(e,t){var n=ku;ku|=1;try{return e(t)}finally{0===(ku=n)&&(Gu=Je()+500,zi&&Vi())}}function dl(e){null!==Yu&&0===Yu.tag&&0===(6&ku)&&wl();var t=ku;ku|=1;var n=Au.transition,r=yt;try{if(Au.transition=null,yt=1,e)return e()}finally{yt=r,Au.transition=n,0===(6&(ku=t))&&Vi()}}function hl(){Du=Lu.current,Ti(Lu)}function fl(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,ii(n)),null!==Uu)for(n=Uu.return;null!==n;){var r=n;switch(ta(r),r.tag){case 1:null!==(r=r.type.childContextTypes)&&void 0!==r&&Di();break;case 3:is(),Ti(ki),Ti(Ai),cs();break;case 5:ss(r);break;case 4:is();break;case 13:case 19:Ti(os);break;case 10:Ca(r.type._context);break;case 22:case 23:hl()}n=n.return}if(Mu=e,Uu=e=Ll(e.current,null),Ou=Du=t,Ru=0,xu=null,zu=Fu=Pu=0,qu=Hu=null,null!==Ia){for(t=0;t<Ia.length;t++)if(null!==(r=(n=Ia[t]).interleaved)){n.interleaved=null;var i=r.next,a=n.pending;if(null!==a){var s=a.next;a.next=i,r.next=s}n.pending=r}Ia=null}return e}function pl(e,t){for(;;){var n=Uu;try{if(ba(),ds.current=ao,ms){for(var r=ps.memoizedState;null!==r;){var i=r.queue;null!==i&&(i.pending=null),r=r.next}ms=!1}if(fs=0,vs=_s=ps=null,gs=!1,ys=0,Nu.current=null,null===n||null===n.return){Ru=1,xu=t,Uu=null;break}e:{var s=e,o=n.return,u=n,l=t;if(t=Ou,u.flags|=32768,null!==l&&"object"===typeof l&&"function"===typeof l.then){var c=l,d=u,h=d.tag;if(0===(1&d.mode)&&(0===h||11===h||15===h)){var f=d.alternate;f?(d.updateQueue=f.updateQueue,d.memoizedState=f.memoizedState,d.lanes=f.lanes):(d.updateQueue=null,d.memoizedState=null)}var p=mo(o);if(null!==p){p.flags&=-257,go(p,o,u,0,t),1&p.mode&&vo(s,c,t),l=c;var _=(t=p).updateQueue;if(null===_){var v=new Set;v.add(l),t.updateQueue=v}else _.add(l);break e}if(0===(1&t)){vo(s,c,t),vl();break e}l=Error(a(426))}else if(ia&&1&u.mode){var m=mo(o);if(null!==m){0===(65536&m.flags)&&(m.flags|=256),go(m,o,u,0,t),pa(lo(l,u));break e}}s=l=lo(l,u),4!==Ru&&(Ru=2),null===Hu?Hu=[s]:Hu.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,t&=-t,s.lanes|=t,xa(s,po(0,l,t));break e;case 1:u=l;var g=s.type,y=s.stateNode;if(0===(128&s.flags)&&("function"===typeof g.getDerivedStateFromError||null!==y&&"function"===typeof y.componentDidCatch&&(null===Ku||!Ku.has(y)))){s.flags|=65536,t&=-t,s.lanes|=t,xa(s,_o(s,u,t));break e}}s=s.return}while(null!==s)}bl(n)}catch(E){t=E,Uu===n&&null!==n&&(Uu=n=n.return);continue}break}}function _l(){var e=Iu.current;return Iu.current=ao,null===e?ao:e}function vl(){0!==Ru&&3!==Ru&&2!==Ru||(Ru=4),null===Mu||0===(268435455&Pu)&&0===(268435455&Fu)||ul(Mu,Ou)}function ml(e,t){var n=ku;ku|=2;var r=_l();for(Mu===e&&Ou===t||(Bu=null,fl(e,t));;)try{gl();break}catch(i){pl(e,i)}if(ba(),ku=n,Iu.current=r,null!==Uu)throw Error(a(261));return Mu=null,Ou=0,Ru}function gl(){for(;null!==Uu;)El(Uu)}function yl(){for(;null!==Uu&&!Ye();)El(Uu)}function El(e){var t=Su(e.alternate,e,Du);e.memoizedProps=e.pendingProps,null===t?bl(e):Uu=t,Nu.current=null}function bl(e){var t=e;do{var n=t.alternate;if(e=t.return,0===(32768&t.flags)){if(null!==(n=Wo(n,t,Du)))return void(Uu=n)}else{if(null!==(n=Yo(n,t)))return n.flags&=32767,void(Uu=n);if(null===e)return Ru=6,void(Uu=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(Uu=t);Uu=t=e}while(null!==t);0===Ru&&(Ru=5)}function Cl(e,t,n){var r=yt,i=Au.transition;try{Au.transition=null,yt=1,function(e,t,n,r){do{wl()}while(null!==Yu);if(0!==(6&ku))throw Error(a(327));n=e.finishedWork;var i=e.finishedLanes;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(a(177));e.callbackNode=null,e.callbackPriority=0;var s=n.lanes|n.childLanes;if(function(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var i=31-st(n),a=1<<i;t[i]=0,r[i]=-1,e[i]=-1,n&=~a}}(e,s),e===Mu&&(Uu=Mu=null,Ou=0),0===(2064&n.subtreeFlags)&&0===(2064&n.flags)||Wu||(Wu=!0,Ml(tt,(function(){return wl(),null}))),s=0!==(15990&n.flags),0!==(15990&n.subtreeFlags)||s){s=Au.transition,Au.transition=null;var o=yt;yt=1;var u=ku;ku|=4,Nu.current=null,function(e,t){if(ei=Bt,fr(e=hr())){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var r=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(r&&0!==r.rangeCount){n=r.anchorNode;var i=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{n.nodeType,s.nodeType}catch(b){n=null;break e}var o=0,u=-1,l=-1,c=0,d=0,h=e,f=null;t:for(;;){for(var p;h!==n||0!==i&&3!==h.nodeType||(u=o+i),h!==s||0!==r&&3!==h.nodeType||(l=o+r),3===h.nodeType&&(o+=h.nodeValue.length),null!==(p=h.firstChild);)f=h,h=p;for(;;){if(h===e)break t;if(f===n&&++c===i&&(u=o),f===s&&++d===r&&(l=o),null!==(p=h.nextSibling))break;f=(h=f).parentNode}h=p}n=-1===u||-1===l?null:{start:u,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(ti={focusedElem:e,selectionRange:n},Bt=!1,$o=t;null!==$o;)if(e=(t=$o).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,$o=e;else for(;null!==$o;){t=$o;try{var _=t.alternate;if(0!==(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==_){var v=_.memoizedProps,m=_.memoizedState,g=t.stateNode,y=g.getSnapshotBeforeUpdate(t.elementType===t.type?v:va(t.type,v),m);g.__reactInternalSnapshotBeforeUpdate=y}break;case 3:var E=t.stateNode.containerInfo;1===E.nodeType?E.textContent="":9===E.nodeType&&E.documentElement&&E.removeChild(E.documentElement);break;default:throw Error(a(163))}}catch(b){Tl(t,t.return,b)}if(null!==(e=t.sibling)){e.return=t.return,$o=e;break}$o=t.return}_=nu,nu=!1}(e,n),mu(n,e),pr(ti),Bt=!!ei,ti=ei=null,e.current=n,yu(n,e,i),Ze(),ku=u,yt=o,Au.transition=s}else e.current=n;if(Wu&&(Wu=!1,Yu=e,Zu=i),s=e.pendingLanes,0===s&&(Ku=null),function(e){if(at&&"function"===typeof at.onCommitFiberRoot)try{at.onCommitFiberRoot(it,e,void 0,128===(128&e.current.flags))}catch(t){}}(n.stateNode),il(e,Je()),null!==t)for(r=e.onRecoverableError,n=0;n<t.length;n++)i=t[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(ju)throw ju=!1,e=Qu,Qu=null,e;0!==(1&Zu)&&0!==e.tag&&wl(),s=e.pendingLanes,0!==(1&s)?e===Xu?Ju++:(Ju=0,Xu=e):Ju=0,Vi()}(e,t,n,r)}finally{Au.transition=i,yt=r}return null}function wl(){if(null!==Yu){var e=Et(Zu),t=Au.transition,n=yt;try{if(Au.transition=null,yt=16>e?16:e,null===Yu)var r=!1;else{if(e=Yu,Yu=null,Zu=0,0!==(6&ku))throw Error(a(331));var i=ku;for(ku|=4,$o=e.current;null!==$o;){var s=$o,o=s.child;if(0!==(16&$o.flags)){var u=s.deletions;if(null!==u){for(var l=0;l<u.length;l++){var c=u[l];for($o=c;null!==$o;){var d=$o;switch(d.tag){case 0:case 11:case 15:ru(8,d,s)}var h=d.child;if(null!==h)h.return=d,$o=h;else for(;null!==$o;){var f=(d=$o).sibling,p=d.return;if(su(d),d===c){$o=null;break}if(null!==f){f.return=p,$o=f;break}$o=p}}}var _=s.alternate;if(null!==_){var v=_.child;if(null!==v){_.child=null;do{var m=v.sibling;v.sibling=null,v=m}while(null!==v)}}$o=s}}if(0!==(2064&s.subtreeFlags)&&null!==o)o.return=s,$o=o;else e:for(;null!==$o;){if(0!==(2048&(s=$o).flags))switch(s.tag){case 0:case 11:case 15:ru(9,s,s.return)}var g=s.sibling;if(null!==g){g.return=s.return,$o=g;break e}$o=s.return}}var y=e.current;for($o=y;null!==$o;){var E=(o=$o).child;if(0!==(2064&o.subtreeFlags)&&null!==E)E.return=o,$o=E;else e:for(o=y;null!==$o;){if(0!==(2048&(u=$o).flags))try{switch(u.tag){case 0:case 11:case 15:iu(9,u)}}catch(C){Tl(u,u.return,C)}if(u===o){$o=null;break e}var b=u.sibling;if(null!==b){b.return=u.return,$o=b;break e}$o=u.return}}if(ku=i,Vi(),at&&"function"===typeof at.onPostCommitFiberRoot)try{at.onPostCommitFiberRoot(it,e)}catch(C){}r=!0}return r}finally{yt=n,Au.transition=t}}return!1}function Sl(e,t,n){e=La(e,t=po(0,t=lo(n,t),1),1),t=tl(),null!==e&&(mt(e,1,t),il(e,t))}function Tl(e,t,n){if(3===e.tag)Sl(e,e,n);else for(;null!==t;){if(3===t.tag){Sl(t,e,n);break}if(1===t.tag){var r=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof r.componentDidCatch&&(null===Ku||!Ku.has(r))){t=La(t,e=_o(t,e=lo(n,e),1),1),e=tl(),null!==t&&(mt(t,1,e),il(t,e));break}}t=t.return}}function Il(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),t=tl(),e.pingedLanes|=e.suspendedLanes&n,Mu===e&&(Ou&n)===n&&(4===Ru||3===Ru&&(130023424&Ou)===Ou&&500>Je()-Vu?fl(e,0):zu|=n),il(e,t)}function Nl(e,t){0===t&&(0===(1&e.mode)?t=1:(t=ct,0===(130023424&(ct<<=1))&&(ct=4194304)));var n=tl();null!==(e=ka(e,t))&&(mt(e,t,n),il(e,n))}function Al(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),Nl(e,n)}function kl(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,i=e.memoizedState;null!==i&&(n=i.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(a(314))}null!==r&&r.delete(t),Nl(e,n)}function Ml(e,t){return Ke(e,t)}function Ul(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ol(e,t,n,r){return new Ul(e,t,n,r)}function Dl(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Ll(e,t){var n=e.alternate;return null===n?((n=Ol(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=14680064&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Rl(e,t,n,r,i,s){var o=2;if(r=e,"function"===typeof e)Dl(e)&&(o=1);else if("string"===typeof e)o=5;else e:switch(e){case w:return xl(n.children,i,s,t);case S:o=8,i|=8;break;case T:return(e=Ol(12,n,t,2|i)).elementType=T,e.lanes=s,e;case k:return(e=Ol(13,n,t,i)).elementType=k,e.lanes=s,e;case M:return(e=Ol(19,n,t,i)).elementType=M,e.lanes=s,e;case D:return Pl(n,i,s,t);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case I:o=10;break e;case N:o=9;break e;case A:o=11;break e;case U:o=14;break e;case O:o=16,r=null;break e}throw Error(a(130,null==e?e:typeof e,""))}return(t=Ol(o,n,t,i)).elementType=e,t.type=r,t.lanes=s,t}function xl(e,t,n,r){return(e=Ol(7,e,r,t)).lanes=n,e}function Pl(e,t,n,r){return(e=Ol(22,e,r,t)).elementType=D,e.lanes=n,e.stateNode={isHidden:!1},e}function Fl(e,t,n){return(e=Ol(6,e,null,t)).lanes=n,e}function zl(e,t,n){return(t=Ol(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Hl(e,t,n,r,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=vt(0),this.expirationTimes=vt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=vt(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function ql(e,t,n,r,i,a,s,o,u){return e=new Hl(e,t,n,o,u),1===t?(t=1,!0===a&&(t|=8)):t=0,a=Ol(3,null,null,t),e.current=a,a.stateNode=e,a.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Ua(a),e}function Vl(e){if(!e)return Ni;e:{if(Ve(e=e._reactInternals)!==e||1!==e.tag)throw Error(a(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Oi(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(a(171))}if(1===e.tag){var n=e.type;if(Oi(n))return Ri(e,n,t)}return t}function Gl(e,t,n,r,i,a,s,o,u){return(e=ql(n,r,!0,e,0,a,0,o,u)).context=Vl(null),n=e.current,(a=Da(r=tl(),i=nl(n))).callback=void 0!==t&&null!==t?t:null,La(n,a,i),e.current.lanes=i,mt(e,i,r),il(e,r),e}function Bl(e,t,n,r){var i=t.current,a=tl(),s=nl(i);return n=Vl(n),null===t.context?t.context=n:t.pendingContext=n,(t=Da(a,s)).payload={element:e},null!==(r=void 0===r?null:r)&&(t.callback=r),null!==(e=La(i,t,s))&&(rl(e,i,s,a),Ra(e,i,s)),s}function jl(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function Ql(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function Kl(e,t){Ql(e,t),(e=e.alternate)&&Ql(e,t)}Su=function(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps||ki.current)Eo=!0;else{if(0===(e.lanes&n)&&0===(128&t.flags))return Eo=!1,function(e,t,n){switch(t.tag){case 3:Mo(t),fa();break;case 5:as(t);break;case 1:Oi(t.type)&&xi(t);break;case 4:rs(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,i=t.memoizedProps.value;Ii(ma,r._currentValue),r._currentValue=i;break;case 13:if(null!==(r=t.memoizedState))return null!==r.dehydrated?(Ii(os,1&os.current),t.flags|=128,null):0!==(n&t.child.childLanes)?Fo(e,t,n):(Ii(os,1&os.current),null!==(e=jo(e,t,n))?e.sibling:null);Ii(os,1&os.current);break;case 19:if(r=0!==(n&t.childLanes),0!==(128&e.flags)){if(r)return Go(e,t,n);t.flags|=128}if(null!==(i=t.memoizedState)&&(i.rendering=null,i.tail=null,i.lastEffect=null),Ii(os,os.current),r)break;return null;case 22:case 23:return t.lanes=0,To(e,t,n)}return jo(e,t,n)}(e,t,n);Eo=0!==(131072&e.flags)}else Eo=!1,ia&&0!==(1048576&t.flags)&&$i(t,Qi,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;Bo(e,t),e=t.pendingProps;var i=Ui(t,Ai.current);Sa(t,n),i=ws(null,t,r,e,i,n);var s=Ss();return t.flags|=1,"object"===typeof i&&null!==i&&"function"===typeof i.render&&void 0===i.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Oi(r)?(s=!0,xi(t)):s=!1,t.memoizedState=null!==i.state&&void 0!==i.state?i.state:null,Ua(t),i.updater=qa,t.stateNode=i,i._reactInternals=t,ja(t,r,e,n),t=ko(null,t,r,!0,s,n)):(t.tag=0,ia&&s&&ea(t),bo(null,t,i,n),t=t.child),t;case 16:r=t.elementType;e:{switch(Bo(e,t),e=t.pendingProps,r=(i=r._init)(r._payload),t.type=r,i=t.tag=function(e){if("function"===typeof e)return Dl(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===A)return 11;if(e===U)return 14}return 2}(r),e=va(r,e),i){case 0:t=No(null,t,r,e,n);break e;case 1:t=Ao(null,t,r,e,n);break e;case 11:t=Co(null,t,r,e,n);break e;case 14:t=wo(null,t,r,va(r.type,e),n);break e}throw Error(a(306,r,""))}return t;case 0:return r=t.type,i=t.pendingProps,No(e,t,r,i=t.elementType===r?i:va(r,i),n);case 1:return r=t.type,i=t.pendingProps,Ao(e,t,r,i=t.elementType===r?i:va(r,i),n);case 3:e:{if(Mo(t),null===e)throw Error(a(387));r=t.pendingProps,i=(s=t.memoizedState).element,Oa(e,t),Pa(t,r,null,n);var o=t.memoizedState;if(r=o.element,s.isDehydrated){if(s={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=s,t.memoizedState=s,256&t.flags){t=Uo(e,t,r,n,i=lo(Error(a(423)),t));break e}if(r!==i){t=Uo(e,t,r,n,i=lo(Error(a(424)),t));break e}for(ra=li(t.stateNode.containerInfo.firstChild),na=t,ia=!0,aa=null,n=Ja(t,null,r,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(fa(),r===i){t=jo(e,t,n);break e}bo(e,t,r,n)}t=t.child}return t;case 5:return as(t),null===e&&la(t),r=t.type,i=t.pendingProps,s=null!==e?e.memoizedProps:null,o=i.children,ni(r,i)?o=null:null!==s&&ni(r,s)&&(t.flags|=32),Io(e,t),bo(e,t,o,n),t.child;case 6:return null===e&&la(t),null;case 13:return Fo(e,t,n);case 4:return rs(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=Za(t,null,r,n):bo(e,t,r,n),t.child;case 11:return r=t.type,i=t.pendingProps,Co(e,t,r,i=t.elementType===r?i:va(r,i),n);case 7:return bo(e,t,t.pendingProps,n),t.child;case 8:case 12:return bo(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,i=t.pendingProps,s=t.memoizedProps,o=i.value,Ii(ma,r._currentValue),r._currentValue=o,null!==s)if(or(s.value,o)){if(s.children===i.children&&!ki.current){t=jo(e,t,n);break e}}else for(null!==(s=t.child)&&(s.return=t);null!==s;){var u=s.dependencies;if(null!==u){o=s.child;for(var l=u.firstContext;null!==l;){if(l.context===r){if(1===s.tag){(l=Da(-1,n&-n)).tag=2;var c=s.updateQueue;if(null!==c){var d=(c=c.shared).pending;null===d?l.next=l:(l.next=d.next,d.next=l),c.pending=l}}s.lanes|=n,null!==(l=s.alternate)&&(l.lanes|=n),wa(s.return,n,t),u.lanes|=n;break}l=l.next}}else if(10===s.tag)o=s.type===t.type?null:s.child;else if(18===s.tag){if(null===(o=s.return))throw Error(a(341));o.lanes|=n,null!==(u=o.alternate)&&(u.lanes|=n),wa(o,n,t),o=s.sibling}else o=s.child;if(null!==o)o.return=s;else for(o=s;null!==o;){if(o===t){o=null;break}if(null!==(s=o.sibling)){s.return=o.return,o=s;break}o=o.return}s=o}bo(e,t,i.children,n),t=t.child}return t;case 9:return i=t.type,r=t.pendingProps.children,Sa(t,n),r=r(i=Ta(i)),t.flags|=1,bo(e,t,r,n),t.child;case 14:return i=va(r=t.type,t.pendingProps),wo(e,t,r,i=va(r.type,i),n);case 15:return So(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:va(r,i),Bo(e,t),t.tag=1,Oi(r)?(e=!0,xi(t)):e=!1,Sa(t,n),Ga(t,r,i),ja(t,r,i,n),ko(null,t,r,!0,e,n);case 19:return Go(e,t,n);case 22:return To(e,t,n)}throw Error(a(156,t.tag))};var Wl="function"===typeof reportError?reportError:function(e){console.error(e)};function Yl(e){this._internalRoot=e}function Zl(e){this._internalRoot=e}function Jl(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function Xl(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function $l(){}function ec(e,t,n,r,i){var a=n._reactRootContainer;if(a){var s=a;if("function"===typeof i){var o=i;i=function(){var e=jl(s);o.call(e)}}Bl(t,s,e,i)}else s=function(e,t,n,r,i){if(i){if("function"===typeof r){var a=r;r=function(){var e=jl(s);a.call(e)}}var s=Gl(t,r,e,0,null,!1,0,"",$l);return e._reactRootContainer=s,e[pi]=s.current,Vr(8===e.nodeType?e.parentNode:e),dl(),s}for(;i=e.lastChild;)e.removeChild(i);if("function"===typeof r){var o=r;r=function(){var e=jl(u);o.call(e)}}var u=ql(e,0,!1,null,0,!1,0,"",$l);return e._reactRootContainer=u,e[pi]=u.current,Vr(8===e.nodeType?e.parentNode:e),dl((function(){Bl(t,u,n,r)})),u}(n,t,e,i,r);return jl(s)}Zl.prototype.render=Yl.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(a(409));Bl(e,t,null,null)},Zl.prototype.unmount=Yl.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;dl((function(){Bl(null,e,null,null)})),t[pi]=null}},Zl.prototype.unstable_scheduleHydration=function(e){if(e){var t=St();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Dt.length&&0!==t&&t<Dt[n].priority;n++);Dt.splice(n,0,e),0===n&&Pt(e)}},bt=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=dt(t.pendingLanes);0!==n&&(gt(t,1|n),il(t,Je()),0===(6&ku)&&(Gu=Je()+500,Vi()))}break;case 13:dl((function(){var t=ka(e,1);if(null!==t){var n=tl();rl(t,e,1,n)}})),Kl(e,1)}},Ct=function(e){if(13===e.tag){var t=ka(e,134217728);if(null!==t)rl(t,e,134217728,tl());Kl(e,134217728)}},wt=function(e){if(13===e.tag){var t=nl(e),n=ka(e,t);if(null!==n)rl(n,e,t,tl());Kl(e,t)}},St=function(){return yt},Tt=function(e,t){var n=yt;try{return yt=e,t()}finally{yt=n}},Ce=function(e,t,n){switch(t){case"input":if(X(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var i=bi(r);if(!i)throw Error(a(90));K(r),X(r,i)}}}break;case"textarea":ae(e,n);break;case"select":null!=(t=n.value)&&ne(e,!!n.multiple,t,!1)}},Ae=cl,ke=dl;var tc={usingClientEntryPoint:!1,Events:[yi,Ei,bi,Ie,Ne,cl]},nc={findFiberByHostInstance:gi,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},rc={bundleType:nc.bundleType,version:nc.version,rendererPackageName:nc.rendererPackageName,rendererConfig:nc.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:E.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=je(e))?null:e.stateNode},findFiberByHostInstance:nc.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var ic=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ic.isDisabled&&ic.supportsFiber)try{it=ic.inject(rc),at=ic}catch(ce){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=tc,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Jl(t))throw Error(a(200));return function(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:C,key:null==r?null:""+r,children:e,containerInfo:t,implementation:n}}(e,t,null,n)},t.createRoot=function(e,t){if(!Jl(e))throw Error(a(299));var n=!1,r="",i=Wl;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(r=t.identifierPrefix),void 0!==t.onRecoverableError&&(i=t.onRecoverableError)),t=ql(e,1,!1,null,0,n,0,r,i),e[pi]=t.current,Vr(8===e.nodeType?e.parentNode:e),new Yl(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(a(188));throw e=Object.keys(e).join(","),Error(a(268,e))}return e=null===(e=je(t))?null:e.stateNode},t.flushSync=function(e){return dl(e)},t.hydrate=function(e,t,n){if(!Xl(t))throw Error(a(200));return ec(null,e,t,!0,n)},t.hydrateRoot=function(e,t,n){if(!Jl(e))throw Error(a(405));var r=null!=n&&n.hydratedSources||null,i=!1,s="",o=Wl;if(null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(i=!0),void 0!==n.identifierPrefix&&(s=n.identifierPrefix),void 0!==n.onRecoverableError&&(o=n.onRecoverableError)),t=Gl(t,null,e,1,null!=n?n:null,i,0,s,o),e[pi]=t.current,Vr(e),r)for(e=0;e<r.length;e++)i=(i=(n=r[e])._getVersion)(n._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[n,i]:t.mutableSourceEagerHydrationData.push(n,i);return new Zl(t)},t.render=function(e,t,n){if(!Xl(t))throw Error(a(200));return ec(null,e,t,!1,n)},t.unmountComponentAtNode=function(e){if(!Xl(e))throw Error(a(40));return!!e._reactRootContainer&&(dl((function(){ec(null,null,e,!1,(function(){e._reactRootContainer=null,e[pi]=null}))})),!0)},t.unstable_batchedUpdates=cl,t.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!Xl(n))throw Error(a(200));if(null==e||void 0===e._reactInternals)throw Error(a(38));return ec(e,t,n,!1,r)},t.version="18.2.0-next-9e3b772b8-20220608"},250:(e,t,n)=>{var r=n(164);t.createRoot=r.createRoot,t.hydrateRoot=r.hydrateRoot},164:(e,t,n)=>{!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(463)},374:(e,t,n)=>{var r=n(791),i=Symbol.for("react.element"),a=Symbol.for("react.fragment"),s=Object.prototype.hasOwnProperty,o=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,u={key:!0,ref:!0,__self:!0,__source:!0};function l(e,t,n){var r,a={},l=null,c=null;for(r in void 0!==n&&(l=""+n),void 0!==t.key&&(l=""+t.key),void 0!==t.ref&&(c=t.ref),t)s.call(t,r)&&!u.hasOwnProperty(r)&&(a[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps)void 0===a[r]&&(a[r]=t[r]);return{$$typeof:i,type:e,key:l,ref:c,props:a,_owner:o.current}}t.jsx=l,t.jsxs=l},117:(e,t)=>{var n=Symbol.for("react.element"),r=Symbol.for("react.portal"),i=Symbol.for("react.fragment"),a=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),o=Symbol.for("react.provider"),u=Symbol.for("react.context"),l=Symbol.for("react.forward_ref"),c=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),f=Symbol.iterator;var p={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},_=Object.assign,v={};function m(e,t,n){this.props=e,this.context=t,this.refs=v,this.updater=n||p}function g(){}function y(e,t,n){this.props=e,this.context=t,this.refs=v,this.updater=n||p}m.prototype.isReactComponent={},m.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},m.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},g.prototype=m.prototype;var E=y.prototype=new g;E.constructor=y,_(E,m.prototype),E.isPureReactComponent=!0;var b=Array.isArray,C=Object.prototype.hasOwnProperty,w={current:null},S={key:!0,ref:!0,__self:!0,__source:!0};function T(e,t,r){var i,a={},s=null,o=null;if(null!=t)for(i in void 0!==t.ref&&(o=t.ref),void 0!==t.key&&(s=""+t.key),t)C.call(t,i)&&!S.hasOwnProperty(i)&&(a[i]=t[i]);var u=arguments.length-2;if(1===u)a.children=r;else if(1<u){for(var l=Array(u),c=0;c<u;c++)l[c]=arguments[c+2];a.children=l}if(e&&e.defaultProps)for(i in u=e.defaultProps)void 0===a[i]&&(a[i]=u[i]);return{$$typeof:n,type:e,key:s,ref:o,props:a,_owner:w.current}}function I(e){return"object"===typeof e&&null!==e&&e.$$typeof===n}var N=/\/+/g;function A(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function k(e,t,i,a,s){var o=typeof e;"undefined"!==o&&"boolean"!==o||(e=null);var u=!1;if(null===e)u=!0;else switch(o){case"string":case"number":u=!0;break;case"object":switch(e.$$typeof){case n:case r:u=!0}}if(u)return s=s(u=e),e=""===a?"."+A(u,0):a,b(s)?(i="",null!=e&&(i=e.replace(N,"$&/")+"/"),k(s,t,i,"",(function(e){return e}))):null!=s&&(I(s)&&(s=function(e,t){return{$$typeof:n,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(s,i+(!s.key||u&&u.key===s.key?"":(""+s.key).replace(N,"$&/")+"/")+e)),t.push(s)),1;if(u=0,a=""===a?".":a+":",b(e))for(var l=0;l<e.length;l++){var c=a+A(o=e[l],l);u+=k(o,t,i,c,s)}else if(c=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=f&&e[f]||e["@@iterator"])?e:null}(e),"function"===typeof c)for(e=c.call(e),l=0;!(o=e.next()).done;)u+=k(o=o.value,t,i,c=a+A(o,l++),s);else if("object"===o)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return u}function M(e,t,n){if(null==e)return e;var r=[],i=0;return k(e,r,"","",(function(e){return t.call(n,e,i++)})),r}function U(e){if(-1===e._status){var t=e._result;(t=t()).then((function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)}),(function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)})),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var O={current:null},D={transition:null},L={ReactCurrentDispatcher:O,ReactCurrentBatchConfig:D,ReactCurrentOwner:w};t.Children={map:M,forEach:function(e,t,n){M(e,(function(){t.apply(this,arguments)}),n)},count:function(e){var t=0;return M(e,(function(){t++})),t},toArray:function(e){return M(e,(function(e){return e}))||[]},only:function(e){if(!I(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=m,t.Fragment=i,t.Profiler=s,t.PureComponent=y,t.StrictMode=a,t.Suspense=c,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=L,t.cloneElement=function(e,t,r){if(null===e||void 0===e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var i=_({},e.props),a=e.key,s=e.ref,o=e._owner;if(null!=t){if(void 0!==t.ref&&(s=t.ref,o=w.current),void 0!==t.key&&(a=""+t.key),e.type&&e.type.defaultProps)var u=e.type.defaultProps;for(l in t)C.call(t,l)&&!S.hasOwnProperty(l)&&(i[l]=void 0===t[l]&&void 0!==u?u[l]:t[l])}var l=arguments.length-2;if(1===l)i.children=r;else if(1<l){u=Array(l);for(var c=0;c<l;c++)u[c]=arguments[c+2];i.children=u}return{$$typeof:n,type:e.type,key:a,ref:s,props:i,_owner:o}},t.createContext=function(e){return(e={$$typeof:u,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:o,_context:e},e.Consumer=e},t.createElement=T,t.createFactory=function(e){var t=T.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:l,render:e}},t.isValidElement=I,t.lazy=function(e){return{$$typeof:h,_payload:{_status:-1,_result:e},_init:U}},t.memo=function(e,t){return{$$typeof:d,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=D.transition;D.transition={};try{e()}finally{D.transition=t}},t.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")},t.useCallback=function(e,t){return O.current.useCallback(e,t)},t.useContext=function(e){return O.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return O.current.useDeferredValue(e)},t.useEffect=function(e,t){return O.current.useEffect(e,t)},t.useId=function(){return O.current.useId()},t.useImperativeHandle=function(e,t,n){return O.current.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return O.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return O.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return O.current.useMemo(e,t)},t.useReducer=function(e,t,n){return O.current.useReducer(e,t,n)},t.useRef=function(e){return O.current.useRef(e)},t.useState=function(e){return O.current.useState(e)},t.useSyncExternalStore=function(e,t,n){return O.current.useSyncExternalStore(e,t,n)},t.useTransition=function(){return O.current.useTransition()},t.version="18.2.0"},791:(e,t,n)=>{e.exports=n(117)},184:(e,t,n)=>{e.exports=n(374)},813:(e,t)=>{function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var r=n-1>>>1,i=e[r];if(!(0<a(i,t)))break e;e[r]=t,e[n]=i,n=r}}function r(e){return 0===e.length?null:e[0]}function i(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,i=e.length,s=i>>>1;r<s;){var o=2*(r+1)-1,u=e[o],l=o+1,c=e[l];if(0>a(u,n))l<i&&0>a(c,u)?(e[r]=c,e[l]=n,r=l):(e[r]=u,e[o]=n,r=o);else{if(!(l<i&&0>a(c,n)))break e;e[r]=c,e[l]=n,r=l}}}return t}function a(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if("object"===typeof performance&&"function"===typeof performance.now){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,u=o.now();t.unstable_now=function(){return o.now()-u}}var l=[],c=[],d=1,h=null,f=3,p=!1,_=!1,v=!1,m="function"===typeof setTimeout?setTimeout:null,g="function"===typeof clearTimeout?clearTimeout:null,y="undefined"!==typeof setImmediate?setImmediate:null;function E(e){for(var t=r(c);null!==t;){if(null===t.callback)i(c);else{if(!(t.startTime<=e))break;i(c),t.sortIndex=t.expirationTime,n(l,t)}t=r(c)}}function b(e){if(v=!1,E(e),!_)if(null!==r(l))_=!0,D(C);else{var t=r(c);null!==t&&L(b,t.startTime-e)}}function C(e,n){_=!1,v&&(v=!1,g(I),I=-1),p=!0;var a=f;try{for(E(n),h=r(l);null!==h&&(!(h.expirationTime>n)||e&&!k());){var s=h.callback;if("function"===typeof s){h.callback=null,f=h.priorityLevel;var o=s(h.expirationTime<=n);n=t.unstable_now(),"function"===typeof o?h.callback=o:h===r(l)&&i(l),E(n)}else i(l);h=r(l)}if(null!==h)var u=!0;else{var d=r(c);null!==d&&L(b,d.startTime-n),u=!1}return u}finally{h=null,f=a,p=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var w,S=!1,T=null,I=-1,N=5,A=-1;function k(){return!(t.unstable_now()-A<N)}function M(){if(null!==T){var e=t.unstable_now();A=e;var n=!0;try{n=T(!0,e)}finally{n?w():(S=!1,T=null)}}else S=!1}if("function"===typeof y)w=function(){y(M)};else if("undefined"!==typeof MessageChannel){var U=new MessageChannel,O=U.port2;U.port1.onmessage=M,w=function(){O.postMessage(null)}}else w=function(){m(M,0)};function D(e){T=e,S||(S=!0,w())}function L(e,n){I=m((function(){e(t.unstable_now())}),n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){_||p||(_=!0,D(C))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):N=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return r(l)},t.unstable_next=function(e){switch(f){case 1:case 2:case 3:var t=3;break;default:t=f}var n=f;f=t;try{return e()}finally{f=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=f;f=e;try{return t()}finally{f=n}},t.unstable_scheduleCallback=function(e,i,a){var s=t.unstable_now();switch("object"===typeof a&&null!==a?a="number"===typeof(a=a.delay)&&0<a?s+a:s:a=s,e){case 1:var o=-1;break;case 2:o=250;break;case 5:o=1073741823;break;case 4:o=1e4;break;default:o=5e3}return e={id:d++,callback:i,priorityLevel:e,startTime:a,expirationTime:o=a+o,sortIndex:-1},a>s?(e.sortIndex=a,n(c,e),null===r(l)&&e===r(c)&&(v?(g(I),I=-1):v=!0,L(b,a-s))):(e.sortIndex=o,n(l,e),_||p||(_=!0,D(C))),e},t.unstable_shouldYield=k,t.unstable_wrapCallback=function(e){var t=f;return function(){var n=f;f=t;try{return e.apply(this,arguments)}finally{f=n}}}},296:(e,t,n)=>{e.exports=n(813)}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var a=t[r]={exports:{}};return e[r](a,a.exports,n),a.exports}n.m=e,(()=>{var e,t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__;n.t=function(r,i){if(1&i&&(r=this(r)),8&i)return r;if("object"===typeof r&&r){if(4&i&&r.__esModule)return r;if(16&i&&"function"===typeof r.then)return r}var a=Object.create(null);n.r(a);var s={};e=e||[null,t({}),t([]),t(t)];for(var o=2&i&&r;"object"==typeof o&&!~e.indexOf(o);o=t(o))Object.getOwnPropertyNames(o).forEach((e=>s[e]=()=>r[e]));return s.default=()=>r,n.d(a,s),a}})(),n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.f={},n.e=e=>Promise.all(Object.keys(n.f).reduce(((t,r)=>(n.f[r](e,t),t)),[])),n.u=e=>"static/js/"+e+"."+{539:"3041950e",932:"189cc2a6"}[e]+".chunk.js",n.miniCssF=e=>{},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={},t="lost-in-translator:";n.l=(r,i,a,s)=>{if(e[r])e[r].push(i);else{var o,u;if(void 0!==a)for(var l=document.getElementsByTagName("script"),c=0;c<l.length;c++){var d=l[c];if(d.getAttribute("src")==r||d.getAttribute("data-webpack")==t+a){o=d;break}}o||(u=!0,(o=document.createElement("script")).charset="utf-8",o.timeout=120,n.nc&&o.setAttribute("nonce",n.nc),o.setAttribute("data-webpack",t+a),o.src=r),e[r]=[i];var h=(t,n)=>{o.onerror=o.onload=null,clearTimeout(f);var i=e[r];if(delete e[r],o.parentNode&&o.parentNode.removeChild(o),i&&i.forEach((e=>e(n))),t)return t(n)},f=setTimeout(h.bind(null,void 0,{type:"timeout",target:o}),12e4);o.onerror=h.bind(null,o.onerror),o.onload=h.bind(null,o.onload),u&&document.head.appendChild(o)}}})(),n.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.p="/LostInTranslator/",(()=>{var e={179:0};n.f.j=(t,r)=>{var i=n.o(e,t)?e[t]:void 0;if(0!==i)if(i)r.push(i[2]);else{var a=new Promise(((n,r)=>i=e[t]=[n,r]));r.push(i[2]=a);var s=n.p+n.u(t),o=new Error;n.l(s,(r=>{if(n.o(e,t)&&(0!==(i=e[t])&&(e[t]=void 0),i)){var a=r&&("load"===r.type?"missing":r.type),s=r&&r.target&&r.target.src;o.message="Loading chunk "+t+" failed.\n("+a+": "+s+")",o.name="ChunkLoadError",o.type=a,o.request=s,i[1](o)}}),"chunk-"+t,t)}};var t=(t,r)=>{var i,a,s=r[0],o=r[1],u=r[2],l=0;if(s.some((t=>0!==e[t]))){for(i in o)n.o(o,i)&&(n.m[i]=o[i]);if(u)u(n)}for(t&&t(r);l<s.length;l++)a=s[l],n.o(e,a)&&e[a]&&e[a][0](),e[a]=0},r=self.webpackChunklost_in_translator=self.webpackChunklost_in_translator||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))})(),(()=>{var e=n(791),t=n.t(e,2),r=n(250),i=n(184);const a=(0,e.createContext)({user:{},setUser:()=>{},resetUser:()=>{}});const s=function(t){let{children:n}=t;const[r,s]=(0,e.useState)({}),o=(0,e.useCallback)((()=>{s({}),localStorage.removeItem("user")}),[]);(0,e.useEffect)((()=>{console.log("user = ",r),r.userId&&localStorage.setItem("user",r.userId)}),[r]);const u=(0,e.useMemo)((()=>({user:r,setUser:s,resetUser:o})),[r,o]);return(0,i.jsx)(a.Provider,{value:u,children:n})},o=(0,e.createContext)({modal:"",setModal:e=>{},resetModal:()=>{}});const u=function(t){let{children:n}=t;const[r,a]=(0,e.useState)(""),s=(0,e.useCallback)((()=>{a("")}),[]);(0,e.useEffect)((()=>{console.log("modal = "+r)}),[r]);const u=(0,e.useMemo)((()=>({modal:r,setModal:a,resetModal:s})),[r,s]);return(0,i.jsx)(o.Provider,{value:u,children:n})},l=(0,e.createContext)({sbClient:{},setSbClient:()=>{}});const c=function(t){let{children:n}=t;const[r,a]=(0,e.useState)();(0,e.useEffect)((()=>{console.log("sbClient = ",r)}),[r]);const s=(0,e.useMemo)((()=>({sbClient:r,setSbClient:a})),[r,a]);return(0,i.jsx)(l.Provider,{value:s,children:n})};const d=function(e){let{children:t}=e;return(0,i.jsx)(c,{children:(0,i.jsx)(s,{children:(0,i.jsx)(u,{children:t})})})};var h,f=n(164),p=n.t(f,2);function _(){return _=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},_.apply(this,arguments)}!function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"}(h||(h={}));const v="popstate";function m(e,t){if(!1===e||null===e||"undefined"===typeof e)throw new Error(t)}function g(e,t){if(!e){"undefined"!==typeof console&&console.warn(t);try{throw new Error(t)}catch(Ge){}}}function y(e,t){return{usr:e.state,key:e.key,idx:t}}function E(e,t,n,r){return void 0===n&&(n=null),_({pathname:"string"===typeof e?e:e.pathname,search:"",hash:""},"string"===typeof t?C(t):t,{state:n,key:t&&t.key||r||Math.random().toString(36).substr(2,8)})}function b(e){let{pathname:t="/",search:n="",hash:r=""}=e;return n&&"?"!==n&&(t+="?"===n.charAt(0)?n:"?"+n),r&&"#"!==r&&(t+="#"===r.charAt(0)?r:"#"+r),t}function C(e){let t={};if(e){let n=e.indexOf("#");n>=0&&(t.hash=e.substr(n),e=e.substr(0,n));let r=e.indexOf("?");r>=0&&(t.search=e.substr(r),e=e.substr(0,r)),e&&(t.pathname=e)}return t}function w(e,t,n,r){void 0===r&&(r={});let{window:i=document.defaultView,v5Compat:a=!1}=r,s=i.history,o=h.Pop,u=null,l=c();function c(){return(s.state||{idx:null}).idx}function d(){o=h.Pop;let e=c(),t=null==e?null:e-l;l=e,u&&u({action:o,location:p.location,delta:t})}function f(e){let t="null"!==i.location.origin?i.location.origin:i.location.href,n="string"===typeof e?e:b(e);return m(t,"No window.location.(origin|href) available to create URL for href: "+n),new URL(n,t)}null==l&&(l=0,s.replaceState(_({},s.state,{idx:l}),""));let p={get action(){return o},get location(){return e(i,s)},listen(e){if(u)throw new Error("A history only accepts one active listener");return i.addEventListener(v,d),u=e,()=>{i.removeEventListener(v,d),u=null}},createHref:e=>t(i,e),createURL:f,encodeLocation(e){let t=f(e);return{pathname:t.pathname,search:t.search,hash:t.hash}},push:function(e,t){o=h.Push;let r=E(p.location,e,t);n&&n(r,e),l=c()+1;let d=y(r,l),f=p.createHref(r);try{s.pushState(d,"",f)}catch(_){if(_ instanceof DOMException&&"DataCloneError"===_.name)throw _;i.location.assign(f)}a&&u&&u({action:o,location:p.location,delta:1})},replace:function(e,t){o=h.Replace;let r=E(p.location,e,t);n&&n(r,e),l=c();let i=y(r,l),d=p.createHref(r);s.replaceState(i,"",d),a&&u&&u({action:o,location:p.location,delta:0})},go:e=>s.go(e)};return p}var S;!function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"}(S||(S={}));new Set(["lazy","caseSensitive","path","id","index","children"]);function T(e,t,n){void 0===n&&(n="/");let r=z(("string"===typeof t?C(t):t).pathname||"/",n);if(null==r)return null;let i=I(e);!function(e){e.sort(((e,t)=>e.score!==t.score?t.score-e.score:function(e,t){let n=e.length===t.length&&e.slice(0,-1).every(((e,n)=>e===t[n]));return n?e[e.length-1]-t[t.length-1]:0}(e.routesMeta.map((e=>e.childrenIndex)),t.routesMeta.map((e=>e.childrenIndex)))))}(i);let a=null;for(let s=0;null==a&&s<i.length;++s)a=x(i[s],F(r));return a}function I(e,t,n,r){void 0===t&&(t=[]),void 0===n&&(n=[]),void 0===r&&(r="");let i=(e,i,a)=>{let s={relativePath:void 0===a?e.path||"":a,caseSensitive:!0===e.caseSensitive,childrenIndex:i,route:e};s.relativePath.startsWith("/")&&(m(s.relativePath.startsWith(r),'Absolute route path "'+s.relativePath+'" nested under path "'+r+'" is not valid. An absolute child route path must start with the combined path of all its parent routes.'),s.relativePath=s.relativePath.slice(r.length));let o=G([r,s.relativePath]),u=n.concat(s);e.children&&e.children.length>0&&(m(!0!==e.index,'Index routes must not have child routes. Please remove all child routes from route path "'+o+'".'),I(e.children,t,u,o)),(null!=e.path||e.index)&&t.push({path:o,score:R(o,e.index),routesMeta:u})};return e.forEach(((e,t)=>{var n;if(""!==e.path&&null!=(n=e.path)&&n.includes("?"))for(let r of N(e.path))i(e,t,r);else i(e,t)})),t}function N(e){let t=e.split("/");if(0===t.length)return[];let[n,...r]=t,i=n.endsWith("?"),a=n.replace(/\?$/,"");if(0===r.length)return i?[a,""]:[a];let s=N(r.join("/")),o=[];return o.push(...s.map((e=>""===e?a:[a,e].join("/")))),i&&o.push(...s),o.map((t=>e.startsWith("/")&&""===t?"/":t))}const A=/^:\w+$/,k=3,M=2,U=1,O=10,D=-2,L=e=>"*"===e;function R(e,t){let n=e.split("/"),r=n.length;return n.some(L)&&(r+=D),t&&(r+=M),n.filter((e=>!L(e))).reduce(((e,t)=>e+(A.test(t)?k:""===t?U:O)),r)}function x(e,t){let{routesMeta:n}=e,r={},i="/",a=[];for(let s=0;s<n.length;++s){let e=n[s],o=s===n.length-1,u="/"===i?t:t.slice(i.length)||"/",l=P({path:e.relativePath,caseSensitive:e.caseSensitive,end:o},u);if(!l)return null;Object.assign(r,l.params);let c=e.route;a.push({params:r,pathname:G([i,l.pathname]),pathnameBase:B(G([i,l.pathnameBase])),route:c}),"/"!==l.pathnameBase&&(i=G([i,l.pathnameBase]))}return a}function P(e,t){"string"===typeof e&&(e={path:e,caseSensitive:!1,end:!0});let[n,r]=function(e,t,n){void 0===t&&(t=!1);void 0===n&&(n=!0);g("*"===e||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were "'+e.replace(/\*$/,"/*")+'" because the `*` character must always follow a `/` in the pattern. To get rid of this warning, please change the route path to "'+e.replace(/\*$/,"/*")+'".');let r=[],i="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:(\w+)(\?)?/g,((e,t,n)=>(r.push({paramName:t,isOptional:null!=n}),n?"/?([^\\/]+)?":"/([^\\/]+)")));e.endsWith("*")?(r.push({paramName:"*"}),i+="*"===e||"/*"===e?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?i+="\\/*$":""!==e&&"/"!==e&&(i+="(?:(?=\\/|$))");let a=new RegExp(i,t?void 0:"i");return[a,r]}(e.path,e.caseSensitive,e.end),i=t.match(n);if(!i)return null;let a=i[0],s=a.replace(/(.)\/+$/,"$1"),o=i.slice(1);return{params:r.reduce(((e,t,n)=>{let{paramName:r,isOptional:i}=t;if("*"===r){let e=o[n]||"";s=a.slice(0,a.length-e.length).replace(/(.)\/+$/,"$1")}const u=o[n];return e[r]=i&&!u?void 0:function(e,t){try{return decodeURIComponent(e)}catch(n){return g(!1,'The value for the URL param "'+t+'" will not be decoded because the string "'+e+'" is a malformed URL segment. This is probably due to a bad percent encoding ('+n+")."),e}}(u||"",r),e}),{}),pathname:a,pathnameBase:s,pattern:e}}function F(e){try{return decodeURI(e)}catch(t){return g(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent encoding ('+t+")."),e}}function z(e,t){if("/"===t)return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith("/")?t.length-1:t.length,r=e.charAt(n);return r&&"/"!==r?null:e.slice(n)||"/"}function H(e,t,n,r){return"Cannot include a '"+e+"' character in a manually specified `to."+t+"` field ["+JSON.stringify(r)+"].  Please separate it out to the `to."+n+'` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.'}function q(e){return e.filter(((e,t)=>0===t||e.route.path&&e.route.path.length>0))}function V(e,t,n,r){let i;void 0===r&&(r=!1),"string"===typeof e?i=C(e):(i=_({},e),m(!i.pathname||!i.pathname.includes("?"),H("?","pathname","search",i)),m(!i.pathname||!i.pathname.includes("#"),H("#","pathname","hash",i)),m(!i.search||!i.search.includes("#"),H("#","search","hash",i)));let a,s=""===e||""===i.pathname,o=s?"/":i.pathname;if(null==o)a=n;else if(r){let e=t[t.length-1].replace(/^\//,"").split("/");if(o.startsWith("..")){let t=o.split("/");for(;".."===t[0];)t.shift(),e.pop();i.pathname=t.join("/")}a="/"+e.join("/")}else{let e=t.length-1;if(o.startsWith("..")){let t=o.split("/");for(;".."===t[0];)t.shift(),e-=1;i.pathname=t.join("/")}a=e>=0?t[e]:"/"}let u=function(e,t){void 0===t&&(t="/");let{pathname:n,search:r="",hash:i=""}="string"===typeof e?C(e):e,a=n?n.startsWith("/")?n:function(e,t){let n=t.replace(/\/+$/,"").split("/");return e.split("/").forEach((e=>{".."===e?n.length>1&&n.pop():"."!==e&&n.push(e)})),n.length>1?n.join("/"):"/"}(n,t):t;return{pathname:a,search:j(r),hash:Q(i)}}(i,a),l=o&&"/"!==o&&o.endsWith("/"),c=(s||"."===o)&&n.endsWith("/");return u.pathname.endsWith("/")||!l&&!c||(u.pathname+="/"),u}const G=e=>e.join("/").replace(/\/\/+/g,"/"),B=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),j=e=>e&&"?"!==e?e.startsWith("?")?e:"?"+e:"",Q=e=>e&&"#"!==e?e.startsWith("#")?e:"#"+e:"";Error;function K(e){return null!=e&&"number"===typeof e.status&&"string"===typeof e.statusText&&"boolean"===typeof e.internal&&"data"in e}const W=["post","put","patch","delete"],Y=(new Set(W),["get",...W]);new Set(Y),new Set([301,302,303,307,308]),new Set([307,308]);Symbol("deferred");function Z(){return Z=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Z.apply(this,arguments)}const J=e.createContext(null);const X=e.createContext(null);const $=e.createContext(null);const ee=e.createContext(null);const te=e.createContext({outlet:null,matches:[],isDataRoute:!1});const ne=e.createContext(null);function re(){return null!=e.useContext(ee)}function ie(){return re()||m(!1),e.useContext(ee).location}function ae(t){e.useContext($).static||e.useLayoutEffect(t)}function se(){let{isDataRoute:t}=e.useContext(te);return t?function(){let{router:t}=_e(fe.UseNavigateStable),n=me(pe.UseNavigateStable),r=e.useRef(!1);ae((()=>{r.current=!0}));let i=e.useCallback((function(e,i){void 0===i&&(i={}),r.current&&("number"===typeof e?t.navigate(e):t.navigate(e,Z({fromRouteId:n},i)))}),[t,n]);return i}():function(){re()||m(!1);let t=e.useContext(J),{basename:n,navigator:r}=e.useContext($),{matches:i}=e.useContext(te),{pathname:a}=ie(),s=JSON.stringify(q(i).map((e=>e.pathnameBase))),o=e.useRef(!1);ae((()=>{o.current=!0}));let u=e.useCallback((function(e,i){if(void 0===i&&(i={}),!o.current)return;if("number"===typeof e)return void r.go(e);let u=V(e,JSON.parse(s),a,"path"===i.relative);null==t&&"/"!==n&&(u.pathname="/"===u.pathname?n:G([n,u.pathname])),(i.replace?r.replace:r.push)(u,i.state,i)}),[n,r,s,a,t]);return u}()}function oe(t,n,r){re()||m(!1);let{navigator:i}=e.useContext($),{matches:a}=e.useContext(te),s=a[a.length-1],o=s?s.params:{},u=(s&&s.pathname,s?s.pathnameBase:"/");s&&s.route;let l,c=ie();if(n){var d;let e="string"===typeof n?C(n):n;"/"===u||(null==(d=e.pathname)?void 0:d.startsWith(u))||m(!1),l=e}else l=c;let f=l.pathname||"/",p=T(t,{pathname:"/"===u?f:f.slice(u.length)||"/"});let _=he(p&&p.map((e=>Object.assign({},e,{params:Object.assign({},o,e.params),pathname:G([u,i.encodeLocation?i.encodeLocation(e.pathname).pathname:e.pathname]),pathnameBase:"/"===e.pathnameBase?u:G([u,i.encodeLocation?i.encodeLocation(e.pathnameBase).pathname:e.pathnameBase])}))),a,r);return n&&_?e.createElement(ee.Provider,{value:{location:Z({pathname:"/",search:"",hash:"",state:null,key:"default"},l),navigationType:h.Pop}},_):_}function ue(){let t=function(){var t;let n=e.useContext(ne),r=ve(pe.UseRouteError),i=me(pe.UseRouteError);if(n)return n;return null==(t=r.errors)?void 0:t[i]}(),n=K(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),r=t instanceof Error?t.stack:null,i="rgba(200,200,200, 0.5)",a={padding:"0.5rem",backgroundColor:i};return e.createElement(e.Fragment,null,e.createElement("h2",null,"Unexpected Application Error!"),e.createElement("h3",{style:{fontStyle:"italic"}},n),r?e.createElement("pre",{style:a},r):null,null)}const le=e.createElement(ue,null);class ce extends e.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||"idle"!==t.revalidation&&"idle"===e.revalidation?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error||t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return this.state.error?e.createElement(te.Provider,{value:this.props.routeContext},e.createElement(ne.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function de(t){let{routeContext:n,match:r,children:i}=t,a=e.useContext(J);return a&&a.static&&a.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(a.staticContext._deepestRenderedBoundaryId=r.route.id),e.createElement(te.Provider,{value:n},i)}function he(t,n,r){var i;if(void 0===n&&(n=[]),void 0===r&&(r=null),null==t){var a;if(null==(a=r)||!a.errors)return null;t=r.matches}let s=t,o=null==(i=r)?void 0:i.errors;if(null!=o){let e=s.findIndex((e=>e.route.id&&(null==o?void 0:o[e.route.id])));e>=0||m(!1),s=s.slice(0,Math.min(s.length,e+1))}return s.reduceRight(((t,i,a)=>{let u=i.route.id?null==o?void 0:o[i.route.id]:null,l=null;r&&(l=i.route.errorElement||le);let c=n.concat(s.slice(0,a+1)),d=()=>{let n;return n=u?l:i.route.Component?e.createElement(i.route.Component,null):i.route.element?i.route.element:t,e.createElement(de,{match:i,routeContext:{outlet:t,matches:c,isDataRoute:null!=r},children:n})};return r&&(i.route.ErrorBoundary||i.route.errorElement||0===a)?e.createElement(ce,{location:r.location,revalidation:r.revalidation,component:l,error:u,children:d(),routeContext:{outlet:null,matches:c,isDataRoute:!0}}):d()}),null)}var fe=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(fe||{}),pe=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(pe||{});function _e(t){let n=e.useContext(J);return n||m(!1),n}function ve(t){let n=e.useContext(X);return n||m(!1),n}function me(t){let n=function(t){let n=e.useContext(te);return n||m(!1),n}(),r=n.matches[n.matches.length-1];return r.route.id||m(!1),r.route.id}t.startTransition;function ge(t){let{to:n,replace:r,state:i,relative:a}=t;re()||m(!1);let{matches:s}=e.useContext(te),{pathname:o}=ie(),u=se(),l=V(n,q(s).map((e=>e.pathnameBase)),o,"path"===a),c=JSON.stringify(l);return e.useEffect((()=>u(JSON.parse(c),{replace:r,state:i,relative:a})),[u,c,a,r,i]),null}function ye(e){m(!1)}function Ee(t){let{basename:n="/",children:r=null,location:i,navigationType:a=h.Pop,navigator:s,static:o=!1}=t;re()&&m(!1);let u=n.replace(/^\/*/,"/"),l=e.useMemo((()=>({basename:u,navigator:s,static:o})),[u,s,o]);"string"===typeof i&&(i=C(i));let{pathname:c="/",search:d="",hash:f="",state:p=null,key:_="default"}=i,v=e.useMemo((()=>{let e=z(c,u);return null==e?null:{location:{pathname:e,search:d,hash:f,state:p,key:_},navigationType:a}}),[u,c,d,f,p,_,a]);return null==v?null:e.createElement($.Provider,{value:l},e.createElement(ee.Provider,{children:r,value:v}))}function be(e){let{children:t,location:n}=e;return oe(Ce(t),n)}new Promise((()=>{}));e.Component;function Ce(t,n){void 0===n&&(n=[]);let r=[];return e.Children.forEach(t,((t,i)=>{if(!e.isValidElement(t))return;let a=[...n,i];if(t.type===e.Fragment)return void r.push.apply(r,Ce(t.props.children,a));t.type!==ye&&m(!1),t.props.index&&t.props.children&&m(!1);let s={id:t.props.id||a.join("-"),caseSensitive:t.props.caseSensitive,element:t.props.element,Component:t.props.Component,index:t.props.index,path:t.props.path,loader:t.props.loader,action:t.props.action,errorElement:t.props.errorElement,ErrorBoundary:t.props.ErrorBoundary,hasErrorBoundary:null!=t.props.ErrorBoundary||null!=t.props.errorElement,shouldRevalidate:t.props.shouldRevalidate,handle:t.props.handle,lazy:t.props.lazy};t.props.children&&(s.children=Ce(t.props.children,a)),r.push(s)})),r}new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);new Map;const we=t.startTransition;p.flushSync;function Se(t){let{basename:n,children:r,future:i,window:a}=t,s=e.useRef();var o;null==s.current&&(s.current=(void 0===(o={window:a,v5Compat:!0})&&(o={}),w((function(e,t){let{pathname:n,search:r,hash:i}=e.location;return E("",{pathname:n,search:r,hash:i},t.state&&t.state.usr||null,t.state&&t.state.key||"default")}),(function(e,t){return"string"===typeof t?t:b(t)}),null,o)));let u=s.current,[l,c]=e.useState({action:u.action,location:u.location}),{v7_startTransition:d}=i||{},h=e.useCallback((e=>{d&&we?we((()=>c(e))):c(e)}),[c,d]);return e.useLayoutEffect((()=>u.listen(h)),[u,h]),e.createElement(Ee,{basename:n,children:r,location:l.location,navigationType:l.action,navigator:u})}"undefined"!==typeof window&&"undefined"!==typeof window.document&&window.document.createElement;var Te,Ie;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(Te||(Te={})),function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"}(Ie||(Ie={}));const Ne="LoginPage_container__mw7V1",Ae="LoginPage_logo__SY0jy",ke="LoginPage_title__A4PGF",Me="LoginPage_forms__Y2fPv",Ue="LoginPage_buttons__JKv9G",Oe="LoginPage_main_button__ZoF2G",De="LoginPage_login_button__kSBo0",Le=()=>{const{user:t,setUser:n}=(0,e.useContext)(a),{sbClient:r}=(0,e.useContext)(l),[s,o]=(0,e.useState)(!1),[u,c]=(0,e.useState)({username:""}),d=(0,e.useRef)(null),h=se(),f=(0,e.useCallback)((e=>{r&&r.connect(e).then((async t=>{console.log("success! ",t),await r.updateCurrentUserInfo({nickname:e,userId:e}),console.log(r.currentUser.metaData),r.currentUser.metaData.language||await r.currentUser.createMetaData({language:"English"}),n(t),h("/")})).catch((e=>console.log("error! ",e)))}),[h,r,n]);(0,e.useEffect)((()=>{const e=localStorage.getItem("user");!t.userId&&e?f(e):o(!0)}),[f,t.userId]);const p=(0,e.useCallback)((()=>{""===u.username?(alert("Enter your nickname"),d.current&&d.current.focus()):f(u.username)}),[u.username,f]);return s?(0,i.jsxs)("div",{className:Ne,children:[(0,i.jsx)("img",{className:Ae,src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAcAAAADdCAMAAAFsw2ImAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAzUExURQAAACsVNSsSMSgSMSgSMicSMikSMygSMygSMycSNCgSMycRMygRMycSMygSMycSMygSM9ze1CYAAAAQdFJOUwAYKjlHVmRygY+fr77P3+92F1K1AAAACXBIWXMAABcRAAAXEQHKJvM/AAARUElEQVR4Xu2diXqjOgyFu02bTtNJ3v9pr6Rz5A1DTALtTav/a0DeLQuMMYY+BCs46083Ip0FeP0zn0UkhsZ/1tQpIYVFNJam9Z177ZjwfDqf38/nw/qE8ieb1Ql/LC/aHtokbA9uDrL7OL+KpB7n86NujprA8YRsUd9Iwr+l28WS84v4MYbsXnQjJjFPq4H8YffWSYhw3UjCp/M/Syii+crO3CoUTBM+y5GuXkwovycL7yV80MOtqCqiMaEEuU8Q3DN6CL/acfxPj2cVcGxb6AISAwmOtmNCSktYLNnZ9mix1cuci1gs2R1VWpsQ0eS3JuGzJTm/Wcw1CX8uZuDz+cPEtLGdBWiwueSw0PgJJmw2+CPareJ4qq464vdgl33ETqngKR6IcRYDqZAxb0uo+SIJ/2RTJtR9gXlXCeXkUN8ioVwLn47nv3MJLbbF14tjriqymFQ1CIIfip7x2ClvLrsHOwIIpc/VWA7ISO6Y3PEkIWVX5wEnG7zfhGflDr1Ew9UrMEe9Gs/FspGd3auYa78CkQ141ttJQUJ2KvBBLxuCDM7OJxd0v1+BwR1R34sLn+IJSU4GShrR9nq0Jt9/nkT9bNBlkh1YFPtI2At2B7lzlojy+/hUQaU387K89Y7cZY3JxNydXyz1E45kFTWghwR5gRrtEZmkjbYBciwKPCCc0RjKcNfQTqgeElYU6L2K/myDAuGZNaQvonFygJHWNCnS1xvLWn5mXt3pptEwmVBd3qSvGtBDwlKBnjtz0o15SYYcgdtAdVIgJDvOUGAREARBEATB/xK5WB9csMEAZR+s4FIue431KHud7bsFZlUOhnSc0S2QfuZzNchK72sBvPoFwmOTAjUfPD/7C4fecssOcRjLB123NaplhSEoisoF+V4QkbHkl3yvwrJKudjeXe4piHjfBepNDB26l62YUnfqqYi4YYHMxg+aP3oztV+BdkJgSsjwKgjcKSJuVSBzKE583dndF5yGiJsV+KCPdAXN6ZmCnoX7FRgEwVeiJ62CBR4cwehlVafAMFGK6Y88vyHIXgXdKeqlPeE/FeCrY5QuFiqwwDKfJGmnhgeY+kMtTMK+TMNRgWJTKFMYmgvM+eRQl3SbfT9cyEnKYBW7WFsJurMpPe201YWLsA4DMYn2aRcrxMQsIDLn7oTeHhmlOesOZYG2kV9RoG5e0Ekzjm2tViZyp8MoTDHmTZ+iQM22X6BuxZTqxnZSoGahe7ON+3dpCkQmSlsgghDTn0ariJ1moftU4Ozc3liBRWuZ94UmhXef0oaewCgL1EPHg2w7KbA+aOQ3OzZuCsybskCVygIbGyJAYUa68kX9e5QF2jkgv26BfxCpW6AJQrodkM3MmV8VqBuM2eTXFGiRH/7AZ1KgdW3oDs0rBwRBEARBEARBEARBsITeQ+ttONEb9URxNy+35AamNEoYQYEH88rPKWdnBb4EVIGV0jnAinf4M5YwqqC9c5eYXXr3BaAGVimblGopIimjCkJM6EzQN4EKlJXCHFCqYiGnQ41a0pWAr+Zls6UWAUL1ds7XggpopfC6Gp/tCXyqqUGQ7DmqsVrBSdSvA+UXWsBbgVsb37seN8R9KrhgwaQhV6fcn4JWAYqdczC50jpbA44MfP+fCmoV5npR1la5QwsmDVXuXwezgna4CneloBsOjt5IxhXksSvcl4JBEARBENwb1YhE4TqZhI+6inffsNxToVvIkw0+jCuHKQqXaSm+LLXGYhVrZotMOSIC6+Y1LirI29eqCJbB+yaC8XUejzYKQnZkcEcpM40l4KasLj212QgDCupI2ifLHC23bGtFsyvmkGoFIWa6CubWyVhbtgoiz3GoJe9xWLQem5AkOx6f/UBqr0m9Jip3FJSmotnNs8hD8YMYC8P8pkw1ZLY5jsUYZ05Bnk4fZUUgVAoWyf2A0Gw6CkqyXNfsTVflELI7JUrTruvoK+gHjC4OpSg5YzenYOqK9A6qd4i+rFCQ6SVfT4Td+hniRQULL8EDs1+T3DUU8VYFs7tWcHZt4yx9Be1ldK7uhSh4YPZrkvupIyIzsJWIEJcVvHwOYueJx+kr6NlWyqTAwi8nh2DkjIQi2YKCbvKKshdt4w8zo6AfbnJdh6AZQ7iooGVkq5OVItmSgmUGpLoO5gjmO86cgjm7JPQCpwp6TvkKgv1FBZdHMiKxzbAqPgiCIAiCIAiCIAiCIAiCIAiCIAiCIPiN4Mlx+az5g17pTSyApRL4HyElxXtl9VPstPQgPff+FlgJuuqFeOUXq7huYVzB4jWa/L7FN8A60FXUyqB3irZCQcigiPPlsApwtPolDVn1FQpCdNYu0doQ1qBylDQBowqmlTTgGw9S1sBkX45WogtnfO2WMKpg+5aXhX8LRQXSAXp8fnhJymqIH6EfD3zZGM721CoUhMT/vCJY+LdQVMA7UJwwvoJO/0EWxVxNOC8rmBY4Wfi3gPLLSvnKdF97JSJrntdZwT2iYLn08ltA+XWlSHb7JRv+Apx3piBPQf/2QaUwxaRR4yT/cwW5ttC6TQPusr6pnnD9IAt6j+PjU7h+zjmYZA+E404V7PSi2YTmuCsF8+rmhevg5L0GOO5CQb/7kzrMjmSO+Q0gJLonBdl3Cv2xqPY5FBUkuicFc+1LOVNFSV0sXPehYFoNL/LM/SBlwZwCXPehYDowVW41tAhZwfQlFjjvREHvZ+DozcnQmfW7MwXlhlarRrkzq9a670/BIAiCIAiCIAiCILgXcCNdkG64hWN+wiL4LXz5tRM+gq6erSO9CLbPd+k+84jIvIXPmK/w5LMhmEo26CN8rF1Nw3SZUkEhfU7CZ7CF5JefyecPdflXnUTMklLMpmrkGQWr6az01W26QdXqF2GiTKNgO0Nv8BFuVUeuAEkVFDlL2QEkcl/Bqph8ZNBJVq3FYJrMREGUTJmYNs3coUXL8bJs/nWmcgx0FWz0SwcLXU6zemwRJslMFdRJseKL+4pNFJYzh4IpnastjixNyukrWH/43sCUJB0J8xyDKTJTBTU7SolOUpuupyxkh/qnpzLkqasgpQprN8qJ/PR1DCajiwrmA0b8KD2V61lcZFdjRxPE8/lF60VZ/Znnh3e77CioJRz56cD7Y3Gwagikw8NT/q7gKupUSUEvRSQI0nA8LsVr8h0gTUsR3R8dKrILTZ5dBeFwZ6kLJE0EyVOMUqfKCtI2IkGQEnLgkoKYvKejFiEsKUiXN0pWa3MFi8e1EIYVxHWEjlqE0FOQx0vqIr2XFhGCJKJZyxWqIyAVy0k6YIeTC9JlBRlcdQ21CKGnIE9BS2rAXSRi9DLOGExGV6tg0V+U333rKuitXvY4hZhy7SmYsyZwqweE6mOEq2A6uhoFbehJ+aKCKWIhl95LCo5bEMErqNPVCmJoDXlAQTehakBRvSmmXHsKXj4Hq+hrQDpP2FjQ/ChfVtAdehRRLHxTrj0F63xSL5qXN7iCa8/ANudNFFRXlpLviIJ0dq6DvGytPgXLmgiuA8ef1iVDvKTgy2u6aSwsqOpQkEjYdRWka2Ekg73HH6dOl3TAviohB3YVpCSoBoxb1wxCV0GPVWFjBojV9zJXgWReTtKBwzLtZiCtUFAzSkvqRxVs1uAr5d2EJIKQEoxSJ8s6QKiqNagg1h34TfyogsWBSar7QUnEHNP8wSBI5eVMFJReC8K4gpZRChlWsNWwvqOXRLx0UO9hkMrLyTrwkJEOA8Kogrl8tPi4guniZzRzMpoIUplihDpV1iEHYH9JQd6Ri1fmIGfyCgWLWbVi9g4emoilrpm0CIIgCIIgCIIgCIIgCIIgCIIgCIIgCIIgCIIgCIIgCIIgCIIgCIIgCIIgCALl5fCBt2U/j4f0qu4sz+9HfRv43/Gw9v3rcZ4PH/bxhdPx7+v6j0n8ILQREnwXueK1+VyZ8Vm92Fzy7N+0MI7pNel52v8dAKpkTb3++Av/mfdfa0Q2AJgYMH1YbMqpdya2X0bYwYCP1RGS+fylJqT6oDbgXFMl2pf/nyZnxvYG5JcKepRfGf09UHkwcqRXVG2WP/yR2NyAi7n9SgtSd1AYsP025Qz/csfV+XTO5gZc6NKV39iLUnWQDXihpQrSP2zK/0ous7UB6Z6jOAB/DVQdpAZorzSnNOp8nJjWD3s6nenXcSqb9M2W6Rqw7qRtFFWNkS9l+hOh6sAbqvkscdFPKs1Q01uNTtJpy9sNWB9XU68wID2r1pueS4/1aJNnZ52o+F94zv4GrD+j9Tug5sAbik7Q+YB73ZUx1fST3A1hwD2g5oAN1bVPBYOA26L56nz9GTohDLgH1BzcZsD2fwS0FgwD7gE1B95QdILRLlSoWn3ypc0w4B5Qc+ANVd/SDQ5ilMaC2bRKGHAPqDnw/yNw1W2EUp+ajZXCgHtQnzOnw4sNHutmGbiRx5CznT8NA+5PayphxnsGmK4fP7rQL2D6cNS8V05mdw0Yg5ivYPoQgQGrHif1DHhqbuXDgPswefBH/1UPdDsGnNx+hAH34rm+A6evsrSkorpNnxjwNF3PFAbcEf9HNwq9yGF6kZTmb6fJGgN21xiFAb+Nxz+Ho/Wnp+PHobUdeHz9a23+21f5BUEQBEEQBEEQBEEQBEEQBEEQBEEQbM3j6/vRFlacjn/fJu8VZZ7e8Nz2fPxYiibxLLvT8f3yZ2WM0QoM8rRtdtvRLH3uYA/MqwUJBaf3jjJPndifnU/01J+AMY69tnmsV+ab3+LKh+UKNKs1OjAieWrfklJOnUUeqxppK240oNJ8UKX9tIvTrkrqNYswWbz03K6hMd8FA16qwCoDNuuzKj4aG65opO3YwIBV7aafdsn4UiJlodz63ZfpWWreswa8XIEVBpw7Fpz6aBtupC3ZxID5haLl7PJ3VxYbsbBg896SYQFzBhyowLABL5lPKc0y2kibspEBzzwU6ZohLY2/sM4+j1N6HZgFzBmQHjNYBUYNeGkZMnlDbGG0kTZlKwNiWealtvFj8EJ2aY3nGz0qLGTGgCMVGDPgUldckzqMwUbai9qUzele1Q2XkmahvPlV0ew9lfpNCb8K0gne1ace0lgkoWmSor+aMeBoBcBMJsqk7/6byn5puwVTQBhspL1Ya8AmgXlRBoh2OaUV1clMaAxIX2Wm7ekG8xUgCwZsPhOV+0mlfcmDjTXYSHux1oCP1YGIyxsdYL79LhrQS296u+LjczsbsK7O9AsndUp2jYONtBdrDNg0rIC2pQNsYMBHup25YSw9tzNgHdKZ/KlyZdLBRtqLmwzIhqELbGDAyUg+GWBnA/bsU1EnRX0HG2kvbjGgx6Yz83KjASfzNd4IIwZU+hUgX2vApkk353oD5p6BHpmbDThphu58GPwEujNXGrAO2aIL3bf7VK42YDFxQp/M7QZs2sEHDDNtT3fmSgM230W5ahAz10h7cbUBizE2PTIbGLDNFJ51DdIUB92ZKw24xW3EXCPtxRoDNqPD1MXQnbnFgI+4dW6vgubZxD8f/6DCdGauNeAGN/JzjbQXawzYforCuxg6M7cYsLER8ekoOgs0c4qZaw3YnUbv059Km2+kvVhlwCa236HSCdBYWxvQe8vpNKlmThHMV4AsGfDWyWwtqd9Ie9Fpwsy0Feo7NJ4XdIH59rvBgLkjmjwQ1swpgvkKkGUDDn2baPZxkpXUbaS9WGnARnv0I3SA+fa72oDVp356N/kUwXwFyAUDXn4iuPBAFyX1Gmkv1hqwOQXsPocymG+/aw3Y3kvVX53RzCmC+QqQiwZcXlKRxzVgsJH2YrUBa09LQRHMt99VBuyvdyq+OqOZUwTzFSADBhSeaz3B6dBYTxhspF/EH/zbuc/lFYdfwvPbX6vL+fP4/vrttQmCIAiCIAiCIAiCIAiCIAiCIAiCIAiCIAiCIAiCIAiCIAiCH87Dw3+/D/p4q7KE5wAAAABJRU5ErkJggg==",alt:"logo",onClick:()=>{h("/login")}}),(0,i.jsx)("h3",{className:ke,children:"Enter your nickname to start"}),(0,i.jsx)("div",{className:Me,children:(0,i.jsx)("input",{type:"text",placeholder:"Enter your nickname",id:"username",value:u.username,onChange:e=>{let{target:t}=e;return c({...u,username:t.value})},ref:d})}),(0,i.jsx)("div",{className:Ue,children:(0,i.jsx)("div",{className:Oe,children:(0,i.jsx)("button",{className:De,onClick:p,children:"Enter!"})})})]}):null},Re="MainPage_container__i8S8d",xe="MainPage_buttons__CtBDK",Pe="MainPage_main_button__-Gd0p",Fe="MainPage_logout_button__A5D9x",ze=()=>{const t=se(),{user:n,resetUser:r}=(0,e.useContext)(a),{sbClient:s}=(0,e.useContext)(l),o=(0,e.useCallback)((()=>{r(),s.disconnect(),t("/login")}),[t,r,s]);return(0,i.jsxs)("div",{className:Re,children:[(0,i.jsx)("h3",{children:"MainPage"}),(0,i.jsxs)("p",{children:["Hello, ",n.userId]}),(0,i.jsx)("div",{className:xe,children:(0,i.jsx)("div",{className:Pe,children:(0,i.jsx)("button",{className:Fe,onClick:o,children:"Logout"})})})]})},He="ChatPage_container__y+Meq",qe=e=>(0,i.jsx)("div",{className:He,children:(0,i.jsx)("h3",{children:"ChatPage"})});const Ve=function(){const{user:t}=(0,e.useContext)(a);return(0,i.jsx)(Se,{children:(0,i.jsxs)(be,{children:[(0,i.jsx)(ye,{path:"/login",element:t.userId?(0,i.jsx)(ge,{replace:!0,to:"/"}):(0,i.jsx)(Le,{})}),(0,i.jsx)(ye,{path:"/",element:t.userId?(0,i.jsx)(ze,{}):(0,i.jsx)(ge,{replace:!0,to:"/login"})}),(0,i.jsx)(ye,{path:"/chat",element:t.userId?(0,i.jsx)(qe,{}):(0,i.jsx)(ge,{replace:!0,to:"/login"})}),(0,i.jsx)(ye,{path:"/*",element:(0,i.jsx)(ge,{replace:!0,to:"/login"})})]})})};var Ge=function(e,t){return Ge=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},Ge(e,t)};function Be(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}Ge(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var je=function(){return je=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},je.apply(this,arguments)};function Qe(e,t,n,r){return new(n||(n=Promise))((function(i,a){function s(e){try{u(r.next(e))}catch(e){a(e)}}function o(e){try{u(r.throw(e))}catch(e){a(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,o)}u((r=r.apply(e,t||[])).next())}))}function Ke(e,t){var n,r,i,a,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function o(o){return function(u){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,o[0]&&(s=0)),s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,u])}}}function We(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function Ye(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,a=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=a.next()).done;)s.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=a.return)&&n.call(a)}finally{if(i)throw i.error}}return s}function Ze(e,t,n){if(n||2===arguments.length)for(var r,i=0,a=t.length;i<a;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))}"function"==typeof SuppressedError&&SuppressedError;var Je,Xe="4.10.4",$e=function(){function e(){}return Object.defineProperty(e,"OS_VERSION",{get:function(){return"undefined"!=typeof navigator&&navigator.userAgent?navigator.userAgent.replace(/,/g,"."):"noAgent"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"SDK_VERSION",{get:function(){return Xe},enumerable:!1,configurable:!0}),Object.defineProperty(e,"SDK_MAJOR_VERSION",{get:function(){return e.SDK_VERSION.split(".")[0]},enumerable:!1,configurable:!0}),Object.defineProperty(e,"DEFAULT_MAX_UNREAD_COUNT_OF_SUPER_GROUP_CHANNEL",{get:function(){return 100},enumerable:!1,configurable:!0}),Object.defineProperty(e,"INTERNAL_CALL",{get:function(){return"ic"},enumerable:!1,configurable:!0}),e}();!function(e){e[e.STAT_LOG_NOT_ALLOWED=400108]="STAT_LOG_NOT_ALLOWED",e[e.NON_AUTHORIZED=400108]="NON_AUTHORIZED",e[e.INVALID_TOKEN=400111]="INVALID_TOKEN",e[e.NOT_FOUND_IN_DATABASE=400201]="NOT_FOUND_IN_DATABASE",e[e.USER_AUTH_DEACTIVATED=400300]="USER_AUTH_DEACTIVATED",e[e.USER_AUTH_DELETED_OR_NOT_FOUND=400301]="USER_AUTH_DELETED_OR_NOT_FOUND",e[e.SESSION_TOKEN_EXPIRED=400302]="SESSION_TOKEN_EXPIRED",e[e.APPLICATION_NOT_FOUND=400304]="APPLICATION_NOT_FOUND",e[e.SESSION_KEY_EXPIRED=400309]="SESSION_KEY_EXPIRED",e[e.SESSION_REVOKED=400310]="SESSION_REVOKED",e[e.INVALID_SESSION_TYPE=400312]="INVALID_SESSION_TYPE",e[e.STAT_UPLOAD_NOT_ALLOWED=403200]="STAT_UPLOAD_NOT_ALLOWED",e[e.NOT_SUPPORTED_PINNED_MESSAGE_IN_REVIEW_MESSAGE=400940]="NOT_SUPPORTED_PINNED_MESSAGE_IN_REVIEW_MESSAGE",e[e.INTERNAL_SERVER_ERROR=500901]="INTERNAL_SERVER_ERROR",e[e.RATE_LIMIT_EXCEEDED=500910]="RATE_LIMIT_EXCEEDED",e[e.INVALID_FORM_KEY=400111]="INVALID_FORM_KEY",e[e.INVALID_REQUIRED_FORM_VALUE=400105]="INVALID_REQUIRED_FORM_VALUE",e[e.UNKNOWN_SERVER_ERROR=900200]="UNKNOWN_SERVER_ERROR",e[e.NOT_SUPPORTED_FEATURE_IN_IN_REVIEW_MESSAGE=901500]="NOT_SUPPORTED_FEATURE_IN_IN_REVIEW_MESSAGE",e[e.DEBUG_MODE_REQUIRED=7e5]="DEBUG_MODE_REQUIRED",e[e.LOST_INSTANCE=700100]="LOST_INSTANCE",e[e.CONNECTION_RENEW=700102]="CONNECTION_RENEW",e[e.INVALID_CONNECTION_STATE_TRANSITION=700200]="INVALID_CONNECTION_STATE_TRANSITION",e[e.INVALID_COMMAND=700700]="INVALID_COMMAND",e[e.UNKNOWN_ERROR=77e4]="UNKNOWN_ERROR",e[e.INVALID_INITIALIZATION=800100]="INVALID_INITIALIZATION",e[e.CONNECTION_REQUIRED=800101]="CONNECTION_REQUIRED",e[e.CONNECTION_CANCELED=800102]="CONNECTION_CANCELED",e[e.INVALID_PARAMETER=800110]="INVALID_PARAMETER",e[e.NOT_SUPPORTED_ERROR=800111]="NOT_SUPPORTED_ERROR",e[e.NETWORK_ERROR=800120]="NETWORK_ERROR",e[e.NETWORK_ROUTING_ERROR=800121]="NETWORK_ROUTING_ERROR",e[e.MALFORMED_DATA=800130]="MALFORMED_DATA",e[e.MALFORMED_ERROR_DATA=800140]="MALFORMED_ERROR_DATA",e[e.WRONG_CHANNEL_TYPE=800150]="WRONG_CHANNEL_TYPE",e[e.MARK_AS_READ_RATE_LIMIT_EXCEEDED=800160]="MARK_AS_READ_RATE_LIMIT_EXCEEDED",e[e.QUERY_IN_PROGRESS=800170]="QUERY_IN_PROGRESS",e[e.ACK_TIMEOUT=800180]="ACK_TIMEOUT",e[e.LOGIN_TIMEOUT=800190]="LOGIN_TIMEOUT",e[e.WEBSOCKET_CONNECTION_CLOSED=800200]="WEBSOCKET_CONNECTION_CLOSED",e[e.WEBSOCKET_CONNECTION_FAILED=800210]="WEBSOCKET_CONNECTION_FAILED",e[e.REQUEST_FAILED=800220]="REQUEST_FAILED",e[e.FILE_UPLOAD_CANCEL_FAILED=800230]="FILE_UPLOAD_CANCEL_FAILED",e[e.REQUEST_CANCELED=800240]="REQUEST_CANCELED",e[e.REQUEST_DUPLICATED=800250]="REQUEST_DUPLICATED",e[e.FILE_SIZE_LIMIT_EXCEEDED=800260]="FILE_SIZE_LIMIT_EXCEEDED",e[e.SESSION_TOKEN_REQUEST_FAILED=800500]="SESSION_TOKEN_REQUEST_FAILED",e[e.SESSION_TOKEN_REFRESHED=800501]="SESSION_TOKEN_REFRESHED",e[e.SESSION_TOKEN_REFRESH_FAILED=800502]="SESSION_TOKEN_REFRESH_FAILED",e[e.COLLECTION_DISPOSED=800600]="COLLECTION_DISPOSED",e[e.DATABASE_ERROR=800700]="DATABASE_ERROR"}(Je||(Je={}));var et,tt,nt,rt,it,at=function(e){return!(e instanceof st&&!e.shouldThrowOutside)},st=function(e){function t(n){var r=n.code,i=void 0===r?0:r,a=n.message,s=void 0===a?"":a,o=e.call(this,s)||this;return o.shouldThrowOutside=!1,o.name="SendbirdError",o.code=i,Object.setPrototypeOf(o,t.prototype),o}return Be(t,e),Object.defineProperty(t.prototype,"isInvalidTokenError",{get:function(){return this.code===Je.INVALID_TOKEN},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isSessionExpiredError",{get:function(){return this.isSessionTokenExpiredError||this.isSessionKeyExpiredError},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isSessionTokenExpiredError",{get:function(){return this.code===Je.SESSION_TOKEN_EXPIRED},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isSessionKeyExpiredError",{get:function(){return this.code===Je.SESSION_KEY_EXPIRED},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isSessionInvalidatedError",{get:function(){return this.isSessionRevokedError||this.isUserAuthDeactivedError||this.isUserAuthDeletedOrNotFoundError},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isSessionRevokedError",{get:function(){return this.code===Je.SESSION_REVOKED},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isUserAuthDeactivedError",{get:function(){return this.code===Je.USER_AUTH_DEACTIVATED},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isUserAuthDeletedOrNotFoundError",{get:function(){return this.code===Je.USER_AUTH_DELETED_OR_NOT_FOUND},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isNetworkError",{get:function(){return this.code===Je.NETWORK_ERROR||this.code===Je.NETWORK_ROUTING_ERROR},enumerable:!1,configurable:!0}),Object.defineProperty(t,"debugModeRequired",{get:function(){return new t({code:Je.DEBUG_MODE_REQUIRED,message:"Cannot run this operation in production mode."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"lostInstance",{get:function(){return new t({code:Je.LOST_INSTANCE,message:"Instance ID is missing. It should belong to an instance."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"invalidCommand",{get:function(){return new t({code:Je.INVALID_COMMAND,message:"Cannot send invalid command."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"unknown",{get:function(){return new t({code:Je.UNKNOWN_ERROR,message:"Unknown error occurred."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"connectionRenew",{get:function(){return new t({code:Je.CONNECTION_RENEW,message:"Connection restarts."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"invalidConnectionStateTransition",{get:function(){return new t({code:Je.INVALID_CONNECTION_STATE_TRANSITION,message:"Invalid connection state transition."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"connectionRequired",{get:function(){return new t({code:Je.CONNECTION_REQUIRED,message:"Connection is required."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"connectionCanceled",{get:function(){return new t({code:Je.CONNECTION_CANCELED,message:"Connection is canceled."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"invalidParameters",{get:function(){return new t({code:Je.INVALID_PARAMETER,message:"Invalid parameters."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"notSupportedError",{get:function(){return new t({code:Je.NOT_SUPPORTED_ERROR,message:"Given parameters are not supported."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"channelTypeNotSupportedError",{get:function(){return new t({code:Je.NOT_SUPPORTED_ERROR,message:"Called method is not supported in the current channel's channel type."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"networkError",{get:function(){return new t({code:Je.NETWORK_ERROR,message:"There was a network error."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"markAsReadAllRateLimitExceeded",{get:function(){return new t({code:Je.MARK_AS_READ_RATE_LIMIT_EXCEEDED,message:"markAsRead rate limit exceeded."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"queryInProgress",{get:function(){return new t({code:Je.QUERY_IN_PROGRESS,message:"Query in progress."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"noAckTimeout",{get:function(){return new t({code:Je.ACK_TIMEOUT,message:"Command received no ack."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"loginTimeout",{get:function(){return new t({code:Je.LOGIN_TIMEOUT,message:"Connection timeout."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"connectionClosed",{get:function(){return new t({code:Je.WEBSOCKET_CONNECTION_CLOSED,message:"Connection is closed. Please reconnect."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"requestFailed",{get:function(){return new t({code:Je.REQUEST_FAILED,message:"Request failed."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"alreadyConnectedAsAnotherUser",{get:function(){return new t({code:Je.REQUEST_FAILED,message:"Already logged in as a different user. Call disconnect() first."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"fileUploadCanceled",{get:function(){return new t({code:Je.FILE_UPLOAD_CANCEL_FAILED,message:"File upload has been canceled."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"requestCanceled",{get:function(){return new t({code:Je.REQUEST_CANCELED,message:"Request has been canceled."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"sessionTokenRefreshFailed",{get:function(){return new t({code:Je.SESSION_TOKEN_REFRESH_FAILED,message:"Failed to refresh the session key."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"sessionTokenRequestFailed",{get:function(){return new t({code:Je.SESSION_TOKEN_REQUEST_FAILED,message:"Failed to get the session token."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"databaseError",{get:function(){return new t({code:Je.DATABASE_ERROR,message:"Database error."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"fileSizeLimitExceededError",{get:function(){return new t({code:Je.FILE_SIZE_LIMIT_EXCEEDED,message:"File size exceeds the file size limit."})},enumerable:!1,configurable:!0}),t.prototype.throwOutside=function(){throw this.shouldThrowOutside=!0,this},t}(Error),ot=[Je.CONNECTION_REQUIRED,Je.NETWORK_ERROR,Je.ACK_TIMEOUT,Je.WEBSOCKET_CONNECTION_CLOSED,Je.WEBSOCKET_CONNECTION_FAILED,Je.FILE_UPLOAD_CANCEL_FAILED,Je.REQUEST_CANCELED,Je.INTERNAL_SERVER_ERROR,Je.RATE_LIMIT_EXCEEDED,Je.UNKNOWN_SERVER_ERROR],ut=[Je.WEBSOCKET_CONNECTION_CLOSED,Je.WEBSOCKET_CONNECTION_FAILED,Je.CONNECTION_REQUIRED],lt=function(e,t){if(e!==t){var n=je({},e),r=je({},t);return(!n.hasOwnProperty("messageId")||!r.hasOwnProperty("messageId")||n.messageId===r.messageId)&&(!n.hasOwnProperty("reqId")||!r.hasOwnProperty("reqId")||n.reqId===r.reqId)&&(n.hasOwnProperty("messageId")&&delete n.messageId,n.hasOwnProperty("reqId")&&delete n.reqId,r.hasOwnProperty("messageId")&&delete r.messageId,r.hasOwnProperty("reqId")&&delete r.reqId,JSON.stringify(n)===JSON.stringify(r))}return!0},ct=function(e,t,n){return void 0===n&&(n=!1),!(!n||null!=t)||("string"!=typeof e?"object"==typeof e?dt(e,t):ht(e,t):typeof t===e)},dt=function(e,t,n){return void 0===n&&(n=!1),!(!n||null!=t)||Object.values(e).includes(t)},ht=function(e,t){return t instanceof e},ft=function(e,t,n){return void 0===n&&(n=!1),!(!n||null!=t)||Array.isArray(t)&&t.every((function(t){return ct(e,t)}))},pt=function(e,t){return void 0===t&&(t=!1),!(!t||void 0!==e)||"number"==typeof e&&13===e.toString().length},_t=function(e){return e>0&&ut.indexOf(e)>=0},vt=function(e,t){if(void 0===t&&(t=!1),t&&null==e)return!0;var n="object"==typeof e&&null!==e&&e.hasOwnProperty("name")&&"string"==typeof e.name&&e.hasOwnProperty("uri")&&"string"==typeof e.uri&&e.hasOwnProperty("type")&&"string"==typeof e.type;if(!n){if("undefined"!=typeof Blob)return e instanceof Blob;if("undefined"!=typeof File)return e instanceof File}return n},mt=function(){function e(e){var t=void 0===e?{}:e,n=t.useMemberInfoInMessage,r=void 0===n||n,i=t.typingIndicatorInvalidateTime,a=void 0===i?1e4:i,s=t.typingIndicatorThrottle,o=void 0===s?1e3:s,u=t.websocketResponseTimeout,l=void 0===u?1e4:u,c=t.websocketPayloadDecompression,d=void 0===c||c,h=t.sessionTokenRefreshTimeout,f=void 0===h?60:h;this._useMemberInfoInMessage=!0,this._typingIndicatorInvalidateTime=1e4,this._typingIndicatorThrottle=1e3,this._websocketResponseTimeout=1e4,this._sessionTokenRefreshTimeout=60,this._useMemberInfoInMessage=r,this._typingIndicatorInvalidateTime=a,this._typingIndicatorThrottle=o,this._websocketResponseTimeout=l,this._sessionTokenRefreshTimeout=f,this.websocketPayloadDecompression=d}return Object.defineProperty(e.prototype,"useMemberInfoInMessage",{get:function(){return this._useMemberInfoInMessage},set:function(e){ct("boolean",e)&&(this._useMemberInfoInMessage=e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"typingIndicatorInvalidateTime",{get:function(){return this._typingIndicatorInvalidateTime},set:function(e){ct("number",e)&&(this._typingIndicatorInvalidateTime=e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"typingIndicatorThrottle",{get:function(){return this._typingIndicatorThrottle},set:function(e){ct("number",e)&&e>=1e3&&e<=9e3&&(this._typingIndicatorThrottle=e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"websocketResponseTimeout",{get:function(){return this._websocketResponseTimeout},set:function(e){ct("number",e)&&e>=5e3&&e<=3e4&&(this._websocketResponseTimeout=e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"sessionTokenRefreshTimeout",{get:function(){return this._sessionTokenRefreshTimeout},set:function(e){ct("number",e)&&(e<60?e=60:e>1800&&(e=1800),this._sessionTokenRefreshTimeout=e)},enumerable:!1,configurable:!0}),e}(),gt={encrypt:function(e){return e},decrypt:function(e){return e}},yt=function(){function e(e){var t=e.store;this._preference=new Map,this._store=t}return e.prototype._savePreferenceKeys=function(){return Qe(this,void 0,void 0,(function(){return Ke(this,(function(e){switch(e.label){case 0:return[4,this._store.set({key:this._keysAddress,value:Ze([],Ye(this._preference.keys()),!1)})];case 1:return e.sent(),[2]}}))}))},e.prototype.init=function(e,t){var n;return void 0===t&&(t=1),Qe(this,void 0,void 0,(function(){var r,i,a,s,o,u,l,c,d,h;return Ke(this,(function(f){switch(f.label){case 0:return this._version=t,this._keysAddress=e,r="".concat(e,".metadata.version"),[4,this._store.get(r)];case 1:return i=f.sent(),[4,this._store.get(e)];case 2:return a=null!==(n=f.sent())&&void 0!==n?n:[],!i||i.version<this._version?[4,this._resetPreferenceData(a,r)]:[3,4];case 3:return f.sent(),[3,11];case 4:f.trys.push([4,9,10,11]),s=We(a),o=s.next(),f.label=5;case 5:return o.done?[3,8]:(u=o.value,[4,this._store.get(u)]);case 6:(l=f.sent())&&this._preference.set(u,l),f.label=7;case 7:return o=s.next(),[3,5];case 8:return[3,11];case 9:return c=f.sent(),d={error:c},[3,11];case 10:try{o&&!o.done&&(h=s.return)&&h.call(s)}finally{if(d)throw d.error}return[7];case 11:return[2]}}))}))},e.prototype._resetPreferenceData=function(e,t){return Qe(this,void 0,void 0,(function(){return Ke(this,(function(n){switch(n.label){case 0:return this._preference=new Map,[4,this._store.removeMany(e)];case 1:return n.sent(),[4,this._store.set({key:t,value:{version:this._version}})];case 2:return n.sent(),[2]}}))}))},e.prototype.get=function(e){return Qe(this,void 0,void 0,(function(){return Ke(this,(function(t){return[2,this._preference.get(e)]}))}))},e.prototype.set=function(e,t){return Qe(this,void 0,void 0,(function(){var n;return Ke(this,(function(r){switch(r.label){case 0:return n=!this._preference.has(e),[4,this._store.set({key:e,value:t})];case 1:return r.sent(),this._preference.set(e,t),n?[4,this._savePreferenceKeys()]:[3,3];case 2:r.sent(),r.label=3;case 3:return[2]}}))}))},e.prototype.remove=function(e){return Qe(this,void 0,void 0,(function(){return Ke(this,(function(t){switch(t.label){case 0:return[4,this._store.remove(e)];case 1:return t.sent(),this._preference.delete(e),[4,this._savePreferenceKeys()];case 2:return t.sent(),[2]}}))}))},e.prototype.clear=function(){return Qe(this,void 0,void 0,(function(){return Ke(this,(function(e){switch(e.label){case 0:return[4,this._store.removeMany(Ze([],Ye(this._preference.keys()),!1))];case 1:return e.sent(),this._preference.clear(),[4,this._savePreferenceKeys()];case 2:return e.sent(),[2]}}))}))},e}(),Et=function(){function e(e){var t=e.encryption,n=e.store,r=e.localCacheEnabled,i=e.localCacheConfig;this.store=n,this.preference=new yt({store:n}),this.encryption=null!=t?t:gt,this.localCacheEnabled=r,this.localCacheConfig=i}return e.prototype.replaceStore=function(e){this.store=e,this.preference=new yt({store:e})},e}();!function(e){e.SUCCESS="success",e.PENDING="pending",e.ERROR="error"}(et||(et={})),function(e){e.DEFAULT="default",e.ALL="all",e.MENTION_ONLY="mention_only",e.OFF="off"}(tt||(tt={})),function(e){e.FCM="gcm",e.APNS="apns",e.UNKNOWN="unknown"}(nt||(nt={})),function(e){e.ALTERNATIVE="alternative",e.DEFAULT="default"}(rt||(rt={})),function(e){e.CUSTOM="custom",e.MESSAGE_COLLECTION_ACCESSED_AT="messagecollection_accessed_at"}(it||(it={}));var bt,Ct=function(){function e(e){var t=e.channel,n=e.cachedMessageCount;this._cachedMessageCount=0,this._channel=t,this._cachedMessageCount=n}return Object.defineProperty(e.prototype,"channel",{get:function(){return this._channel},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"cachedMessageCount",{get:function(){return this._cachedMessageCount},enumerable:!1,configurable:!0}),e}(),wt=function(){function e(e){var t=void 0===e?{}:e,n=t.maxSize,r=void 0===n?256:n,i=t.clearOrder,a=void 0===i?it.MESSAGE_COLLECTION_ACCESSED_AT:i,s=t.customClearOrderComparator,o=t.enableAutoResend,u=void 0===o||o;this._clearOrderComparatorUseMessageCollectionAccessedAt=function(e,t){return e.channel.messageCollectionLastAccessedAt===t.channel.messageCollectionLastAccessedAt?e.channel.lastMessage&&!t.channel.lastMessage?1:!e.channel.lastMessage&&t.channel.lastMessage?-1:e.channel.lastMessage||t.channel.lastMessage?e.channel.lastMessage.createdAt-t.channel.lastMessage.createdAt:0:e.channel.messageCollectionLastAccessedAt>t.channel.messageCollectionLastAccessedAt?1:-1},this._maxSize=Math.max(r,64),s?(this._clearOrder=a,this._customClearOrderComparator=s):this._clearOrder=it.MESSAGE_COLLECTION_ACCESSED_AT,this._enableAutoResend=u}return Object.defineProperty(e.prototype,"maxSize",{get:function(){return this._maxSize},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"clearOrder",{get:function(){return this._clearOrder},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"clearOrderComparator",{get:function(){var e;return this._clearOrder===it.MESSAGE_COLLECTION_ACCESSED_AT?this._clearOrderComparatorUseMessageCollectionAccessedAt:null!==(e=this._customClearOrderComparator)&&void 0!==e?e:this._clearOrderComparatorUseMessageCollectionAccessedAt},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"enableAutoResend",{get:function(){return this._enableAutoResend},enumerable:!1,configurable:!0}),e}();!function(e){e.FEED="feed",e.CHAT="chat"}(bt||(bt={}));var St,Tt,It,Nt,At,kt,Mt,Ut,Ot,Dt,Lt,Rt=function(){function e(){this.isRefreshing=!1}return Object.defineProperty(e.prototype,"hasSession",{get:function(){return!!this.sessionKey},enumerable:!1,configurable:!0}),e.prototype.clear=function(){this.authToken=void 0,this.sessionKey=void 0,this.services=[]},e.prototype.hasLessServiceScopeThan=function(e){var t;return!this.sessionKey||!(null===(t=this.services)||void 0===t?void 0:t.includes(bt.CHAT))||e.includes(bt.CHAT)},e}(),xt=function(){var e=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var n=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"===t?n:3&n|8).toString(16)}))},Pt=function(){function e(e){var t=e.container;this._container={},this._container=t,this.key=xt()}return e.prototype._register=function(e,t,n){var r;return e in this._container||(this._container[e]=new Map),null===(r=this._container[e])||void 0===r||r.set(this.key,{occurence:t,handler:n}),this},e.prototype.on=function(e,t){return this._register(e,-1,t)},e.prototype.once=function(e,t){return this._register(e,1,t)},e.prototype.close=function(){var e;for(var t in this._container)null===(e=this._container[t])||void 0===e||e.delete(this.key)},e}(),Ft=function(){function e(){this._container={}}return e.prototype.on=function(e,t){return new Pt({container:this._container}).on(e,t)},e.prototype.once=function(e,t){return new Pt({container:this._container}).once(e,t)},e.prototype.dispatch=function(e,t){var n,r,i=this._container[e];if(i){var a=[];try{for(var s=We(i.keys()),o=s.next();!o.done;o=s.next()){var u=o.value,l=i.get(u);l.handler(t),l.occurence>0&&(l.occurence--,0===l.occurence&&a.push(u))}}catch(e){n={error:e}}finally{try{o&&!o.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}a.forEach((function(e){return i.delete(e)}))}},e}(),zt=function(){function e(){this._dispatcher=new Ft}return e.prototype.on=function(e){return this._dispatcher.on("event",e)},e.prototype.once=function(e){return this._dispatcher.once("event",e)},e.prototype.dispatch=function(e){this._dispatcher.dispatch("event",e)},e}(),Ht=function(){},qt=function(e){var t={};return e&&Object.keys(e).forEach((function(n){void 0===e[n]||Number.isNaN(e[n])||null===e[n]||(t[n]=e[n])})),t},Vt=function(e){if(null!=e){if("object"==typeof e){if(Array.isArray(e)){var t=Ze([],Ye(e),!1);for(var n in t)t[n]=Vt(t[n]);return t}for(var r in e)null===e[r]&&delete e[r];return e}return e}};!function(e){e.BASE="base",e.GROUP="group",e.OPEN="open",e.FEED="feed"}(St||(St={})),function(e){e.OPERATOR="operator",e.NONE="none"}(Tt||(Tt={})),function(e){e.MUTED="muted",e.UNMUTED="unmuted"}(It||(It={})),function(e){e.BASE="base",e.USER="user",e.FILE="file",e.ADMIN="admin"}(Nt||(Nt={})),function(e){e.ALL="",e.USER="MESG",e.FILE="FILE",e.ADMIN="ADMM"}(At||(At={})),function(e){e.USER="MESG",e.FILE="FILE",e.ADMIN="ADMM"}(kt||(kt={})),function(e){e.USERS="users",e.CHANNEL="channel"}(Mt||(Mt={})),function(e){e.ALL="all",e.NONE="none",e.ONLY_REPLY_TO_CHANNEL="only_reply_to_channel"}(Ut||(Ut={})),function(e){e.DEFAULT="default",e.SUPPRESS="suppress"}(Ot||(Ot={})),function(e){e.PENDING="pending",e.SCHEDULED="scheduled",e.SUCCEEDED="succeeded",e.FAILED="failed",e.CANCELED="canceled"}(Dt||(Dt={})),function(e){e.INREVIEW="InReview",e.APPROVED="Approved"}(Lt||(Lt={}));var Gt,Bt="v3",jt="/".concat(Bt,"/users"),Qt="/".concat(Bt,"/storage/file"),Kt="/".concat(Bt,"/group_channels"),Wt="/".concat(Bt,"/sdk/group_channels"),Yt="/".concat(Bt,"/open_channels"),Zt="/".concat(Bt,"/sdk/open_channels"),Jt="/".concat(Bt,"/search"),Xt="/".concat(Bt,"/report"),$t="/".concat(Bt,"/emojis"),en="/".concat(Bt,"/emoji_categories"),tn="/".concat(Bt,"/polls"),nn="/".concat(Bt,"/scheduled_messages"),rn="/".concat(Bt,"/sdk/ui_kit/configuration"),an="/".concat(Bt,"/sdk/statistics"),sn=("/".concat(Bt,"/notifications"),function(e){switch(e){case St.FEED:case St.GROUP:return Kt;case St.OPEN:return Yt;default:return null}}),on=function(e){switch(e){case St.GROUP:return"".concat(Xt,"/group_channels");case St.OPEN:return"".concat(Xt,"/open_channels");default:return null}},un=function(e,t,n){var r,i;switch(e){case Mt.CHANNEL:return!0;case Mt.USERS:if(t)try{for(var a=We(t),s=a.next();!s.done;s=a.next())if(s.value===n)return!0}catch(e){r={error:e}}finally{try{s&&!s.done&&(i=a.return)&&i.call(a)}finally{if(r)throw r.error}}}return!1},ln=function(e,t,n){var r,i,a,s,o=un(null!==(r=e.mentionType)&&void 0!==r?r:null,null!==(i=e.mentionedUserIds)&&void 0!==i?i:[],n),u=un(null!==(a=t.mentionType)&&void 0!==a?a:null,null!==(s=t.mentionedUserIds)&&void 0!==s?s:[],n);return!o&&u?1:o&&!u?-1:0},cn=function(e,t,n){var r,i=t||new FormData;for(var a in e)if(e.hasOwnProperty(a)){var s=e[a],o=n?"".concat(n,"[").concat(a,"]"):a;vt(s)?i.append(o,s,null!==(r=s.name)&&void 0!==r?r:"filename"):"object"!=typeof s||null===s||Array.isArray(s)||s instanceof Blob?i.append(o,String(s)):i=cn(s,i,o)}return i};!function(e){e.GET="GET",e.POST="POST",e.PUT="PUT",e.DELETE="DELETE"}(Gt||(Gt={}));var dn,hn=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.params={},t.requireAuth=!0,t.headers={},t.requestId=xt(),t}return Be(t,e),t.prototype.encodeParams=function(e){var t=this;return null==e||""===e?encodeURIComponent(""):Array.isArray(e)?e.map((function(e){return t.encodeParams(e)})).join(","):"object"==typeof e?encodeURIComponent(JSON.stringify(e)):encodeURIComponent(String(e))},Object.defineProperty(t.prototype,"query",{get:function(){var e=this,t=qt(this.params);return"?".concat(Object.keys(t).map((function(n){return"".concat(encodeURIComponent(n),"=").concat(e.encodeParams(t[n]))})).join("&"))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"payload",{get:function(){var e=qt(this.params);return Object.keys(e).some((function(t){return vt(e[t])}))?cn(e):JSON.stringify(e)},enumerable:!1,configurable:!0}),t}(Ht),fn=function(e){function t(t,n){var r=e.call(this)||this;return r._iid=t,r._payload=n,r}return Be(t,e),Object.defineProperty(t.prototype,"payload",{get:function(){return je({},this._payload)},enumerable:!1,configurable:!0}),t.prototype.as=function(e){return new e(this._iid,this.payload)},t}(Ht),pn=function(e){function t(t){var n=e.call(this)||this;return n.requestId=t,n}return Be(t,e),t}(Ht),_n=function(e){function t(t){var n=t.expires_in,r=t.reason,i=void 0===r?Je.SESSION_KEY_EXPIRED:r,a=e.call(this)||this;switch(a.expiresIn=null!=n?n:0,i){case Je.SESSION_KEY_EXPIRED:case Je.SESSION_TOKEN_EXPIRED:case Je.SESSION_REVOKED:case Je.USER_AUTH_DEACTIVATED:case Je.USER_AUTH_DELETED_OR_NOT_FOUND:a.error=new st({code:i})}return a}return Be(t,e),Object.defineProperty(t.prototype,"invalidateSessionToken",{get:function(){var e;return!!(null===(e=this.error)||void 0===e?void 0:e.isSessionTokenExpiredError)},enumerable:!1,configurable:!0}),t}(Ht),vn=function(e){function t(t,n,r,i){void 0===i&&(i="");var a,s=this;return(s=e.call(this)||this)._iid=t,s.code=n,s.payload=r,s.requestId=null!==(a=r.req_id)&&void 0!==a?a:i,s}return Be(t,e),t.createFromRawMessage=function(e,n){var r=n.substring(0,4),i={};try{i=JSON.parse(n.substring(4))}catch(e){r="NOOP"}finally{return new t(e,r,i)}},t.prototype.convertToMessage=function(){return"".concat(this.code).concat(JSON.stringify(this.payload),"\n")},t.prototype.as=function(e){return new e(this._iid,this.code,this.payload)},t}(Ht),mn=function(e){function t(t){var n,r=t.code,i=t.ackRequired,a=t.payload,s=void 0===a?{}:a,o=this;return(o=e.call(this)||this).code=r,o.payload=s,o.requestId=null!==(n=o.payload.req_id)&&void 0!==n?n:xt(),o.ackRequired=i,o.payload.req_id=o.requestId,o}return Be(t,e),t.prototype.convertToMessage=function(){return"".concat(this.code).concat(JSON.stringify(this.payload),"\n")},t}(Ht),gn=function(e){function t(t){var n=t.userId,r=t.authToken,i=t.services,a=void 0===i?[bt.CHAT]:i,s=t.expiringSession,o=void 0===s||s,u=e.call(this)||this;return u.path="".concat(jt,"/").concat(n,"/session_key"),u.method=Gt.POST,u.params=qt({token:r,services:a,expiring_session:!!o}),u.requireAuth=!1,u}return Be(t,e),t}(hn),yn=function(e){function t(t){var n=t.authToken,r=t.expiringSession,i=void 0===r||r,a=t.requestId,s=void 0===a?void 0:a;return e.call(this,{code:"LOGI",payload:{token:n,expiring_session:i?1:0,req_id:s},ackRequired:!0})||this}return Be(t,e),t}(mn),En=function(e){function t(t,n){var r=e.call(this,t,n)||this,i=n.key,a=n.expires_at,s=n.services;return r.key=i,r.expiresAt=a,r.services=s,r}return Be(t,e),t}(fn),bn=function(e){function t(t,n,r){var i,a=this;return(a=e.call(this,t,"LOGI",r)||this).error=null,a.newKey=null,a.newKey=null!==(i=r.new_key)&&void 0!==i?i:null,a.error=r.error?new st(r):null,a}return Be(t,e),t}(vn),Cn=function(e){function t(t){var n=e.call(this)||this;return n.statLog=t,n}return Be(t,e),t}(Ht),wn=function(e){function t(t){var n=t.request,r=t.deferred,i=t.error,a=void 0===i?st.requestFailed:i,s=e.call(this)||this;return s.request=n,s.deferred=r,s.error=a,s}return Be(t,e),t}(Ht);!function(e){e.FEATURE_LOCALCACHE="feature:local_cache",e.FEATURE_LOCALCACHE_EVENT="feature:local_cache_event",e.NOTIFICATION="noti:stats",e.WEBSOCKET_CONNECT="ws:connect",e.API_RESULT="api:result"}(dn||(dn={}));var Sn,Tn,In,Nn=function(){function e(e){var t=e.type,n=e.data,r=e.ts,i=void 0===r?Date.now():r;this.type=t,this.createdAt=i,this.data=n}return e.payloadify=function(e){return qt({stat_type:e.type,ts:e.createdAt,data:qt(e.data)})},e}(),An=function(){return"undefined"==typeof document&&"undefined"!=typeof navigator&&"ReactNative"==navigator.product},kn=function(){return!("undefined"==typeof navigator||!/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini|Windows Phone/i.test(navigator.userAgent))};!function(e){e.CHAT="chat",e.CALLS="calls",e.DESK="desk",e.LIVE="live",e.UIKIT_CHAT="uikit-chat",e.UIKIT_LIVE="uikit-live"}(Sn||(Sn={})),function(e){e.ANDROID="android",e.IOS="ios",e.JS="js",e.UNREAL="unreal",e.UNITY="unity",e.REACT_NATIVE="react-native",e.FLUTTER="flutter"}(Tn||(Tn={})),function(e){e.ANDROID="android",e.IOS="ios",e.WEB="web",e.MOBILE_WEB="mobile_web",e.WINDOWS="windows"}(In||(In={}));var Mn=function(){function e(){}return e.sendbirdSdkUserAgentWithExtension=function(e){var t=An()?Tn.REACT_NATIVE:Tn.JS,n={main_sdk_info:"chat/".concat(t,"/").concat($e.SDK_VERSION),device_os_platform:kn()?"mobile-web":"web",os_version:$e.OS_VERSION};if(e){var r=e.sendbirdExtensions,i=e.deviceOS,a=e.customData,s=void 0===a?{}:a;i.version&&(n.os_version=i.version),i.platform&&(n.device_os_platform=i.platform),r.length>0&&(n.extension_sdk_info=r.map((function(e){var t=e.product,n=e.platform,r=e.version;return"".concat(t,"/").concat(n,"/").concat(r)})).join(",")),Object.keys(n).forEach((function(e){return delete s[e]})),Object.keys(s).length>0&&(n=je(je({},n),s))}return Object.entries(n).map((function(e){var t=Ye(e,2),n=t[0],r=t[1];return"".concat(n,"=").concat(r)})).join("&")},e.userAgentWithExtension=function(e){var t=An()?"reactnative":"JS",n=e.sb_syncmanager?"s".concat(e.sb_syncmanager):"",r=e.sb_uikit?"u".concat(e.sb_uikit):"",i=e["device-os-platform"]?"o".concat(e["device-os-platform"]):kn()?"omobile-web":"oweb";return"".concat(t,"/c").concat($e.SDK_VERSION,"/").concat(n,"/").concat(r,"/").concat(i)},e}(),Un=function(){var e=this;this.promise=new Promise((function(t,n){e.resolve=t,e.reject=function(e){n(e)}}))},On=function(){function e(e,t){var n=t.session,r=t.sdkState,i=t.dispatcher,a=t.logger,s=t.useFetchCompat,o=void 0!==s&&s,u=this;this._abortControl=new Map,this._shouldImportFetchCompat=!1,this._iid=e,this._session=n,this._sdkState=r,this._dispatcher=i,this._dispatcher.on((function(e){e instanceof pn&&u.cancel(e.requestId)})),this._logger=a,this._shouldImportFetchCompat=o}return e.prototype._createHeader=function(e,t){var n=this._sdkState,r=n.appId,i=n.appVersion,a=n.sendbirdRuntimeEnvironment,s=je(je({},e.headers),{SendBird:"JS,".concat($e.OS_VERSION,",").concat($e.SDK_VERSION,",").concat(r).concat(i?",".concat(i):""),"SB-User-Agent":Mn.userAgentWithExtension(this._sdkState.extensions),"Request-Sent-Timestamp":Date.now().toString(),"SB-SDK-User-Agent":Mn.sendbirdSdkUserAgentWithExtension(a)});return t||(s["Content-Type"]="application/json; charset=utf-8"),e.requireAuth&&this._session.hasSession&&(s["Session-Key"]=this._session.sessionKey),this._session&&this._session.authToken&&(s["App-Id"]=r,s["Access-Token"]=this._session.authToken),s},e.prototype._statLogApiResult=function(e,t,n){this._dispatcher.dispatch(new Cn(new Nn({type:dn.API_RESULT,data:{endpoint:e.path,method:e.method,success:!n,latency:Date.now()-t,error_code:null==n?void 0:n.code,error_description:null==n?void 0:n.message}})))},e.prototype.send=function(e){return Qe(this,void 0,void 0,(function(){var t,r,i,a,s,o,u,l,c,d,h,f,p,_,v,m;return Ke(this,(function(g){switch(g.label){case 0:t=e.path,r=e.method,i=![Gt.GET,Gt.DELETE].includes(r),a=this._sdkState.api,s="".concat(a.host).concat(t).concat(i?"":e.query),o=i?e.payload:null,u=this._createHeader(e,o instanceof FormData?o:void 0),l=new AbortController,c=l.signal,this._abortControl.set(e.requestId,l),d=Date.now(),g.label=1;case 1:return g.trys.push([1,8,,9]),this._shouldImportFetchCompat&&(this._shouldImportFetchCompat=!1,("undefined"!=typeof globalThis&&globalThis||"undefined"!=typeof self&&self||"undefined"!=typeof global&&global||{fetch:null}).fetch=null),"undefined"!=typeof AbortController?[3,3]:[4,n.e(539).then(n.bind(n,539))];case 2:g.sent(),g.label=3;case 3:return"function"==typeof fetch?[3,5]:[4,n.e(932).then(n.bind(n,932))];case 4:g.sent(),g.label=5;case 5:return[4,fetch(s,{method:r,body:o,headers:u,signal:c})];case 6:return[4,(h=g.sent()).json()];case 7:if(f=g.sent(),h.ok||h.redirected)return this._logger.debug("receive api response",e.requestId),this._statLogApiResult(e,d),[2,new fn(this._iid,f)];if(f){if((_=new st(f)).isSessionExpiredError){if(this._dispatcher.dispatch(new _n({reason:_.code})),!(e instanceof gn))return p=new Un,this._dispatcher.dispatch(new wn({request:e,deferred:p,error:_})),[2,p.promise];throw _}throw _.isSessionInvalidatedError?(this._dispatcher.dispatch(new _n({reason:_.code})),_):_}throw _=st.requestFailed;case 8:throw v=g.sent(),this._statLogApiResult(e,d,v),v instanceof st?(this._logger.debug("fail api request",v),v):"AbortError"===(null==v?void 0:v.name)?st.requestCanceled:(m=st.networkError,this._logger.debug("fail api request",m),m);case 9:return[2]}}))}))},e.prototype.cancel=function(e){this._abortControl.has(e)&&(this._abortControl.get(e).abort(),this._abortControl.delete(e))},e.prototype.cancelAll=function(){var e,t;try{for(var n=We(this._abortControl.values()),r=n.next();!r.done;r=n.next())r.value.abort()}catch(t){e={error:t}}finally{try{r&&!r.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}this._abortControl.clear()},e}(),Dn=function(){};function Ln(e){let t=e.length;for(;--t>=0;)e[t]=0}const Rn=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),xn=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),Pn=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),Fn=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),zn=new Array(576);Ln(zn);const Hn=new Array(60);Ln(Hn);const qn=new Array(512);Ln(qn);const Vn=new Array(256);Ln(Vn);const Gn=new Array(29);Ln(Gn);const Bn=new Array(30);function jn(e,t,n,r,i){this.static_tree=e,this.extra_bits=t,this.extra_base=n,this.elems=r,this.max_length=i,this.has_stree=e&&e.length}let Qn,Kn,Wn;function Yn(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}Ln(Bn);const Zn=e=>e<256?qn[e]:qn[256+(e>>>7)],Jn=(e,t)=>{e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255},Xn=(e,t,n)=>{e.bi_valid>16-n?(e.bi_buf|=t<<e.bi_valid&65535,Jn(e,e.bi_buf),e.bi_buf=t>>16-e.bi_valid,e.bi_valid+=n-16):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=n)},$n=(e,t,n)=>{Xn(e,n[2*t],n[2*t+1])},er=(e,t)=>{let n=0;do{n|=1&e,e>>>=1,n<<=1}while(--t>0);return n>>>1},tr=(e,t,n)=>{const r=new Array(16);let i,a,s=0;for(i=1;i<=15;i++)s=s+n[i-1]<<1,r[i]=s;for(a=0;a<=t;a++){let t=e[2*a+1];0!==t&&(e[2*a]=er(r[t]++,t))}},nr=e=>{let t;for(t=0;t<286;t++)e.dyn_ltree[2*t]=0;for(t=0;t<30;t++)e.dyn_dtree[2*t]=0;for(t=0;t<19;t++)e.bl_tree[2*t]=0;e.dyn_ltree[512]=1,e.opt_len=e.static_len=0,e.sym_next=e.matches=0},rr=e=>{e.bi_valid>8?Jn(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0},ir=(e,t,n,r)=>{const i=2*t,a=2*n;return e[i]<e[a]||e[i]===e[a]&&r[t]<=r[n]},ar=(e,t,n)=>{const r=e.heap[n];let i=n<<1;for(;i<=e.heap_len&&(i<e.heap_len&&ir(t,e.heap[i+1],e.heap[i],e.depth)&&i++,!ir(t,r,e.heap[i],e.depth));)e.heap[n]=e.heap[i],n=i,i<<=1;e.heap[n]=r},sr=(e,t,n)=>{let r,i,a,s,o=0;if(0!==e.sym_next)do{r=255&e.pending_buf[e.sym_buf+o++],r+=(255&e.pending_buf[e.sym_buf+o++])<<8,i=e.pending_buf[e.sym_buf+o++],0===r?$n(e,i,t):(a=Vn[i],$n(e,a+256+1,t),s=Rn[a],0!==s&&(i-=Gn[a],Xn(e,i,s)),r--,a=Zn(r),$n(e,a,n),s=xn[a],0!==s&&(r-=Bn[a],Xn(e,r,s)))}while(o<e.sym_next);$n(e,256,t)},or=(e,t)=>{const n=t.dyn_tree,r=t.stat_desc.static_tree,i=t.stat_desc.has_stree,a=t.stat_desc.elems;let s,o,u,l=-1;for(e.heap_len=0,e.heap_max=573,s=0;s<a;s++)0!==n[2*s]?(e.heap[++e.heap_len]=l=s,e.depth[s]=0):n[2*s+1]=0;for(;e.heap_len<2;)u=e.heap[++e.heap_len]=l<2?++l:0,n[2*u]=1,e.depth[u]=0,e.opt_len--,i&&(e.static_len-=r[2*u+1]);for(t.max_code=l,s=e.heap_len>>1;s>=1;s--)ar(e,n,s);u=a;do{s=e.heap[1],e.heap[1]=e.heap[e.heap_len--],ar(e,n,1),o=e.heap[1],e.heap[--e.heap_max]=s,e.heap[--e.heap_max]=o,n[2*u]=n[2*s]+n[2*o],e.depth[u]=(e.depth[s]>=e.depth[o]?e.depth[s]:e.depth[o])+1,n[2*s+1]=n[2*o+1]=u,e.heap[1]=u++,ar(e,n,1)}while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],((e,t)=>{const n=t.dyn_tree,r=t.max_code,i=t.stat_desc.static_tree,a=t.stat_desc.has_stree,s=t.stat_desc.extra_bits,o=t.stat_desc.extra_base,u=t.stat_desc.max_length;let l,c,d,h,f,p,_=0;for(h=0;h<=15;h++)e.bl_count[h]=0;for(n[2*e.heap[e.heap_max]+1]=0,l=e.heap_max+1;l<573;l++)c=e.heap[l],h=n[2*n[2*c+1]+1]+1,h>u&&(h=u,_++),n[2*c+1]=h,c>r||(e.bl_count[h]++,f=0,c>=o&&(f=s[c-o]),p=n[2*c],e.opt_len+=p*(h+f),a&&(e.static_len+=p*(i[2*c+1]+f)));if(0!==_){do{for(h=u-1;0===e.bl_count[h];)h--;e.bl_count[h]--,e.bl_count[h+1]+=2,e.bl_count[u]--,_-=2}while(_>0);for(h=u;0!==h;h--)for(c=e.bl_count[h];0!==c;)d=e.heap[--l],d>r||(n[2*d+1]!==h&&(e.opt_len+=(h-n[2*d+1])*n[2*d],n[2*d+1]=h),c--)}})(e,t),tr(n,l,e.bl_count)},ur=(e,t,n)=>{let r,i,a=-1,s=t[1],o=0,u=7,l=4;for(0===s&&(u=138,l=3),t[2*(n+1)+1]=65535,r=0;r<=n;r++)i=s,s=t[2*(r+1)+1],++o<u&&i===s||(o<l?e.bl_tree[2*i]+=o:0!==i?(i!==a&&e.bl_tree[2*i]++,e.bl_tree[32]++):o<=10?e.bl_tree[34]++:e.bl_tree[36]++,o=0,a=i,0===s?(u=138,l=3):i===s?(u=6,l=3):(u=7,l=4))},lr=(e,t,n)=>{let r,i,a=-1,s=t[1],o=0,u=7,l=4;for(0===s&&(u=138,l=3),r=0;r<=n;r++)if(i=s,s=t[2*(r+1)+1],!(++o<u&&i===s)){if(o<l)do{$n(e,i,e.bl_tree)}while(0!=--o);else 0!==i?(i!==a&&($n(e,i,e.bl_tree),o--),$n(e,16,e.bl_tree),Xn(e,o-3,2)):o<=10?($n(e,17,e.bl_tree),Xn(e,o-3,3)):($n(e,18,e.bl_tree),Xn(e,o-11,7));o=0,a=i,0===s?(u=138,l=3):i===s?(u=6,l=3):(u=7,l=4)}};let cr=!1;const dr=(e,t,n,r)=>{Xn(e,0+(r?1:0),3),rr(e),Jn(e,n),Jn(e,~n),n&&e.pending_buf.set(e.window.subarray(t,t+n),e.pending),e.pending+=n};var hr={_tr_init:e=>{cr||((()=>{let e,t,n,r,i;const a=new Array(16);for(n=0,r=0;r<28;r++)for(Gn[r]=n,e=0;e<1<<Rn[r];e++)Vn[n++]=r;for(Vn[n-1]=r,i=0,r=0;r<16;r++)for(Bn[r]=i,e=0;e<1<<xn[r];e++)qn[i++]=r;for(i>>=7;r<30;r++)for(Bn[r]=i<<7,e=0;e<1<<xn[r]-7;e++)qn[256+i++]=r;for(t=0;t<=15;t++)a[t]=0;for(e=0;e<=143;)zn[2*e+1]=8,e++,a[8]++;for(;e<=255;)zn[2*e+1]=9,e++,a[9]++;for(;e<=279;)zn[2*e+1]=7,e++,a[7]++;for(;e<=287;)zn[2*e+1]=8,e++,a[8]++;for(tr(zn,287,a),e=0;e<30;e++)Hn[2*e+1]=5,Hn[2*e]=er(e,5);Qn=new jn(zn,Rn,257,286,15),Kn=new jn(Hn,xn,0,30,15),Wn=new jn(new Array(0),Pn,0,19,7)})(),cr=!0),e.l_desc=new Yn(e.dyn_ltree,Qn),e.d_desc=new Yn(e.dyn_dtree,Kn),e.bl_desc=new Yn(e.bl_tree,Wn),e.bi_buf=0,e.bi_valid=0,nr(e)},_tr_stored_block:dr,_tr_flush_block:(e,t,n,r)=>{let i,a,s=0;e.level>0?(2===e.strm.data_type&&(e.strm.data_type=(e=>{let t,n=4093624447;for(t=0;t<=31;t++,n>>>=1)if(1&n&&0!==e.dyn_ltree[2*t])return 0;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return 1;for(t=32;t<256;t++)if(0!==e.dyn_ltree[2*t])return 1;return 0})(e)),or(e,e.l_desc),or(e,e.d_desc),s=(e=>{let t;for(ur(e,e.dyn_ltree,e.l_desc.max_code),ur(e,e.dyn_dtree,e.d_desc.max_code),or(e,e.bl_desc),t=18;t>=3&&0===e.bl_tree[2*Fn[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t})(e),i=e.opt_len+3+7>>>3,a=e.static_len+3+7>>>3,a<=i&&(i=a)):i=a=n+5,n+4<=i&&-1!==t?dr(e,t,n,r):4===e.strategy||a===i?(Xn(e,2+(r?1:0),3),sr(e,zn,Hn)):(Xn(e,4+(r?1:0),3),((e,t,n,r)=>{let i;for(Xn(e,t-257,5),Xn(e,n-1,5),Xn(e,r-4,4),i=0;i<r;i++)Xn(e,e.bl_tree[2*Fn[i]+1],3);lr(e,e.dyn_ltree,t-1),lr(e,e.dyn_dtree,n-1)})(e,e.l_desc.max_code+1,e.d_desc.max_code+1,s+1),sr(e,e.dyn_ltree,e.dyn_dtree)),nr(e),r&&rr(e)},_tr_tally:(e,t,n)=>(e.pending_buf[e.sym_buf+e.sym_next++]=t,e.pending_buf[e.sym_buf+e.sym_next++]=t>>8,e.pending_buf[e.sym_buf+e.sym_next++]=n,0===t?e.dyn_ltree[2*n]++:(e.matches++,t--,e.dyn_ltree[2*(Vn[n]+256+1)]++,e.dyn_dtree[2*Zn(t)]++),e.sym_next===e.sym_end),_tr_align:e=>{Xn(e,2,3),$n(e,256,zn),(e=>{16===e.bi_valid?(Jn(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)})(e)}},fr=(e,t,n,r)=>{let i=65535&e|0,a=e>>>16&65535|0,s=0;for(;0!==n;){s=n>2e3?2e3:n,n-=s;do{i=i+t[r++]|0,a=a+i|0}while(--s);i%=65521,a%=65521}return i|a<<16|0};const pr=new Uint32Array((()=>{let e,t=[];for(var n=0;n<256;n++){e=n;for(var r=0;r<8;r++)e=1&e?3988292384^e>>>1:e>>>1;t[n]=e}return t})());var _r=(e,t,n,r)=>{const i=pr,a=r+n;e^=-1;for(let s=r;s<a;s++)e=e>>>8^i[255&(e^t[s])];return-1^e},vr={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},mr={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:gr,_tr_stored_block:yr,_tr_flush_block:Er,_tr_tally:br,_tr_align:Cr}=hr,{Z_NO_FLUSH:wr,Z_PARTIAL_FLUSH:Sr,Z_FULL_FLUSH:Tr,Z_FINISH:Ir,Z_BLOCK:Nr,Z_OK:Ar,Z_STREAM_END:kr,Z_STREAM_ERROR:Mr,Z_DATA_ERROR:Ur,Z_BUF_ERROR:Or,Z_DEFAULT_COMPRESSION:Dr,Z_FILTERED:Lr,Z_HUFFMAN_ONLY:Rr,Z_RLE:xr,Z_FIXED:Pr,Z_DEFAULT_STRATEGY:Fr,Z_UNKNOWN:zr,Z_DEFLATED:Hr}=mr,qr=258,Vr=262,Gr=42,Br=113,jr=666,Qr=(e,t)=>(e.msg=vr[t],t),Kr=e=>2*e-(e>4?9:0),Wr=e=>{let t=e.length;for(;--t>=0;)e[t]=0},Yr=e=>{let t,n,r,i=e.w_size;t=e.hash_size,r=t;do{n=e.head[--r],e.head[r]=n>=i?n-i:0}while(--t);t=i,r=t;do{n=e.prev[--r],e.prev[r]=n>=i?n-i:0}while(--t)};let Zr=(e,t,n)=>(t<<e.hash_shift^n)&e.hash_mask;const Jr=e=>{const t=e.state;let n=t.pending;n>e.avail_out&&(n=e.avail_out),0!==n&&(e.output.set(t.pending_buf.subarray(t.pending_out,t.pending_out+n),e.next_out),e.next_out+=n,t.pending_out+=n,e.total_out+=n,e.avail_out-=n,t.pending-=n,0===t.pending&&(t.pending_out=0))},Xr=(e,t)=>{Er(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,Jr(e.strm)},$r=(e,t)=>{e.pending_buf[e.pending++]=t},ei=(e,t)=>{e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t},ti=(e,t,n,r)=>{let i=e.avail_in;return i>r&&(i=r),0===i?0:(e.avail_in-=i,t.set(e.input.subarray(e.next_in,e.next_in+i),n),1===e.state.wrap?e.adler=fr(e.adler,t,i,n):2===e.state.wrap&&(e.adler=_r(e.adler,t,i,n)),e.next_in+=i,e.total_in+=i,i)},ni=(e,t)=>{let n,r,i=e.max_chain_length,a=e.strstart,s=e.prev_length,o=e.nice_match;const u=e.strstart>e.w_size-Vr?e.strstart-(e.w_size-Vr):0,l=e.window,c=e.w_mask,d=e.prev,h=e.strstart+qr;let f=l[a+s-1],p=l[a+s];e.prev_length>=e.good_match&&(i>>=2),o>e.lookahead&&(o=e.lookahead);do{if(n=t,l[n+s]===p&&l[n+s-1]===f&&l[n]===l[a]&&l[++n]===l[a+1]){a+=2,n++;do{}while(l[++a]===l[++n]&&l[++a]===l[++n]&&l[++a]===l[++n]&&l[++a]===l[++n]&&l[++a]===l[++n]&&l[++a]===l[++n]&&l[++a]===l[++n]&&l[++a]===l[++n]&&a<h);if(r=qr-(h-a),a=h-qr,r>s){if(e.match_start=t,s=r,r>=o)break;f=l[a+s-1],p=l[a+s]}}}while((t=d[t&c])>u&&0!=--i);return s<=e.lookahead?s:e.lookahead},ri=e=>{const t=e.w_size;let n,r,i;do{if(r=e.window_size-e.lookahead-e.strstart,e.strstart>=t+(t-Vr)&&(e.window.set(e.window.subarray(t,t+t-r),0),e.match_start-=t,e.strstart-=t,e.block_start-=t,e.insert>e.strstart&&(e.insert=e.strstart),Yr(e),r+=t),0===e.strm.avail_in)break;if(n=ti(e.strm,e.window,e.strstart+e.lookahead,r),e.lookahead+=n,e.lookahead+e.insert>=3)for(i=e.strstart-e.insert,e.ins_h=e.window[i],e.ins_h=Zr(e,e.ins_h,e.window[i+1]);e.insert&&(e.ins_h=Zr(e,e.ins_h,e.window[i+3-1]),e.prev[i&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=i,i++,e.insert--,!(e.lookahead+e.insert<3)););}while(e.lookahead<Vr&&0!==e.strm.avail_in)},ii=(e,t)=>{let n,r,i,a=e.pending_buf_size-5>e.w_size?e.w_size:e.pending_buf_size-5,s=0,o=e.strm.avail_in;do{if(n=65535,i=e.bi_valid+42>>3,e.strm.avail_out<i)break;if(i=e.strm.avail_out-i,r=e.strstart-e.block_start,n>r+e.strm.avail_in&&(n=r+e.strm.avail_in),n>i&&(n=i),n<a&&(0===n&&t!==Ir||t===wr||n!==r+e.strm.avail_in))break;s=t===Ir&&n===r+e.strm.avail_in?1:0,yr(e,0,0,s),e.pending_buf[e.pending-4]=n,e.pending_buf[e.pending-3]=n>>8,e.pending_buf[e.pending-2]=~n,e.pending_buf[e.pending-1]=~n>>8,Jr(e.strm),r&&(r>n&&(r=n),e.strm.output.set(e.window.subarray(e.block_start,e.block_start+r),e.strm.next_out),e.strm.next_out+=r,e.strm.avail_out-=r,e.strm.total_out+=r,e.block_start+=r,n-=r),n&&(ti(e.strm,e.strm.output,e.strm.next_out,n),e.strm.next_out+=n,e.strm.avail_out-=n,e.strm.total_out+=n)}while(0===s);return o-=e.strm.avail_in,o&&(o>=e.w_size?(e.matches=2,e.window.set(e.strm.input.subarray(e.strm.next_in-e.w_size,e.strm.next_in),0),e.strstart=e.w_size,e.insert=e.strstart):(e.window_size-e.strstart<=o&&(e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,e.insert>e.strstart&&(e.insert=e.strstart)),e.window.set(e.strm.input.subarray(e.strm.next_in-o,e.strm.next_in),e.strstart),e.strstart+=o,e.insert+=o>e.w_size-e.insert?e.w_size-e.insert:o),e.block_start=e.strstart),e.high_water<e.strstart&&(e.high_water=e.strstart),s?4:t!==wr&&t!==Ir&&0===e.strm.avail_in&&e.strstart===e.block_start?2:(i=e.window_size-e.strstart,e.strm.avail_in>i&&e.block_start>=e.w_size&&(e.block_start-=e.w_size,e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,i+=e.w_size,e.insert>e.strstart&&(e.insert=e.strstart)),i>e.strm.avail_in&&(i=e.strm.avail_in),i&&(ti(e.strm,e.window,e.strstart,i),e.strstart+=i,e.insert+=i>e.w_size-e.insert?e.w_size-e.insert:i),e.high_water<e.strstart&&(e.high_water=e.strstart),i=e.bi_valid+42>>3,i=e.pending_buf_size-i>65535?65535:e.pending_buf_size-i,a=i>e.w_size?e.w_size:i,r=e.strstart-e.block_start,(r>=a||(r||t===Ir)&&t!==wr&&0===e.strm.avail_in&&r<=i)&&(n=r>i?i:r,s=t===Ir&&0===e.strm.avail_in&&n===r?1:0,yr(e,e.block_start,n,s),e.block_start+=n,Jr(e.strm)),s?3:1)},ai=(e,t)=>{let n,r;for(;;){if(e.lookahead<Vr){if(ri(e),e.lookahead<Vr&&t===wr)return 1;if(0===e.lookahead)break}if(n=0,e.lookahead>=3&&(e.ins_h=Zr(e,e.ins_h,e.window[e.strstart+3-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==n&&e.strstart-n<=e.w_size-Vr&&(e.match_length=ni(e,n)),e.match_length>=3)if(r=br(e,e.strstart-e.match_start,e.match_length-3),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=3){e.match_length--;do{e.strstart++,e.ins_h=Zr(e,e.ins_h,e.window[e.strstart+3-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart}while(0!=--e.match_length);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=Zr(e,e.ins_h,e.window[e.strstart+1]);else r=br(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(r&&(Xr(e,!1),0===e.strm.avail_out))return 1}return e.insert=e.strstart<2?e.strstart:2,t===Ir?(Xr(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(Xr(e,!1),0===e.strm.avail_out)?1:2},si=(e,t)=>{let n,r,i;for(;;){if(e.lookahead<Vr){if(ri(e),e.lookahead<Vr&&t===wr)return 1;if(0===e.lookahead)break}if(n=0,e.lookahead>=3&&(e.ins_h=Zr(e,e.ins_h,e.window[e.strstart+3-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=2,0!==n&&e.prev_length<e.max_lazy_match&&e.strstart-n<=e.w_size-Vr&&(e.match_length=ni(e,n),e.match_length<=5&&(e.strategy===Lr||3===e.match_length&&e.strstart-e.match_start>4096)&&(e.match_length=2)),e.prev_length>=3&&e.match_length<=e.prev_length){i=e.strstart+e.lookahead-3,r=br(e,e.strstart-1-e.prev_match,e.prev_length-3),e.lookahead-=e.prev_length-1,e.prev_length-=2;do{++e.strstart<=i&&(e.ins_h=Zr(e,e.ins_h,e.window[e.strstart+3-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart)}while(0!=--e.prev_length);if(e.match_available=0,e.match_length=2,e.strstart++,r&&(Xr(e,!1),0===e.strm.avail_out))return 1}else if(e.match_available){if(r=br(e,0,e.window[e.strstart-1]),r&&Xr(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return 1}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(r=br(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<2?e.strstart:2,t===Ir?(Xr(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(Xr(e,!1),0===e.strm.avail_out)?1:2};function oi(e,t,n,r,i){this.good_length=e,this.max_lazy=t,this.nice_length=n,this.max_chain=r,this.func=i}const ui=[new oi(0,0,0,0,ii),new oi(4,4,8,4,ai),new oi(4,5,16,8,ai),new oi(4,6,32,32,ai),new oi(4,4,16,16,si),new oi(8,16,32,32,si),new oi(8,16,128,128,si),new oi(8,32,128,256,si),new oi(32,128,258,1024,si),new oi(32,258,258,4096,si)];function li(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=Hr,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(1146),this.dyn_dtree=new Uint16Array(122),this.bl_tree=new Uint16Array(78),Wr(this.dyn_ltree),Wr(this.dyn_dtree),Wr(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(16),this.heap=new Uint16Array(573),Wr(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(573),Wr(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const ci=e=>{if(!e)return 1;const t=e.state;return!t||t.strm!==e||t.status!==Gr&&57!==t.status&&69!==t.status&&73!==t.status&&91!==t.status&&103!==t.status&&t.status!==Br&&t.status!==jr?1:0},di=e=>{if(ci(e))return Qr(e,Mr);e.total_in=e.total_out=0,e.data_type=zr;const t=e.state;return t.pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=2===t.wrap?57:t.wrap?Gr:Br,e.adler=2===t.wrap?0:1,t.last_flush=-2,gr(t),Ar},hi=e=>{const t=di(e);var n;return t===Ar&&((n=e.state).window_size=2*n.w_size,Wr(n.head),n.max_lazy_match=ui[n.level].max_lazy,n.good_match=ui[n.level].good_length,n.nice_match=ui[n.level].nice_length,n.max_chain_length=ui[n.level].max_chain,n.strstart=0,n.block_start=0,n.lookahead=0,n.insert=0,n.match_length=n.prev_length=2,n.match_available=0,n.ins_h=0),t},fi=(e,t,n,r,i,a)=>{if(!e)return Mr;let s=1;if(t===Dr&&(t=6),r<0?(s=0,r=-r):r>15&&(s=2,r-=16),i<1||i>9||n!==Hr||r<8||r>15||t<0||t>9||a<0||a>Pr||8===r&&1!==s)return Qr(e,Mr);8===r&&(r=9);const o=new li;return e.state=o,o.strm=e,o.status=Gr,o.wrap=s,o.gzhead=null,o.w_bits=r,o.w_size=1<<o.w_bits,o.w_mask=o.w_size-1,o.hash_bits=i+7,o.hash_size=1<<o.hash_bits,o.hash_mask=o.hash_size-1,o.hash_shift=~~((o.hash_bits+3-1)/3),o.window=new Uint8Array(2*o.w_size),o.head=new Uint16Array(o.hash_size),o.prev=new Uint16Array(o.w_size),o.lit_bufsize=1<<i+6,o.pending_buf_size=4*o.lit_bufsize,o.pending_buf=new Uint8Array(o.pending_buf_size),o.sym_buf=o.lit_bufsize,o.sym_end=3*(o.lit_bufsize-1),o.level=t,o.strategy=a,o.method=n,hi(e)};var pi={deflateInit:(e,t)=>fi(e,t,Hr,15,8,Fr),deflateInit2:fi,deflateReset:hi,deflateResetKeep:di,deflateSetHeader:(e,t)=>ci(e)||2!==e.state.wrap?Mr:(e.state.gzhead=t,Ar),deflate:(e,t)=>{if(ci(e)||t>Nr||t<0)return e?Qr(e,Mr):Mr;const n=e.state;if(!e.output||0!==e.avail_in&&!e.input||n.status===jr&&t!==Ir)return Qr(e,0===e.avail_out?Or:Mr);const r=n.last_flush;if(n.last_flush=t,0!==n.pending){if(Jr(e),0===e.avail_out)return n.last_flush=-1,Ar}else if(0===e.avail_in&&Kr(t)<=Kr(r)&&t!==Ir)return Qr(e,Or);if(n.status===jr&&0!==e.avail_in)return Qr(e,Or);if(n.status===Gr&&0===n.wrap&&(n.status=Br),n.status===Gr){let t=Hr+(n.w_bits-8<<4)<<8,r=-1;if(r=n.strategy>=Rr||n.level<2?0:n.level<6?1:6===n.level?2:3,t|=r<<6,0!==n.strstart&&(t|=32),t+=31-t%31,ei(n,t),0!==n.strstart&&(ei(n,e.adler>>>16),ei(n,65535&e.adler)),e.adler=1,n.status=Br,Jr(e),0!==n.pending)return n.last_flush=-1,Ar}if(57===n.status)if(e.adler=0,$r(n,31),$r(n,139),$r(n,8),n.gzhead)$r(n,(n.gzhead.text?1:0)+(n.gzhead.hcrc?2:0)+(n.gzhead.extra?4:0)+(n.gzhead.name?8:0)+(n.gzhead.comment?16:0)),$r(n,255&n.gzhead.time),$r(n,n.gzhead.time>>8&255),$r(n,n.gzhead.time>>16&255),$r(n,n.gzhead.time>>24&255),$r(n,9===n.level?2:n.strategy>=Rr||n.level<2?4:0),$r(n,255&n.gzhead.os),n.gzhead.extra&&n.gzhead.extra.length&&($r(n,255&n.gzhead.extra.length),$r(n,n.gzhead.extra.length>>8&255)),n.gzhead.hcrc&&(e.adler=_r(e.adler,n.pending_buf,n.pending,0)),n.gzindex=0,n.status=69;else if($r(n,0),$r(n,0),$r(n,0),$r(n,0),$r(n,0),$r(n,9===n.level?2:n.strategy>=Rr||n.level<2?4:0),$r(n,3),n.status=Br,Jr(e),0!==n.pending)return n.last_flush=-1,Ar;if(69===n.status){if(n.gzhead.extra){let t=n.pending,r=(65535&n.gzhead.extra.length)-n.gzindex;for(;n.pending+r>n.pending_buf_size;){let i=n.pending_buf_size-n.pending;if(n.pending_buf.set(n.gzhead.extra.subarray(n.gzindex,n.gzindex+i),n.pending),n.pending=n.pending_buf_size,n.gzhead.hcrc&&n.pending>t&&(e.adler=_r(e.adler,n.pending_buf,n.pending-t,t)),n.gzindex+=i,Jr(e),0!==n.pending)return n.last_flush=-1,Ar;t=0,r-=i}let i=new Uint8Array(n.gzhead.extra);n.pending_buf.set(i.subarray(n.gzindex,n.gzindex+r),n.pending),n.pending+=r,n.gzhead.hcrc&&n.pending>t&&(e.adler=_r(e.adler,n.pending_buf,n.pending-t,t)),n.gzindex=0}n.status=73}if(73===n.status){if(n.gzhead.name){let t,r=n.pending;do{if(n.pending===n.pending_buf_size){if(n.gzhead.hcrc&&n.pending>r&&(e.adler=_r(e.adler,n.pending_buf,n.pending-r,r)),Jr(e),0!==n.pending)return n.last_flush=-1,Ar;r=0}t=n.gzindex<n.gzhead.name.length?255&n.gzhead.name.charCodeAt(n.gzindex++):0,$r(n,t)}while(0!==t);n.gzhead.hcrc&&n.pending>r&&(e.adler=_r(e.adler,n.pending_buf,n.pending-r,r)),n.gzindex=0}n.status=91}if(91===n.status){if(n.gzhead.comment){let t,r=n.pending;do{if(n.pending===n.pending_buf_size){if(n.gzhead.hcrc&&n.pending>r&&(e.adler=_r(e.adler,n.pending_buf,n.pending-r,r)),Jr(e),0!==n.pending)return n.last_flush=-1,Ar;r=0}t=n.gzindex<n.gzhead.comment.length?255&n.gzhead.comment.charCodeAt(n.gzindex++):0,$r(n,t)}while(0!==t);n.gzhead.hcrc&&n.pending>r&&(e.adler=_r(e.adler,n.pending_buf,n.pending-r,r))}n.status=103}if(103===n.status){if(n.gzhead.hcrc){if(n.pending+2>n.pending_buf_size&&(Jr(e),0!==n.pending))return n.last_flush=-1,Ar;$r(n,255&e.adler),$r(n,e.adler>>8&255),e.adler=0}if(n.status=Br,Jr(e),0!==n.pending)return n.last_flush=-1,Ar}if(0!==e.avail_in||0!==n.lookahead||t!==wr&&n.status!==jr){let r=0===n.level?ii(n,t):n.strategy===Rr?((e,t)=>{let n;for(;;){if(0===e.lookahead&&(ri(e),0===e.lookahead)){if(t===wr)return 1;break}if(e.match_length=0,n=br(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,n&&(Xr(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,t===Ir?(Xr(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(Xr(e,!1),0===e.strm.avail_out)?1:2})(n,t):n.strategy===xr?((e,t)=>{let n,r,i,a;const s=e.window;for(;;){if(e.lookahead<=qr){if(ri(e),e.lookahead<=qr&&t===wr)return 1;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=3&&e.strstart>0&&(i=e.strstart-1,r=s[i],r===s[++i]&&r===s[++i]&&r===s[++i])){a=e.strstart+qr;do{}while(r===s[++i]&&r===s[++i]&&r===s[++i]&&r===s[++i]&&r===s[++i]&&r===s[++i]&&r===s[++i]&&r===s[++i]&&i<a);e.match_length=qr-(a-i),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=3?(n=br(e,1,e.match_length-3),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(n=br(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),n&&(Xr(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,t===Ir?(Xr(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(Xr(e,!1),0===e.strm.avail_out)?1:2})(n,t):ui[n.level].func(n,t);if(3!==r&&4!==r||(n.status=jr),1===r||3===r)return 0===e.avail_out&&(n.last_flush=-1),Ar;if(2===r&&(t===Sr?Cr(n):t!==Nr&&(yr(n,0,0,!1),t===Tr&&(Wr(n.head),0===n.lookahead&&(n.strstart=0,n.block_start=0,n.insert=0))),Jr(e),0===e.avail_out))return n.last_flush=-1,Ar}return t!==Ir?Ar:n.wrap<=0?kr:(2===n.wrap?($r(n,255&e.adler),$r(n,e.adler>>8&255),$r(n,e.adler>>16&255),$r(n,e.adler>>24&255),$r(n,255&e.total_in),$r(n,e.total_in>>8&255),$r(n,e.total_in>>16&255),$r(n,e.total_in>>24&255)):(ei(n,e.adler>>>16),ei(n,65535&e.adler)),Jr(e),n.wrap>0&&(n.wrap=-n.wrap),0!==n.pending?Ar:kr)},deflateEnd:e=>{if(ci(e))return Mr;const t=e.state.status;return e.state=null,t===Br?Qr(e,Ur):Ar},deflateSetDictionary:(e,t)=>{let n=t.length;if(ci(e))return Mr;const r=e.state,i=r.wrap;if(2===i||1===i&&r.status!==Gr||r.lookahead)return Mr;if(1===i&&(e.adler=fr(e.adler,t,n,0)),r.wrap=0,n>=r.w_size){0===i&&(Wr(r.head),r.strstart=0,r.block_start=0,r.insert=0);let e=new Uint8Array(r.w_size);e.set(t.subarray(n-r.w_size,n),0),t=e,n=r.w_size}const a=e.avail_in,s=e.next_in,o=e.input;for(e.avail_in=n,e.next_in=0,e.input=t,ri(r);r.lookahead>=3;){let e=r.strstart,t=r.lookahead-2;do{r.ins_h=Zr(r,r.ins_h,r.window[e+3-1]),r.prev[e&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=e,e++}while(--t);r.strstart=e,r.lookahead=2,ri(r)}return r.strstart+=r.lookahead,r.block_start=r.strstart,r.insert=r.lookahead,r.lookahead=0,r.match_length=r.prev_length=2,r.match_available=0,e.next_in=s,e.input=o,e.avail_in=a,r.wrap=i,Ar},deflateInfo:"pako deflate (from Nodeca project)"};const _i=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var vi={assign:function(e){const t=Array.prototype.slice.call(arguments,1);for(;t.length;){const n=t.shift();if(n){if("object"!=typeof n)throw new TypeError(n+"must be non-object");for(const t in n)_i(n,t)&&(e[t]=n[t])}}return e},flattenChunks:e=>{let t=0;for(let r=0,i=e.length;r<i;r++)t+=e[r].length;const n=new Uint8Array(t);for(let r=0,i=0,a=e.length;r<a;r++){let t=e[r];n.set(t,i),i+=t.length}return n}};let mi=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(Ge){mi=!1}const gi=new Uint8Array(256);for(let n=0;n<256;n++)gi[n]=n>=252?6:n>=248?5:n>=240?4:n>=224?3:n>=192?2:1;gi[254]=gi[254]=1;var yi={string2buf:e=>{if("function"==typeof TextEncoder&&TextEncoder.prototype.encode)return(new TextEncoder).encode(e);let t,n,r,i,a,s=e.length,o=0;for(i=0;i<s;i++)n=e.charCodeAt(i),55296==(64512&n)&&i+1<s&&(r=e.charCodeAt(i+1),56320==(64512&r)&&(n=65536+(n-55296<<10)+(r-56320),i++)),o+=n<128?1:n<2048?2:n<65536?3:4;for(t=new Uint8Array(o),a=0,i=0;a<o;i++)n=e.charCodeAt(i),55296==(64512&n)&&i+1<s&&(r=e.charCodeAt(i+1),56320==(64512&r)&&(n=65536+(n-55296<<10)+(r-56320),i++)),n<128?t[a++]=n:n<2048?(t[a++]=192|n>>>6,t[a++]=128|63&n):n<65536?(t[a++]=224|n>>>12,t[a++]=128|n>>>6&63,t[a++]=128|63&n):(t[a++]=240|n>>>18,t[a++]=128|n>>>12&63,t[a++]=128|n>>>6&63,t[a++]=128|63&n);return t},buf2string:(e,t)=>{const n=t||e.length;if("function"==typeof TextDecoder&&TextDecoder.prototype.decode)return(new TextDecoder).decode(e.subarray(0,t));let r,i;const a=new Array(2*n);for(i=0,r=0;r<n;){let t=e[r++];if(t<128){a[i++]=t;continue}let s=gi[t];if(s>4)a[i++]=65533,r+=s-1;else{for(t&=2===s?31:3===s?15:7;s>1&&r<n;)t=t<<6|63&e[r++],s--;s>1?a[i++]=65533:t<65536?a[i++]=t:(t-=65536,a[i++]=55296|t>>10&1023,a[i++]=56320|1023&t)}}return((e,t)=>{if(t<65534&&e.subarray&&mi)return String.fromCharCode.apply(null,e.length===t?e:e.subarray(0,t));let n="";for(let r=0;r<t;r++)n+=String.fromCharCode(e[r]);return n})(a,i)},utf8border:(e,t)=>{(t=t||e.length)>e.length&&(t=e.length);let n=t-1;for(;n>=0&&128==(192&e[n]);)n--;return n<0||0===n?t:n+gi[e[n]]>t?n:t}},Ei=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0};const bi=Object.prototype.toString,{Z_NO_FLUSH:Ci,Z_SYNC_FLUSH:wi,Z_FULL_FLUSH:Si,Z_FINISH:Ti,Z_OK:Ii,Z_STREAM_END:Ni,Z_DEFAULT_COMPRESSION:Ai,Z_DEFAULT_STRATEGY:ki,Z_DEFLATED:Mi}=mr;function Ui(e){this.options=vi.assign({level:Ai,method:Mi,chunkSize:16384,windowBits:15,memLevel:8,strategy:ki},e||{});let t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Ei,this.strm.avail_out=0;let n=pi.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(n!==Ii)throw new Error(vr[n]);if(t.header&&pi.deflateSetHeader(this.strm,t.header),t.dictionary){let e;if(e="string"==typeof t.dictionary?yi.string2buf(t.dictionary):"[object ArrayBuffer]"===bi.call(t.dictionary)?new Uint8Array(t.dictionary):t.dictionary,n=pi.deflateSetDictionary(this.strm,e),n!==Ii)throw new Error(vr[n]);this._dict_set=!0}}function Oi(e,t){const n=new Ui(t);if(n.push(e,!0),n.err)throw n.msg||vr[n.err];return n.result}Ui.prototype.push=function(e,t){const n=this.strm,r=this.options.chunkSize;let i,a;if(this.ended)return!1;for(a=t===~~t?t:!0===t?Ti:Ci,"string"==typeof e?n.input=yi.string2buf(e):"[object ArrayBuffer]"===bi.call(e)?n.input=new Uint8Array(e):n.input=e,n.next_in=0,n.avail_in=n.input.length;;)if(0===n.avail_out&&(n.output=new Uint8Array(r),n.next_out=0,n.avail_out=r),(a===wi||a===Si)&&n.avail_out<=6)this.onData(n.output.subarray(0,n.next_out)),n.avail_out=0;else{if(i=pi.deflate(n,a),i===Ni)return n.next_out>0&&this.onData(n.output.subarray(0,n.next_out)),i=pi.deflateEnd(this.strm),this.onEnd(i),this.ended=!0,i===Ii;if(0!==n.avail_out){if(a>0&&n.next_out>0)this.onData(n.output.subarray(0,n.next_out)),n.avail_out=0;else if(0===n.avail_in)break}else this.onData(n.output)}return!0},Ui.prototype.onData=function(e){this.chunks.push(e)},Ui.prototype.onEnd=function(e){e===Ii&&(this.result=vi.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};var Di={Deflate:Ui,deflate:Oi,deflateRaw:function(e,t){return(t=t||{}).raw=!0,Oi(e,t)},gzip:function(e,t){return(t=t||{}).gzip=!0,Oi(e,t)},constants:mr};const Li=16209;var Ri=function(e,t){let n,r,i,a,s,o,u,l,c,d,h,f,p,_,v,m,g,y,E,b,C,w,S,T;const I=e.state;n=e.next_in,S=e.input,r=n+(e.avail_in-5),i=e.next_out,T=e.output,a=i-(t-e.avail_out),s=i+(e.avail_out-257),o=I.dmax,u=I.wsize,l=I.whave,c=I.wnext,d=I.window,h=I.hold,f=I.bits,p=I.lencode,_=I.distcode,v=(1<<I.lenbits)-1,m=(1<<I.distbits)-1;e:do{f<15&&(h+=S[n++]<<f,f+=8,h+=S[n++]<<f,f+=8),g=p[h&v];t:for(;;){if(y=g>>>24,h>>>=y,f-=y,y=g>>>16&255,0===y)T[i++]=65535&g;else{if(!(16&y)){if(0==(64&y)){g=p[(65535&g)+(h&(1<<y)-1)];continue t}if(32&y){I.mode=16191;break e}e.msg="invalid literal/length code",I.mode=Li;break e}E=65535&g,y&=15,y&&(f<y&&(h+=S[n++]<<f,f+=8),E+=h&(1<<y)-1,h>>>=y,f-=y),f<15&&(h+=S[n++]<<f,f+=8,h+=S[n++]<<f,f+=8),g=_[h&m];n:for(;;){if(y=g>>>24,h>>>=y,f-=y,y=g>>>16&255,!(16&y)){if(0==(64&y)){g=_[(65535&g)+(h&(1<<y)-1)];continue n}e.msg="invalid distance code",I.mode=Li;break e}if(b=65535&g,y&=15,f<y&&(h+=S[n++]<<f,f+=8,f<y&&(h+=S[n++]<<f,f+=8)),b+=h&(1<<y)-1,b>o){e.msg="invalid distance too far back",I.mode=Li;break e}if(h>>>=y,f-=y,y=i-a,b>y){if(y=b-y,y>l&&I.sane){e.msg="invalid distance too far back",I.mode=Li;break e}if(C=0,w=d,0===c){if(C+=u-y,y<E){E-=y;do{T[i++]=d[C++]}while(--y);C=i-b,w=T}}else if(c<y){if(C+=u+c-y,y-=c,y<E){E-=y;do{T[i++]=d[C++]}while(--y);if(C=0,c<E){y=c,E-=y;do{T[i++]=d[C++]}while(--y);C=i-b,w=T}}}else if(C+=c-y,y<E){E-=y;do{T[i++]=d[C++]}while(--y);C=i-b,w=T}for(;E>2;)T[i++]=w[C++],T[i++]=w[C++],T[i++]=w[C++],E-=3;E&&(T[i++]=w[C++],E>1&&(T[i++]=w[C++]))}else{C=i-b;do{T[i++]=T[C++],T[i++]=T[C++],T[i++]=T[C++],E-=3}while(E>2);E&&(T[i++]=T[C++],E>1&&(T[i++]=T[C++]))}break}}break}}while(n<r&&i<s);E=f>>3,n-=E,f-=E<<3,h&=(1<<f)-1,e.next_in=n,e.next_out=i,e.avail_in=n<r?r-n+5:5-(n-r),e.avail_out=i<s?s-i+257:257-(i-s),I.hold=h,I.bits=f};const xi=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),Pi=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),Fi=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),zi=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]);var Hi=(e,t,n,r,i,a,s,o)=>{const u=o.bits;let l,c,d,h,f,p,_=0,v=0,m=0,g=0,y=0,E=0,b=0,C=0,w=0,S=0,T=null;const I=new Uint16Array(16),N=new Uint16Array(16);let A,k,M,U=null;for(_=0;_<=15;_++)I[_]=0;for(v=0;v<r;v++)I[t[n+v]]++;for(y=u,g=15;g>=1&&0===I[g];g--);if(y>g&&(y=g),0===g)return i[a++]=20971520,i[a++]=20971520,o.bits=1,0;for(m=1;m<g&&0===I[m];m++);for(y<m&&(y=m),C=1,_=1;_<=15;_++)if(C<<=1,C-=I[_],C<0)return-1;if(C>0&&(0===e||1!==g))return-1;for(N[1]=0,_=1;_<15;_++)N[_+1]=N[_]+I[_];for(v=0;v<r;v++)0!==t[n+v]&&(s[N[t[n+v]]++]=v);if(0===e?(T=U=s,p=20):1===e?(T=xi,U=Pi,p=257):(T=Fi,U=zi,p=0),S=0,v=0,_=m,f=a,E=y,b=0,d=-1,w=1<<y,h=w-1,1===e&&w>852||2===e&&w>592)return 1;for(;;){A=_-b,s[v]+1<p?(k=0,M=s[v]):s[v]>=p?(k=U[s[v]-p],M=T[s[v]-p]):(k=96,M=0),l=1<<_-b,c=1<<E,m=c;do{c-=l,i[f+(S>>b)+c]=A<<24|k<<16|M|0}while(0!==c);for(l=1<<_-1;S&l;)l>>=1;if(0!==l?(S&=l-1,S+=l):S=0,v++,0==--I[_]){if(_===g)break;_=t[n+s[v]]}if(_>y&&(S&h)!==d){for(0===b&&(b=y),f+=m,E=_-b,C=1<<E;E+b<g&&(C-=I[E+b],!(C<=0));)E++,C<<=1;if(w+=1<<E,1===e&&w>852||2===e&&w>592)return 1;d=S&h,i[d]=y<<24|E<<16|f-a|0}}return 0!==S&&(i[f+S]=_-b<<24|64<<16|0),o.bits=y,0};const{Z_FINISH:qi,Z_BLOCK:Vi,Z_TREES:Gi,Z_OK:Bi,Z_STREAM_END:ji,Z_NEED_DICT:Qi,Z_STREAM_ERROR:Ki,Z_DATA_ERROR:Wi,Z_MEM_ERROR:Yi,Z_BUF_ERROR:Zi,Z_DEFLATED:Ji}=mr,Xi=16180,$i=16190,ea=16191,ta=16192,na=16194,ra=16199,ia=16200,aa=16206,sa=16209,oa=e=>(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24);function ua(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const la=e=>{if(!e)return 1;const t=e.state;return!t||t.strm!==e||t.mode<Xi||t.mode>16211?1:0},ca=e=>{if(la(e))return Ki;const t=e.state;return e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=Xi,t.last=0,t.havedict=0,t.flags=-1,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(852),t.distcode=t.distdyn=new Int32Array(592),t.sane=1,t.back=-1,Bi},da=e=>{if(la(e))return Ki;const t=e.state;return t.wsize=0,t.whave=0,t.wnext=0,ca(e)},ha=(e,t)=>{let n;if(la(e))return Ki;const r=e.state;return t<0?(n=0,t=-t):(n=5+(t>>4),t<48&&(t&=15)),t&&(t<8||t>15)?Ki:(null!==r.window&&r.wbits!==t&&(r.window=null),r.wrap=n,r.wbits=t,da(e))},fa=(e,t)=>{if(!e)return Ki;const n=new ua;e.state=n,n.strm=e,n.window=null,n.mode=Xi;const r=ha(e,t);return r!==Bi&&(e.state=null),r};let pa,_a,va=!0;const ma=e=>{if(va){pa=new Int32Array(512),_a=new Int32Array(32);let t=0;for(;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(Hi(1,e.lens,0,288,pa,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;Hi(2,e.lens,0,32,_a,0,e.work,{bits:5}),va=!1}e.lencode=pa,e.lenbits=9,e.distcode=_a,e.distbits=5},ga=(e,t,n,r)=>{let i;const a=e.state;return null===a.window&&(a.wsize=1<<a.wbits,a.wnext=0,a.whave=0,a.window=new Uint8Array(a.wsize)),r>=a.wsize?(a.window.set(t.subarray(n-a.wsize,n),0),a.wnext=0,a.whave=a.wsize):(i=a.wsize-a.wnext,i>r&&(i=r),a.window.set(t.subarray(n-r,n-r+i),a.wnext),(r-=i)?(a.window.set(t.subarray(n-r,n),0),a.wnext=r,a.whave=a.wsize):(a.wnext+=i,a.wnext===a.wsize&&(a.wnext=0),a.whave<a.wsize&&(a.whave+=i))),0};var ya={inflateReset:da,inflateReset2:ha,inflateResetKeep:ca,inflateInit:e=>fa(e,15),inflateInit2:fa,inflate:(e,t)=>{let n,r,i,a,s,o,u,l,c,d,h,f,p,_,v,m,g,y,E,b,C,w,S=0;const T=new Uint8Array(4);let I,N;const A=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(la(e)||!e.output||!e.input&&0!==e.avail_in)return Ki;n=e.state,n.mode===ea&&(n.mode=ta),s=e.next_out,i=e.output,u=e.avail_out,a=e.next_in,r=e.input,o=e.avail_in,l=n.hold,c=n.bits,d=o,h=u,w=Bi;e:for(;;)switch(n.mode){case Xi:if(0===n.wrap){n.mode=ta;break}for(;c<16;){if(0===o)break e;o--,l+=r[a++]<<c,c+=8}if(2&n.wrap&&35615===l){0===n.wbits&&(n.wbits=15),n.check=0,T[0]=255&l,T[1]=l>>>8&255,n.check=_r(n.check,T,2,0),l=0,c=0,n.mode=16181;break}if(n.head&&(n.head.done=!1),!(1&n.wrap)||(((255&l)<<8)+(l>>8))%31){e.msg="incorrect header check",n.mode=sa;break}if((15&l)!==Ji){e.msg="unknown compression method",n.mode=sa;break}if(l>>>=4,c-=4,C=8+(15&l),0===n.wbits&&(n.wbits=C),C>15||C>n.wbits){e.msg="invalid window size",n.mode=sa;break}n.dmax=1<<n.wbits,n.flags=0,e.adler=n.check=1,n.mode=512&l?16189:ea,l=0,c=0;break;case 16181:for(;c<16;){if(0===o)break e;o--,l+=r[a++]<<c,c+=8}if(n.flags=l,(255&n.flags)!==Ji){e.msg="unknown compression method",n.mode=sa;break}if(57344&n.flags){e.msg="unknown header flags set",n.mode=sa;break}n.head&&(n.head.text=l>>8&1),512&n.flags&&4&n.wrap&&(T[0]=255&l,T[1]=l>>>8&255,n.check=_r(n.check,T,2,0)),l=0,c=0,n.mode=16182;case 16182:for(;c<32;){if(0===o)break e;o--,l+=r[a++]<<c,c+=8}n.head&&(n.head.time=l),512&n.flags&&4&n.wrap&&(T[0]=255&l,T[1]=l>>>8&255,T[2]=l>>>16&255,T[3]=l>>>24&255,n.check=_r(n.check,T,4,0)),l=0,c=0,n.mode=16183;case 16183:for(;c<16;){if(0===o)break e;o--,l+=r[a++]<<c,c+=8}n.head&&(n.head.xflags=255&l,n.head.os=l>>8),512&n.flags&&4&n.wrap&&(T[0]=255&l,T[1]=l>>>8&255,n.check=_r(n.check,T,2,0)),l=0,c=0,n.mode=16184;case 16184:if(1024&n.flags){for(;c<16;){if(0===o)break e;o--,l+=r[a++]<<c,c+=8}n.length=l,n.head&&(n.head.extra_len=l),512&n.flags&&4&n.wrap&&(T[0]=255&l,T[1]=l>>>8&255,n.check=_r(n.check,T,2,0)),l=0,c=0}else n.head&&(n.head.extra=null);n.mode=16185;case 16185:if(1024&n.flags&&(f=n.length,f>o&&(f=o),f&&(n.head&&(C=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Uint8Array(n.head.extra_len)),n.head.extra.set(r.subarray(a,a+f),C)),512&n.flags&&4&n.wrap&&(n.check=_r(n.check,r,f,a)),o-=f,a+=f,n.length-=f),n.length))break e;n.length=0,n.mode=16186;case 16186:if(2048&n.flags){if(0===o)break e;f=0;do{C=r[a+f++],n.head&&C&&n.length<65536&&(n.head.name+=String.fromCharCode(C))}while(C&&f<o);if(512&n.flags&&4&n.wrap&&(n.check=_r(n.check,r,f,a)),o-=f,a+=f,C)break e}else n.head&&(n.head.name=null);n.length=0,n.mode=16187;case 16187:if(4096&n.flags){if(0===o)break e;f=0;do{C=r[a+f++],n.head&&C&&n.length<65536&&(n.head.comment+=String.fromCharCode(C))}while(C&&f<o);if(512&n.flags&&4&n.wrap&&(n.check=_r(n.check,r,f,a)),o-=f,a+=f,C)break e}else n.head&&(n.head.comment=null);n.mode=16188;case 16188:if(512&n.flags){for(;c<16;){if(0===o)break e;o--,l+=r[a++]<<c,c+=8}if(4&n.wrap&&l!==(65535&n.check)){e.msg="header crc mismatch",n.mode=sa;break}l=0,c=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),e.adler=n.check=0,n.mode=ea;break;case 16189:for(;c<32;){if(0===o)break e;o--,l+=r[a++]<<c,c+=8}e.adler=n.check=oa(l),l=0,c=0,n.mode=$i;case $i:if(0===n.havedict)return e.next_out=s,e.avail_out=u,e.next_in=a,e.avail_in=o,n.hold=l,n.bits=c,Qi;e.adler=n.check=1,n.mode=ea;case ea:if(t===Vi||t===Gi)break e;case ta:if(n.last){l>>>=7&c,c-=7&c,n.mode=aa;break}for(;c<3;){if(0===o)break e;o--,l+=r[a++]<<c,c+=8}switch(n.last=1&l,l>>>=1,c-=1,3&l){case 0:n.mode=16193;break;case 1:if(ma(n),n.mode=ra,t===Gi){l>>>=2,c-=2;break e}break;case 2:n.mode=16196;break;case 3:e.msg="invalid block type",n.mode=sa}l>>>=2,c-=2;break;case 16193:for(l>>>=7&c,c-=7&c;c<32;){if(0===o)break e;o--,l+=r[a++]<<c,c+=8}if((65535&l)!=(l>>>16^65535)){e.msg="invalid stored block lengths",n.mode=sa;break}if(n.length=65535&l,l=0,c=0,n.mode=na,t===Gi)break e;case na:n.mode=16195;case 16195:if(f=n.length,f){if(f>o&&(f=o),f>u&&(f=u),0===f)break e;i.set(r.subarray(a,a+f),s),o-=f,a+=f,u-=f,s+=f,n.length-=f;break}n.mode=ea;break;case 16196:for(;c<14;){if(0===o)break e;o--,l+=r[a++]<<c,c+=8}if(n.nlen=257+(31&l),l>>>=5,c-=5,n.ndist=1+(31&l),l>>>=5,c-=5,n.ncode=4+(15&l),l>>>=4,c-=4,n.nlen>286||n.ndist>30){e.msg="too many length or distance symbols",n.mode=sa;break}n.have=0,n.mode=16197;case 16197:for(;n.have<n.ncode;){for(;c<3;){if(0===o)break e;o--,l+=r[a++]<<c,c+=8}n.lens[A[n.have++]]=7&l,l>>>=3,c-=3}for(;n.have<19;)n.lens[A[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,I={bits:n.lenbits},w=Hi(0,n.lens,0,19,n.lencode,0,n.work,I),n.lenbits=I.bits,w){e.msg="invalid code lengths set",n.mode=sa;break}n.have=0,n.mode=16198;case 16198:for(;n.have<n.nlen+n.ndist;){for(;S=n.lencode[l&(1<<n.lenbits)-1],v=S>>>24,m=S>>>16&255,g=65535&S,!(v<=c);){if(0===o)break e;o--,l+=r[a++]<<c,c+=8}if(g<16)l>>>=v,c-=v,n.lens[n.have++]=g;else{if(16===g){for(N=v+2;c<N;){if(0===o)break e;o--,l+=r[a++]<<c,c+=8}if(l>>>=v,c-=v,0===n.have){e.msg="invalid bit length repeat",n.mode=sa;break}C=n.lens[n.have-1],f=3+(3&l),l>>>=2,c-=2}else if(17===g){for(N=v+3;c<N;){if(0===o)break e;o--,l+=r[a++]<<c,c+=8}l>>>=v,c-=v,C=0,f=3+(7&l),l>>>=3,c-=3}else{for(N=v+7;c<N;){if(0===o)break e;o--,l+=r[a++]<<c,c+=8}l>>>=v,c-=v,C=0,f=11+(127&l),l>>>=7,c-=7}if(n.have+f>n.nlen+n.ndist){e.msg="invalid bit length repeat",n.mode=sa;break}for(;f--;)n.lens[n.have++]=C}}if(n.mode===sa)break;if(0===n.lens[256]){e.msg="invalid code -- missing end-of-block",n.mode=sa;break}if(n.lenbits=9,I={bits:n.lenbits},w=Hi(1,n.lens,0,n.nlen,n.lencode,0,n.work,I),n.lenbits=I.bits,w){e.msg="invalid literal/lengths set",n.mode=sa;break}if(n.distbits=6,n.distcode=n.distdyn,I={bits:n.distbits},w=Hi(2,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,I),n.distbits=I.bits,w){e.msg="invalid distances set",n.mode=sa;break}if(n.mode=ra,t===Gi)break e;case ra:n.mode=ia;case ia:if(o>=6&&u>=258){e.next_out=s,e.avail_out=u,e.next_in=a,e.avail_in=o,n.hold=l,n.bits=c,Ri(e,h),s=e.next_out,i=e.output,u=e.avail_out,a=e.next_in,r=e.input,o=e.avail_in,l=n.hold,c=n.bits,n.mode===ea&&(n.back=-1);break}for(n.back=0;S=n.lencode[l&(1<<n.lenbits)-1],v=S>>>24,m=S>>>16&255,g=65535&S,!(v<=c);){if(0===o)break e;o--,l+=r[a++]<<c,c+=8}if(m&&0==(240&m)){for(y=v,E=m,b=g;S=n.lencode[b+((l&(1<<y+E)-1)>>y)],v=S>>>24,m=S>>>16&255,g=65535&S,!(y+v<=c);){if(0===o)break e;o--,l+=r[a++]<<c,c+=8}l>>>=y,c-=y,n.back+=y}if(l>>>=v,c-=v,n.back+=v,n.length=g,0===m){n.mode=16205;break}if(32&m){n.back=-1,n.mode=ea;break}if(64&m){e.msg="invalid literal/length code",n.mode=sa;break}n.extra=15&m,n.mode=16201;case 16201:if(n.extra){for(N=n.extra;c<N;){if(0===o)break e;o--,l+=r[a++]<<c,c+=8}n.length+=l&(1<<n.extra)-1,l>>>=n.extra,c-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=16202;case 16202:for(;S=n.distcode[l&(1<<n.distbits)-1],v=S>>>24,m=S>>>16&255,g=65535&S,!(v<=c);){if(0===o)break e;o--,l+=r[a++]<<c,c+=8}if(0==(240&m)){for(y=v,E=m,b=g;S=n.distcode[b+((l&(1<<y+E)-1)>>y)],v=S>>>24,m=S>>>16&255,g=65535&S,!(y+v<=c);){if(0===o)break e;o--,l+=r[a++]<<c,c+=8}l>>>=y,c-=y,n.back+=y}if(l>>>=v,c-=v,n.back+=v,64&m){e.msg="invalid distance code",n.mode=sa;break}n.offset=g,n.extra=15&m,n.mode=16203;case 16203:if(n.extra){for(N=n.extra;c<N;){if(0===o)break e;o--,l+=r[a++]<<c,c+=8}n.offset+=l&(1<<n.extra)-1,l>>>=n.extra,c-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){e.msg="invalid distance too far back",n.mode=sa;break}n.mode=16204;case 16204:if(0===u)break e;if(f=h-u,n.offset>f){if(f=n.offset-f,f>n.whave&&n.sane){e.msg="invalid distance too far back",n.mode=sa;break}f>n.wnext?(f-=n.wnext,p=n.wsize-f):p=n.wnext-f,f>n.length&&(f=n.length),_=n.window}else _=i,p=s-n.offset,f=n.length;f>u&&(f=u),u-=f,n.length-=f;do{i[s++]=_[p++]}while(--f);0===n.length&&(n.mode=ia);break;case 16205:if(0===u)break e;i[s++]=n.length,u--,n.mode=ia;break;case aa:if(n.wrap){for(;c<32;){if(0===o)break e;o--,l|=r[a++]<<c,c+=8}if(h-=u,e.total_out+=h,n.total+=h,4&n.wrap&&h&&(e.adler=n.check=n.flags?_r(n.check,i,h,s-h):fr(n.check,i,h,s-h)),h=u,4&n.wrap&&(n.flags?l:oa(l))!==n.check){e.msg="incorrect data check",n.mode=sa;break}l=0,c=0}n.mode=16207;case 16207:if(n.wrap&&n.flags){for(;c<32;){if(0===o)break e;o--,l+=r[a++]<<c,c+=8}if(4&n.wrap&&l!==(4294967295&n.total)){e.msg="incorrect length check",n.mode=sa;break}l=0,c=0}n.mode=16208;case 16208:w=ji;break e;case sa:w=Wi;break e;case 16210:return Yi;default:return Ki}return e.next_out=s,e.avail_out=u,e.next_in=a,e.avail_in=o,n.hold=l,n.bits=c,(n.wsize||h!==e.avail_out&&n.mode<sa&&(n.mode<aa||t!==qi))&&ga(e,e.output,e.next_out,h-e.avail_out),d-=e.avail_in,h-=e.avail_out,e.total_in+=d,e.total_out+=h,n.total+=h,4&n.wrap&&h&&(e.adler=n.check=n.flags?_r(n.check,i,h,e.next_out-h):fr(n.check,i,h,e.next_out-h)),e.data_type=n.bits+(n.last?64:0)+(n.mode===ea?128:0)+(n.mode===ra||n.mode===na?256:0),(0===d&&0===h||t===qi)&&w===Bi&&(w=Zi),w},inflateEnd:e=>{if(la(e))return Ki;let t=e.state;return t.window&&(t.window=null),e.state=null,Bi},inflateGetHeader:(e,t)=>{if(la(e))return Ki;const n=e.state;return 0==(2&n.wrap)?Ki:(n.head=t,t.done=!1,Bi)},inflateSetDictionary:(e,t)=>{const n=t.length;let r,i,a;return la(e)?Ki:(r=e.state,0!==r.wrap&&r.mode!==$i?Ki:r.mode===$i&&(i=1,i=fr(i,t,n,0),i!==r.check)?Wi:(a=ga(e,t,n,n),a?(r.mode=16210,Yi):(r.havedict=1,Bi)))},inflateInfo:"pako inflate (from Nodeca project)"},Ea=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1};const ba=Object.prototype.toString,{Z_NO_FLUSH:Ca,Z_FINISH:wa,Z_OK:Sa,Z_STREAM_END:Ta,Z_NEED_DICT:Ia,Z_STREAM_ERROR:Na,Z_DATA_ERROR:Aa,Z_MEM_ERROR:ka}=mr;function Ma(e){this.options=vi.assign({chunkSize:65536,windowBits:15,to:""},e||{});const t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(t.windowBits>=0&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&0==(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Ei,this.strm.avail_out=0;let n=ya.inflateInit2(this.strm,t.windowBits);if(n!==Sa)throw new Error(vr[n]);if(this.header=new Ea,ya.inflateGetHeader(this.strm,this.header),t.dictionary&&("string"==typeof t.dictionary?t.dictionary=yi.string2buf(t.dictionary):"[object ArrayBuffer]"===ba.call(t.dictionary)&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(n=ya.inflateSetDictionary(this.strm,t.dictionary),n!==Sa)))throw new Error(vr[n])}function Ua(e,t){const n=new Ma(t);if(n.push(e),n.err)throw n.msg||vr[n.err];return n.result}Ma.prototype.push=function(e,t){const n=this.strm,r=this.options.chunkSize,i=this.options.dictionary;let a,s,o;if(this.ended)return!1;for(s=t===~~t?t:!0===t?wa:Ca,"[object ArrayBuffer]"===ba.call(e)?n.input=new Uint8Array(e):n.input=e,n.next_in=0,n.avail_in=n.input.length;;){for(0===n.avail_out&&(n.output=new Uint8Array(r),n.next_out=0,n.avail_out=r),a=ya.inflate(n,s),a===Ia&&i&&(a=ya.inflateSetDictionary(n,i),a===Sa?a=ya.inflate(n,s):a===Aa&&(a=Ia));n.avail_in>0&&a===Ta&&n.state.wrap>0&&0!==e[n.next_in];)ya.inflateReset(n),a=ya.inflate(n,s);switch(a){case Na:case Aa:case Ia:case ka:return this.onEnd(a),this.ended=!0,!1}if(o=n.avail_out,n.next_out&&(0===n.avail_out||a===Ta))if("string"===this.options.to){let e=yi.utf8border(n.output,n.next_out),t=n.next_out-e,i=yi.buf2string(n.output,e);n.next_out=t,n.avail_out=r-t,t&&n.output.set(n.output.subarray(e,e+t),0),this.onData(i)}else this.onData(n.output.length===n.next_out?n.output:n.output.subarray(0,n.next_out));if(a!==Sa||0!==o){if(a===Ta)return a=ya.inflateEnd(this.strm),this.onEnd(a),this.ended=!0,!0;if(0===n.avail_in)break}}return!0},Ma.prototype.onData=function(e){this.chunks.push(e)},Ma.prototype.onEnd=function(e){e===Sa&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=vi.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};var Oa={Inflate:Ma,inflate:Ua,inflateRaw:function(e,t){return(t=t||{}).raw=!0,Ua(e,t)},ungzip:Ua,constants:mr};const{Deflate:Da,deflate:La,deflateRaw:Ra,gzip:xa}=Di,{Inflate:Pa,inflate:Fa,inflateRaw:za,ungzip:Ha}=Oa;var qa,Va={Deflate:Da,deflate:La,deflateRaw:Ra,gzip:xa,Inflate:Pa,inflate:Fa,inflateRaw:za,ungzip:Ha,constants:mr};!function(e){e.CONNECTING="CONNECTING",e.OPEN="OPEN",e.CLOSED="CLOSED"}(qa||(qa={}));var Ga,Ba=function(e){function t(t,n){var r=n.sdkState,i=n.dispatcher,a=n.logger,s=e.call(this)||this;return s.lastActive=0,s._iid=t,s._sdkState=r,s._dispatcher=i,s._logger=a,s}return Be(t,e),Object.defineProperty(t.prototype,"isOpen",{get:function(){return this.connectionState===qa.OPEN},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"connectionState",{get:function(){if(this._ws)switch(this._ws.readyState){case 0:return qa.CONNECTING;case 1:return qa.OPEN}return qa.CLOSED},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ws",{get:function(){var e;return null!==(e=this._ws)&&void 0!==e?e:null},enumerable:!1,configurable:!0}),t.prototype._handleMessage=function(e){var t=this;e.split("\n").forEach((function(e){if(e){var n=vn.createFromRawMessage(t._iid,e);if(t._logger.debug("receive websocket event",n),"LOGI"===n.code)t.dispatch("message",n);else if("PONG"===n.code)t.dispatch("pong");else if("EXPR"===n.code){if(n.payload){var r=new _n(n.payload);r.expiresIn>=0&&t._dispatcher.dispatch(r)}}else"NOOP"===n.code||t.dispatch("message",n)}}))},t.prototype.connect=function(e,t){var n=this;this._ws=new WebSocket(e,encodeURIComponent(t)),this._ws.onopen=function(){n._logger.debug("websocket open"),n.dispatch("open")},this._ws.onmessage=function(e){return Qe(n,void 0,void 0,(function(){var t,n,r=this;return Ke(this,(function(i){return(null===(n=this._sdkState.websocket)||void 0===n?void 0:n.compression)?e.data instanceof Blob?((t=new FileReader).readAsArrayBuffer(e.data),t.onloadend=function(){return Qe(r,void 0,void 0,(function(){var e;return Ke(this,(function(n){switch(n.label){case 0:return[4,(r=t.result,Qe(void 0,void 0,void 0,(function(){var e;return Ke(this,(function(t){return e=Va.ungzip(r),[2,String.fromCharCode.apply(null,e)]}))})))];case 1:return e=n.sent(),this._handleMessage(e),[2]}var r}))}))}):"string"==typeof e.data&&this._handleMessage(e.data):this._handleMessage(e.data),[2]}))}))},this._ws.onerror=function(){n._logger.debug("websocket error"),n.dispatch("error",st.networkError)},this._ws.onclose=function(){n._logger.debug("websocket close"),n.dispatch("close")},this.lastActive=Date.now()},t.prototype.disconnect=function(){var e=this;return new Promise((function(t){e._logger.debug("websocket disconnect"),e._ws?(e._ws.onopen=Dn,e._ws.onmessage=Dn,e._ws.onerror=Dn,e.connectionState!==qa.CLOSED?(e._ws.onclose=function(){e.dispatch("close"),t()},e._ws.close(),e._ws=void 0):t()):t()}))},t.prototype.send=function(e){if(!this._ws)throw st.connectionClosed;"PING"!==e.code?this.dispatch("ping-refresh"):this._logger.debug("send ping",e),this._ws.send(e.convertToMessage())},t.prototype.error=function(e){this._logger.debug("websocket error",e),this.dispatch("error",e)},t}(Ft),ja=function(e){function t(t){var n=t.all,r=t.feed,i=t.custom_types,a=t.ts,s=e.call(this)||this;return s.all=n,s.feed=r,s.customTypes=i,s.ts=a,s}return Be(t,e),t}(Ht),Qa=function(){function e(e,t){var n=t.session,r=t.sdkState,i=t.dispatcher,a=t.logger,s=t.useFetchCompat,o=void 0!==s&&s,u=this;this._ackStateMap=new Map,this._sdkState=r,this._dispatcher=i,this._logger=a,this.apiClient=new On(e,{session:n,sdkState:r,dispatcher:i,logger:a,useFetchCompat:o}),this.websocketClient=new Ba(e,{sdkState:r,dispatcher:i,logger:a}),this.websocketClient.on("message",(function(e){if(e.payload.unread_cnt&&u._dispatcher.dispatch(new ja(e.payload.unread_cnt)),e.requestId){if(u._ackStateMap.has(e.requestId)){var t=u._ackStateMap.get(e.requestId);"EROR"!==e.code?t.resolve(e):t.reject(new st({code:e.payload.code,message:e.payload.message}))}}else u._dispatcher.dispatch(e)})).on("close",(function(){u._ackStateMap.forEach((function(e){e.reject(st.connectionClosed)})),u._ackStateMap.clear()}))}return e.prototype._sendApiRequest=function(e){return Qe(this,void 0,void 0,(function(){return Ke(this,(function(t){switch(t.label){case 0:return[4,this.apiClient.send(e)];case 1:return[2,t.sent()]}}))}))},e.prototype._sendWebsocketRequest=function(e){return Qe(this,void 0,void 0,(function(){var t,n,r,i=this;return Ke(this,(function(a){if(!this._sdkState.websocket)throw st.connectionRequired;if(t=new Un,e.ackRequired){r=function(r,a){i._ackStateMap.has(e.requestId)&&(i._ackStateMap.delete(e.requestId),n&&(clearTimeout(n),n=null),r?(i._logger.debug("fail websocket request",e.requestId,r),t.reject(r)):(i._logger.debug("receive websocket ack",e.requestId,e),i._logger.debug("receive websocket ack",a),t.resolve(a)))};try{n=setTimeout((function(){return r(st.noAckTimeout)}),this._sdkState.websocket.responseTimeout),this._ackStateMap.set(e.requestId,{resolve:function(e){return r(void 0,e)},reject:function(e){return r(e)}}),this.websocketClient.send(e)}catch(e){r(e)}}else try{this.websocketClient.send(e),t.resolve()}catch(e){t.reject(e)}return[2,t.promise]}))}))},e.prototype.send=function(e){return Qe(this,void 0,void 0,(function(){return Ke(this,(function(t){switch(t.label){case 0:return e instanceof hn?[4,this._sendApiRequest(e)]:[3,2];case 1:case 3:return[2,t.sent()];case 2:return e instanceof mn?[4,this._sendWebsocketRequest(e)]:[3,4];case 4:throw st.invalidParameters}}))}))},e.prototype.cancel=function(e){this.apiClient.cancel(e)},e.prototype.cancelAll=function(){this.apiClient.cancelAll()},e}();!function(e){e[e.NONE=0]="NONE",e[e.INITIALIZED=1]="INITIALIZED",e[e.CONNECTING=2]="CONNECTING",e[e.CONNECTED=3]="CONNECTED",e[e.RECONNECTING=4]="RECONNECTING",e[e.INTERNAL_DISCONNECTED=5]="INTERNAL_DISCONNECTED",e[e.EXTERNAL_DISCONNECTED=6]="EXTERNAL_DISCONNECTED",e[e.LOGOUT=7]="LOGOUT"}(Ga||(Ga={}));var Ka=function(e){function t(t){var n=t.stateType,r=e.call(this)||this;return r.stateType=n,r}return Be(t,e),t}(Ht),Wa=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Be(t,e),t}(Ht),Ya=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Be(t,e),t}(Ht),Za=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Be(t,e),t}(Ht),Ja=function(){function e(e){var t,n,r,i;this.isEnabled=null!==(t=e.enabled)&&void 0!==t&&t,this.feedChannels=null!==(n=e.feed_channels)&&void 0!==n?n:{},this.templateListToken=null!==(r=e.template_list_token)&&void 0!==r?r:null,this.settingsUpdatedAt=null!==(i=e.settings_updated_at)&&void 0!==i?i:0}return e.payloadify=function(e){return qt(Vt({enabled:e.isEnabled,feed_channels:e.feedChannels,template_list_token:e.templateListToken,settings_updated_at:e.settingsUpdatedAt}))},e}(),Xa=function(e){return"sendbird@".concat(e,"/changelog_include_chat_notifications")},$a=function(){function e(e){var t;this.lastUpdatedAt=null!==(t=e.last_updated_at)&&void 0!==t?t:0}return e.payloadify=function(e){return qt(Vt({last_updated_at:e.lastUpdatedAt}))},e}(),es=1048576,ts=function(){function e(e){var t,n,r,i,a;void 0===e&&(e={}),this.emojiHash=e.emoji_hash||"",this.uploadSizeLimit=e.file_upload_size_limit?e.file_upload_size_limit*es:Number.MAX_SAFE_INTEGER,this.useReaction=!!e.use_reaction,this.applicationAttributes=null!==(t=e.application_attributes)&&void 0!==t?t:[],this.premiumFeatureList=null!==(n=e.premium_feature_list)&&void 0!==n?n:[],this.deviceTokenCache=this.applicationAttributes.includes("sdk_device_token_cache"),this.enabledChannelMemberShipHistory=this.applicationAttributes.includes("channel_membership_history"),this.multipleFilesMessageFileCountLimit=null!==(r=e.multiple_file_send_max_size)&&void 0!==r?r:5,this.allowSdkStatsUpload=null===(i=e.allow_sdk_log_ingestion)||void 0===i||i,this.uikitConfigInfo=new $a(null!==(a=e.uikit_config)&&void 0!==a?a:{}),this.notificationInfo=e.notifications?new Ja(e.notifications):null}return e.payloadify=function(e){return qt(Vt({emoji_hash:e.emojiHash,file_upload_size_limit:e.uploadSizeLimit/es,application_attributes:e.applicationAttributes,premium_feature_list:e.premiumFeatureList,use_reaction:e.useReaction,allow_sdk_log_ingestion:e.allowSdkStatsUpload,uikit_config:e.uikitConfigInfo?$a.payloadify(e.uikitConfigInfo):null,notifications:e.notificationInfo?Ja.payloadify(e.notificationInfo):null}))},e}(),ns=function(){function e(e){this._iid="",this._iid=e}return e.payloadify=function(e){return{}},e}(),rs=function(e){function t(t){var n=t.userId,r=t.metadata,i=e.call(this)||this;return i.method=Gt.POST,i.path="".concat(jt,"/").concat(n,"/metadata"),i.params={metadata:r},i}return Be(t,e),t}(hn),is=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.metaData=n,r}return Be(t,e),t}(fn),as=function(e){function t(t){var n=t.userId,r=t.metadata,i=t.upsert,a=e.call(this)||this;return a.method=Gt.PUT,a.path="".concat(jt,"/").concat(n,"/metadata"),a.params={metadata:r,upsert:i},a}return Be(t,e),t}(hn),ss=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.metadata=n,r}return Be(t,e),t}(fn),os=function(e){function t(t){var n=t.userId,r=t.metadataKey,i=e.call(this)||this;return i.method=Gt.DELETE,i.path="".concat(jt,"/").concat(n,"/metadata/").concat(r),i}return Be(t,e),t}(hn);!function(e){Be((function(){return null!==e&&e.apply(this,arguments)||this}),e)}(fn);var us=function(e){function t(t){var n=t.userId,r=e.call(this)||this;return r.method=Gt.DELETE,r.path="".concat(jt,"/").concat(n,"/metadata"),r}return Be(t,e),t}(hn);!function(e){Be((function(){return null!==e&&e.apply(this,arguments)||this}),e)}(fn);var ls,cs=function(e,t){var n=JSON.parse(JSON.stringify(e));return n._iid&&delete n._iid,t&&t(n),n},ds=function(e,t){var n=JSON.parse(JSON.stringify(e));return t&&t(n),n},hs=function(e){return{do:function(t){e||t()},throw:function(t){if(!e)throw t}}};!function(e){e.ONLINE="online",e.OFFLINE="offline",e.NON_AVAILABLE="nonavailable"}(ls||(ls={}));var fs,ps=function(e){function t(t,n){var r,i,a,s,o,u,l,c,d,h,f,p,_=this;return(_=e.call(this,t)||this).userId=null!==(i=null!==(r=n.guest_id)&&void 0!==r?r:n.user_id)&&void 0!==i?i:"",_.nickname=null!==(s=null!==(a=n.nickname)&&void 0!==a?a:n.name)&&void 0!==s?s:"",_.plainProfileUrl=null!==(u=null!==(o=n.profile_url)&&void 0!==o?o:n.image)&&void 0!==u?u:"",_.requireAuth=null!==(l=n.require_auth_for_profile_image)&&void 0!==l&&l,_.metaData=null!==(c=n.metadata)&&void 0!==c?c:{},_.connectionStatus=ls.NON_AVAILABLE,dt(ls,n.is_online)?_.connectionStatus=n.is_online:ct("boolean",n.is_online)&&(_.connectionStatus=n.is_online?ls.ONLINE:ls.OFFLINE),_.isActive=null===(d=n.is_active)||void 0===d||d,_.lastSeenAt=null!==(h=n.last_seen_at)&&void 0!==h?h:null,_.preferredLanguages=n.preferred_languages?Ze([],Ye(n.preferred_languages),!1):null,_.friendDiscoveryKey=null!==(f=n.friend_discovery_key)&&void 0!==f?f:null,_.friendName=null!==(p=n.friend_name)&&void 0!==p?p:null,_}return Be(t,e),t.payloadify=function(t){return qt(Vt(je(je({},e.payloadify.call(this,t)),{user_id:t.userId,nickname:t.nickname,profile_url:t.plainProfileUrl,require_auth_for_profile_image:t.requireAuth,metadata:t.metaData,is_online:t.connectionStatus,is_active:t.isActive,last_seen_at:t.lastSeenAt,preferred_languages:t.preferredLanguages,friend_discovery_key:t.friendDiscoveryKey,friend_name:t.friendName})))},Object.defineProperty(t.prototype,"profileUrl",{get:function(){var e=eo.of(this._iid).sessionManager;return this.requireAuth?"".concat(this.plainProfileUrl,"?auth=").concat(e.ekey):this.plainProfileUrl},enumerable:!1,configurable:!0}),t.prototype.serialize=function(){return cs(this)},t.prototype._isValidMetaData=function(e){return!Array.isArray(e)&&Object.keys(e).length>0&&Object.keys(e).map((function(t){return e[t]})).every((function(e){return ct("string",e)}))},t.prototype._applyMetaData=function(e,t){var n=this;void 0===t&&(t=!1),Object.keys(e).forEach((function(r){t?delete n.metaData[r]:n.metaData[r]=e[r]}))},t.prototype.createMetaData=function(e){return Qe(this,void 0,void 0,(function(){var t,n,r,i,a,s;return Ke(this,(function(o){switch(o.label){case 0:return hs(this._isValidMetaData(e)).throw(st.invalidParameters),t=eo.of(this._iid),n=t.sdkState,r=t.requestQueue,i=new rs({userId:n.userId,metadata:e}),[4,r.send(i)];case 1:return a=o.sent(),s=a.as(is).metaData,this._applyMetaData(s),[2,this.metaData]}}))}))},t.prototype.updateMetaData=function(e,t){return void 0===t&&(t=!1),Qe(this,void 0,void 0,(function(){var n,r,i,a,s,o;return Ke(this,(function(u){switch(u.label){case 0:return hs(this._isValidMetaData(e)).throw(st.invalidParameters),n=eo.of(this._iid),r=n.sdkState,i=n.requestQueue,a=new as({userId:r.userId,metadata:e,upsert:t}),[4,i.send(a)];case 1:return s=u.sent(),o=s.as(ss).metadata,this._applyMetaData(o),[2,this.metaData]}}))}))},t.prototype.deleteMetaData=function(e){return Qe(this,void 0,void 0,(function(){var t,n,r,i,a;return Ke(this,(function(s){switch(s.label){case 0:return hs(ct("string",e)).throw(st.invalidParameters),t=eo.of(this._iid),n=t.sdkState,r=t.requestQueue,i=new os({userId:n.userId,metadataKey:e}),[4,r.send(i)];case 1:return s.sent(),this._applyMetaData(((a={})[e]=!0,a),!0),[2,this.metaData]}}))}))},t.prototype.deleteAllMetaData=function(){return Qe(this,void 0,void 0,(function(){var e,t,n,r;return Ke(this,(function(i){switch(i.label){case 0:return e=eo.of(this._iid),t=e.sdkState,n=e.requestQueue,r=new us({userId:t.userId}),[4,n.send(r)];case 1:return i.sent(),this.metaData={},[2]}}))}))},t}(ns),_s=function(e){function t(t){var n=t.userProfile,r=e.call(this)||this;return r.userProfile=n,r}return Be(t,e),t}(Ht),vs=function(){function e(e,t){var n,r,i,a,s,o,u,l,c,d,h,f,p,_;this._iid=e,this.appInfo=new ts(t),this.user=new ps(e,t),this.connectedAt=null!==(n=t.login_ts)&&void 0!==n?n:0,this.firstConnectedAt=0,this.pingInterval=null!==(r=t.ping_interval)&&void 0!==r?r:15e3,this.pongTimeout=null!==(i=t.pong_timeout)&&void 0!==i?i:5e3,this.reconnectInterval=null!==(s=null===(a=t.reconnect)||void 0===a?void 0:a.interval)&&void 0!==s?s:3e3,this.reconnectMaxInterval=null!==(u=null===(o=t.reconnect)||void 0===o?void 0:o.max_interval)&&void 0!==u?u:6e4,this.reconnectRetryCount=null!==(c=null===(l=t.reconnect)||void 0===l?void 0:l.retry_cnt)&&void 0!==c?c:5,this.reconnectIntervalMultiple=null!==(h=null===(d=t.reconnect)||void 0===d?void 0:d.mul)&&void 0!==h?h:2,this.maxUnreadCountOnSuperGroup=null!==(f=t.max_unread_cnt_on_super_group)&&void 0!==f?f:100,this.profileImageEncryption=!!t.profile_image_encryption,this.concurrentCallLimit=null!==(p=t.concurrent_call_limit)&&void 0!==p?p:5,this.backOffDelay=null!==(_=t.back_off_delay)&&void 0!==_?_:100}return e.payloadify=function(e){return qt(Vt(je(je(je({},ps.payloadify(e.user)),ts.payloadify(e.appInfo)),{login_ts:e.connectedAt,ping_interval:e.pingInterval,pong_timeout:e.pongTimeout,reconnect:{interval:e.reconnectInterval,max_interval:e.reconnectMaxInterval,retry_cnt:e.reconnectRetryCount,mul:e.reconnectIntervalMultiple},max_unread_cnt_on_super_group:e.maxUnreadCountOnSuperGroup,profile_image_encryption:e.profileImageEncryption,concurrent_call_limit:e.concurrentCallLimit,back_off_delay:e.backOffDelay})))},e.prototype.apply=function(){var e=this.reconnectInterval,t=this.reconnectMaxInterval,n=this.reconnectIntervalMultiple,r=eo.of(this._iid);r.sdkState.websocket&&(r.sdkState.websocket.pingInterval=1e3*this.pingInterval,r.sdkState.websocket.pongTimeout=1e3*this.pongTimeout,r.sdkState.websocket.reconnectMaxRetry=this.reconnectRetryCount,r.sdkState.websocket.reconnectRetryStrategy={calcTimeout:function(r){return r>0?1e3*Math.min(e*Math.pow(n,r-1),t):10}}),r.appInfo=this.appInfo,r.sessionManager.currentUser=this.user,r.connectedAt=this.connectedAt,this.firstConnectedAt||(r.firstConnectedAt=this.connectedAt),r.maxSuperGroupChannelUnreadCount=this.maxUnreadCountOnSuperGroup,r.concurrentCallLimit=this.concurrentCallLimit,r.backOffDelay=this.backOffDelay,r.dispatcher.dispatch(new _s({userProfile:this}))},e}(),ms=function(e){function t(t){var n=t.request,r=void 0===n||n,i=t.features,a=void 0===i?{}:i,s=t.options,o=void 0===s?{}:s,u=e.call(this)||this;return u.request=r,u.features=je({localCache:!0,notification:!0},a),u.options=je({ingestion:!0},o),u}return Be(t,e),t}(Ht),gs=function(e){function t(t,n,r){var i,a,s,o,u=this;return(u=e.call(this,t,n,r)||this).error=null,u.services=[],u.userProfile=new vs(t,r),u.deviceTokenLastDeletedAt=null!==(i=r.device_token_last_deleted_at)&&void 0!==i?i:0,u.key=null!==(a=r.key)&&void 0!==a?a:"",u.ekey=null!==(s=r.ekey)&&void 0!==s?s:"",u.error=r.error?new st(r):null,u.services=null!==(o=r.services)&&void 0!==o?o:[],u}return Be(t,e),t.asError=function(e){return new t("","LOGI",je({user_id:"",error:!0},e))},t.prototype.applyTo=function(e){return Qe(this,void 0,void 0,(function(){var t,n,r;return Ke(this,(function(i){switch(i.label){case 0:return this.error?[3,4]:(t=eo.of(e))?(n=t.sessionManager,r=t.dispatcher,[4,n.login(this)]):[3,2];case 1:return i.sent(),this.userProfile.apply(),r.dispatch(new ms({request:this.userProfile.appInfo.applicationAttributes.includes("allow_sdk_request_log_publish"),features:{localCache:this.userProfile.appInfo.applicationAttributes.includes("allow_sdk_feature_local_cache_log_publish"),notification:this.userProfile.appInfo.applicationAttributes.includes("allow_sdk_noti_stats_log_publish")},options:{ingestion:this.userProfile.appInfo.allowSdkStatsUpload}})),[3,3];case 2:throw st.lostInstance;case 3:return[3,5];case 4:throw this.error;case 5:return[2]}}))}))},t}(vn),ys=function(){function e(){this.type=Ga.NONE,this.name="none"}return e.prototype.run=function(e){return Qe(this,void 0,void 0,(function(){return Ke(this,(function(e){return[2]}))}))},e.prototype.onConnect=function(e,t){return Qe(this,void 0,void 0,(function(){return Ke(this,(function(e){return[2]}))}))},e.prototype.onReconnect=function(e,t){return t.resetReconnectCount,Qe(this,void 0,void 0,(function(){return Ke(this,(function(e){return[2]}))}))},e.prototype.onDisconnect=function(e,t){return t.error,t.autoReconnect,Qe(this,void 0,void 0,(function(){return Ke(this,(function(e){return[2]}))}))},e.prototype.onDisconnectWebSocket=function(e){return Qe(this,void 0,void 0,(function(){return Ke(this,(function(e){return[2]}))}))},e.prototype.onLogout=function(e){return Qe(this,void 0,void 0,(function(){return Ke(this,(function(e){return[2]}))}))},e}(),Es=function(e){return Qe(void 0,void 0,void 0,(function(){var t;return Ke(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,e()];case 1:return n.sent(),[3,3];case 2:if(!((t=n.sent())instanceof st))throw t;return t.throwOutside(),[3,3];case 3:return[2]}}))}))},bs=function(e){return Qe(void 0,void 0,void 0,(function(){return Ke(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,e()];case 1:case 2:return t.sent(),[3,3];case 3:return[2]}}))}))},Cs=function(e){function t(t){void 0===t&&(t={});var n,r=this;return(r=e.call(this)||this).type=Ga.LOGOUT,r.name="logout",r._wasPreviouslyConnected=null===(n=t.wasPreviouslyConnected)||void 0===n||n,r}return Be(t,e),t.prototype.run=function(e){return Qe(this,void 0,void 0,(function(){var t,n,r=this;return Ke(this,(function(i){switch(i.label){case 0:return t=Date.now(),n=e.sdkState.userId,[4,e.logout()];case 1:return i.sent(),[4,e.changeState(new Us,t)];case 2:return i.sent(),this._wasPreviouslyConnected&&Es((function(){return Qe(r,void 0,void 0,(function(){return Ke(this,(function(t){return e.connectionHandlers.forEach((function(e){e.onDisconnected&&e.onDisconnected(n)})),[2]}))}))})),[2]}}))}))},t}(ys),ws=function(e){function t(){var t=e.call(this)||this;return t.type=Ga.EXTERNAL_DISCONNECTED,t.name="externaldisconnected",t}return Be(t,e),t.prototype.run=function(e){return Qe(this,void 0,void 0,(function(){return Ke(this,(function(t){switch(t.label){case 0:return[4,e.disconnect()];case 1:return t.sent(),[2]}}))}))},t.prototype.onConnect=function(e,t){return Qe(this,void 0,void 0,(function(){var n;return Ke(this,(function(r){switch(r.label){case 0:return n=Date.now(),[4,e.disconnect()];case 1:return r.sent(),[4,e.changeState(new Ms({authToken:t}),n)];case 2:return r.sent(),[2]}}))}))},t.prototype.onReconnect=function(e){return Qe(this,void 0,void 0,(function(){var t;return Ke(this,(function(n){switch(n.label){case 0:return t=Date.now(),[4,e.changeState(new As,t)];case 1:return n.sent(),[2]}}))}))},t.prototype.onLogout=function(e){return Qe(this,void 0,void 0,(function(){var t;return Ke(this,(function(n){switch(n.label){case 0:return t=Date.now(),[4,e.changeState(new Cs,t)];case 1:return n.sent(),[2]}}))}))},t}(ys),Ss=function(e){function t(t){var n=t.autoReconnect,r=e.call(this)||this;return r.type=Ga.INTERNAL_DISCONNECTED,r.name="internaldisconnected",r._autoReconnect=!1,r._autoReconnect=n,r}return Be(t,e),t.prototype.run=function(e){return Qe(this,void 0,void 0,(function(){var t;return Ke(this,(function(n){switch(n.label){case 0:return t=Date.now(),[4,e.disconnect()];case 1:return n.sent(),this._autoReconnect?[4,e.changeState(new As,t)]:[3,3];case 2:n.sent(),n.label=3;case 3:return[2]}}))}))},t.prototype.onConnect=function(e,t){return Qe(this,void 0,void 0,(function(){var n;return Ke(this,(function(r){switch(r.label){case 0:return n=Date.now(),[4,e.disconnect()];case 1:return r.sent(),[4,e.changeState(new Ms({authToken:t}),n)];case 2:return r.sent(),[2]}}))}))},t.prototype.onReconnect=function(e){return Qe(this,void 0,void 0,(function(){var t;return Ke(this,(function(n){switch(n.label){case 0:return t=Date.now(),[4,e.changeState(new As,t)];case 1:return n.sent(),[2]}}))}))},t.prototype.onDisconnectWebSocket=function(e){return Qe(this,void 0,void 0,(function(){var t;return Ke(this,(function(n){switch(n.label){case 0:return t=Date.now(),[4,e.changeState(new ws,t)];case 1:return n.sent(),[2]}}))}))},t.prototype.onLogout=function(e){return Qe(this,void 0,void 0,(function(){var t;return Ke(this,(function(n){switch(n.label){case 0:return t=Date.now(),[4,e.changeState(new Cs,t)];case 1:return n.sent(),[2]}}))}))},t}(ys),Ts=function(e){return Qe(void 0,void 0,void 0,(function(){return Ke(this,(function(t){return[2,new Promise((function(t){return setTimeout(t,e)}))]}))}))},Is=function(){function e(){}return e.prototype.calcTimeout=function(){return 0},e}(),Ns=function(e,t,n){return void 0===n&&(n=new Is),Qe(void 0,void 0,void 0,(function(){var r,i,a,s,o,u;return Ke(this,(function(l){switch(l.label){case 0:r=0,i=null,a=function(e){return i=null!=e?e:new Error("Halted")},s=function(){r=0},l.label=1;case 1:if(!(-1===t||r<t))return[3,9];l.label=2;case 2:return l.trys.push([2,4,,8]),[4,e(a,s)];case 3:if(o=l.sent(),i)throw i;return[2,o];case 4:if(u=l.sent(),i)return[3,6];if(++r===t)throw u;return[4,Ts(n.calcTimeout(r))];case 5:return l.sent(),[3,7];case 6:throw i;case 7:return[3,8];case 8:return[3,1];case 9:throw"It should not happen."}}))}))},As=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type=Ga.RECONNECTING,t.name="reconnecting",t._callbacks=[],t}return Be(t,e),t.prototype._halt=function(e){this._haltConnect&&(this._haltConnect(e),this._haltConnect=void 0)},t.prototype._flushCallbacks=function(e){this._haltConnect=void 0,this._resetConnect=void 0,this._callbacks.forEach((function(t){return t(e)}))},t.prototype.run=function(e){return Qe(this,void 0,void 0,(function(){var t,n,r,i,a,s,o=this;return Ke(this,(function(u){switch(u.label){case 0:t=Date.now(),n=new Un,this._callbacks.push((function(e){return e?n.reject(e):n.resolve()})),Es((function(){return Qe(o,void 0,void 0,(function(){return Ke(this,(function(t){return e.connectionHandlers.forEach((function(e){e.onReconnectStarted&&e.onReconnectStarted()})),[2]}))}))})),u.label=1;case 1:return u.trys.push([1,4,,9]),r=e.sdkState.websocket,i=r.reconnectMaxRetry,a=r.reconnectRetryStrategy,[4,Ns((function(t,n){return Qe(o,void 0,void 0,(function(){var r;return Ke(this,(function(i){switch(i.label){case 0:this._haltConnect=t,this._resetConnect=n,i.label=1;case 1:return i.trys.push([1,3,,4]),[4,e.connect()];case 2:return i.sent(),[3,4];case 3:if(r=i.sent(),e.clearLoginTimer(),r instanceof st){if(r.code===Je.CONNECTION_CANCELED)return t(r),[2];if(r.isSessionExpiredError||r.isSessionInvalidatedError)return t(r),[2]}throw r;case 4:return[2]}}))}))}),i,a)];case 2:return u.sent(),[4,e.changeState(new ks,t)];case 3:return u.sent(),this._flushCallbacks(),Es((function(){return Qe(o,void 0,void 0,(function(){return Ke(this,(function(t){return e.connectionHandlers.forEach((function(e){e.onReconnectSucceeded&&e.onReconnectSucceeded()})),[2]}))}))})),[3,9];case 4:return s=u.sent(),at(s)?[3,7]:s instanceof st?s.code===Je.CONNECTION_CANCELED?[3,6]:[4,e.changeState(new Ss({autoReconnect:!1}),t)]:[3,6];case 5:u.sent(),u.label=6;case 6:return this._flushCallbacks(s),Es((function(){return Qe(o,void 0,void 0,(function(){return Ke(this,(function(t){return e.connectionHandlers.forEach((function(e){e.onReconnectFailed&&e.onReconnectFailed()})),[2]}))}))})),[3,8];case 7:throw s;case 8:return[3,9];case 9:return[2,n.promise]}}))}))},t.prototype.onConnect=function(e,t){return Qe(this,void 0,void 0,(function(){var n;return Ke(this,(function(r){return n=new Un,this._halt(st.connectionCanceled),e.cancelConnectForRetry(),this._callbacks.push((function(){var r=Date.now();e.changeState(new Ms({authToken:t}),r).then((function(){n.resolve()})).catch((function(e){n.reject(e)}))})),[2,n.promise]}))}))},t.prototype.onReconnect=function(e,t){var n=t.resetReconnectCount,r=void 0!==n&&n;return Qe(this,void 0,void 0,(function(){var e;return Ke(this,(function(t){return e=new Un,this._resetConnect&&r&&this._resetConnect(),this._callbacks.push((function(t){return t?e.reject(t):e.resolve()})),[2,e.promise]}))}))},t.prototype.onDisconnect=function(e,t){t.error;var n=t.autoReconnect,r=void 0===n||n;return Qe(this,void 0,void 0,(function(){var t;return Ke(this,(function(n){switch(n.label){case 0:return t=Date.now(),this._halt(st.connectionCanceled),[4,e.changeState(new Ss({autoReconnect:r}),t)];case 1:return n.sent(),[2]}}))}))},t.prototype.onDisconnectWebSocket=function(e){return Qe(this,void 0,void 0,(function(){var t;return Ke(this,(function(n){switch(n.label){case 0:return t=Date.now(),this._halt(st.connectionCanceled),[4,e.changeState(new ws,t)];case 1:return n.sent(),[2]}}))}))},t.prototype.onLogout=function(e){return Qe(this,void 0,void 0,(function(){var t;return Ke(this,(function(n){switch(n.label){case 0:return t=Date.now(),this._halt(st.connectionCanceled),[4,e.changeState(new Cs,t)];case 1:return n.sent(),[2]}}))}))},t}(ys),ks=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type=Ga.CONNECTED,t.name="connected",t}return Be(t,e),t.prototype.onReconnect=function(e){return Qe(this,void 0,void 0,(function(){var t;return Ke(this,(function(n){switch(n.label){case 0:return t=Date.now(),[4,e.disconnect()];case 1:return n.sent(),[4,e.changeState(new As,t)];case 2:return n.sent(),[2]}}))}))},t.prototype.onDisconnect=function(e,t){var n=t.autoReconnect;return Qe(this,void 0,void 0,(function(){var t;return Ke(this,(function(r){switch(r.label){case 0:return t=Date.now(),[4,e.changeState(new Ss({autoReconnect:n}),t)];case 1:return r.sent(),[2]}}))}))},t.prototype.onDisconnectWebSocket=function(e){return Qe(this,void 0,void 0,(function(){var t;return Ke(this,(function(n){switch(n.label){case 0:return t=Date.now(),[4,e.changeState(new ws,t)];case 1:return n.sent(),[2]}}))}))},t.prototype.onLogout=function(e){return Qe(this,void 0,void 0,(function(){var t;return Ke(this,(function(n){switch(n.label){case 0:return t=Date.now(),[4,e.changeState(new Cs,t)];case 1:return n.sent(),[2]}}))}))},t}(ys),Ms=function(e){function t(t){var n=t.authToken,r=e.call(this)||this;return r.type=Ga.CONNECTING,r.name="connecting",r._authToken="",r._callbacks=[],r._authToken=n,r}return Be(t,e),t.prototype._halt=function(e){this._haltConnect&&(this._haltConnect(e),this._haltConnect=void 0)},t.prototype._flushCallbacks=function(e){this._haltConnect=void 0,this._callbacks.forEach((function(t){return t(e)}))},t.prototype.run=function(e){return Qe(this,void 0,void 0,(function(){var t,n,r,i=this;return Ke(this,(function(a){switch(a.label){case 0:t=Date.now(),n=new Un,this._callbacks.push((function(e){return e?n.reject(e):n.resolve()})),a.label=1;case 1:return a.trys.push([1,4,,10]),[4,Ns((function(t){return Qe(i,void 0,void 0,(function(){var n;return Ke(this,(function(r){switch(r.label){case 0:this._haltConnect=t,r.label=1;case 1:return r.trys.push([1,3,,4]),[4,e.connect(this._authToken)];case 2:return r.sent(),[3,4];case 3:if(n=r.sent(),e.clearLoginTimer(),n instanceof st&&n.code===Je.CONNECTION_CANCELED)return t(n),[2];throw n;case 4:return[2]}}))}))}),e.sdkState.websocket.connectMaxRetry)];case 2:return a.sent(),[4,e.changeState(new ks,t)];case 3:return a.sent(),Es((function(){return Qe(i,void 0,void 0,(function(){return Ke(this,(function(t){return this._flushCallbacks(),e.connectionHandlers.forEach((function(t){t.onConnected&&t.onConnected(e.sdkState.userId)})),[2]}))}))})),[3,10];case 4:return r=a.sent(),at(r)?[3,8]:[4,e.disconnect()];case 5:return a.sent(),r instanceof st?r.code===Je.CONNECTION_CANCELED?[3,7]:[4,e.changeState(new Us,t)]:[3,7];case 6:a.sent(),a.label=7;case 7:return Es((function(){return Qe(i,void 0,void 0,(function(){return Ke(this,(function(e){return this._flushCallbacks(r),[2]}))}))})),[3,9];case 8:throw r;case 9:return[3,10];case 10:return[2,n.promise]}}))}))},t.prototype.onConnect=function(e){return Qe(this,void 0,void 0,(function(){var e;return Ke(this,(function(t){return e=new Un,this._callbacks.push((function(t){return t?e.reject(t):e.resolve()})),[2,e.promise]}))}))},t.prototype.onDisconnect=function(e,t){var n=t.error,r=void 0===n?null:n,i=t.autoReconnect,a=void 0!==i&&i;return Qe(this,void 0,void 0,(function(){var t;return Ke(this,(function(n){switch(n.label){case 0:return t=Date.now(),this._halt(null!=r?r:st.connectionCanceled),e.hasSession?[4,e.changeState(new Ss({autoReconnect:a}),t)]:[3,2];case 1:return n.sent(),[3,4];case 2:return[4,e.changeState(new Cs,t)];case 3:n.sent(),n.label=4;case 4:return[2]}}))}))},t.prototype.onDisconnectWebSocket=function(e){return Qe(this,void 0,void 0,(function(){var t;return Ke(this,(function(n){switch(n.label){case 0:return t=Date.now(),this._halt(st.connectionCanceled),e.hasSession?[4,e.changeState(new ws,t)]:[3,2];case 1:return n.sent(),[3,4];case 2:return[4,e.changeState(new Cs,t)];case 3:n.sent(),n.label=4;case 4:return[2]}}))}))},t.prototype.onLogout=function(e){return Qe(this,void 0,void 0,(function(){var t;return Ke(this,(function(n){switch(n.label){case 0:return t=Date.now(),this._halt(st.connectionCanceled),[4,e.changeState(new Cs,t)];case 1:return n.sent(),[2]}}))}))},t}(ys),Us=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type=Ga.INITIALIZED,t.name="initialized",t}return Be(t,e),t.prototype.onConnect=function(e,t){return Qe(this,void 0,void 0,(function(){var n;return Ke(this,(function(r){switch(r.label){case 0:return n=Date.now(),[4,e.changeState(new Ms({authToken:t}),n)];case 1:return r.sent(),[2]}}))}))},t.prototype.onLogout=function(e){return Qe(this,void 0,void 0,(function(){var t;return Ke(this,(function(n){switch(n.label){case 0:return t=Date.now(),[4,e.changeState(new Cs({wasPreviouslyConnected:!1}),t)];case 1:return n.sent(),[2]}}))}))},t}(ys),Os=function(e){function t(){return e.call(this,{code:"PING",payload:{id:Date.now(),active:1},ackRequired:!1})||this}return Be(t,e),t}(mn),Ds=function(){function e(e){var t=e.pingDelegate,n=e.sdkState,r=e.logger;this.pingDelegate=t,this.sdkState=n,this._logger=r}return Object.defineProperty(e.prototype,"isWaiting",{get:function(){return!!this._pingTimeoutTimer},enumerable:!1,configurable:!0}),e.prototype.ping=function(){var e,t=this;if(!this.sdkState.websocket)throw st.connectionRequired;var n=new Os;try{var r=null!==(e=this.sdkState.websocket.pongTimeout)&&void 0!==e?e:5e3;this._pingTimeoutTimer=setTimeout((function(){t._logger.debug("pinger.ping() timeout"),t.pingDelegate.error()}),r),this.pingDelegate.send(n),this._logger.debug("pinger.ping()")}catch(e){this._logger.debug("pinger.ping() error",e),this._pingTimeoutTimer&&(clearTimeout(this._pingTimeoutTimer),this._pingTimeoutTimer=void 0),this.pingDelegate.error()}return n},e.prototype.pong=function(){this._logger.debug("pinger.pong()"),this._pingTimeoutTimer&&(clearTimeout(this._pingTimeoutTimer),this._pingTimeoutTimer=void 0)},e.prototype.refreshTimer=function(){var e,t=this;if(!this.sdkState.websocket)throw st.connectionRequired;this._logger.debug("pinger.refreshTimer()");var n=null!==(e=this.sdkState.websocket.pingInterval)&&void 0!==e?e:15e3;this.stop(),this._pingTimer=setInterval((function(){t.ping()}),n)},e.prototype.start=function(){this._logger.debug("pinger.start()"),this.refreshTimer(),this.ping()},e.prototype.stop=function(){this._logger.debug("pinger.stop()"),this._pingTimer&&(clearInterval(this._pingTimer),this._pingTimer=void 0),this._pingTimeoutTimer&&(clearTimeout(this._pingTimeoutTimer),this._pingTimeoutTimer=void 0)},e}(),Ls=["premium_feature_list","file_upload_size_limit","application_attributes","emoji_hash","multiple_file_send_max_size","notifications"],Rs=function(e){function t(t,n){var r,i=n.sdkState,a=n.cacheContext,s=n.connectionHandlers,o=n.sessionManager,u=n.websocketClient,l=n.dispatcher,c=n.logger,d=n.entryState,h=void 0===d?new Us:d,f=this;return(f=e.call(this)||this)._stateUpdatedAt=0,f._connectingAt=0,f._connectionRequestQueue=[],f._iid=t,f.sdkState=i,f.cacheContext=a,f.connectionHandlers=s,f._sessionManager=o,f._websocketClient=u,f._dispatcher=l,f._logger=c,f._currentState=h,(null===(r=f.sdkState.websocket)||void 0===r?void 0:r.pingerDisabled)||(f._pinger=new Ds({pingDelegate:{send:function(e){return f._websocketClient.send(e)},error:function(e){return f._websocketClient.error(e)}},sdkState:f.sdkState,logger:c})),f._websocketClient.on("open",(function(){f._tryResolveConnectionRequest()})).on("message",(function(e){"LOGI"===e.code&&(f.clearLoginTimer(),f._dispatcher.dispatch(e.as(gs)))})).on("ping-refresh",(function(){var e;return null===(e=f._pinger)||void 0===e?void 0:e.refreshTimer()})).on("pong",(function(){var e;return null===(e=f._pinger)||void 0===e?void 0:e.pong()})).on("error",(function(){var e;return null===(e=f._pinger)||void 0===e?void 0:e.stop()})).on("close",(function(){f._logiProcessingTimer=setTimeout((function(){f._logiProcessingTimer=void 0,f._unresolvedLogi||f._rejectConnectionRequest(st.networkError)}),500)})),f._dispatcher.on((function(e){e instanceof gs&&(f._unresolvedLogi=e,f._tryResolveConnectionRequest())})),f}return Be(t,e),Object.defineProperty(t.prototype,"currentState",{get:function(){return this._currentState},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasSession",{get:function(){return this._sessionManager.session.hasSession},enumerable:!1,configurable:!0}),t.prototype.changeState=function(e,t){return Qe(this,void 0,void 0,(function(){return Ke(this,(function(n){switch(n.label){case 0:return t>=this._stateUpdatedAt?(this._currentState=e,this._stateUpdatedAt=t,this._dispatcher.dispatch(new Ka({stateType:e.type})),this._logger.debug("connection state changes to ".concat(e.name)),[4,this._currentState.run(this)]):[3,2];case 1:return n.sent(),[2,!0];case 2:return[2,!1]}}))}))},t.prototype._tryResolveConnectionRequest=function(){var e;return Qe(this,void 0,void 0,(function(){var t;return Ke(this,(function(n){switch(n.label){case 0:return t=this._unresolvedLogi,this._websocketClient.isOpen&&t?(this._unresolvedLogi=void 0,t.error?[3,2]:[4,t.applyTo(this._iid)]):[3,3];case 1:return n.sent(),this._statLogConnection(),null===(e=this._pinger)||void 0===e||e.start(),this._connectionRequestQueue.forEach((function(e){return e.resolve()})),this._connectionRequestQueue=[],this.sdkState.appState="foreground",[3,3];case 2:this._sessionManager.session.authToken=void 0,(t.error.isSessionExpiredError||t.error.isSessionInvalidatedError)&&this._dispatcher.dispatch(new _n({reason:t.error.code})),this._rejectConnectionRequest(t.error),n.label=3;case 3:return[2]}}))}))},t.prototype._rejectConnectionRequest=function(e){var t;if(null===(t=this._pinger)||void 0===t||t.stop(),this.clearLoginTimer(),this._connectionRequestQueue.length>0){var n=this._connectionRequestQueue;this._connectionRequestQueue=[],n.forEach((function(t){return t.reject(e)})),this._statLogConnection(e)}},t.prototype._url=function(){var e,t=this.sdkState,n=t.appId,r=t.appVersion,i=t.userId,a=t.extensions,s=t.sendbirdRuntimeEnvironment,o=this.cacheContext.localCacheEnabled,u=this._sessionManager.session,l=null===(e=this.sdkState.websocket)||void 0===e?void 0:e.compression,c=!!(null!=a?a:{}).sb_uikit,d=Mn.userAgentWithExtension(a);return"".concat(this.sdkState.websocket.host,"/?p=JS&pv=").concat(encodeURIComponent($e.OS_VERSION),"&sv=").concat(encodeURIComponent($e.SDK_VERSION),"&ai=").concat(n).concat(r?"&av=".concat(r):"").concat(u.hasSession?"":"&user_id=".concat(encodeURIComponent(i)),"&pmce=").concat(l?1:0,"&active=1&device_token_types=").concat(encodeURIComponent(["gcm","huawei","apns"].join(",")),"&SB-User-Agent=").concat(d,"&SB-SDK-User-Agent=").concat(encodeURIComponent(Mn.sendbirdSdkUserAgentWithExtension(s)),"&Request-Sent-Timestamp=").concat(Date.now().toString(),"&include_extra_data=").concat(encodeURIComponent(String(Ls))).concat(this._sessionManager.handler?"&expiring_session=1":"","&use_local_cache=").concat(o?1:0,"&include_poll_details=1").concat(c?"&uikit_config=1":"")},t.prototype._statLogConnection=function(e){var t;this._dispatcher.dispatch(new Cn(new Nn({type:dn.WEBSOCKET_CONNECT,data:{host_url:null===(t=this.sdkState.websocket)||void 0===t?void 0:t.host,success:!e,latency:Date.now()-this._connectingAt,error_code:null==e?void 0:e.code,error_description:null==e?void 0:e.message}})))},t.prototype.connect=function(e){var t;return void 0===e&&(e=""),Qe(this,void 0,void 0,(function(){var n,r,i,a=this;return Ke(this,(function(s){return this._logiProcessingTimer&&(clearTimeout(this._logiProcessingTimer),this._logiProcessingTimer=void 0,this._rejectConnectionRequest(st.connectionCanceled)),n=this._url(),r=new Un,this._connectionRequestQueue.push(r),1===this._connectionRequestQueue.length&&(this._connectingAt=Date.now(),this._loginTimer=setTimeout((function(){a._loginTimer=void 0,a._rejectConnectionRequest(st.loginTimeout)}),null===(t=this.sdkState.websocket)||void 0===t?void 0:t.responseTimeout),i=this._sessionManager.session,e&&(i.authToken=e),this._websocketClient.connect(n,JSON.stringify(i.hasSession?{auth:i.sessionKey}:{token:e}))),[2,r.promise]}))}))},t.prototype.cancelConnectForRetry=function(){this._dispatcher.dispatch(gs.asError(st.connectionRenew))},t.prototype.disconnect=function(){return Qe(this,void 0,void 0,(function(){return Ke(this,(function(e){switch(e.label){case 0:return[4,this._websocketClient.disconnect()];case 1:return e.sent(),[2]}}))}))},t.prototype.logout=function(){return Qe(this,void 0,void 0,(function(){return Ke(this,(function(e){switch(e.label){case 0:return this.sdkState.userId=void 0,this._unresolvedLogi=void 0,[4,this._sessionManager.clear()];case 1:return e.sent(),[4,this.disconnect()];case 2:return e.sent(),[2]}}))}))},t.prototype.clearLoginTimer=function(){this._loginTimer&&(clearTimeout(this._loginTimer),this._loginTimer=void 0)},t}(Ft),xs=function(e){function t(t){var n=t.appId,r=t.userId,i=t.services,a=void 0===i?[bt.CHAT]:i,s=t.includeUIKitConfig,o=void 0!==s&&s,u=t.localCacheEnabled,l=void 0===u||u,c=t.expiringSession,d=void 0===c||c,h=e.call(this)||this;return h.path="".concat(jt,"/").concat(r,"/login"),h.method=Gt.POST,h.params={expiring_session:!!d,services:a,include_logi:!0,include_extra_data:String(Ls),uikit_config:o,use_local_cache:l,app_id:n},h.requireAuth=!1,h}return Be(t,e),t}(hn),Ps=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.logi=new gs(t,"LOGI",n),r}return Be(t,e),t}(fn);!function(e){e[e.ALL=0]="ALL",e[e.WEBSOCKET=1]="WEBSOCKET",e[e.API=2]="API"}(fs||(fs={}));var Fs,zs=[gn,xs],Hs=function(){function e(e,t){var n=t.session,r=t.sdkState,i=t.dispatcher,a=t.logger,s=t.useFetchCompat,o=void 0!==s&&s,u=this;this._currentConnectionStateType=Ga.INITIALIZED,this._lazyCallQueue=[],this.commandRouter=new Qa(e,{session:n,sdkState:r,dispatcher:i,logger:a,useFetchCompat:o}),this._session=n,this._logger=a,this._dispatcher=i,this._dispatcher.on((function(e){var t,n,r,i;if(e instanceof Ka){var a=e.stateType;switch(u._currentConnectionStateType=a,a){case Ga.CONNECTED:u._resolveLazyCallQueue();break;case Ga.INITIALIZED:case Ga.INTERNAL_DISCONNECTED:case Ga.EXTERNAL_DISCONNECTED:case Ga.LOGOUT:u._rejectLazyCallQueue((null===(r=u._session)||void 0===r?void 0:r.hasSession)?st.connectionClosed:st.connectionRequired)}}else if(e instanceof Wa)(null===(i=u._session.services)||void 0===i?void 0:i.includes(bt.CHAT))||u._resolveLazyCallQueue(fs.API);else if(e instanceof Ya||e instanceof Za)u._rejectLazyCallQueue(st.connectionClosed);else if(e instanceof wn){var s=e.request,o=e.deferred,l=e.error;try{for(var c=We(zs),d=c.next();!d.done;d=c.next())if(s instanceof d.value)return void o.reject(l)}catch(e){t={error:e}}finally{try{d&&!d.done&&(n=c.return)&&n.call(c)}finally{if(t)throw t.error}}u._lazyCallQueue.push({command:s,deferred:o})}}))}return Object.defineProperty(e.prototype,"isReady",{get:function(){return this._currentConnectionStateType===Ga.CONNECTED},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isLazyCallActivated",{get:function(){return this._currentConnectionStateType===Ga.CONNECTING||this._currentConnectionStateType===Ga.RECONNECTING||this._session.isRefreshing},enumerable:!1,configurable:!0}),e.prototype._classifyLazyCallQueueByScope=function(e){var t,n=[],r=[];switch(e){case fs.ALL:t=null;break;case fs.WEBSOCKET:t=mn;break;case fs.API:t=hn}var i=!1;return this._lazyCallQueue.forEach((function(e){!t||e.command instanceof t||(i=!0),i?r.push(e):n.push(e)})),[n,r]},e.prototype._resolveLazyCallQueue=function(e){var t=this;void 0===e&&(e=fs.ALL);var n=Ye(this._classifyLazyCallQueueByScope(e),2),r=n[0],i=n[1];this._lazyCallQueue=i,r.forEach((function(e){return Qe(t,void 0,void 0,(function(){var t,n,r,i,a;return Ke(this,(function(s){switch(s.label){case 0:t=e.command,n=e.deferred,(r=e.timeout)&&clearTimeout(r),s.label=1;case 1:return s.trys.push([1,3,,4]),[4,this.send(t)];case 2:return i=s.sent(),n.resolve(i),[3,4];case 3:return a=s.sent(),n.reject(a),[3,4];case 4:return[2]}}))}))}))},e.prototype._rejectLazyCallQueue=function(e,t){var n=this;void 0===t&&(t=fs.ALL);var r=Ye(this._classifyLazyCallQueueByScope(t),2),i=r[0],a=r[1];this._lazyCallQueue=a,i.forEach((function(t){return Qe(n,void 0,void 0,(function(){var n,r;return Ke(this,(function(i){return n=t.deferred,r=t.timeout,clearTimeout(r),n.reject(e),[2]}))}))}))},e.prototype.send=function(e){return Qe(this,void 0,void 0,(function(){var t,n,r=this;return Ke(this,(function(i){switch(i.label){case 0:return e instanceof mn?this.isReady?(this._logger.debug("send websocket request",e),[4,this.commandRouter.send(e)]):[3,2]:[3,4];case 1:case 5:return[2,i.sent()];case 2:if(this.isLazyCallActivated)return this._logger.debug("wait websocket request",e),t=new Un,this._lazyCallQueue.push({command:e,deferred:t,timeout:setTimeout((function(){return r.timeout(e.requestId)}),1e4)}),[2,t.promise];throw this._logger.debug("fail websocket request"),st.connectionRequired;case 3:case 7:return[3,9];case 4:return e instanceof hn?this._session.hasSession?(this._logger.debug("send api request",e),[4,this.commandRouter.send(e)]):[3,6]:[3,8];case 6:if(this.isLazyCallActivated)return this._logger.debug("wait api request",e),t=new Un,this._lazyCallQueue.push({command:e,deferred:t,timeout:setTimeout((function(){return r.timeout(e.requestId)}),1e4)}),[2,t.promise];throw n=st.connectionRequired,this._logger.debug("fail api request",n),n;case 8:throw st.invalidCommand;case 9:return[2]}}))}))},e.prototype.forceSend=function(e){return Qe(this,void 0,void 0,(function(){return Ke(this,(function(t){switch(t.label){case 0:return this._logger.debug("send forced request",e),e instanceof mn||e instanceof hn?[4,this.commandRouter.send(e)]:[3,2];case 1:return[2,t.sent()];case 2:throw st.invalidCommand}}))}))},e.prototype.timeout=function(e){this._logger.debug("timeout request",e);var t=this._lazyCallQueue.findIndex((function(t){return t.command.requestId===e}));t>-1&&(this._lazyCallQueue[t].deferred.reject(st.connectionRequired),this._lazyCallQueue.splice(t,1))},e.prototype.cancel=function(e){this._logger.debug("cancel api request",e),this.commandRouter.cancel(e)},e.prototype.cancelAll=function(){this._logger.debug("cancel all api requests"),this.commandRouter.cancelAll()},e}(),qs="sendbird@devicetokens",Vs=function(){function e(e){var t=e.type,n=e.token;this.type=t,this.token=n}return e.payloadify=function(e){return qt(Vt({type:e.type,token:e.token}))},e}(),Gs=new WeakMap,Bs=function(e){function t(t){var n=t._iid,r=t.session,i=t.cacheContext,a=t.sdkState,s=t.dispatcher,o=t.requestQueue,u=t.logger,l=e.call(this)||this;return l._currentConnectionStateType=Ga.INITIALIZED,l._isRefreshingAuthToken=!1,l.currentUser=null,l.session=r,l._iid=n,l._cacheContext=i,l._sdkState=a,l._dispatcher=s,l._requestQueue=o,l._logger=u,l._deviceTokens=[],l._dispatcher.on((function(e){var t;if(e instanceof Ka){var n=e.stateType;l._currentConnectionStateType=n}else e instanceof _n&&l.handler&&!l.isSessionKeyRefreshing&&((null===(t=e.error)||void 0===t?void 0:t.isSessionInvalidatedError)?l.handler.onSessionClosed&&l.handler.onSessionClosed():(e.invalidateSessionToken&&(l.session.authToken=void 0),e.error&&e.error.isSessionExpiredError&&(l._logger.debug("session expired"),l.handler.onSessionExpired&&l.handler.onSessionExpired(),l.refresh())))})),l}return Be(t,e),Object.defineProperty(t.prototype,"ekey",{get:function(){return Gs.get(this)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"deviceTokens",{get:function(){return this._deviceTokens},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"deviceTokenLastDeletedAt",{get:function(){return this._deviceTokenLastDeletedAt},enumerable:!1,configurable:!0}),t.prototype.indexOfDeviceToken=function(e,t){return this._deviceTokens.findIndex((function(n){return n.type===e&&n.token===t}))},t.prototype.hasDeviceToken=function(e,t){return this.indexOfDeviceToken(e,t)>=0},t.prototype.createRefreshWebsocketCommand=function(e,t){return new yn({authToken:e,expiringSession:!0,requestId:t})},t.prototype._refreshSessionKeyByWebSocket=function(e){return Qe(this,void 0,void 0,(function(){var t,n,r,i,a;return Ke(this,(function(s){switch(s.label){case 0:return t=this.createRefreshWebsocketCommand(e),[4,this._requestQueue.forceSend(t)];case 1:if(n=s.sent(),r=n.as(bn),i=r.newKey,a=r.error)throw a;return this.session.sessionKey=null!=i?i:this.session.sessionKey,[2]}}))}))},t.prototype._refreshSessionKeyByApi=function(e){return Qe(this,void 0,void 0,(function(){var t,n=this;return Ke(this,(function(r){switch(r.label){case 0:return t=new gn({userId:this._sdkState.userId,authToken:e,services:this.session.services,expiringSession:!0}),[4,Ns((function(e){return Qe(n,void 0,void 0,(function(){var n,r,i,a,s;return Ke(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,this._requestQueue.forceSend(t)];case 1:return n=o.sent(),r=n.as(En),i=r.key,a=r.services,this.session.sessionKey=i,this.session.services=a,[3,3];case 2:if(s=o.sent(),!this._isSessionRelatedError(s))throw s.code===Je.APPLICATION_NOT_FOUND&&e(s),s;return e(s),[3,3];case 3:return[2]}}))}))}),3)];case 1:return r.sent(),[2]}}))}))},t.prototype._refreshSessionKey=function(e,t){return void 0===t&&(t=!0),Qe(this,void 0,void 0,(function(){var n,r,i;return Ke(this,(function(a){switch(a.label){case 0:if(this._currentConnectionStateType!==Ga.CONNECTED)return[3,11];a.label=1;case 1:return a.trys.push([1,3,,11]),[4,this._refreshSessionKeyByWebSocket(e)];case 2:return a.sent(),this.complete(),[2];case 3:return(n=a.sent())instanceof st&&n.isSessionTokenExpiredError?t?[4,this._receiveNewAuthToken()]:[3,9]:[3,10];case 4:return(i=a.sent())?(this.session.authToken=i,[4,this._refreshSessionKey(this.session.authToken,!1)]):[3,6];case 5:return a.sent(),this.complete(),[3,8];case 6:return[4,this.clear()];case 7:a.sent(),a.label=8;case 8:return[2];case 9:this.session.authToken=void 0,a.label=10;case 10:return[3,11];case 11:return a.trys.push([11,13,,23]),[4,this._refreshSessionKeyByApi(e)];case 12:return a.sent(),this.complete(),[3,23];case 13:return(r=a.sent())instanceof st&&r.isSessionTokenExpiredError?t?[4,this._receiveNewAuthToken()]:[3,19]:[3,21];case 14:return(i=a.sent())?(this.session.authToken=i,[4,this._refreshSessionKeyByApi(this.session.authToken)]):[3,16];case 15:return a.sent(),this.complete(),[3,18];case 16:return[4,this.clear()];case 17:a.sent(),a.label=18;case 18:return[3,20];case 19:throw this.session.authToken=void 0,r;case 20:return[3,22];case 21:throw r;case 22:return[3,23];case 23:return[2]}}))}))},t.prototype._receiveNewAuthToken=function(){var e,t=this,n=new Un;if(this._isRefreshingAuthToken=!0,this.session.clear(),null===(e=this.handler)||void 0===e?void 0:e.onSessionTokenRequired){var r=null,i=function(){r&&(clearTimeout(r),r=null)},a=function(e){i(),t._isRefreshingAuthToken&&(t._isRefreshingAuthToken=!1,n.resolve(e))},s=function(e){i(),t._isRefreshingAuthToken&&(t._isRefreshingAuthToken=!1,n.reject(e))};r=setTimeout((function(){return s()}),1e3*this._sdkState.sessionTokenRefreshTimeout),Es((function(){return Qe(t,void 0,void 0,(function(){var e;return Ke(this,(function(t){return(null===(e=this.handler)||void 0===e?void 0:e.onSessionTokenRequired)&&this.handler.onSessionTokenRequired(a,s),[2]}))}))}))}else n.resolve(null);return n.promise},t.prototype._isSessionRelatedError=function(e){return e instanceof st&&(e.isSessionExpiredError||e.isSessionInvalidatedError)},Object.defineProperty(t.prototype,"isSessionKeyRefreshing",{get:function(){return this.session.isRefreshing},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isRefreshingAuthToken",{get:function(){return this._isRefreshingAuthToken},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isSessionExpiring",{get:function(){return!!this.handler},enumerable:!1,configurable:!0}),t.prototype.authenticateFeed=function(e,t){var n;return Qe(this,void 0,void 0,(function(){var r,i,a;return Ke(this,(function(s){switch(s.label){case 0:return this.session.authToken=t,r=new xs({appId:this._sdkState.appId,userId:e,services:[bt.FEED],includeUIKitConfig:!!(null!==(n=this._sdkState.extensions)&&void 0!==n?n:{}).sb_uikit,localCacheEnabled:this._cacheContext.localCacheEnabled,expiringSession:!t||this.isSessionExpiring}),[4,this._requestQueue.commandRouter.send(r)];case 1:return i=s.sent(),(a=i.as(Ps).logi).error?[3,3]:[4,a.applyTo(this._iid)];case 2:return s.sent(),[3,4];case 3:throw a.error;case 4:return[2]}}))}))},t.prototype.login=function(e){var t;return Qe(this,void 0,void 0,(function(){var n,r,i,a,s,o,u,l;return Ke(this,(function(c){switch(c.label){case 0:return n=e.key,r=e.ekey,i=e.services,a=e.userProfile,s=e.deviceTokenLastDeletedAt,o=void 0===s?0:s,this.session.hasLessServiceScopeThan(i)&&(this.session.sessionKey=n,this.session.services=i),Gs.set(this,r),this._deviceTokenCacheEnabled=null===(t=null==a?void 0:a.appInfo)||void 0===t?void 0:t.deviceTokenCache,u=this._cacheContext.preference,this._deviceTokenCacheEnabled?[4,u.get(qs)]:[3,5];case 1:return!(l=c.sent())||l.lastDeletedAt<o?(this._deviceTokens=[],this._deviceTokenLastDeletedAt=o,[4,this.saveDeviceToken()]):[3,3];case 2:return c.sent(),[3,4];case 3:this._deviceTokens=l.tokens.map((function(e){return new Vs(Vs.payloadify(e))})),this._deviceTokenLastDeletedAt=l.lastDeletedAt,c.label=4;case 4:return[3,7];case 5:return[4,u.remove(qs)];case 6:c.sent(),c.label=7;case 7:return[2]}}))}))},t.prototype.complete=function(){var e=this;this.dispatch("refresh"),this._dispatcher.dispatch(new Wa),Es((function(){return Qe(e,void 0,void 0,(function(){var e;return Ke(this,(function(t){return this._logger.debug("session refreshed"),(null===(e=this.handler)||void 0===e?void 0:e.onSessionRefreshed)&&this.handler.onSessionRefreshed(),[2]}))}))}))},t.prototype.error=function(e){var t=this;Es((function(){return Qe(t,void 0,void 0,(function(){var t;return Ke(this,(function(n){return(null===(t=this.handler)||void 0===t?void 0:t.onSessionError)&&this.handler.onSessionError(e),[2]}))}))}))},t.prototype.close=function(){var e=this;this.dispatch("close"),this._dispatcher.dispatch(new Za),Es((function(){return Qe(e,void 0,void 0,(function(){var e;return Ke(this,(function(t){return this._logger.debug("session closed"),(null===(e=this.handler)||void 0===e?void 0:e.onSessionClosed)&&this.handler.onSessionClosed(),[2]}))}))}))},t.prototype.refresh=function(){return Qe(this,void 0,void 0,(function(){var e,t,n;return Ke(this,(function(r){switch(r.label){case 0:if(!this.isSessionExpiring)return[3,13];if(this.session.isRefreshing)return[3,13];if(this.session.isRefreshing=!0,this.session.authToken)return[3,7];r.label=1;case 1:return r.trys.push([1,6,,7]),[4,this._receiveNewAuthToken()];case 2:return(e=r.sent())?(this._logger.debug("session refreshing.."),this.session.authToken=e,[3,5]):[3,3];case 3:return[4,this.clear()];case 4:return r.sent(),this.session.isRefreshing=!1,[2];case 5:return[3,7];case 6:return r.sent(),n=st.sessionTokenRequestFailed,this._dispatcher.dispatch(new Ya),this.error(n),this.session.isRefreshing=!1,this._logger.debug("refresh auth token error = ",n),[2];case 7:return r.trys.push([7,9,,13]),[4,this._refreshSessionKey(this.session.authToken)];case 8:return r.sent(),this.session.isRefreshing=!1,[3,13];case 9:return t=r.sent(),this.session.isRefreshing=!1,t instanceof st&&(t.code===Je.APPLICATION_NOT_FOUND||t.code===Je.SESSION_TOKEN_EXPIRED)?(this.session.authToken=void 0,[4,this.refresh()]):[3,11];case 10:return r.sent(),[3,12];case 11:return n=st.sessionTokenRefreshFailed,this._dispatcher.dispatch(new Ya),this.error(n),[2];case 12:return[3,13];case 13:return[2]}}))}))},t.prototype.setDeviceToken=function(e,t){return!!(this._deviceTokenCacheEnabled&&this.indexOfDeviceToken(e,t)<0)&&(this._deviceTokens.push(new Vs({type:e,token:t})),!0)},t.prototype.unsetDeviceToken=function(e,t){if(this._deviceTokenCacheEnabled){var n=this.indexOfDeviceToken(e,t);n>=0&&this._deviceTokens.splice(n,1)}},t.prototype.unsetDeviceTokens=function(e){this._deviceTokenCacheEnabled&&(this._deviceTokens=e?this._deviceTokens.filter((function(t){return t.type!==e})):[])},t.prototype.setDeviceTokenDeletedAt=function(e){e>0&&(this._deviceTokenLastDeletedAt=e)},t.prototype.saveDeviceToken=function(){return Qe(this,void 0,void 0,(function(){return Ke(this,(function(e){switch(e.label){case 0:return this._deviceTokenCacheEnabled?[4,this._cacheContext.preference.set(qs,{tokens:this._deviceTokens,lastDeletedAt:this._deviceTokenLastDeletedAt})]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))}))},t.prototype.clear=function(){return Qe(this,void 0,void 0,(function(){return Ke(this,(function(e){switch(e.label){case 0:return this.currentUser=null,this.session.clear(),this.close(),Gs.delete(this),this._deviceTokens=[],this._deviceTokenLastDeletedAt=0,[4,this.saveDeviceToken()];case 1:return e.sent(),[2]}}))}))},t}(Ft),js=function(){function e(e,t){var n=t.sdkState,r=t.cacheContext,i=t.connectionHandlers,a=t.sessionManager,s=t.websocketClient,o=t.dispatcher,u=t.logger,l=t.disableWebSocketCloseEventHandling,c=void 0!==l&&l;this._disableWebSocketCloseEventHandling=!1,this._externalCalledWebSocketClose=!1,this._logger=u,this._disableWebSocketCloseEventHandling=c,this._context=new Rs(e,{sdkState:n,cacheContext:r,connectionHandlers:i,sessionManager:a,websocketClient:s,dispatcher:o,logger:u}),this._sdkState=n,this._sessionManager=a,this._websocketClient=s}return e.prototype._registerEventDispatcher=function(){var e=this;this._disableWebSocketCloseEventHandling||(this._clearEventDispatcher(),this._sessionEventDispatcherContext=this._sessionManager.on("refresh",(function(){e.isConnecting||e.isConnected||(e._logger.debug("try reconnect by session key refresh"),bs((function(){return Qe(e,void 0,void 0,(function(){return Ke(this,(function(e){switch(e.label){case 0:return[4,this.reconnect()];case 1:return e.sent(),[2]}}))}))})))})),this._websocketEventDispatcherContext=this._websocketClient.on("close",(function(){"foreground"!==e._sdkState.appState||e._externalCalledWebSocketClose||bs((function(){return Qe(e,void 0,void 0,(function(){return Ke(this,(function(e){switch(e.label){case 0:return this._sessionManager.isSessionKeyRefreshing?[3,2]:(this._logger.debug("try reconnect by websocket connection closed"),[4,this.reconnect()]);case 1:return e.sent(),[3,4];case 2:return[4,this.disconnectWebSocket()];case 3:e.sent(),e.label=4;case 4:return[2]}}))}))}))})))},e.prototype._clearEventDispatcher=function(){this._sessionEventDispatcherContext&&(this._sessionEventDispatcherContext.close(),this._sessionEventDispatcherContext=void 0),this._websocketEventDispatcherContext&&(this._websocketEventDispatcherContext.close(),this._websocketEventDispatcherContext=void 0)},Object.defineProperty(e.prototype,"isConnected",{get:function(){return this._context.currentState.type===Ga.CONNECTED},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isConnecting",{get:function(){var e=this._context.currentState;return e.type===Ga.CONNECTING||e.type===Ga.RECONNECTING},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"websocketClient",{get:function(){return this._websocketClient},enumerable:!1,configurable:!0}),e.prototype.connect=function(e){return Qe(this,void 0,void 0,(function(){var t;return Ke(this,(function(n){switch(n.label){case 0:return t=this._context.currentState,this._externalCalledWebSocketClose=!1,[4,t.onConnect(this._context,e)];case 1:return n.sent(),this._registerEventDispatcher(),[2]}}))}))},e.prototype.reconnect=function(){return Qe(this,void 0,void 0,(function(){var e;return Ke(this,(function(t){switch(t.label){case 0:return e=this._context.currentState,this._externalCalledWebSocketClose=!1,[4,e.onReconnect(this._context,{})];case 1:return t.sent(),[2]}}))}))},e.prototype.resetAndReconnect=function(){return Qe(this,void 0,void 0,(function(){var e;return Ke(this,(function(t){switch(t.label){case 0:return e=this._context.currentState,this._externalCalledWebSocketClose=!1,[4,e.onReconnect(this._context,{resetReconnectCount:!0})];case 1:return t.sent(),[2]}}))}))},e.prototype.background=function(){return Qe(this,void 0,void 0,(function(){var e;return Ke(this,(function(t){switch(t.label){case 0:return e=this._context.currentState,this._externalCalledWebSocketClose=!0,[4,e.onDisconnect(this._context,{autoReconnect:!1})];case 1:return t.sent(),[2]}}))}))},e.prototype.disconnect=function(e){return Qe(this,void 0,void 0,(function(){return Ke(this,(function(t){switch(t.label){case 0:return[4,this._context.currentState.onDisconnect(this._context,{error:e,autoReconnect:!0})];case 1:return t.sent(),[2]}}))}))},e.prototype.disconnectWebSocket=function(){return Qe(this,void 0,void 0,(function(){var e;return Ke(this,(function(t){switch(t.label){case 0:return e=this._context.currentState,this._externalCalledWebSocketClose=!0,[4,e.onDisconnectWebSocket(this._context)];case 1:return t.sent(),[2]}}))}))},e.prototype.logout=function(){return Qe(this,void 0,void 0,(function(){var e;return Ke(this,(function(t){switch(t.label){case 0:return e=this._context.currentState,this._clearEventDispatcher(),[4,e.onLogout(this._context)];case 1:return t.sent(),[2]}}))}))},e}(),Qs=function(e){function t(t){var n,r,i,a,s=t.type,o=t.data,u=t.ts,l=void 0===u?Date.now():u,c=e.call(this,{type:s,data:o,ts:l})||this;return c.date=new Date(l),c.key="".concat((n=c.date,r=n.getFullYear(),i=String(n.getMonth()+1).padStart(2,"0"),a=String(n.getDate()).padStart(2,"0"),"".concat(r).concat(i).concat(a)),"_").concat(s),c}return Be(t,e),t}(Nn),Ks=function(e){function t(t){var n=t.deviceId,r=t.statLogs,i=e.call(this)||this;return i.method=Gt.POST,i.path="".concat(an),i.params={device_id:n,log_entries:r.map((function(e){return Nn.payloadify(e)}))},i}return Be(t,e),t}(hn),Ws=function(e,t){var n,r;if(null!==e&&null!==t){var i=Object.keys(e),a=Object.keys(t),s=Ze([],Ye(new Set(Ze(Ze([],Ye(i),!1),Ye(a),!1))),!1),o={};try{for(var u=We(s),l=u.next();!l.done;l=u.next()){var c=l.value,d=typeof e[c],h=typeof t[c];"undefined"===d?o[c]=t[c]:"undefined"===h?o[c]=e[c]:d!==h?o[c]=t[c]:"object"===d&&e[c]&&t[c]?o[c]=Ws(e[c],t[c]):o[c]=t[c]}}catch(e){n={error:e}}finally{try{l&&!l.done&&(r=u.return)&&r.call(u)}finally{if(n)throw n.error}}return o}return t};!function(e){e[e.PENDING=0]="PENDING",e[e.COLLECT_ONLY=1]="COLLECT_ONLY",e[e.ENABLED=2]="ENABLED",e[e.DISABLED=3]="DISABLED"}(Fs||(Fs={}));var Ys,Zs=function(e){function t(t){var n=t.cacheContext,r=t.requestQueue,i=t.dispatcher,a=t.baseLimit,s=void 0===a?100:a,o=t.maxLimit,u=void 0===o?1e3:o,l=t.minLimit,c=void 0===l?10:l,d=e.call(this)||this;return d.queue=[],d.flushWaitQueue=[],d.enabledState=Fs.PENDING,d.isFlushing=!1,d.generation=1,d.lastFlushedAt=0,d._collectRequestStat=!0,d._collectFeatureLocalCacheStat=!0,d._collectionNotificationStat=!0,d.deviceId=xt(),d.cacheContext=n,d.requestQueue=r,d.dispatcher=i,d.baseLimit=s,d.limit=s,d.maxLimit=u,d.minLimit=c,d}return Be(t,e),Object.defineProperty(t.prototype,"isEnabled",{get:function(){return this.enabledState===Fs.ENABLED},enumerable:!1,configurable:!0}),t.prototype._arrangeStat=function(){var e=Ze([],Ye(this.queue),!1);this._collectRequestStat||(e=e.filter((function(e){return e.type!==dn.API_RESULT&&e.type!==dn.WEBSOCKET_CONNECT}))),this._collectFeatureLocalCacheStat||(e=e.filter((function(e){return e.type!==dn.FEATURE_LOCALCACHE&&e.type!==dn.FEATURE_LOCALCACHE_EVENT}))),this._collectionNotificationStat||(e=e.filter((function(e){return e.type!==dn.NOTIFICATION}))),this.queue=e},t.prototype._save=function(){return Qe(this,void 0,void 0,(function(){var e;return Ke(this,(function(t){switch(t.label){case 0:return this.isEnabled?(e=Ze(Ze([],Ye(this.queue),!1),Ye(this.flushWaitQueue),!1),[4,this.cacheContext.preference.set(this.key,{deviceId:this.deviceId,statLogs:e.map((function(e){return Nn.payloadify(e)})),generation:this.generation++,lastFlushedAt:this.lastFlushedAt})]):[3,2];case 1:t.sent(),this.dispatch("save",e),t.label=2;case 2:return[2]}}))}))},t.prototype._flush=function(){return Qe(this,void 0,void 0,(function(){var e,t,n,r,i;return Ke(this,(function(a){switch(a.label){case 0:if(!this.isEnabled)return[3,10];if(this.isFlushing)return[3,10];this.isFlushing=!0,a.label=1;case 1:return a.trys.push([1,5,9,10]),this._arrangeStat(),e=this.queue.filter((function(e){if(e instanceof Qs){var t=new Date,n=Ye([e.date.getFullYear(),t.getFullYear()],2),r=n[0],i=n[1];if(r<i)return!0;if(r===i){var a=Ye([e.date.getMonth(),t.getMonth()],2),s=a[0],o=a[1];if(s<o)return!0;if(s===o){var u=Ye([e.date.getDate(),t.getDate()],2);return u[0]<u[1]}}}return!1})),t=this.queue.filter((function(e){return!(e instanceof Qs)})),(n=Ze(Ze([],Ye(e),!1),Ye(t),!1).slice(0,Math.min(this.limit,this.maxLimit))).length>0?(r=new Ks({deviceId:this.deviceId,statLogs:n}),[4,this.requestQueue.send(r)]):[3,4];case 2:return a.sent(),this.dispatch("flush",n),this.queue=Ze(Ze([],Ye(e),!1),Ye(t),!1).slice(n.length).concat(this.flushWaitQueue),this.flushWaitQueue=[],[4,this._save()];case 3:a.sent(),a.label=4;case 4:return this.limit=this.baseLimit,this.lastFlushedAt=Date.now(),[3,10];case 5:return(i=a.sent())instanceof st?i.code!==Je.STAT_LOG_NOT_ALLOWED?[3,7]:[4,this.clear()]:[3,8];case 6:return a.sent(),this.enabledState=Fs.DISABLED,[3,8];case 7:i.code===Je.STAT_UPLOAD_NOT_ALLOWED&&(this.enabledState=Fs.COLLECT_ONLY),a.label=8;case 8:return this.limit=this.limit+20,[3,10];case 9:return this.isFlushing=!1,[7];case 10:return[2]}}))}))},t.prototype.init=function(e){return Qe(this,void 0,void 0,(function(){var t,n,r=this;return Ke(this,(function(i){switch(i.label){case 0:return this.key=e,[4,this.cacheContext.preference.get(this.key)];case 1:return(t=i.sent())?(this.deviceId=t.deviceId,this.queue=t.statLogs.map((function(e){var t;return e.stat_type===dn.FEATURE_LOCALCACHE_EVENT&&(e.data=je({message_init_policy:"",starting_point:0},e.data)),e.stat_type===dn.NOTIFICATION&&(e.data=qt(je(je({},e.data),{message_id:null!==(t=e.data.notificationId)&&void 0!==t?t:e.data.message_id,notificationId:void 0}))),new Nn({type:e.stat_type,ts:e.ts,data:e.data})})),this.generation=t.generation,this.lastFlushedAt=t.lastFlushedAt,Date.now()-this.lastFlushedAt>=108e5&&this.queue.length>=this.minLimit?(n=Math.min(Math.floor(18e4*Math.random()),100),[4,Ts(n)]):[3,4]):[3,4];case 2:return i.sent(),[4,this._flush()];case 3:i.sent(),i.label=4;case 4:return this.commandEventContext||(this.commandEventContext=this.dispatcher.on((function(e){if(e instanceof Cn){var t=e.statLog;r.put(t)}else if(e instanceof ms){var n=e.request,i=e.features,a=e.options;r._collectRequestStat=n,r._collectFeatureLocalCacheStat=null==i?void 0:i.localCache,r._collectionNotificationStat=null==i?void 0:i.notification,r._arrangeStat(),r._collectRequestStat||r._collectFeatureLocalCacheStat||r._collectionNotificationStat?r.enabledState=a.ingestion?Fs.ENABLED:Fs.COLLECT_ONLY:r.enabledState=Fs.DISABLED,r.isEnabled?r.queue.length>=r.limit&&r._flush():r.clear()}}))),[2]}}))}))},t.prototype.put=function(e){return Qe(this,void 0,void 0,(function(){var t,n,r;return Ke(this,(function(i){switch(i.label){case 0:if(this.enabledState===Fs.DISABLED)return[3,3];if(t=this.isFlushing?this.flushWaitQueue:this.queue,e instanceof Qs)this._collectFeatureLocalCacheStat&&(n=Ye(this.queue.filter((function(t){return t instanceof Qs&&t.key===e.key})),1),(r=n[0])?r.data=Ws(r.data,e.data):t.push(e));else switch(e.type){case dn.API_RESULT:case dn.WEBSOCKET_CONNECT:this._collectRequestStat&&t.push(e);break;case dn.FEATURE_LOCALCACHE:case dn.FEATURE_LOCALCACHE_EVENT:this._collectFeatureLocalCacheStat&&t.push(e);break;case dn.NOTIFICATION:this._collectionNotificationStat&&t.push(e)}return[4,this._save()];case 1:return i.sent(),t.length>=this.limit?[4,this._flush()]:[3,3];case 2:i.sent(),i.label=3;case 3:return[2]}}))}))},t.prototype.clear=function(){return Qe(this,void 0,void 0,(function(){return Ke(this,(function(e){switch(e.label){case 0:return this.queue=[],this.flushWaitQueue=[],this.generation=1,[4,this._save()];case 1:return e.sent(),[2]}}))}))},t.prototype.close=function(){this.commandEventContext&&(this.commandEventContext.close(),this.commandEventContext=void 0)},t}(Ft);!function(e){e[e.NONE=0]="NONE",e[e.VERBOSE=1]="VERBOSE",e[e.DEBUG=2]="DEBUG",e[e.INFO=3]="INFO",e[e.WARN=4]="WARN",e[e.ERROR=5]="ERROR"}(Ys||(Ys={}));var Js,Xs=function(){function e(){this.level=Ys.WARN}return e.prototype.verbose=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.level<=Ys.VERBOSE&&console.log.apply(console,Ze(["[verbose]"],Ye(e),!1))},e.prototype.debug=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.level<=Ys.DEBUG&&console.log.apply(console,Ze(["[debug]"],Ye(e),!1))},e.prototype.info=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.level<=Ys.INFO&&console.log.apply(console,Ze(["[info]"],Ye(e),!1))},e.prototype.warn=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.level<=Ys.WARN&&console.warn.apply(console,Ze(["[warn]"],Ye(e),!1))},e.prototype.error=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.level<=Ys.ERROR&&console.error.apply(console,Ze(["[error]"],Ye(e),!1))},e}(),$s={},eo=function(){function e(e,t){var n,r,i,a,s,o,u,l,c,d;if(this.connectedAt=0,this.firstConnectedAt=0,this.connectionHandlers=new Map,this.userEventHandlers=new Map,!$s[e]){$s[e]=this;var h=null!==(n=t.options)&&void 0!==n?n:new mt,f=this.sdkState={appId:t.appId,appVersion:null!==(r=t.appVersion)&&void 0!==r?r:"",appState:"foreground",userId:void 0,extensions:{},api:{host:null!==(i=t.apiHost)&&void 0!==i?i:"https://api-".concat(t.appId,".sendbird.com")},websocket:{host:null!==(a=t.websocketHost)&&void 0!==a?a:"wss://ws-".concat(t.appId,".sendbird.com"),pingerDisabled:!!t.noPingpong,pingInterval:void 0,pongTimeout:void 0,connectMaxRetry:2,compression:!0,reconnectMaxRetry:-1,reconnectRetryStrategy:new Is,responseTimeout:h.websocketResponseTimeout},sessionTokenRefreshTimeout:h.sessionTokenRefreshTimeout};this.appInfo=void 0,this.subscribedUnreadMessageCount={all:0,feed:0,customTypes:{},ts:0};var p=this.logger=new Xs;this.logger.level=null!==(s=t.logLevel)&&void 0!==s?s:Ys.WARN,this.connectedAt=0,this.firstConnectedAt=0,this.connectionHandlers=new Map,this.userEventHandlers=new Map;var _=this.cacheContext=new Et({encryption:t.encryption,store:t.store,localCacheEnabled:null!==(o=t.localCacheEnabled)&&void 0!==o&&o,localCacheConfig:null!==(u=t.localCacheConfig)&&void 0!==u?u:new wt});this.debugMode=null!==(l=t.debugMode)&&void 0!==l&&l,this.maxSuperGroupChannelUnreadCount=$e.DEFAULT_MAX_UNREAD_COUNT_OF_SUPER_GROUP_CHANNEL,this.useMemberInfoInMessage=h.useMemberInfoInMessage,this.typingIndicatorInvalidateTime=h.typingIndicatorInvalidateTime,this.typingIndicatorThrottle=h.typingIndicatorThrottle,this.concurrentCallLimit=void 0,this.backOffDelay=void 0;var v=this.dispatcher=new zt,m=new Rt;this.requestQueue=new Hs(e,{session:m,sdkState:f,dispatcher:v,logger:p,useFetchCompat:t.useFetchCompat}),this.sessionManager=new Bs({_iid:e,session:m,cacheContext:_,sdkState:f,dispatcher:v,requestQueue:this.requestQueue,logger:p}),this.connectionManager=new js(e,{sdkState:f,cacheContext:this.cacheContext,connectionHandlers:this.connectionHandlers,dispatcher:v,sessionManager:this.sessionManager,websocketClient:this.requestQueue.commandRouter.websocketClient,disableWebSocketCloseEventHandling:null!==(c=t.disableWebSocketCloseEventHandling)&&void 0!==c&&c,logger:p}),this.statLogCollector=new Zs({cacheContext:this.cacheContext,requestQueue:this.requestQueue,dispatcher:v}),this.appStateToggleEnabled=null===(d=t.appStateToggleEnabled)||void 0===d||d}return $s[e]}return e.of=function(e){if($s[e])return $s[e];throw st.lostInstance},e.clear=function(e){$s[e]&&delete $s[e]},e.prototype.hasExtension=function(e){return this.sdkState.extensions&&this.sdkState.extensions[e]},e}(),to=function(){function e(){}return e.prototype.init=function(e,t){var n=t.sdkState,r=t.dispatcher,i=t.sessionManager,a=t.requestQueue,s=t.logger;t.onlineDetector;var o=t.cacheContext;this._iid=e,this._cacheContext=o,this._sdkState=n,this._dispatcher=r,this._sessionManager=i,this._requestQueue=a,this._logger=s},e}();!function(e){e.OPEN="open",e.CLOSED="closed"}(Js||(Js={}));var no,ro="removed",io=function(e){switch(e){case"open":return Js.OPEN;case"closed":return Js.CLOSED;default:return null}},ao=function(e){return!e||!!e.text&&ct("string",e.text)},so=function(e){function t(t,n){var r,i,a,s,o,u,l,c=this;return(c=e.call(this,t)||this).pollId=0,c.id=0,c.text=null,c.voteCount=0,c.createdBy=null,c.createdAt=0,c.updatedAt=0,c._lastVotedAt=0,c.pollId=null!==(r=n.poll_id)&&void 0!==r?r:0,c.id=null!==(i=n.id)&&void 0!==i?i:0,c.text=null!==(a=n.text)&&void 0!==a?a:null,c.voteCount=null!==(s=n.vote_count)&&void 0!==s?s:0,c.createdBy=null!==(o=n.created_by)&&void 0!==o?o:null,c.createdAt=null!==(u=n.created_at)&&void 0!==u?u:0,c.updatedAt=null!==(l=n.updated_at)&&void 0!==l?l:0,c}return Be(t,e),t.payloadify=function(t){return qt(Vt(je(je({},e.payloadify.call(this,t)),{vote_count:t.voteCount,poll_id:t.pollId,text:t.text,created_at:t.createdAt,id:t.id,created_by:t.createdBy,updated_at:t.updatedAt})))},t}(ns),oo=function(e){function t(t,n){var r,i,a,s,o,u,l,c,d,h,f,p,_,v=this;return(v=e.call(this,t)||this).id=0,v.title=null,v.createdAt=0,v.updatedAt=0,v.closeAt=-1,v.status=Js.CLOSED,v.messageId=0,v.data=null,v.voterCount=-1,v.options=[],v.createdBy=null,v.allowUserSuggestion=!1,v.allowMultipleVotes=!1,v.votedPollOptionIds=[],v.id=null!==(r=n.id)&&void 0!==r?r:0,v.title=null!==(i=n.title)&&void 0!==i?i:null,v.createdAt=null!==(a=n.created_at)&&void 0!==a?a:0,v.updatedAt=null!==(s=n.updated_at)&&void 0!==s?s:0,v.closeAt=null!==(o=n.close_at)&&void 0!==o?o:-1,v.status=null!==(u=io(n.status))&&void 0!==u?u:Js.CLOSED,v.messageId=null!==(l=n.message_id)&&void 0!==l?l:0,v.data=null!==(c=n.data)&&void 0!==c?c:null,v.voterCount=null!==(d=n.voter_count)&&void 0!==d?d:-1,v.options=n.options?n.options.map((function(e){return new so(v._iid,e)})):[],v.createdBy=null!==(h=n.created_by)&&void 0!==h?h:null,v.allowUserSuggestion=null!==(f=n.allow_user_suggestion)&&void 0!==f&&f,v.allowMultipleVotes=null!==(p=n.allow_multiple_votes)&&void 0!==p&&p,v.votedPollOptionIds=null!==(_=n.voted_option_ids)&&void 0!==_?_:[],v}return Be(t,e),t.prototype._applyPollUpdatePayload=function(e){var t,n,r,i,a,s,o,u,l=this;this.title=null!==(t=e.title)&&void 0!==t?t:this.title,this.updatedAt=null!==(n=e.updated_at)&&void 0!==n?n:this.updatedAt,this.closeAt=null!==(r=e.close_at)&&void 0!==r?r:this.closeAt,this.status=null!==(i=io(e.status))&&void 0!==i?i:this.status,this.data=null!==(a=e.data)&&void 0!==a?a:this.data,this.voterCount=null!==(s=e.voter_count)&&void 0!==s?s:this.voterCount,e.options&&(this.options=e.options.map((function(e){return new so(l._iid,e)})),this.votedPollOptionIds=e.options.filter((function(e){return e.vote_count>0})).map((function(e){return e.id}))),this.allowUserSuggestion=null!==(o=e.allow_user_suggestion)&&void 0!==o?o:this.allowUserSuggestion,this.allowMultipleVotes=null!==(u=e.allow_multiple_votes)&&void 0!==u?u:this.allowMultipleVotes},t.payloadify=function(t){return qt(Vt(je(je({},e.payloadify.call(this,t)),{id:t.id,title:t.title,created_at:t.createdAt,updated_at:t.updatedAt,close_at:t.closeAt,status:t.status,message_id:t.messageId,data:t.data,voter_count:t.voterCount,options:t.options.map((function(e){return so.payloadify(e)})),created_by:t.createdBy,allow_user_suggestion:t.allowUserSuggestion,allow_multiple_votes:t.allowMultipleVotes,voted_option_ids:t.votedPollOptionIds})))},t.prototype.applyPollUpdateEvent=function(e){var t=e._payload.poll;return!(!t||this.id!==t.id||t.updated_at<this.updatedAt)&&(this._applyPollUpdatePayload(t),!0)},t.prototype.applyPollVoteEvent=function(e){if(this.id!==e.pollId)return!1;var t=this.options,n=t.map((function(e){return e.id})),r=e._payload,i=Math.floor(r.ts/1e3);return r.updated_vote_counts.forEach((function(e){var r=n.indexOf(e.option_id);if(r>-1){var a=t[r];i>=a._lastVotedAt&&(a.voteCount=e.vote_count,a._lastVotedAt=i)}})),r.req_id&&r.voted_option_ids&&(this.votedPollOptionIds=r.voted_option_ids),"number"==typeof r.voter_count&&(this.voterCount=r.voter_count),!0},t.prototype.serialize=function(){return cs(this)},t}(ns);!function(e){e.UNKNOWN="UNKNOWN",e.EVENT_CHANNEL_CREATED="EVENT_CHANNEL_CREATED",e.EVENT_CHANNEL_UPDATED="EVENT_CHANNEL_UPDATED",e.EVENT_CHANNEL_DELETED="EVENT_CHANNEL_DELETED",e.EVENT_CHANNEL_READ="EVENT_CHANNEL_READ",e.EVENT_CHANNEL_DELIVERED="EVENT_CHANNEL_DELIVERED",e.EVENT_CHANNEL_INVITED="EVENT_CHANNEL_INVITED",e.EVENT_CHANNEL_JOINED="EVENT_CHANNEL_JOINED",e.EVENT_CHANNEL_LEFT="EVENT_CHANNEL_LEFT",e.EVENT_CHANNEL_ACCEPTED_INVITE="EVENT_CHANNEL_ACCEPTED_INVITE",e.EVENT_CHANNEL_DECLINED_INVITE="EVENT_CHANNEL_DECLINED_INVITE",e.EVENT_CHANNEL_OPERATOR_UPDATED="EVENT_CHANNEL_OPERATOR_UPDATED",e.EVENT_CHANNEL_BANNED="EVENT_CHANNEL_BANNED",e.EVENT_CHANNEL_UNBANNED="EVENT_CHANNEL_UNBANNED",e.EVENT_CHANNEL_MUTED="EVENT_CHANNEL_MUTED",e.EVENT_CHANNEL_UNMUTED="EVENT_CHANNEL_UNMUTED",e.EVENT_CHANNEL_FROZEN="EVENT_CHANNEL_FROZEN",e.EVENT_CHANNEL_UNFROZEN="EVENT_CHANNEL_UNFROZEN",e.EVENT_CHANNEL_HIDDEN="EVENT_CHANNEL_HIDDEN",e.EVENT_CHANNEL_UNHIDDEN="EVENT_CHANNEL_UNHIDDEN",e.EVENT_CHANNEL_RESET_HISTORY="EVENT_CHANNEL_RESET_HISTORY",e.EVENT_CHANNEL_TYPING_STATUS_UPDATE="EVENT_CHANNEL_TYPING_STATUS_UPDATE",e.EVENT_CHANNEL_MEMBER_COUNT_UPDATED="EVENT_CHANNEL_MEMBER_COUNT_UPDATED",e.EVENT_CHANNEL_METADATA_CREATED="EVENT_CHANNEL_METADATA_CREATED",e.EVENT_CHANNEL_METADATA_UPDATED="EVENT_CHANNEL_METADATA_UPDATED",e.EVENT_CHANNEL_METADATA_DELETED="EVENT_CHANNEL_METADATA_DELETED",e.EVENT_CHANNEL_METACOUNTER_CREATED="EVENT_CHANNEL_METACOUNTER_CREATED",e.EVENT_CHANNEL_METACOUNTER_UPDATED="EVENT_CHANNEL_METACOUNTER_UPDATED",e.EVENT_CHANNEL_METACOUNTER_DELETED="EVENT_CHANNEL_METACOUNTER_DELETED",e.EVENT_MESSAGE_SENT="EVENT_MESSAGE_SENT",e.EVENT_MESSAGE_RECEIVED="EVENT_MESSAGE_RECEIVED",e.EVENT_MESSAGE_UPDATED="EVENT_MESSAGE_UPDATED",e.EVENT_PINNED_MESSAGE_UPDATED="EVENT_PINNED_MESSAGE_UPDATED",e.REQUEST_CHANNEL="REQUEST_CHANNEL",e.REQUEST_CHANNEL_CHANGELOGS="REQUEST_CHANNEL_CHANGELOGS",e.REFRESH_CHANNEL="REFRESH_CHANNEL",e.CHANNEL_LASTACCESSEDAT_UPDATED="CHANNEL_LASTACCESSEDAT_UPDATED",e.SYNC_CHANNEL_BACKGROUND="SYNC_CHANNEL_BACKGROUND",e.SYNC_CHANNEL_CHANGELOGS="SYNC_CHANNEL_CHANGELOGS",e.EVENT_MESSAGE_SENT_SUCCESS="EVENT_MESSAGE_SENT_SUCCESS",e.EVENT_MESSAGE_SENT_FAILED="EVENT_MESSAGE_SENT_FAILED",e.EVENT_MESSAGE_SENT_PENDING="EVENT_MESSAGE_SENT_PENDING",e.EVENT_MESSAGE_DELETED="EVENT_MESSAGE_DELETED",e.EVENT_MESSAGE_READ="EVENT_MESSAGE_READ",e.EVENT_MESSAGE_DELIVERED="EVENT_MESSAGE_DELIVERED",e.EVENT_MESSAGE_REACTION_UPDATED="EVENT_MESSAGE_REACTION_UPDATED",e.EVENT_MESSAGE_THREADINFO_UPDATED="EVENT_MESSAGE_THREADINFO_UPDATED",e.EVENT_MESSAGE_OFFSET_UPDATED="EVENT_MESSAGE_OFFSET_UPDATED",e.REQUEST_MESSAGE="REQUEST_MESSAGE",e.EVENT_POLL_UPDATED="EVENT_POLL_UPDATED",e.EVENT_POLL_VOTED="EVENT_POLL_VOTED",e.SYNC_POLL_CHANGELOGS="SYNC_POLL_CHANGELOGS",e.REQUEST_RESEND_MESSAGE="REQUEST_RESEND_MESSAGE",e.REQUEST_THREADED_MESSAGE="REQUEST_THREADED_MESSAGE",e.REQUEST_MESSAGE_CHANGELOGS="REQUEST_MESSAGE_CHANGELOGS",e.SYNC_MESSAGE_FILL="SYNC_MESSAGE_FILL",e.SYNC_MESSAGE_BACKGROUND="SYNC_MESSAGE_BACKGROUND",e.SYNC_MESSAGE_CHANGELOGS="SYNC_MESSAGE_CHANGELOGS",e.LOCAL_MESSAGE_PENDING_CREATED="LOCAL_MESSAGE_PENDING_CREATED",e.LOCAL_MESSAGE_FAILED="LOCAL_MESSAGE_FAILED",e.LOCAL_MESSAGE_CANCELED="LOCAL_MESSAGE_CANCELED",e.LOCAL_MESSAGE_RESEND_STARTED="LOCAL_MESSAGE_RESEND_STARTED"}(no||(no={}));je({},no);var uo,lo=function(e){return e.startsWith("EVENT_")||e.startsWith("LOCAL_MESSAGE_")||e===no.SYNC_MESSAGE_FILL||e===no.SYNC_MESSAGE_CHANGELOGS||e===no.SYNC_POLL_CHANGELOGS},co=function(e){function t(t){var n=t.messages,r=t.source,i=t.isWebSocketEventComing,a=void 0!==i&&i,s=e.call(this)||this;return s.messages=n,s.source=r,s.isWebSocketEventComing=a,s}return Be(t,e),t}(Ht),ho=function(e){function t(t){var n=t.messageIds,r=t.source,i=t.isWebSocketEventComing,a=void 0!==i&&i,s=e.call(this)||this;return s.messageIds=n,s.source=r,s.isWebSocketEventComing=a,s}return Be(t,e),t}(Ht),fo=function(e){function t(t){var n=t.reqId,r=t.source,i=e.call(this)||this;return i.reqId=n,i.source=r,i}return Be(t,e),t}(Ht),po=function(e){function t(t){var n=t.polls,r=t.source,i=e.call(this)||this;return i.polls=n,i.source=r,i}return Be(t,e),t}(Ht),_o=function(e){function t(t){var n=t.event,r=t.source,i=e.call(this)||this;return i.event=n,i.source=r,i}return Be(t,e),t}(Ht),vo=function(e){function t(t){var n=t.event,r=t.source,i=e.call(this)||this;return i.event=n,i.source=r,i}return Be(t,e),t}(Ht),mo=function(){function e(e,t){var n;this.limit=20,this._isLoading=!1,this._hasNext=!0,this._token="",this._iid=e,this.limit=null!==(n=t.limit)&&void 0!==n?n:20}return Object.defineProperty(e.prototype,"hasNext",{get:function(){return this._hasNext},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isLoading",{get:function(){return this._isLoading},enumerable:!1,configurable:!0}),e.prototype._validate=function(){return ct("number",this.limit)&&this.limit>0},e}(),go=function(e){function t(t,n,r,i){var a=e.call(this,t,i)||this;return a.channelUrl=n,a.channelType=r,a}return Be(t,e),t.prototype._validate=function(){return e.prototype._validate.call(this)&&ct("string",this.channelUrl)&&dt(St,this.channelType)},t}(mo),yo=function(e){this.pollId=0,this.messageId=0,this.pollId=e.poll_id,this.messageId=e.message_id,this._payload=e},Eo=function(e){function t(t){var n=t.title,r=t.optionTexts,i=t.data,a=t.allowUserSuggestion,s=t.allowMultipleVotes,o=t.closeAt,u=e.call(this)||this;return u.method=Gt.POST,u.path=tn,u.params={title:n,options:r,data:i,allow_user_suggestion:a,allow_multiple_votes:s,close_at:o},u}return Be(t,e),t}(hn),bo=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.poll=new oo(t,n),r}return Be(t,e),t}(fn),Co=function(e){function t(t){var n=t.channelUrl,r=t.channelType,i=t.pollId,a=e.call(this)||this;return a.method=Gt.GET,a.path="".concat(tn,"/").concat(encodeURIComponent(i)),a.params={channel_url:n,channel_type:r},a}return Be(t,e),t}(hn),wo=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.poll=new oo(t,n),r}return Be(t,e),t}(fn),So=function(e){function t(t){var n=t.channelUrl,r=t.channelType,i=t.pollId,a=t.pollOptionId,s=e.call(this)||this;return s.method=Gt.GET,s.path="".concat(tn,"/").concat(encodeURIComponent(i),"/options/").concat(encodeURIComponent(a)),s.params={channel_url:n,channel_type:r},s}return Be(t,e),t}(hn),To=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.pollOption=new so(t,n),r}return Be(t,e),t}(fn),Io=function(e){function t(t){var n=t.channelType,r=t.channelUrl,i=t.timestamp,a=t.token,s=e.call(this)||this;return s.method=Gt.GET,s.path="".concat(sn(n),"/").concat(encodeURIComponent(r),"/polls/changelogs"),s.params=qt({change_ts:i,token:a}),s}return Be(t,e),t}(hn),No=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.updatedPolls=n.updated.map((function(e){return function(e,t){return new oo(e,t)}(t,e)})),r.deletedPollIds=n.deleted.map((function(e){return e})),r.hasMore=n.has_more,r.nextToken=n.next,r}return Be(t,e),t}(fn),Ao={title:"",optionTexts:[],data:void 0,allowUserSuggestion:void 0,allowMultipleVotes:void 0,closeAt:-1},ko=function(e){return ct("string",e.title)&&(t=e.optionTexts,ft("string",t)&&t.every((function(e){return""!==e.trim()})))&&ao(e.data)&&ct("boolean",e.allowUserSuggestion,!0)&&ct("boolean",e.allowMultipleVotes,!0)&&ct("number",e.closeAt,!0);var t},Mo={channelUrl:"",channelType:St.BASE,pollId:0,pollOptionId:0},Uo=function(e){return ct("string",e.channelUrl)&&""!==e.channelUrl&&dt(St,e.channelType)&&ct("number",e.pollId)&&e.pollId>0&&ct("number",e.pollOptionId)&&e.pollOptionId>0},Oo={channelUrl:"",channelType:St.BASE,pollId:0},Do=function(e){return ct("string",e.channelUrl)&&""!==e.channelUrl&&dt(St,e.channelType)&&ct("number",e.pollId)},Lo={},Ro=function(){function e(e,t){var n=t.sdkState,r=t.dispatcher,i=t.sessionManager,a=t.requestQueue,s=t.logger;this._iid=e,this._sdkState=n,this._sessionManager=i,this._requestQueue=a,this._dispatcher=r,this._logger=s,Lo[e]=this}return e.of=function(e){return Lo[e]},e.prototype.buildPollFromSerializedData=function(e){var t=ds(e);return new oo(this._iid,oo.payloadify(t))},e.prototype.get=function(e){return Qe(this,void 0,void 0,(function(){var t;return Ke(this,(function(n){switch(n.label){case 0:return hs(Do(e)).throw(st.invalidParameters),t=new Co(je({},e)),[4,this._requestQueue.send(t)];case 1:return[2,n.sent().as(wo).poll]}}))}))},e.prototype.create=function(e){return Qe(this,void 0,void 0,(function(){var t;return Ke(this,(function(n){switch(n.label){case 0:return hs(ko(e)).throw(st.invalidParameters),t=new Eo(je({},e)),[4,this._requestQueue.send(t)];case 1:return[2,n.sent().as(bo).poll]}}))}))},e.prototype.getOption=function(e){return Qe(this,void 0,void 0,(function(){var t;return Ke(this,(function(n){switch(n.label){case 0:return hs(Uo(e)).throw(st.invalidParameters),t=new So(je({},e)),[4,this._requestQueue.send(t)];case 1:return[2,n.sent().as(To).pollOption]}}))}))},e.prototype.getPollChangeLogs=function(e,t,n,r){return void 0===r&&(r=no.SYNC_POLL_CHANGELOGS),Qe(this,void 0,void 0,(function(){var i,a,s,o,u,l,c;return Ke(this,(function(d){switch(d.label){case 0:return i=new Io(Vt({channelType:t,channelUrl:e,timestamp:"number"==typeof n?n:null,token:"string"==typeof n?n:null})),[4,this._requestQueue.send(i)];case 1:return a=d.sent(),s=a.as(No),o=s.updatedPolls,u=s.deletedPollIds,l=s.hasMore,c=s.nextToken,o.length>0&&this._dispatcher.dispatch(new po({polls:o,source:r})),[2,{updatedPolls:o,deletedPollIds:u,hasMore:l,token:c}]}}))}))},e}(),xo=function(e){function t(t){var n=t.channelUrl,r=t.channelType,i=t.token,a=t.limit,s=e.call(this)||this;return s.method=Gt.GET,s.path=tn,s.params={channel_url:n,channel_type:r,token:i,limit:a},s}return Be(t,e),t}(hn),Po=function(e){function t(t,n){var r,i=this;return(i=e.call(this,t,n)||this).polls=(null!==(r=n.polls)&&void 0!==r?r:[]).map((function(e){return new oo(t,e)})),i.token=n.next,i}return Be(t,e),t}(fn),Fo=function(e){function t(t,n){return e.call(this,t,n.channelUrl,n.channelType,n)||this}return Be(t,e),t.prototype.next=function(){return Qe(this,void 0,void 0,(function(){var e,t,n,r,i,a;return Ke(this,(function(s){switch(s.label){case 0:return this._validate()?this._isLoading?[3,3]:this._hasNext?(this._isLoading=!0,e=eo.of(this._iid).requestQueue,t=new xo(je(je({},this),{token:this._token})),[4,e.send(t)]):[3,2]:[3,5];case 1:return n=s.sent(),r=n.as(Po),i=r.polls,a=r.token,this._token=a,this._hasNext=!!a,this._isLoading=!1,[2,i];case 2:return[2,[]];case 3:throw st.queryInProgress;case 4:return[3,6];case 5:throw st.invalidParameters;case 6:return[2]}}))}))},t}(go),zo=function(e){function t(t){var n=t.channelUrl,r=t.channelType,i=t.pollId,a=t.pollOptionId,s=t.token,o=t.limit,u=e.call(this)||this;return u.method=Gt.GET,u.path="".concat(tn,"/").concat(encodeURIComponent(i),"/options/").concat(encodeURIComponent(a),"/voters"),u.params={channel_url:n,channel_type:r,token:s,limit:o},u}return Be(t,e),t}(hn),Ho=function(e){function t(t,n){var r,i=this;return(i=e.call(this,t,n)||this).voters=(null!==(r=n.voters)&&void 0!==r?r:[]).map((function(e){return new ps(t,e)})),i.token=n.next,i}return Be(t,e),t}(fn),qo=function(e){function t(t,n){var r=e.call(this,t,n.channelUrl,n.channelType,n)||this;return r.pollId=n.pollId,r.pollOptionId=n.pollOptionId,r}return Be(t,e),t.prototype._validate=function(){return e.prototype._validate.call(this)&&ct("number",this.pollId)&&ct("number",this.pollOptionId)},t.prototype.next=function(){return Qe(this,void 0,void 0,(function(){var e,t,n,r,i,a;return Ke(this,(function(s){switch(s.label){case 0:return this._validate()?this._isLoading?[3,3]:this._hasNext?(this._isLoading=!0,e=eo.of(this._iid).requestQueue,t=new zo(je(je({},this),{pollId:this.pollId,pollOptionId:this.pollOptionId,token:this._token})),[4,e.send(t)]):[3,2]:[3,5];case 1:return n=s.sent(),r=n.as(Ho),i=r.voters,a=r.token,this._token=a,this._hasNext=!!a,this._isLoading=!1,[2,i];case 2:return[2,[]];case 3:throw st.queryInProgress;case 4:return[3,6];case 5:throw st.invalidParameters;case 6:return[2]}}))}))},t}(go),Vo=function(e){function t(t){var n=e.call(this)||this;if(n.method=Gt.POST,n.path="".concat(Qt),n.params=qt({file:t.file,channel_url:t.channelUrl}),t.thumbnailSizes)for(var r=0;r<t.thumbnailSizes.length;r++){var i=t.thumbnailSizes[r],a=i.maxWidth,s=i.maxHeight;n.params["thumbnail".concat(r+1)]="".concat(a,",").concat(s)}return n.requestId=t.requestId,n}return Be(t,e),t}(hn),Go=function(e){function t(t,n){var r,i,a,s=this;return(s=e.call(this,t,n)||this).url=n.url,s.fileSize=null!==(r=n.file_size)&&void 0!==r?r:0,s.thumbnailSizes=null!==(i=n.thumbnails)&&void 0!==i?i:[],s.requireAuth=null!==(a=n.require_auth)&&void 0!==a&&a,s}return Be(t,e),t}(fn),Bo=function(e){function t(t,n){var r,i,a,s=this;return(s=e.call(this,t)||this).replyCount=0,s.lastRepliedAt=0,s.updatedAt=0,s.replyCount=null!==(r=n.reply_count)&&void 0!==r?r:0,s.mostRepliedUsers=n.most_replies&&ft("object",n.most_replies)?n.most_replies.map((function(e){return new ps(s._iid,e)})):[],s.lastRepliedAt=null!==(i=n.last_replied_at)&&void 0!==i?i:0,s.updatedAt=null!==(a=n.updated_at)&&void 0!==a?a:0,s}return Be(t,e),t.payloadify=function(t){return qt(Vt(je(je({},e.payloadify.call(this,t)),{reply_count:t.replyCount,most_replies:Array.isArray(t.mostRepliedUsers)?t.mostRepliedUsers.map((function(e){return ps.payloadify(e)})):[],last_replied_at:t.lastRepliedAt,updated_at:t.updatedAt})))},t}(ns);!function(e){e.ADD="add",e.DELETE="delete"}(uo||(uo={}));var jo,Qo,Ko=function(e){this.messageId=0,this.operation=null,this.updatedAt=0;var t=ct("string",e.msg_id)?parseInt(e.msg_id):e.msg_id,n=e.user_id,r=e.operation?e.operation.toLowerCase():null,i=e.reaction,a=e.updated_at;t&&ct("string",n)&&ct("string",r)&&dt(uo,r)&&ct("string",i)&&i&&ct("number",a)&&(this.messageId=t,this.userId=n,this.key=i,this.operation=r,this.updatedAt=a)},Wo=function(){function e(e){var t,n,r,i=e.key,a=null!==(r=Ze([],Ye(e.user_ids),!1))&&void 0!==r?r:[],s=e.updated_at;ct("string",i)&&i&&ft("string",a)&&a.length>0&&ct("number",s)&&(this.key=i,this.userIds=a,this.updatedAt=s);var o={};try{for(var u=We(this.userIds),l=u.next();!l.done;l=u.next())o[l.value]=this.updatedAt}catch(e){t={error:e}}finally{try{l&&!l.done&&(n=u.return)&&n.call(u)}finally{if(t)throw t.error}}this._version=o}return Object.defineProperty(e.prototype,"isEmpty",{get:function(){return 0===this.userIds.length},enumerable:!1,configurable:!0}),e.payloadify=function(e){return qt(Vt({key:e.key,user_ids:e.userIds,updated_at:e.updatedAt}))},e.prototype.applyEvent=function(e){if(e.key===this.key&&this.updatedAt<=e.updatedAt){if(!this._version[e.userId]||this._version[e.userId]<=e.updatedAt){var t=this.userIds.indexOf(e.userId);switch(e.operation){case uo.ADD:t<0&&this.userIds.push(e.userId);break;case uo.DELETE:t>=0&&this.userIds.splice(t,1)}this._version[e.userId]=e.updatedAt}this.updatedAt=Math.max(this.updatedAt,e.updatedAt)}},e}(),Yo=function(){function e(e){this.secureUrl=null,this.type=null,this.width=0,this.height=0,this.alt=null,this.url=e.url,e.secure_url&&(this.secureUrl=e.secure_url),e.type&&(this.type=e.type),e.width&&(this.width=e.width),e.height&&(this.height=e.height),e.alt&&(this.alt=e.alt)}return e.payloadify=function(e){var t,n;return qt(Vt({url:e.url,secure_url:e.secureUrl,type:e.type,width:null!==(t=e.width)&&void 0!==t?t:0,height:null!==(n=e.height)&&void 0!==n?n:0,alt:e.alt}))},e}(),Zo=function(){function e(e){this.title=null,this.url=null,this.description=null,this.defaultImage=null,e["og:title"]&&(this.title=e["og:title"]),e["og:url"]&&(this.url=e["og:url"]),e["og:description"]&&(this.description=e["og:description"]),e["og:image"]&&(this.defaultImage=new Yo(e["og:image"]))}return e.payloadify=function(e){return qt(Vt({"og:title":e.title,"og:url":e.url,"og:description":e.description,"og:image":e.defaultImage?Yo.payloadify(e.defaultImage):null}))},e}(),Jo=function(){function e(e){var t,n;this.volume=0,this.name=null!==(t=e.name)&&void 0!==t?t:"default",this.volume=null!==(n=e.volume)&&void 0!==n?n:1}return e.prototype.serialize=function(){return{name:this.name,volume:this.volume}},e.payloadify=function(e){return qt(Vt({name:e.name,volume:e.volume}))},e}(),Xo=function(e){function t(t,n){var r,i=this;return(i=e.call(this,t,n)||this).isBlockedByMe=!1,i.role=dt(Tt,n.role)?n.role:Tt.NONE,i.isBlockedByMe=null!==(r=n.is_blocked_by_me)&&void 0!==r&&r,i}return Be(t,e),t.payloadify=function(t){return qt(Vt(je(je({},e.payloadify.call(this,t)),{role:t.role,is_blocked_by_me:t.isBlockedByMe})))},t}(ps),$o=function(){function e(e){this.key=e.key,this.value=ft("string",e.value)?Ze([],Ye(e.value),!1):[]}return e.payloadify=function(e){var t;return qt(Vt({key:e.key,value:null!==(t=e.value)&&void 0!==t?t:[]}))},e}(),eu=function(e){switch(e){case Nt.BASE:return"";case Nt.USER:return"MESG";case Nt.FILE:return"FILE";case Nt.ADMIN:return"ADMM"}},tu=function(e){function t(t,n){var r,i,a,s,o,u,l,c,d,h,f=this;(f=e.call(this,t)||this).channelType=St.BASE,f.messageType=Nt.BASE,f.mentionType=null,f.mentionedUsers=null,f.mentionedUserIds=null,f.metaArrays=[],f.extendedMessage={},f.createdAt=0,f.updatedAt=0,f.channelUrl=n.channel_url,f.channelType=dt(St,n.channel_type)?n.channel_type:St.GROUP,n.channel&&(n.channel.channel_url&&(f.channelUrl=n.channel.channel_url),n.channel.channel_type&&(f.channelType=n.channel.channel_type)),f.data=null!==(r=n.data)&&void 0!==r?r:"",f.customType=null!==(i=n.custom_type)&&void 0!==i?i:"",f.mentionType=dt(Mt,n.mention_type)?n.mention_type:null,f.mentionedUsers=n.mentioned_users?n.mentioned_users.map((function(e){return new ps(f._iid,e)})):null,f.mentionedUserIds=null!==(a=n.mentioned_user_ids)&&void 0!==a?a:null,f.mentionedUsers&&!f.mentionedUserIds&&(f.mentionedUserIds=f.mentionedUsers.map((function(e){return e.userId}))),f.mentionedMessageTemplate=null!==(s=n.mentioned_message_template)&&void 0!==s?s:"";var p=null!==(o=n.metaarray)&&void 0!==o?o:{},_=null!==(u=n.metaarray_key_order)&&void 0!==u?u:Object.keys(p).sort((function(e,t){return e.localeCompare(t)}));f.metaArrays=[];for(var v=0;v<_.length;v++){var m=_[v];f.metaArrays.push(new $o({key:m,value:p[m]||[]}))}return n.sorted_metaarray&&(f.metaArrays=n.sorted_metaarray.map((function(e){return new $o(e)}))),f.extendedMessage=null!==(l=n.extended_message)&&void 0!==l?l:{},f.extendedMessagePayload=n.extended_message_payload,f.createdAt=null!==(d=null!==(c=n.created_at)&&void 0!==c?c:n.ts)&&void 0!==d?d:0,f.updatedAt=null!==(h=n.updated_at)&&void 0!==h?h:0,f}return Be(t,e),t.payloadify=function(t){var n,r;return qt(Vt(je(je({},e.payloadify.call(this,t)),{channel_url:t.channelUrl,channel_type:t.channelType,type:eu(t.messageType),data:t.data,custom_type:t.customType,mention_type:t.mentionType,mentioned_user_ids:t.mentionedUserIds,mentioned_users:null===(n=t.mentionedUsers)||void 0===n?void 0:n.map((function(e){return ps.payloadify(e)})),mentioned_message_template:t.mentionedMessageTemplate,sorted_metaarray:null===(r=t.metaArrays)||void 0===r?void 0:r.map((function(e){return $o.payloadify(e)})),extended_message:t.extendedMessage,extended_message_payload:t.extendedMessagePayload,created_at:t.createdAt,updated_at:t.updatedAt})))},t.prototype.isIdentical=function(e){return!0},t.prototype.isEqual=function(e){return lt(this,e)},t.prototype.isUserMessage=function(){return this.messageType===Nt.USER},t.prototype.isFileMessage=function(){return this.messageType===Nt.FILE&&!Object.prototype.hasOwnProperty.call(this,"fileInfoList")},t.prototype.isMultipleFilesMessage=function(){return this.messageType===Nt.FILE&&Object.prototype.hasOwnProperty.call(this,"fileInfoList")},t.prototype.isAdminMessage=function(){return this.messageType===Nt.ADMIN},t.prototype.serialize=function(){return cs(this)},t.prototype.getMetaArraysByKeys=function(e){return this.metaArrays.filter((function(t){return e.includes(t.key)}))},t}(ns),nu=function(e){function t(t){var n=e.call(this)||this;return n.method=Gt.POST,n.path=function(e,t){return"/".concat(Bt,"/group_channels/").concat(e,"/messages/").concat(t,"/submit_forms")}(t.channelUrl,t.messageId),n.params=qt({forms:t.forms}),n}return Be(t,e),t}(hn);!function(e){e.PENDING="pending",e.SENT="sent",e.FAILED="failed",e.CANCELED="canceled"}(jo||(jo={})),function(e){e.PENDING="pending",e.IN_QUEUE="in_queue",e.SENT="sent",e.FAILED="failed",e.CANCELED="canceled",e.REMOVED="removed"}(Qo||(Qo={}));var ru,iu=function(e){function t(t,n){var r,i,a,s,o,u,l,c=this;return(c=e.call(this,t,n)||this).parentMessage=null,c.silent=!1,c.isOperatorMessage=!1,c.threadInfo=null,c.reactions=[],c.appleCriticalAlertOptions=null,c.scheduledInfo=null,c.suggestedReplies=null,c._isContinuousMessages=!1,c._scheduledStatus=null,c.messageId=null!==(i=null!==(r=n.msg_id)&&void 0!==r?r:n.message_id)&&void 0!==i?i:0,c.parentMessageId=null!==(a="string"==typeof n.parent_message_id?parseInt(n.parent_message_id):n.parent_message_id)&&void 0!==a?a:0,c.threadInfo=n.thread_info?new Bo(c._iid,n.thread_info):null,c.reactions=n.reactions?n.reactions.map((function(e){return new Wo(e)})):[],c.ogMetaData=n.og_tag?new Zo(n.og_tag):null,c.silent=null!==(s=n.silent)&&void 0!==s&&s,c.isOperatorMessage=null!==(o=n.is_op_msg)&&void 0!==o&&o,c.appleCriticalAlertOptions=n.apple_critical_alert_options?new Jo(n.apple_critical_alert_options):null,"number"==typeof n.scheduled_message_id&&"number"==typeof n.scheduled_at&&n.scheduled_status&&(c.scheduledInfo={scheduledMessageId:n.scheduled_message_id,scheduledAt:n.scheduled_at},c._scheduledStatus=n.scheduled_status),c._isContinuousMessages=null!==(u=n.is_continuous_messages)&&void 0!==u&&u,c.suggestedReplies=null!==(l=n.suggested_replies)&&void 0!==l?l:null,c}return Be(t,e),t.payloadify=function(t){var n,r;return qt(Vt(je(je({},e.payloadify.call(this,t)),{message_id:t.messageId,parent_message_id:t.parentMessageId,thread_info:t.threadInfo?Bo.payloadify(t.threadInfo):null,reactions:t.reactions.map((function(e){return Wo.payloadify(e)})),og_tag:t.ogMetaData?Zo.payloadify(t.ogMetaData):null,silent:t.silent,is_op_msg:t.isOperatorMessage,apple_critical_alert_options:t.appleCriticalAlertOptions?Jo.payloadify(t.appleCriticalAlertOptions):null,scheduled_message_id:null===(n=t.scheduledInfo)||void 0===n?void 0:n.scheduledMessageId,scheduled_at:null===(r=t.scheduledInfo)||void 0===r?void 0:r.scheduledAt,scheduled_status:t._scheduledStatus,suggested_replies:t.suggestedReplies})))},t._getParentMessageInfoPayload=function(e){return qt(Vt({type:eu(e.messageType),ts:e.createdAt,user:e.sender?Xo.payloadify(e.sender):null,message:e.message,file:{url:e.plainUrl,name:e.name,type:e.type,require_auth:e.requireAuth}}))},t.prototype.isIdentical=function(e){return this.messageId===e.messageId},t.prototype.applyThreadInfoUpdateEvent=function(e){return this.messageId===e.targetMessageId&&(this.threadInfo=e.threadInfo),!1},t.prototype.applyReactionEvent=function(e){if(this.messageId===e.messageId){for(var t=!1,n=0;n<this.reactions.length;n++)if(this.reactions[n].key===e.key){this.reactions[n].applyEvent(e),this.reactions[n].isEmpty&&this.reactions.splice(n,1),t=!0;break}t||"add"!==e.operation||this.reactions.push(new Wo(Wo.payloadify({key:e.key,userIds:[e.userId],updatedAt:e.updatedAt})))}},t.prototype.applyParentMessage=function(e){if(!this.parentMessage)return this.parentMessage=e,!0;if(this.parentMessageId===e.messageId){var t=this.parentMessage.updatedAt;if(e.updatedAt>=t)return this.parentMessage=e,!0}return!1},t.prototype.submitForm=function(e){return Qe(this,void 0,void 0,(function(){var t,n,r,i;return Ke(this,(function(a){switch(a.label){case 0:return t=eo.of(this._iid),n=t.requestQueue,r=t.sdkState,i=new nu({userId:r.userId,channelUrl:this.channelUrl,channelType:this.channelType,messageId:this.messageId,forms:[{form_key:e.formId,data:e.answers}]}),[4,n.send(i)];case 1:return a.sent(),[2]}}))}))},t}(tu),au=function(e){function t(t,n){var r,i,a,s,o=this;if((o=e.call(this,t,n)||this).reqId="",o.replyToChannel=!1,o.errorCode=0,o.sender=n.user?new Xo(o._iid,n.user):n.sender_id,o.reqId=null!==(i=null!==(r=n.req_id)&&void 0!==r?r:n.request_id)&&void 0!==i?i:"",o.replyToChannel=null!==(a=n.reply_to_channel)&&void 0!==a&&a,n.request_state&&dt(Dt,n.request_state)&&(o.sendingStatus=n.request_state),!o.sendingStatus)if(o.messageId>0)o.sendingStatus=Dt.SUCCEEDED;else if(o.scheduledInfo)switch(n.scheduled_status&&(o._scheduledStatus=n.scheduled_status),n.scheduled_status){case Qo.SENT:case Qo.IN_QUEUE:o.sendingStatus=Dt.SUCCEEDED;break;case Qo.PENDING:o.sendingStatus=Dt.SCHEDULED;break;case Qo.FAILED:case Qo.REMOVED:o.sendingStatus=Dt.FAILED;break;case Qo.CANCELED:o.sendingStatus=Dt.CANCELED}else o.sendingStatus=Dt.PENDING;return o.errorCode=null!==(s=n.error_code)&&void 0!==s?s:0,o}return Be(t,e),t.payloadify=function(t){return qt(Vt(je(je({},e.payloadify.call(this,t)),{user:Xo.payloadify(t.sender),req_id:t.reqId,reply_to_channel:t.replyToChannel,request_state:t.sendingStatus,error_code:t.errorCode})))},Object.defineProperty(t.prototype,"isResendable",{get:function(){return(this.sendingStatus===Dt.FAILED||this.sendingStatus===Dt.CANCELED)&&function(e){return e>0&&ot.indexOf(e)>=0}(this.errorCode)},enumerable:!1,configurable:!0}),t.prototype.isIdentical=function(e){return this.messageId>0&&e.messageId>0?this.messageId===e.messageId:this.reqId===e.reqId},t}(iu),su=function(){function e(e,t,n){var r,i;this.width=0,this.height=0,this.realWidth=0,this.realHeight=0,this._requireAuth=!1,this._iid=e,this.plainUrl=t.url,this.width=t.width,this.height=t.height,this.realWidth=null!==(r=t.real_width)&&void 0!==r?r:t.width,this.realHeight=null!==(i=t.real_height)&&void 0!==i?i:t.height,this._requireAuth=n}return e.payloadify=function(e){return qt(Vt({url:"",width:e.maxWidth,height:e.maxHeight,real_width:0,real_height:0}))},Object.defineProperty(e.prototype,"url",{get:function(){var e=eo.of(this._iid).sessionManager;return this._requireAuth?"".concat(this.plainUrl,"?auth=").concat(e.ekey):this.plainUrl},enumerable:!1,configurable:!0}),e}(),ou={prevResultSize:0,nextResultSize:0,isInclusive:!1,reverse:!1,messageTypeFilter:At.ALL,customTypesFilter:void 0,senderUserIdsFilter:void 0,includeReactions:!1,includeMetaArray:!1,includeParentMessageInfo:!1},uu=function(e){return ct("number",e.prevResultSize)&&ct("number",e.nextResultSize)&&ct("boolean",e.isInclusive)&&ct("boolean",e.reverse)&&ct("string",e.messageTypeFilter)&&dt(At,e.messageTypeFilter)&&ft("string",e.customTypesFilter,!0)&&ft("string",e.senderUserIdsFilter,!0)&&ct("boolean",e.includeMetaArray)&&ct("boolean",e.includeReactions)&&ct("boolean",e.includeParentMessageInfo)},lu=function(e){function t(t,n){var r,i,a,s,o=this;if((o=e.call(this,t,n)||this).translations={},o.message=null!==(r=n.message)&&void 0!==r?r:"",o.messageType=Nt.ADMIN,o.translations=null!==(i=n.translations)&&void 0!==i?i:{},n.parent_message_info){var u=n.parent_message_info;o.parentMessage=gu(t,qt(Vt(je(je({},u),{message_id:o.parentMessageId,channel_url:o.channelUrl,channel_type:o.channelType,file:u.file,url:null===(a=u.file)||void 0===a?void 0:a.url,require_auth:null===(s=u.file)||void 0===s?void 0:s.require_auth}))))}return o}return Be(t,e),t.payloadify=function(t){return qt(Vt(je(je({},e.payloadify.call(this,t)),{message:t.message,translations:t.translations,parent_message_info:t.parentMessage?e._getParentMessageInfoPayload.call(this,t.parentMessage):null})))},t.prototype.getThreadedMessagesByTimestamp=function(e,t){return Qe(this,void 0,void 0,(function(){var n;return Ke(this,(function(r){switch(r.label){case 0:return n=je(je({},ou),t),hs(this.messageId>0&&ct("number",e)&&uu(n)).throw(st.invalidParameters),[4,vh.of(this._iid).getThreadedMessagesByTimestamp(this,e,n)];case 1:return[2,r.sent()]}}))}))},t}(iu),cu=function(){function e(e){var t,n;this.detail={},this.type=null!==(t=e.type)&&void 0!==t?t:"",this.vendor=null!==(n=e.vendor)&&void 0!==n?n:"",e.detail&&ct("object",e.detail)&&!Array.isArray(e.detail)&&(this.detail=e.detail)}return e.payloadify=function(e){return qt(Vt({type:e.type,vendor:e.vendor,detail:e.detail}))},e}(),du=function(){function e(e){this.status=e.status,e.original_message_info&&(this.originalMessageInfo={createdAt:e.original_message_info.ts,messageId:e.original_message_info.id})}return e.payloadify=function(e){return qt({status:e.status,original_message_info:e.originalMessageInfo?{id:e.originalMessageInfo.messageId,ts:e.originalMessageInfo.createdAt}:void 0})},e}(),hu=function(e){function t(t,n){var r,i,a,s,o,u,l,c=this;if((c=e.call(this,t,n)||this).message="",c.messageParams=null,c.translations={},c.translationTargetLanguages=[],c.messageSurvivalSeconds=-1,c.plugins=[],c._poll=null,c.message=n.message,c.messageType=Nt.USER,c.translations=null!==(a=n.translations)&&void 0!==a?a:{},c.translationTargetLanguages=null!==(s=n.target_langs)&&void 0!==s?s:[],0===Object.keys(c.translations).length&&c.translationTargetLanguages.length>0)try{for(var d=We(c.translationTargetLanguages),h=d.next();!h.done;h=d.next()){var f=h.value;c.translations[f]=""}}catch(t){r={error:t}}finally{try{h&&!h.done&&(i=d.return)&&i.call(d)}finally{if(r)throw r.error}}if(c.messageSurvivalSeconds=null!==(o=n.message_survival_seconds)&&void 0!==o?o:-1,c.plugins=n.plugins?n.plugins.map((function(e){return new cu(e)})):[],c._poll=n.poll?new oo(c._iid,n.poll):null,n.parent_message_info){var p=n.parent_message_info;c.parentMessage=gu(t,qt(Vt(je(je({},p),{created_at:p.ts,message_id:c.parentMessageId,channel_url:c.channelUrl,channel_type:c.channelType,file:p.file,url:null===(u=p.file)||void 0===u?void 0:u.url,require_auth:null===(l=p.file)||void 0===l?void 0:l.require_auth}))))}return n.review_info&&(c.messageReviewInfo=new du(n.review_info)),c}return Be(t,e),t.payloadify=function(t){return qt(Vt(je(je({},e.payloadify.call(this,t)),{message:t.message,translations:t.translations,message_survival_seconds:t.messageSurvivalSeconds,plugins:t.plugins.map((function(e){return cu.payloadify(e)})),poll:t._poll?oo.payloadify(t._poll):null,parent_message_info:t.parentMessage?e._getParentMessageInfoPayload.call(this,t.parentMessage):null,review_info:t.messageReviewInfo?du.payloadify(t.messageReviewInfo):void 0})))},t.prototype.getThreadedMessagesByTimestamp=function(e,t){return Qe(this,void 0,void 0,(function(){var n;return Ke(this,(function(r){switch(r.label){case 0:return n=je(je({},ou),t),hs(this.messageId>0&&ct("number",e)&&uu(n)).throw(st.invalidParameters),[4,vh.of(this._iid).getThreadedMessagesByTimestamp(this,e,n)];case 1:return[2,r.sent()]}}))}))},t.prototype.applyPoll=function(e){return!(this._poll&&this._poll.id===e.id&&this._poll.updatedAt>e.updatedAt)&&(this._poll=e,!0)},Object.defineProperty(t.prototype,"poll",{get:function(){return this._poll},enumerable:!1,configurable:!0}),t}(au),fu=function(e){function t(t,n){var r,i,a,s,o,u=this;return(u=e.call(this,t)||this).plainUrl="",u.fileName=null,u.mimeType=null,u.fileSize=0,u.thumbnails=[],u._requireAuth=!1,u.plainUrl=null!==(r=n.url)&&void 0!==r?r:"",u.fileName=null!==(i=n.file_name)&&void 0!==i?i:null,u.mimeType=null!==(a=n.file_type)&&void 0!==a?a:null,u.fileSize=null!==(s=n.file_size)&&void 0!==s?s:0,u._requireAuth=null!==(o=n.require_auth)&&void 0!==o&&o,u.thumbnails=n.thumbnails?n.thumbnails.map((function(e){var t;return new su(u._iid,"string"==typeof e?{url:e,width:0,height:0}:je(je({},e),{url:(null!==(t=e.url)&&void 0!==t?t:"").split("auth=")[0]}),u._requireAuth)})):[],u}return Be(t,e),t.payloadify=function(e){var t;return qt(Vt({url:e.plainUrl,file_name:e.fileName,file_type:e.mimeType,file_size:e.fileSize,thumbnails:null===(t=e.thumbnails)||void 0===t?void 0:t.map((function(e){return{url:e.url,width:e.width,height:e.height,real_width:e.realWidth,real_height:e.realHeight}})),require_auth:e._requireAuth}))},Object.defineProperty(t.prototype,"url",{get:function(){var e=eo.of(this._iid).sessionManager;return this._requireAuth?"".concat(this.plainUrl,"?auth=").concat(e.ekey):this.plainUrl},enumerable:!1,configurable:!0}),t}(ns),pu=function(e){function t(t,n){var r,i,a,s,o,u=this;if((u=e.call(this,t,n)||this).messageParams=null,u.fileInfoList=[],u.messageSurvivalSeconds=-1,u.messageType=Nt.FILE,u.fileInfoList=null!==(i=null===(r=n.files)||void 0===r?void 0:r.map((function(e){return new fu(t,e)})))&&void 0!==i?i:[],u.messageSurvivalSeconds=null!==(a=n.message_survival_seconds)&&void 0!==a?a:-1,n.parent_message_info){var l=n.parent_message_info;u.parentMessage=gu(t,qt(Vt(je(je({},l),{created_at:l.ts,message_id:u.parentMessageId,channel_url:u.channelUrl,channel_type:u.channelType,file:l.file,url:null===(s=l.file)||void 0===s?void 0:s.url,require_auth:null===(o=l.file)||void 0===o?void 0:o.require_auth}))))}return u}return Be(t,e),t.prototype.getThreadedMessagesByTimestamp=function(e,t){return Qe(this,void 0,void 0,(function(){var n;return Ke(this,(function(r){switch(r.label){case 0:return n=je(je({},ou),t),hs(this.messageId>0&&ct("number",e)&&uu(n)).throw(st.invalidParameters),[4,vh.of(this._iid).getThreadedMessagesByTimestamp(this,e,n)];case 1:return[2,r.sent()]}}))}))},t.payloadify=function(t){return qt(Vt(je(je({},e.payloadify.call(this,t)),{files:t.fileInfoList&&t.fileInfoList&&Array.isArray(t.fileInfoList)?t.fileInfoList.map((function(e){return fu.payloadify(e)})):null,message_survival_seconds:t.messageSurvivalSeconds,parent_message_info:t.parentMessage?e._getParentMessageInfoPayload.call(this,t.parentMessage):null})))},t._isMultipleFilesMessagePayload=function(e){var t=e.files;return Array.isArray(t)&&t.length>=2},t._isMultipleFilesMessageSerializedData=function(e){var t=e.fileInfoList;return Array.isArray(t)},t}(au);!function(e){e.SENT="SENT",e.READ="READ"}(ru||(ru={}));var _u,vu=function(e){function t(t,n){var r,i=this;if((i=e.call(this,t,n)||this).notificationData=null,i.notificationId=n.notification_message_id,i.messageType=Nt.ADMIN,i.messageStatus=null!==(r=n.message_status)&&void 0!==r?r:ru.SENT,0===i.extendedMessage.sub_type)try{var a=JSON.parse(i.extendedMessage.sub_data),s=a.label,o=a.tags,u=void 0===o?[]:o,l=a.template_key,c=a.template_variables;i.notificationData={label:s,tags:u,templateKey:l,templateVariables:c}}catch(t){}return i}return Be(t,e),t.payloadify=function(t){return qt(Vt(je(je({},e.payloadify.call(this,t)),{notification_message_id:t.notificationId,message_status:t.messageStatus})))},t.prototype.isIdentical=function(e){return this.notificationId===e.notificationId},t}(tu),mu=function(e){if(e.notificationId)return vu.payloadify(e);switch(e.messageType){case Nt.USER:return hu.payloadify(e);case Nt.FILE:return e.fileInfoList?pu.payloadify(e):yu.payloadify(e);case Nt.ADMIN:return lu.payloadify(e);default:throw st.unknown}},gu=function(e,t){if(t.notification_message_id)return new vu(e,t);switch(t.type){case"MESG":return new hu(e,t);case"FILE":return pu._isMultipleFilesMessagePayload(t)?new pu(e,t):new yu(e,t);case"ADMM":case"BRDM":return new lu(e,t);default:return null}},yu=function(e){function t(t,n){var r,i,a,s,o,u,l,c,d,h,f,p,_,v,m=this;(m=e.call(this,t,n)||this).messageParams=null,m.plainUrl="",m.requireAuth=!1,m.thumbnails=[],m.messageSurvivalSeconds=-1,m.messageType=Nt.FILE;var g=n.file;if(m.plainUrl=(null!==(i=null!==(r=null==g?void 0:g.url)&&void 0!==r?r:n.url)&&void 0!==i?i:"").split("?auth=")[0],m.name=null!==(s=null!==(a=null==g?void 0:g.name)&&void 0!==a?a:n.name)&&void 0!==s?s:"File",m.size=null!==(u=null!==(o=null==g?void 0:g.size)&&void 0!==o?o:n.size)&&void 0!==u?u:0,m.data=null!==(c=null!==(l=null==g?void 0:g.data)&&void 0!==l?l:n.custom)&&void 0!==c?c:"",m.type=g?null!==(d=g.type)&&void 0!==d?d:"":null!==(h=n.type)&&void 0!==h?h:"",m.requireAuth=null!==(f=n.require_auth)&&void 0!==f&&f,m.thumbnails=n.thumbnails?n.thumbnails.map((function(e){var t;return new su(m._iid,"string"==typeof e?{url:e,width:0,height:0}:je(je({},e),{url:(null!==(t=e.url)&&void 0!==t?t:"").split("auth=")[0]}),m.requireAuth)})):[],m.messageSurvivalSeconds=null!==(p=n.message_survival_seconds)&&void 0!==p?p:-1,n.parent_message_info){var y=n.parent_message_info;m.parentMessage=gu(t,qt(Vt(je(je({},y),{created_at:y.ts,message_id:m.parentMessageId,channel_url:m.channelUrl,channel_type:m.channelType,file:y.file,url:null===(_=y.file)||void 0===_?void 0:_.url,require_auth:null===(v=y.file)||void 0===v?void 0:v.require_auth}))))}return m}return Be(t,e),t.payloadify=function(t){var n;return qt(Vt(je(je({},e.payloadify.call(this,t)),{url:t.plainUrl,require_auth:t.requireAuth,file:{name:t.name,size:t.size,type:t.type,data:t.data},thumbnails:null===(n=t.thumbnails)||void 0===n?void 0:n.map((function(e){return{url:e.plainUrl,width:e.width,height:e.height,real_width:e.realWidth,real_height:e.realHeight}})),message_survival_seconds:t.messageSurvivalSeconds,parent_message_info:t.parentMessage?e._getParentMessageInfoPayload.call(this,t.parentMessage):null})))},Object.defineProperty(t.prototype,"url",{get:function(){var e=eo.of(this._iid).sessionManager;return this.requireAuth?"".concat(this.plainUrl,"?auth=").concat(e.ekey):this.plainUrl},enumerable:!1,configurable:!0}),t.prototype.getThreadedMessagesByTimestamp=function(e,t){return Qe(this,void 0,void 0,(function(){var n;return Ke(this,(function(r){switch(r.label){case 0:return n=je(je({},ou),t),hs(this.messageId>0&&ct("number",e)&&uu(n)).throw(st.invalidParameters),[4,vh.of(this._iid).getThreadedMessagesByTimestamp(this,e,n)];case 1:return[2,r.sent()]}}))}))},t}(au),Eu=function(e){function t(t,n){var r=n.file,i=n.fileUrl,a=n.fileName,s=n.fileSize,o=n.mimeType,u=n.thumbnailSizes,l=n._uploadedMetaData,c=e.call(this,t)||this;return c._plainUrl=i,c.file=r,c.fileName=a,c.fileSize=s,c.mimeType=o,c.thumbnailSizes=u,c._uploadedMetaData=l,c}return Be(t,e),t.getPlainUrl=function(e){return e instanceof t?e._plainUrl:e.fileUrl},Object.defineProperty(t.prototype,"fileUrl",{get:function(){var e;if(this._plainUrl&&(null===(e=this._uploadedMetaData)||void 0===e?void 0:e.requireAuth)){var t=eo.of(this._iid).sessionManager;return"".concat(this._plainUrl,"?auth=").concat(t.ekey)}return this._plainUrl},set:function(e){this._plainUrl=e},enumerable:!1,configurable:!0}),t.prototype.toJSON=function(){return{file:this.file,fileUrl:this._plainUrl,fileName:this.fileName,fileSize:this.fileSize,mimeType:this.mimeType,thumbnailSizes:this.thumbnailSizes,_uploadedMetaData:this._uploadedMetaData}},t}(ns),bu=function(e){function t(t){var n,r,i,a=[];return t.mentionType===Mt.USERS&&(t.mentionedUserIds?a=t.mentionedUserIds:t.mentionedUsers&&(a=t.mentionedUsers.map((function(e){return e.userId})))),e.call(this,{code:"FILE",ackRequired:!0,payload:qt(Vt({channel_url:t.channelUrl,files:t.files?Tu(t.files):null,url:t.url,name:null!==(n=t.fileName)&&void 0!==n?n:"",type:null!==(r=t.mimeType)&&void 0!==r?r:"",size:null!==(i=t.fileSize)&&void 0!==i?i:0,custom:t.data,custom_type:t.customType,thumbnails:t.thumbnailSizes,require_auth:t.requireAuth,metaarray:t.metaArrays,mention_type:t.mentionType,mentioned_user_ids:a,push_option:t.pushNotificationDeliveryOption&&t.pushNotificationDeliveryOption!==Ot.DEFAULT?t.pushNotificationDeliveryOption:void 0,apple_critical_alert_options:t.appleCriticalAlertOptions?Jo.payloadify(t.appleCriticalAlertOptions):null,silent:t.silent,reply_to_channel:t.isReplyToChannel,parent_message_id:t.parentMessageId?t.parentMessageId:null,req_id:t.reqId,pin_message:t.isPinnedMessage}))})||this}return Be(t,e),t}(mn),Cu=function(e){function t(t){var n,r,i=this;i=e.call(this)||this;var a=[];return t.mentionType===Mt.USERS&&(t.mentionedUserIds?a=t.mentionedUserIds:t.mentionedUsers&&(a=t.mentionedUsers.map((function(e){return e.userId})))),i.method=Gt.POST,i.path="".concat(sn(t.channelType),"/").concat(encodeURIComponent(t.channelUrl),"/messages"),i.params=qt(Vt({message_type:Nt.FILE,user_id:t.userId,files:t.files?Tu(t.files):null,url:t.fileUrl,mention_type:t.mentionType,mentioned_user_ids:a,file_name:t.fileName,file_size:t.fileSize,file_type:t.mimeType,data:t.data,custom_type:t.customType,thumbnails:null===(n=t.thumbnailSizes)||void 0===n?void 0:n.map((function(e){return su.payloadify(e)})),require_auth:t.requireAuth,sorted_metaarray:null===(r=t.metaArrays)||void 0===r?void 0:r.map((function(e){return $o.payloadify(e)})),push_option:t.pushNotificationDeliveryOption,parent_message_id:t.parentMessageId?t.parentMessageId:null,apple_critical_alert_options:t.appleCriticalAlertOptions?Jo.payloadify(t.appleCriticalAlertOptions):null,reply_to_channel:t.isReplyToChannel,req_id:t.reqId,pin_message:t.isPinnedMessage})),i}return Be(t,e),t}(hn),wu=function(e){function t(t,n,r){var i,a,s,o,u=this;(u=e.call(this,t,"FILE",r)||this).message=r.files&&r.files.length>=2?new pu(t,r):new yu(t,r);var l=eo.of(t).sdkState;return u.isMentioned=un(u.message.mentionType,null!==(s=null!==(i=u.message.mentionedUserIds)&&void 0!==i?i:null===(a=u.message.mentionedUsers)||void 0===a?void 0:a.map((function(e){return e.userId})))&&void 0!==s?s:[],l.userId),u.forceUpdateLastMessage=null!==(o=r.force_update_last_message)&&void 0!==o&&o,u}return Be(t,e),t}(vn),Su=function(e){function t(t,n){var r,i,a,s,o=this;(o=e.call(this,t,n)||this).message=n.files&&n.files.length>=2?new pu(t,n):new yu(t,n);var u=eo.of(t).sdkState;return o.isMentioned=un(o.message.mentionType,null!==(a=null!==(r=o.message.mentionedUserIds)&&void 0!==r?r:null===(i=o.message.mentionedUsers)||void 0===i?void 0:i.map((function(e){return e.userId})))&&void 0!==a?a:[],u.userId),o.forceUpdateLastMessage=null!==(s=n.force_update_last_message)&&void 0!==s&&s,o}return Be(t,e),t}(fn);function Tu(e){return e.map((function(e){var t,n;return qt(Vt({url:Eu.getPlainUrl(e),file_name:e.fileName,file_type:e.mimeType,file_size:e.fileSize,thumbnails:null===(t=e.thumbnailSizes)||void 0===t?void 0:t.map((function(e){return su.payloadify(e)})),require_auth:null===(n=e._uploadedMetaData)||void 0===n?void 0:n.requireAuth}))}))}!function(e){e[e.PENDING=0]="PENDING",e[e.UPLOADING=1]="UPLOADING",e[e.UPLOADED=2]="UPLOADED",e[e.SENDING=3]="SENDING",e[e.FAILED=4]="FAILED"}(_u||(_u={}));var Iu,Nu=function(){function e(e,t){var n=t.sdkState,r=t.dispatcher,i=t.requestQueue,a=t.onlineDetector,s=t.cacheContext,o=this;this._queueMap=new Map,this._iid=e,this._sdkState=n,this._requestQueue=i,this._cacheContext=s,this._dispatcher=r,this._dispatcher.on((function(e){e instanceof Ka&&(o._connectionState=e.stateType)})),this._onlineDetector=a}return Object.defineProperty(e.prototype,"_shouldSendThroughWebSocket",{get:function(){return this._connectionState===Ga.CONNECTED||this._connectionState===Ga.CONNECTING||this._connectionState===Ga.RECONNECTING},enumerable:!1,configurable:!0}),e.prototype._sendFileMessage=function(e,t){return Qe(this,void 0,void 0,(function(){var n,r;return Ke(this,(function(i){switch(i.label){case 0:return n=this._createSendFileMessageRequestParams(e,t),this._shouldSendThroughWebSocket?(r=new bu(n),[4,this._requestQueue.send(r)]):[3,2];case 1:return[2,i.sent().as(wu).message];case 2:return r=new Cu(je(je({},n),{userId:this._sdkState.userId})),[4,this._requestQueue.send(r)];case 3:return[2,i.sent().as(Su).message]}}))}))},e.prototype._createSendFileMessageRequestParams=function(e,t){var n=je(je({},t.params),{channelUrl:e.url,channelType:e.channelType,reqId:t.requestId,url:""});if(t.multipleFileUploadInfo){var r=t.params;n.files=r.fileInfoList}else r=t.params,n.url=r.fileUrl,n.requireAuth=r.requireAuth;return n},e.prototype._resolveMessageQueue=function(e){var t;return Qe(this,void 0,void 0,(function(){var n,r,i,a,s,o,u,l,c,d,h,f,p;return Ke(this,(function(_){switch(_.label){case 0:if(!(n=this._queueMap.get(e.url)))return[3,21];if(n.isResolving)return[3,20];n.isResolving=!0,r=[],i=!0,_.label=1;case 1:_.trys.push([1,15,16,17]),a=We(n.messageQueue),s=a.next(),_.label=2;case 2:if(s.done)return[3,14];switch((o=s.value).state){case _u.PENDING:case _u.UPLOADING:return[3,3];case _u.UPLOADED:return[3,4];case _u.FAILED:return[3,12]}return[3,13];case 3:return i=!1,r.push(o),[3,13];case 4:if(!i)return[3,10];_.label=5;case 5:return _.trys.push([5,8,,9]),o.state=_u.SENDING,[4,this._sendFileMessage(e,o)];case 6:return u=_.sent(),o.deferred.resolve(u),[4,Ts(100)];case 7:return _.sent(),[3,9];case 8:return l=_.sent(),o.deferred.reject(l),[3,9];case 9:return[3,11];case 10:r.push(o),_.label=11;case 11:return[3,13];case 12:return c=null!==(t=o.error)&&void 0!==t?t:st.unknown,o.deferred.reject(c.code===Je.REQUEST_CANCELED?st.fileUploadCanceled:c),[3,13];case 13:return s=a.next(),[3,2];case 14:return[3,17];case 15:return d=_.sent(),f={error:d},[3,17];case 16:try{s&&!s.done&&(p=a.return)&&p.call(a)}finally{if(f)throw f.error}return[7];case 17:return h=n.isResolveRequestPending,n.messageQueue=r,n.isResolving=!1,n.isResolveRequestPending=!1,h?[4,this._resolveMessageQueue(e)]:[3,19];case 18:_.sent(),_.label=19;case 19:return[3,21];case 20:n.isResolveRequestPending=!0,_.label=21;case 21:return[2]}}))}))},e.prototype._uploadNextPendingItem=function(e){var t;return Qe(this,void 0,void 0,(function(){var n,r,i,a,s,o,u,l,c,d;return Ke(this,(function(h){switch(h.label){case 0:return(n=this._queueMap.get(e.url))&&(r=n.messageQueue.find((function(e){return e.state===_u.PENDING})))?r.multipleFileUploadInfo?(i=r.multipleFileUploadInfo,a=i.uploadIndex,s=i.uploadCount,o=i.requestHandler,d=r.params,u=d.fileInfoList[a],!vt(u.file)||(null===(t=u._uploadedMetaData)||void 0===t?void 0:t.isUploaded)?[3,2]:[4,this._tryUploadNextItemAndUpdateItemState(e,n,r)]):[3,4]:[3,9];case 1:return h.sent(),[3,3];case 2:r.state=a<s-1?_u.PENDING:_u.UPLOADED,h.label=3;case 3:return l=d.fileInfoList[a],c=r.multipleFileUploadInfo.uploadIndex++,r.multipleFileUploadInfo.isCopy||null==o||o._triggerOnFileUploaded(r.requestId,c,l,r.error),[3,7];case 4:return d=r.params,vt(d.file)?[4,this._tryUploadNextItemAndUpdateItemState(e,n,r)]:[3,6];case 5:return h.sent(),[3,7];case 6:d.thumbnailSizes=[],r.state=_u.UPLOADED,h.label=7;case 7:return this._uploadNextPendingItem(e),[4,this._resolveMessageQueue(e)];case 8:h.sent(),h.label=9;case 9:return[2]}}))}))},e.prototype._tryUploadNextItemAndUpdateItemState=function(e,t,n){return Qe(this,void 0,void 0,(function(){var r,i,a,s,o,u;return Ke(this,(function(l){switch(l.label){case 0:return[4,this._onlineDetector.isOnline()];case 1:if(r=l.sent(),!eo.of(this._iid).sessionManager.currentUser||!r)return n.error=st.connectionRequired,n.state=_u.FAILED,[2];if(!(t.uploadQueue.length<6))return[3,9];n.state=_u.UPLOADING,t.uploadQueue.push(n),l.label=2;case 2:return l.trys.push([2,7,,8]),n.multipleFileUploadInfo?(i=n.multipleFileUploadInfo,a=i.uploadIndex,s=i.uploadCount,o=n.params,[4,this._uploadNextFileForMultipleFilesItemAndUpdateParams(e,n,o)]):[3,4];case 3:return l.sent(),n.state=a<s-1?_u.PENDING:_u.UPLOADED,[3,6];case 4:return o=n.params,[4,this._uploadNextFileForSingleFileItemAndUpdateParams(e,n,o)];case 5:l.sent(),n.state=_u.UPLOADED,l.label=6;case 6:return[3,8];case 7:switch((u=l.sent()).code){case Je.REQUEST_FAILED:n.error=new st({code:Je.NETWORK_ERROR,message:"Failed to upload a file."});break;case Je.REQUEST_CANCELED:n.error=st.fileUploadCanceled;break;default:n.error=u}return n.state=_u.FAILED,[3,8];case 8:this._dequeueUploadItem(t,n),l.label=9;case 9:return[2]}}))}))},e.prototype._dequeueUploadItem=function(e,t){var n=e.uploadQueue.findIndex((function(e){return e.requestId===t.requestId}));n>=0&&e.uploadQueue.splice(n,1)},e.prototype._uploadNextFileForSingleFileItemAndUpdateParams=function(e,t,n){var r,i,a;return Qe(this,void 0,void 0,(function(){var s,o,u,l,c,d,h,f,p,_;return Ke(this,(function(v){switch(v.label){case 0:return s=new Vo({file:n.file,channelUrl:e.url,thumbnailSizes:n.thumbnailSizes,requestId:t.requestId}),[4,this._requestQueue.send(s)];case 1:return o=v.sent(),u=o.as(Go),l=u.url,c=u.fileSize,d=void 0===c?n.fileSize:c,h=u.thumbnailSizes,f=void 0===h?n.thumbnailSizes:h,p=u.requireAuth,_=void 0!==p&&p,n.fileName=null!==(r=n.fileName)&&void 0!==r?r:n.file.name,n.mimeType=null!==(i=n.mimeType)&&void 0!==i?i:n.file.type,n.fileSize=null!==(a=n.fileSize)&&void 0!==a?a:n.file.size,n.fileUrl=l,n.fileSize=d,n.thumbnailSizes=f,n.requireAuth=_,[2]}}))}))},e.prototype._uploadNextFileForMultipleFilesItemAndUpdateParams=function(e,t,n){var r,i,a;return Qe(this,void 0,void 0,(function(){var s,o,u,l,c,d,h,f,p,_,v,m;return Ke(this,(function(g){switch(g.label){case 0:return s=t.multipleFileUploadInfo.uploadIndex,o=n.fileInfoList[s],u=new Vo({file:o.file,channelUrl:e.url,thumbnailSizes:o.thumbnailSizes,requestId:t.requestId}),[4,this._requestQueue.send(u)];case 1:return l=g.sent(),c=l.as(Go),d=c.url,h=c.fileSize,f=void 0===h?o.fileSize:h,p=c.thumbnailSizes,_=void 0===p?o.thumbnailSizes:p,v=c.requireAuth,m=void 0!==v&&v,o.fileName=null!==(r=o.fileName)&&void 0!==r?r:o.file.name,o.mimeType=null!==(i=o.mimeType)&&void 0!==i?i:o.file.type,o.fileSize=null!==(a=o.fileSize)&&void 0!==a?a:o.file.size,o.file=void 0,o.fileUrl=d,o.fileSize=f,o.thumbnailSizes=_,o._uploadedMetaData=je(je({},o._uploadedMetaData),{requireAuth:m,isUploaded:!0}),o instanceof Eu||(n.fileInfoList[s]=new Eu(this._iid,o)),[2]}}))}))},e.prototype.request=function(e,t,n,r){return void 0===r&&(r={}),Qe(this,void 0,void 0,(function(){var i,a,s,o,u;return Ke(this,(function(l){return this._queueMap.has(e.url)||(i={messageQueue:[],uploadQueue:[],isResolving:!1,isResolveRequestPending:!1},this._queueMap.set(e.url,i)),a=this._queueMap.get(e.url),s=new Un,o={requestId:t,params:n,state:_u.PENDING,deferred:s},function(e){return"fileInfoList"in e}(n)&&(u=je({uploadIndex:0,uploadCount:n.fileInfoList.length},r),o.multipleFileUploadInfo=u),a.messageQueue.push(o),this._uploadNextPendingItem(e),[2,s.promise]}))}))},e.prototype.cancel=function(e,t){var n,r,i=this._queueMap.get(e.url);if(i){var a=t?[i.messageQueue.find((function(e){return e.requestId===t}))]:Ze([],Ye(i.messageQueue),!1);try{for(var s=We(a),o=s.next();!o.done;o=s.next()){var u=o.value;if(u)switch(u.state){case _u.PENDING:if(u.state=_u.FAILED,u.error=st.requestCanceled,u.multipleFileUploadInfo&&!u.multipleFileUploadInfo.isCopy){var l=u.multipleFileUploadInfo,c=l.uploadIndex,d=l.requestHandler,h=u.params.fileInfoList[c];null==d||d._triggerOnFileUploaded(u.requestId,c,h,st.fileUploadCanceled)}this._resolveMessageQueue(e);break;case _u.UPLOADING:this._requestQueue.cancel(u.requestId)}}}catch(e){n={error:e}}finally{try{o&&!o.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}}},e}(),Au={prevResultSize:0,nextResultSize:0,isInclusive:!1,reverse:!1,messageTypeFilter:At.ALL,customTypesFilter:void 0,senderUserIdsFilter:void 0,replyType:Ut.NONE,includeReactions:!1,includeMetaArray:!1,includeParentMessageInfo:!1,includeThreadInfo:!1,showSubchannelMessagesOnly:!1},ku=function(e){return ct("number",e.prevResultSize)&&ct("number",e.nextResultSize)&&ct("boolean",e.isInclusive)&&ct("boolean",e.reverse)&&ct("string",e.messageTypeFilter)&&dt(At,e.messageTypeFilter)&&ft("string",e.customTypesFilter,!0)&&ft("string",e.senderUserIdsFilter,!0)&&dt(Ut,e.replyType)&&ct("boolean",e.includeMetaArray)&&ct("boolean",e.includeReactions)&&ct("boolean",e.includeParentMessageInfo)&&ct("boolean",e.includeThreadInfo)&&ct("boolean",e.showSubchannelMessagesOnly)},Mu={replyType:Ut.NONE,includeReactions:!1,includeThreadInfo:!1,includeMetaArray:!1,includeParentMessageInfo:!1},Uu=function(e){return dt(Ut,e.replyType)&&ct("boolean",e.includeReactions)&&ct("boolean",e.includeMetaArray)&&ct("boolean",e.includeParentMessageInfo)&&ct("boolean",e.includeThreadInfo)},Ou=function(e){function t(t){var n=t.channelType,r=t.channelUrl,i=t.messageId,a=t.includeMetaArray,s=t.includeReactions,o=t.includeThreadInfo,u=t.includeParentMessageInfo,l=e.call(this)||this;return l.method=Gt.GET,l.path="".concat(sn(n),"/").concat(encodeURIComponent(r),"/messages/").concat(encodeURIComponent(i)),l.params={is_sdk:!0,with_sorted_meta_array:a,include_reactions:s,include_thread_info:o,include_parent_message_info:u,include_poll_details:!0},l}return Be(t,e),t}(hn),Du=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.message=n?gu(t,je({},n)):null,r}return Be(t,e),t}(fn),Lu=function(e){function t(t){var n=t.channelType,r=t.channelUrl,i=t.timestamp,a=t.token,s=t.prevResultSize,o=t.nextResultSize,u=t.isInclusive,l=t.reverse,c=t.messageTypeFilter,d=t.customTypesFilter,h=t.senderUserIdsFilter,f=t.replyType,p=t.includeMetaArray,_=t.includeReactions,v=t.parentMessageId,m=t.includeThreadInfo,g=t.includeParentMessageInfo,y=t.showSubchannelMessagesOnly,E=t.checkingHasNext,b=t.checkingContinuousMessages,C=e.call(this)||this;return C.method=Gt.GET,C.path="".concat(sn(n),"/").concat(encodeURIComponent(r),"/messages"),C.params=qt(Vt({is_sdk:!0,prev_limit:s,next_limit:o,include:u,reverse:l,message_ts:i,message_id:a,message_type:null!=c?c:null,custom_types:d,sender_ids:h,include_reply_type:f,with_sorted_meta_array:p,include_reactions:_,parent_message_id:v,include_thread_info:m,include_parent_message_info:g,show_subchannel_message_only:y,include_poll_details:!0,checking_has_next:E,checking_continuous_messages:b})),C}return Be(t,e),t}(hn),Ru=function(e){function t(t,n){var r=e.call(this,t,n)||this;return void 0!==n.is_continuous_messages&&(r.isContinuousMessages=n.is_continuous_messages),void 0!==n.has_next&&(r.hasNext=n.has_next),r.messages=n.messages.map((function(e){return gu(t,e)})),r}return Be(t,e),t}(fn),xu=function(e){function t(t){var n=t.channelType,r=t.channelUrl,i=t.timestamp,a=t.token,s=t.replyType,o=t.includeMetaArray,u=t.includeReactions,l=t.includeThreadInfo,c=t.includeParentMessageInfo,d=e.call(this)||this;return d.method=Gt.GET,d.path="".concat(sn(n),"/").concat(encodeURIComponent(r),"/messages/changelogs"),d.params={change_ts:i,token:a,with_sorted_meta_array:o,include_reactions:u,include_thread_info:l,include_reply_type:s,include_parent_message_info:c,include_poll_details:!0},d}return Be(t,e),t}(hn),Pu=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.updatedMessages=n.updated.map((function(e){return gu(t,e)})),r.deletedMessagesInfo=n.deleted.map((function(e){return{messageId:e.message_id,deletedAt:e.deleted_at}})),r.hasMore=n.has_more,r.nextToken=n.next,r}return Be(t,e),t}(fn),Fu=function(e){function t(t){var n=t.channelUrl,r=t.scheduledMessageId,i=e.call(this)||this;return i.method=Gt.GET,i.path="".concat(Kt,"/").concat(encodeURIComponent(n),"/scheduled_messages/").concat(encodeURIComponent(r)),i.params={},i}return Be(t,e),t}(hn),zu=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.message=n?gu(t,je({},n)):null,r}return Be(t,e),t}(fn);!function(e){e.MUTED="muted",e.BANNED="banned"}(Iu||(Iu={}));var Hu=function(){function e(e){var t,n,r,i;this.restrictionType=null,dt(Iu,e.restriction_type)&&(this.restrictionType=e.restriction_type),this.description=null!==(t=e.description)&&void 0!==t?t:null,this.endAt=null!==(r=null!==(n=e.end_at)&&void 0!==n?n:e.muted_end_at)&&void 0!==r?r:-1,this.remainingDuration=null!==(i=e.remaining_duration)&&void 0!==i?i:-1}return e.payloadify=function(e){return qt(Vt({restriction_type:e.restrictionType,description:e.description,end_at:e.endAt,remaining_duration:e.remainingDuration}))},e}(),qu=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.restrictionInfo=new Hu(n),r}return Be(t,e),t.payloadify=function(t){return qt(Vt(je(je({},e.payloadify.call(this,t)),Hu.payloadify(t.restrictionInfo))))},t}(ps),Vu=function(e){function t(t,n){var r,i=this;return(i=e.call(this,t,n)||this).isMuted=!1,i.isMuted=null!==(r=n.is_muted)&&void 0!==r&&r,i}return Be(t,e),t}(ps),Gu=function(){function e(){this._onPending=Dn,this._onFailed=Dn,this._onSucceeded=Dn}return e.prototype._trigger=function(e){switch(null==e?void 0:e.sendingStatus){case Dt.PENDING:0===e.errorCode&&this._onPending(e);break;case Dt.SCHEDULED:case Dt.SUCCEEDED:this._onSucceeded(e)}},e.prototype._triggerFailed=function(e,t){switch(null==t?void 0:t.sendingStatus){case Dt.FAILED:case Dt.CANCELED:this._onFailed(e,t.scheduledInfo?null:t)}},e.prototype.onPending=function(e){return this._onPending=e,this},e.prototype.onFailed=function(e){return this._onFailed=e,this},e.prototype.onSucceeded=function(e){return this._onSucceeded=e,this},e}(),Bu={data:void 0,customType:void 0,mentionType:Mt.USERS,mentionedUserIds:void 0,mentionedUsers:void 0,mentionedMessageTemplate:void 0,metaArrays:void 0,parentMessageId:void 0,isReplyToChannel:!1,pushNotificationDeliveryOption:void 0,appleCriticalAlertOptions:void 0,isPinnedMessage:!1},ju=function(e){return ct("string",e.data,!0)&&ct("string",e.customType,!0)&&dt(Mt,e.mentionType)&&ft("string",e.mentionedUserIds,!0)&&ft(ps,e.mentionedUsers,!0)&&ct("string",e.mentionedMessageTemplate,!0)&&ft($o,e.metaArrays,!0)&&ct("number",e.parentMessageId,!0)&&ct("boolean",e.isReplyToChannel)&&dt(Ot,e.pushNotificationDeliveryOption,!0)&&ct(Jo,e.appleCriticalAlertOptions,!0)&&ct("boolean",e.isPinnedMessage,!0)},Qu=function(e){return{isReplyToChannel:e.isReplyToChannel,pushNotificationDeliveryOption:e.pushNotificationDeliveryOption,pollId:e.pollId}},Ku=je(je({},Bu),{message:"",translationTargetLanguages:void 0,pollId:void 0});function Wu(e){var t,n,r;return null!==(t=e.messageParams)&&void 0!==t?t:Vt(je(je({},e),{mentionType:e.mentionType,mentionedUserIds:null!==(n=e.mentionedUserIds)&&void 0!==n?n:null===(r=e.mentionedUsers)||void 0===r?void 0:r.map((function(e){return e.userId})),translationTargetLanguages:Object.keys(e.translations),pushNotificationDeliveryOption:Ot.DEFAULT,parentMessageId:null,isReplyToChannel:!1,isPinnedMessage:!1}))}var Yu,Zu=function(e){var t;return qt(Vt({data:e.data,customType:e.customType,mentionType:e.mentionType,mentionedUsers:e.mentionedUsers,mentionedUserIds:e.mentionedUserIds,mentionedMessageTemplate:e.mentionedMessageTemplate,metaArrays:e.metaArrays,pollId:null===(t=e.poll)||void 0===t?void 0:t.id,parentMessageId:e.parentMessageId,appleCriticalAlertOptions:e.appleCriticalAlertOptions,message:e.message,translationTargetLanguages:Object.keys(e.translations)}))},Ju=function(e){return ju(e)&&ct("string",e.message)&&ft("string",e.translationTargetLanguages,!0)&&ct("number",e.pollId,!0)};!function(e){e.FILE="file",e.BLOB="blob",e.BLOB_LIKE_OBJECT="blobLikeObject",e.URL="url"}(Yu||(Yu={}));var Xu=function(e){return"undefined"!=typeof window&&"Blob"in window&&"undefined"!=typeof Blob&&e instanceof Blob},$u=function(e){return e===Yu.BLOB||e===Yu.FILE},el=function(e){return{file:e.file,fileKey:e.fileKey,fileType:e.fileType,isReplyToChannel:e.isReplyToChannel,pushNotificationDeliveryOption:e.pushNotificationDeliveryOption}},tl=je(je({},Bu),{file:void 0,fileKey:void 0,fileUrl:void 0,fileName:void 0,fileType:void 0,fileSize:void 0,mimeType:void 0,thumbnailSizes:void 0,requireAuth:!1});function nl(e){var t,n,r,i;return null!==(t=e.messageParams)&&void 0!==t?t:Vt(je(je({},e),{fileUrl:e.plainUrl,fileName:e.name,fileSize:e.size,mimeType:e.type,mentionType:e.mentionType,mentionedUserIds:null!==(n=e.mentionedUserIds)&&void 0!==n?n:null===(r=e.mentionedUsers)||void 0===r?void 0:r.map((function(e){return e.userId})),pushNotificationDeliveryOption:Ot.DEFAULT,parentMessageId:null,isReplyToChannel:!1,thumbnailSizes:null===(i=e.thumbnails)||void 0===i?void 0:i.map((function(e){return{maxWidth:e.width,maxHeight:e.height}})),requireAuth:e.requireAuth,isPinnedMessage:!1}))}var rl,il=function(e,t){var n;return e.messageParams?(!e.url&&vt(t)&&(e.messageParams.file=t),e.messageParams):qt(Vt({data:e.data,customType:e.customType,mentionType:e.mentionType,mentionedUsers:e.mentionedUsers,mentionedUserIds:e.mentionedUserIds,metaArrays:e.metaArrays,parentMessageId:e.parentMessageId,appleCriticalAlertOptions:e.appleCriticalAlertOptions,file:t,fileUrl:e.url,fileName:e.name,fileSize:e.size,mimeType:e.type,thumbnailSizes:null===(n=e.thumbnails)||void 0===n?void 0:n.map((function(e){return{maxWidth:e.width,maxHeight:e.height}}))}))},al=function(e){return ju(e)&&(vt(e.file)||ct("string",e.fileUrl))&&ct("string",e.fileName,!0)&&ct("string",e.mimeType,!0)&&ct("number",e.fileSize,!0)&&(null===e.thumbnailSizes||void 0===e.thumbnailSizes||Array.isArray(e.thumbnailSizes)&&e.thumbnailSizes.every((function(e){return ct("object",e)&&e.maxWidth>0&&e.maxHeight>0})))},sl={data:void 0,customType:void 0,mentionType:Mt.USERS,mentionedUserIds:void 0,mentionedUsers:void 0,mentionedMessageTemplate:void 0,metaArrays:void 0,pushNotificationDeliveryOption:void 0,appleCriticalAlertOptions:void 0},ol=function(e){return ct("string",e.data,!0)&&ct("string",e.customType,!0)&&dt(Mt,e.mentionType)&&ft("string",e.mentionedUserIds,!0)&&ft(ps,e.mentionedUsers,!0)&&ct("string",e.mentionedMessageTemplate,!0)&&ft($o,e.metaArrays,!0)&&dt(Ot,e.pushNotificationDeliveryOption,!0)&&ct(Jo,e.appleCriticalAlertOptions,!0)},ul=je(je({},sl),{message:void 0,translationTargetLanguages:void 0,pollId:void 0}),ll=function(e){return ol(e)&&ct("string",e.message,!0)&&ft("string",e.translationTargetLanguages,!0)&&ct("number",e.pollId,!0)},cl=je({},sl),dl=function(e){function t(t){var n=t.channelUrl,r=t.channelType,i=t.token,a=t.limit,s=e.call(this)||this;return s.method=Gt.GET,s.path="".concat(sn(r),"/").concat(encodeURIComponent(n),"/operators"),s.params={token:i,limit:a},s}return Be(t,e),t}(hn),hl=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.operators=n.operators.map((function(e){return new ps(t,e)})),r.token=n.next,r}return Be(t,e),t}(fn),fl=function(e){function t(t,n,r,i){return e.call(this,t,n,r,i)||this}return Be(t,e),t.prototype._validate=function(){return e.prototype._validate.call(this)},t.prototype.next=function(){return Qe(this,void 0,void 0,(function(){var e,t,n,r,i,a,s;return Ke(this,(function(o){switch(o.label){case 0:return this._validate()?this._isLoading?[3,3]:(e=[],this._hasNext?(this._isLoading=!0,t=eo.of(this._iid).requestQueue,n=new dl(je(je({},this),{channelUrl:this.channelUrl,token:this._token})),[4,t.send(n)]):[3,2]):[3,5];case 1:return r=o.sent(),i=r.as(hl),a=i.operators,s=i.token,this._token=s,this._hasNext=!!s,this._isLoading=!1,[2,a];case 2:return[2,e];case 3:throw st.queryInProgress;case 4:return[3,6];case 5:throw st.invalidParameters;case 6:return[2]}}))}))},t}(go),pl=function(e){function t(t,n,r,i){var a,s,o,u,l,c,d,h,f,p,_=this;return(_=e.call(this,t,n,r,i)||this).reverse=!1,_.messageTypeFilter=At.ALL,_.customTypesFilter=null,_.senderUserIdsFilter=null,_.replyType=Ut.NONE,_.includeMetaArray=!1,_.includeReactions=!1,_.includeParentMessageInfo=!1,_.includeThreadInfo=!1,_.showSubchannelMessagesOnly=!1,_._edge=Number.MAX_SAFE_INTEGER,_.reverse=null!==(a=i.reverse)&&void 0!==a&&a,_.messageTypeFilter=null!==(s=i.messageTypeFilter)&&void 0!==s?s:At.ALL,_.customTypesFilter=null!==(o=i.customTypesFilter)&&void 0!==o?o:null,_.senderUserIdsFilter=null!==(u=i.senderUserIdsFilter)&&void 0!==u?u:null,_.replyType=null!==(l=i.replyType)&&void 0!==l?l:Ut.NONE,_.includeMetaArray=null!==(c=i.includeMetaArray)&&void 0!==c&&c,_.includeReactions=null!==(d=i.includeReactions)&&void 0!==d&&d,_.includeParentMessageInfo=null!==(h=i.includeParentMessageInfo)&&void 0!==h&&h,_.includeThreadInfo=null!==(f=i.includeThreadInfo)&&void 0!==f&&f,_.showSubchannelMessagesOnly=null!==(p=i.showSubchannelMessagesOnly)&&void 0!==p&&p,_}return Be(t,e),t.prototype._validate=function(){return e.prototype._validate.call(this)&&ct("boolean",this.reverse)&&dt(At,this.messageTypeFilter)&&dt(Ut,this.replyType)&&ft("string",this.customTypesFilter,!0)&&ft("string",this.senderUserIdsFilter,!0)&&ct("boolean",this.includeMetaArray)&&ct("boolean",this.includeReactions)&&ct("boolean",this.includeParentMessageInfo)&&ct("boolean",this.includeThreadInfo)&&ct("boolean",this.showSubchannelMessagesOnly)},t.prototype.load=function(){return Qe(this,void 0,void 0,(function(){var e;return Ke(this,(function(t){switch(t.label){case 0:return this._validate()?this._isLoading?[3,3]:this._hasNext?(this._isLoading=!0,[4,vh.of(this._iid).getMessagesByTimestamp(this.channelUrl,this.channelType,this._edge,Vt({prevResultSize:this.limit,nextResultSize:0,isInclusive:!1,reverse:this.reverse,messageTypeFilter:this.messageTypeFilter,customTypesFilter:this.customTypesFilter,replyType:this.replyType,senderUserIdsFilter:this.senderUserIdsFilter,includeReactions:this.includeReactions,includeMetaArray:this.includeMetaArray,includeParentMessageInfo:this.includeParentMessageInfo,includeThreadInfo:this.includeThreadInfo,showSubchannelMessagesOnly:this.showSubchannelMessagesOnly}))]):[3,2]:[3,5];case 1:return e=t.sent(),this._edge=Math.min.apply(Math,Ze([Number.MAX_SAFE_INTEGER],Ye(e.map((function(e){return e.createdAt}))),!1)),this._hasNext=e.length>=this.limit,this._isLoading=!1,[2,e];case 2:return[2,[]];case 3:throw st.queryInProgress;case 4:return[3,6];case 5:throw st.invalidParameters;case 6:return[2]}}))}))},t}(go),_l=function(e){function t(t){var n=this,r=t.channelUrl,i=t.channelType,a=t.limit,s=t.token;return(n=e.call(this)||this).method=Gt.GET,n.path="".concat(sn(i),"/").concat(encodeURIComponent(r),"/mute"),n.params={limit:a,token:s},n}return Be(t,e),t}(hn),vl=function(e){function t(t,n){var r=e.call(this,t,n)||this;r.mutedUsers=[];var i=n.next,a=n.muted_list;return r.token=i,a&&a.length>0&&(r.mutedUsers=a.map((function(e){return new qu(t,e)}))),r}return Be(t,e),t}(fn),ml=function(e){function t(t,n,r,i){return e.call(this,t,n,r,i)||this}return Be(t,e),t.prototype.next=function(){return Qe(this,void 0,void 0,(function(){var e,t,n,r,i,a;return Ke(this,(function(s){switch(s.label){case 0:return this._validate()?this._isLoading?[3,3]:this._hasNext?(this._isLoading=!0,e=eo.of(this._iid).requestQueue,t=new _l(je(je({},this),{token:this._token})),[4,e.send(t)]):[3,2]:[3,5];case 1:return n=s.sent(),r=n.as(vl),i=r.mutedUsers,a=r.token,this._token=a,this._hasNext=!!a,this._isLoading=!1,[2,i];case 2:return[2,[]];case 3:throw st.queryInProgress;case 4:return[3,6];case 5:throw st.invalidParameters;case 6:return[2]}}))}))},t}(go),gl=function(e){function t(t){var n=this,r=t.channelUrl,i=t.channelType,a=t.limit,s=t.token;return(n=e.call(this)||this).method=Gt.GET,n.path="".concat(sn(i),"/").concat(encodeURIComponent(r),"/ban"),n.params=qt({limit:a,token:s}),n}return Be(t,e),t}(hn),yl=function(e){function t(t,n){var r=e.call(this,t,n)||this;r.bannedUsers=[];var i=n.next,a=n.banned_list;return r.token=i,a&&a.length>0&&(r.bannedUsers=a.map((function(e){return new qu(t,e.user)}))),r}return Be(t,e),t}(fn),El=function(e){function t(t,n,r,i){return e.call(this,t,n,r,i)||this}return Be(t,e),t.prototype._validate=function(){return e.prototype._validate.call(this)},t.prototype.next=function(){return Qe(this,void 0,void 0,(function(){var e,t,n,r,i,a;return Ke(this,(function(s){switch(s.label){case 0:return this._validate()?this._isLoading?[3,3]:this._hasNext?(this._isLoading=!0,e=eo.of(this._iid).requestQueue,t=new gl(je(je({},this),{token:this._token})),[4,e.send(t)]):[3,2]:[3,5];case 1:return n=s.sent(),r=n.as(yl),i=r.bannedUsers,a=r.token,this._token=a,this._hasNext=!!a,this._isLoading=!1,[2,i];case 2:return[2,[]];case 3:throw st.queryInProgress;case 4:return[3,6];case 5:throw st.invalidParameters;case 6:return[2]}}))}))},t}(go);!function(e){e.SPAM="spam",e.HARASSING="harassing",e.SUSPICIOUS="suspicious",e.INAPPROPRIATE="inappropriate"}(rl||(rl={}));var bl=function(e){function t(t){var n=this,r=t.channelUrl,i=t.channelType,a=t.operatorUserIds;return(n=e.call(this)||this).method=Gt.POST,n.path="".concat(sn(i),"/").concat(encodeURIComponent(r),"/operators"),n.params={operator_ids:a},n}return Be(t,e),t}(hn);!function(e){Be((function(){return null!==e&&e.apply(this,arguments)||this}),e)}(fn);var Cl=function(e){function t(t){var n=this,r=t.channelUrl,i=t.channelType,a=t.operatorUserIds;return(n=e.call(this)||this).method=Gt.DELETE,n.path="".concat(sn(i),"/").concat(encodeURIComponent(r),"/operators"),n.params={operator_ids:a},n}return Be(t,e),t}(hn);!function(e){Be((function(t,n){return e.call(this,t,n)||this}),e)}(fn);var wl=function(e){function t(t){var n=this,r=t.channelUrl,i=t.channelType,a=t.userId;return(n=e.call(this)||this).method=Gt.GET,n.path="".concat(sn(i),"/").concat(encodeURIComponent(r),"/mute/").concat(a),n}return Be(t,e),t}(hn),Sl=function(e){function t(t,n){var r=e.call(this,t,n)||this;r.isMuted=!1,r.startAt=0,r.endAt=0;var i=n.is_muted,a=n.start_at,s=n.end_at,o=n.remaining_duration,u=n.description;return r.isMuted=i,r.startAt=a,r.endAt=s,r.remainingDuration=o,r.description=u,r}return Be(t,e),t}(fn),Tl=function(e){function t(t){var n=this,r=t.channelUrl,i=t.channelType,a=t.keys;return(n=e.call(this)||this).method=Gt.GET,n.path="".concat(sn(i),"/").concat(encodeURIComponent(r),"/metadata"),n.params={keys:a,include_ts:!0},n}return Be(t,e),t}(hn),Il=function(e){function t(t,n){var r=e.call(this,t,n)||this,i=n.metadata,a=n.ts;return r.metadata=i,r.ts=a,r}return Be(t,e),t}(fn),Nl=function(e){function t(t){var n=this,r=t.channelUrl,i=t.channelType,a=t.metadata;return(n=e.call(this)||this).method=Gt.POST,n.path="".concat(sn(i),"/").concat(encodeURIComponent(r),"/metadata"),n.params={metadata:a,include_ts:!0},n}return Be(t,e),t}(hn),Al=function(e){function t(t,n){var r,i,a=this;return(a=e.call(this,t,n)||this).metaData=null!==(r=n.metadata)&&void 0!==r?r:{},a.ts=null!==(i=n.ts)&&void 0!==i?i:null,a}return Be(t,e),t}(fn),kl=function(e){function t(t){var n=this,r=t.channelUrl,i=t.channelType,a=t.metadata,s=t.upsert;return(n=e.call(this)||this).method=Gt.PUT,n.path="".concat(sn(i),"/").concat(encodeURIComponent(r),"/metadata"),n.params={metadata:a,include_ts:!0,upsert:null!=s&&s},n}return Be(t,e),t}(hn),Ml=function(e){function t(t,n){var r=e.call(this,t,n)||this,i=n.metadata,a=n.ts;return r.metadata=i,r.ts=a,r}return Be(t,e),t}(fn),Ul=function(e){function t(t,n,r){var i=e.call(this,t,"SYEV",r)||this;return r.data&&(i.created=r.data.created,i.updated=r.data.updated,i.deleted=r.data.deleted),i}return Be(t,e),t}(vn),Ol=function(e){function t(t){var n=this,r=t.channelUrl,i=t.channelType,a=t.key;return(n=e.call(this)||this).method=Gt.DELETE,n.path="".concat(sn(i),"/").concat(encodeURIComponent(r),"/metadata/").concat(a),n.params={include_ts:!0},n}return Be(t,e),t}(hn),Dl=function(e){function t(t,n){var r=e.call(this,t,n)||this,i=n.ts;return r.ts=i,r}return Be(t,e),t}(fn),Ll=function(e){function t(t){var n=this,r=t.channelUrl,i=t.channelType;return(n=e.call(this)||this).method=Gt.DELETE,n.path="".concat(sn(i),"/").concat(encodeURIComponent(r),"/metadata"),n.params={include_ts:!0},n}return Be(t,e),t}(hn),Rl=function(e){function t(t,n){var r=e.call(this,t,n)||this,i=n.ts;return r.ts=i,r}return Be(t,e),t}(fn),xl=function(e){function t(t){var n=this,r=t.channelUrl,i=t.channelType,a=t.keys;return(n=e.call(this)||this).method=Gt.GET,n.path="".concat(sn(i),"/").concat(encodeURIComponent(r),"/metacounter"),n.params={keys:a},n}return Be(t,e),t}(hn),Pl=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.metaCounter=n,r}return Be(t,e),t}(fn),Fl=function(e){function t(t){var n=this,r=t.channelUrl,i=t.channelType,a=t.metaCounter;return(n=e.call(this)||this).method=Gt.POST,n.path="".concat(sn(i),"/").concat(encodeURIComponent(r),"/metacounter"),n.params={metacounter:a},n}return Be(t,e),t}(hn),zl=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.metaCounter=n,r}return Be(t,e),t}(fn),Hl=function(e){function t(t){var n=this,r=t.channelUrl,i=t.channelType,a=t.metaCounter,s=t.upsert,o=void 0!==s&&s,u=t.mode,l=void 0===u?"set":u;return(n=e.call(this)||this).method=Gt.PUT,n.path="".concat(sn(i),"/").concat(encodeURIComponent(r),"/metacounter"),n.params={metacounter:a,upsert:o,mode:l},n}return Be(t,e),t}(hn),ql=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.metaCounter=n,r}return Be(t,e),t}(fn),Vl=function(e){function t(t,n,r){var i=e.call(this,t,"SYEV",r)||this;return r.data&&(i.created=r.data.created,i.updated=r.data.updated,i.deleted=r.data.deleted),i}return Be(t,e),t}(vn),Gl=function(e){function t(t){var n=this,r=t.channelUrl,i=t.channelType,a=t.key;return(n=e.call(this)||this).method=Gt.DELETE,n.path="".concat(sn(i),"/").concat(encodeURIComponent(r),"/metacounter/").concat(a),n.params={},n}return Be(t,e),t}(hn);!function(e){Be((function(t,n){return e.call(this,t,n)||this}),e)}(fn);var Bl=function(e){function t(t){var n=this,r=t.channelUrl,i=t.channelType;return(n=e.call(this)||this).method=Gt.DELETE,n.path="".concat(sn(i),"/").concat(encodeURIComponent(r),"/metacounter"),n.params={},n}return Be(t,e),t}(hn);!function(e){Be((function(){return null!==e&&e.apply(this,arguments)||this}),e)}(fn);var jl=function(e){function t(t){var n=this,r=t.channelUrl,i=t.channelType,a=t.userId,s=t.seconds,o=t.description;return(n=e.call(this)||this).method=Gt.POST,n.path="".concat(sn(i),"/").concat(encodeURIComponent(r),"/mute"),n.params={user_id:a,seconds:s,description:o},n}return Be(t,e),t}(hn);!function(e){Be((function(t,n){return e.call(this,t,n)||this}),e)}(fn);var Ql=function(e){function t(t,n,r){var i=e.call(this,t,"SYEV",r)||this;return i.user=new qu(t,r.data),i}return Be(t,e),t}(vn),Kl=function(e){function t(t){var n=this,r=t.channelUrl,i=t.channelType,a=t.userId;return(n=e.call(this)||this).method=Gt.DELETE,n.path="".concat(sn(i),"/").concat(encodeURIComponent(r),"/mute/").concat(encodeURIComponent(a)),n}return Be(t,e),t}(hn);!function(e){Be((function(){return null!==e&&e.apply(this,arguments)||this}),e)}(fn);var Wl=function(e){function t(t,n,r){var i=e.call(this,t,"SYEV",r)||this;return i.user=new qu(t,r.data),i}return Be(t,e),t}(vn),Yl=function(e){function t(t){var n=this,r=t.channelUrl,i=t.channelType,a=t.userId,s=t.seconds,o=t.description;return(n=e.call(this)||this).method=Gt.POST,n.path="".concat(sn(i),"/").concat(encodeURIComponent(r),"/ban"),n.params=qt({user_id:a,seconds:s,description:o}),n}return Be(t,e),t}(hn);!function(e){Be((function(){return null!==e&&e.apply(this,arguments)||this}),e)}(fn);var Zl=function(e){function t(t,n,r){var i=e.call(this,t,"SYEV",r)||this;return i.user=new qu(t,r.data),r.data.member_count&&(i.memberCount=r.data.member_count),r.data.joined_member_count&&(i.joinedMemberCount=r.data.joined_member_count),i}return Be(t,e),t}(vn),Jl=function(e){function t(t){var n=this,r=t.channelUrl,i=t.channelType,a=t.userId;return(n=e.call(this)||this).method=Gt.DELETE,n.path="".concat(sn(i),"/").concat(encodeURIComponent(r),"/ban/").concat(encodeURIComponent(a)),n}return Be(t,e),t}(hn);!function(e){Be((function(){return null!==e&&e.apply(this,arguments)||this}),e)}(fn);var Xl=function(e){function t(t,n,r){var i=e.call(this,t,"SYEV",r)||this;return i.user=new qu(t,r.data),i}return Be(t,e),t}(vn),$l=function(e){function t(t){var n=this,r=t.channelUrl,i=t.channelType,a=t.freezing;return(n=e.call(this)||this).method=Gt.PUT,n.path="".concat(sn(i),"/").concat(encodeURIComponent(r),"/freeze"),n.params={freeze:a},n}return Be(t,e),t}(hn);!function(e){Be((function(){return null!==e&&e.apply(this,arguments)||this}),e)}(fn);var ec=function(e){function t(t,n,r){var i=e.call(this,t,"SYEV",r)||this;return i.freeze=r.data.freeze,i}return Be(t,e),t}(vn),tc=function(e){function t(t){var n=this,r=t.channelUrl,i=t.channelType,a=t.category,s=t.userId,o=t.description;return(n=e.call(this)||this).method=Gt.POST,n.path="".concat(on(i),"/").concat(encodeURIComponent(r)),n.params={report_category:a,reporting_user_id:s,report_description:o},n}return Be(t,e),t}(hn),nc=function(e){function t(t){var n=this,r=t.channelUrl,i=t.channelType,a=t.category,s=t.userId,o=t.offendingUserId,u=t.description;return(n=e.call(this)||this).method=Gt.POST,n.path="".concat(Xt,"/users/").concat(o),n.params={channel_url:r,channel_type:i===St.OPEN?"open_channels":"group_channels",report_category:a,reporting_user_id:s,report_description:u},n}return Be(t,e),t}(hn),rc=function(e){function t(t){var n=this,r=t.channelUrl,i=t.channelType,a=t.category,s=t.userId,o=t.offendingUserId,u=t.messageId,l=t.description;return(n=e.call(this)||this).method=Gt.POST,n.path="".concat(on(i),"/").concat(encodeURIComponent(r),"/messages/").concat(u),n.params={report_category:a,reporting_user_id:s,report_description:l,offending_user_id:o},n}return Be(t,e),t}(hn),ic=function(e){function t(t){var n=[];return t.mentionType===Mt.USERS&&(t.mentionedUserIds?n=t.mentionedUserIds:t.mentionedUsers&&(n=t.mentionedUsers.map((function(e){return e.userId})))),e.call(this,{code:"MESG",ackRequired:!0,payload:qt(Vt({channel_url:t.channelUrl,message:t.message,data:t.data,custom_type:t.customType,metaarray:t.metaArrays,mention_type:t.mentionType,mentioned_user_ids:n,mentioned_message_template:t.mentionedMessageTemplate,target_langs:t.translationTargetLanguages,push_option:t.pushNotificationDeliveryOption&&t.pushNotificationDeliveryOption!==Ot.DEFAULT?t.pushNotificationDeliveryOption:void 0,apple_critical_alert_options:t.appleCriticalAlertOptions,silent:t.silent,reply_to_channel:t.isReplyToChannel,parent_message_id:t.parentMessageId?t.parentMessageId:null,req_id:t.reqId,poll_id:t.pollId,pin_message:t.isPinnedMessage}))})||this}return Be(t,e),t}(mn),ac=function(e){function t(t,n,r){var i,a,s,o,u=this;(u=e.call(this,t,"MESG",r)||this).message=new hu(t,r);var l=eo.of(t).sdkState;return u.isMentioned=un(u.message.mentionType,null!==(s=null!==(i=u.message.mentionedUserIds)&&void 0!==i?i:null===(a=u.message.mentionedUsers)||void 0===a?void 0:a.map((function(e){return e.userId})))&&void 0!==s?s:[],l.userId),u.forceUpdateLastMessage=null!==(o=r.force_update_last_message)&&void 0!==o&&o,u}return Be(t,e),t}(vn),sc=function(e){function t(t){var n=null;return t.mentionType===Mt.USERS&&(t.mentionedUserIds?n=t.mentionedUserIds:t.mentionedUsers&&(n=t.mentionedUsers.map((function(e){return e.userId})))),e.call(this,{code:"MEDI",ackRequired:!0,payload:qt(Vt({channel_url:t.channelUrl,msg_id:t.messageId,message:t.message,data:t.data,custom_type:t.customType,metaarray:t.metaArrayParams,mention_type:t.mentionType,mentioned_user_ids:n,mentioned_message_template:t.mentionedMessageTemplate,apple_critical_alert_options:t.appleCriticalAlertOptions?Jo.payloadify(t.appleCriticalAlertOptions):null,poll_id:t.pollId}))})||this}return Be(t,e),t}(mn),oc=function(e){function t(t,n,r){var i,a,s,o,u,l=this;(l=e.call(this,t,"MEDI",r)||this).message=new hu(t,r);var c=eo.of(t).sdkState;return l.mentionCountChange=ln({mentionType:null===(i=r.old_values)||void 0===i?void 0:i.mention_type,mentionedUserIds:null!==(s=null===(a=r.old_values)||void 0===a?void 0:a.mentioned_user_ids)&&void 0!==s?s:[]},Vt({mentionType:l.message.mentionType,mentionedUserIds:null!==(o=l.message.mentionedUserIds)&&void 0!==o?o:null===(u=l.message.mentionedUsers)||void 0===u?void 0:u.map((function(e){return e.userId}))}),c.userId),l}return Be(t,e),t}(vn),uc=function(e){function t(t){var n=null;return t.mentionType===Mt.USERS&&(t.mentionedUserIds?n=t.mentionedUserIds:t.mentionedUsers&&(n=t.mentionedUsers.map((function(e){return e.userId})))),e.call(this,{code:"FEDI",ackRequired:!0,payload:qt(Vt({channel_url:t.channelUrl,msg_id:t.messageId,data:t.data,custom_type:t.customType,metaarray:t.metaArrayParams,mention_type:t.mentionType,mentioned_user_ids:n,apple_critical_alert_options:t.appleCriticalAlertOptions}))})||this}return Be(t,e),t}(mn),lc=function(e){function t(t,n,r){var i,a,s,o,u,l=this;(l=e.call(this,t,"FEDI",r)||this).message=new yu(t,r);var c=eo.of(t).sdkState;return l.mentionCountChange=ln({mentionType:null===(i=r.old_values)||void 0===i?void 0:i.mention_type,mentionedUserIds:null!==(s=null===(a=r.old_values)||void 0===a?void 0:a.mentioned_user_ids)&&void 0!==s?s:[]},Vt({mentionType:l.message.mentionType,mentionedUserIds:null!==(o=l.message.mentionedUserIds)&&void 0!==o?o:null===(u=l.message.mentionedUsers)||void 0===u?void 0:u.map((function(e){return e.userId}))}),c.userId),l}return Be(t,e),t}(vn),cc=function(e){function t(t){var n=e.call(this)||this;return n.method=Gt.DELETE,n.path="".concat(sn(t.channelType),"/").concat(t.channelUrl,"/messages/").concat(t.messageId),n}return Be(t,e),t}(hn);!function(e){Be((function(){return null!==e&&e.apply(this,arguments)||this}),e)}(fn);var dc=function(e){function t(t,n,r){var i=e.call(this,t,"DELM",r)||this;return i.channelUrl=r.channel_url,i.channelType=r.channel_type,i.messageId=Number(r.msg_id),i}return Be(t,e),t}(vn),hc=function(e){function t(t){var n=t.channelType,r=t.channelUrl,i=t.messageId,a=t.reactionKey,s=e.call(this)||this;return s.method=Gt.POST,s.path="".concat(sn(n),"/").concat(encodeURIComponent(r),"/messages/").concat(i,"/reactions"),s.params={reaction:a},s}return Be(t,e),t}(hn),fc=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.reactionEvent=new Ko(n),r}return Be(t,e),t}(fn),pc=function(e){function t(t){var n=t.channelType,r=t.channelUrl,i=t.messageId,a=t.reactionKey,s=e.call(this)||this;return s.method=Gt.DELETE,s.path="".concat(sn(n),"/").concat(encodeURIComponent(r),"/messages/").concat(i,"/reactions"),s.params={reaction:a},s}return Be(t,e),t}(hn),_c=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.reactionEvent=new Ko(je({},n)),r}return Be(t,e),t}(fn),vc=function(e){function t(t){var n=t.channelType,r=t.channelUrl,i=t.messageId,a=t.translationTargetLanguages,s=e.call(this)||this;return s.method=Gt.POST,s.path="".concat(sn(n),"/").concat(encodeURIComponent(r),"/messages/").concat(encodeURIComponent(i),"/translation"),s.params={target_langs:a},s}return Be(t,e),t}(hn),mc=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.message=new hu(t,n),r}return Be(t,e),t}(fn),gc=function(e){function t(t){var n,r=this;r=e.call(this)||this;var i=[];t.mentionType===Mt.USERS&&(t.mentionedUserIds?i=t.mentionedUserIds:t.mentionedUsers&&(i=t.mentionedUsers.map((function(e){return e.userId}))));var a=t.channelType,s=t.channelUrl;return r.method=Gt.POST,r.path="".concat(sn(a),"/").concat(encodeURIComponent(s),"/scheduled_messages"),r.params=qt(Vt({req_id:t.reqId,scheduled_at:t.scheduledAt,message_type:kt.USER,message:t.message,custom_type:t.customType,data:t.data,mention_type:t.mentionType,mentioned_user_ids:i,sorted_metaarray:null===(n=t.metaArrays)||void 0===n?void 0:n.map((function(e){return $o.payloadify(e)})),apple_critical_alert_options:t.appleCriticalAlertOptions?Jo.payloadify(t.appleCriticalAlertOptions):null,target_langs:t.translationTargetLanguages,push_option:t.pushNotificationDeliveryOption})),r}return Be(t,e),t}(hn),yc=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.message=new hu(t,n),r}return Be(t,e),t}(fn),Ec=function(e){function t(t){var n,r=this;r=e.call(this)||this;var i=[];t.mentionType===Mt.USERS&&(t.mentionedUserIds?i=t.mentionedUserIds:t.mentionedUsers&&(i=t.mentionedUsers.map((function(e){return e.userId}))));var a=t.channelType,s=t.channelUrl;return r.method=Gt.POST,r.path="".concat(sn(a),"/").concat(encodeURIComponent(s),"/scheduled_messages"),r.params=Vt({req_id:t.reqId,scheduled_at:t.scheduledAt,message_type:kt.FILE,url:t.fileUrl,file_name:t.fileName,file_size:t.fileSize,file_type:t.mimeType,thumbnails:t.thumbnailSizes?t.thumbnailSizes.map((function(e){return su.payloadify(e)})):[],custom_type:t.customType,data:t.data,require_auth:t.requireAuth,mention_type:t.mentionType,mentioned_user_ids:i,sorted_metaarray:null===(n=t.metaArrays)||void 0===n?void 0:n.map((function(e){return $o.payloadify(e)})),apple_critical_alert_options:t.appleCriticalAlertOptions?Jo.payloadify(t.appleCriticalAlertOptions):null,push_option:t.pushNotificationDeliveryOption}),r}return Be(t,e),t}(hn),bc=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.message=new yu(t,n),r}return Be(t,e),t}(fn),Cc=function(e){function t(t){var n=t.pollId,r=t.title,i=t.data,a=t.allowUserSuggestion,s=t.allowMultipleVotes,o=t.closeAt,u=e.call(this)||this;return u.method=Gt.PUT,u.path="".concat(tn,"/").concat(encodeURIComponent(n)),u.params={title:r,data:i,allow_user_suggestion:a,allow_multiple_votes:s,close_at:o},u}return Be(t,e),t}(hn),wc=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.poll=new oo(t,n),r}return Be(t,e),t}(fn),Sc=function(e){function t(t){var n=t.pollId,r=e.call(this)||this;return r.method=Gt.DELETE,r.path="".concat(tn,"/").concat(encodeURIComponent(n)),r}return Be(t,e),t}(hn);!function(e){Be((function(){return null!==e&&e.apply(this,arguments)||this}),e)}(fn);var Tc=function(e){function t(t){var n=t.pollId,r=e.call(this)||this;return r.method=Gt.PUT,r.path="".concat(tn,"/").concat(encodeURIComponent(n),"/close"),r}return Be(t,e),t}(hn),Ic=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.poll=new oo(t,n),r}return Be(t,e),t}(fn),Nc=function(e){function t(t){var n=t.channelUrl,r=t.channelType,i=t.pollId,a=t.optionText,s=e.call(this)||this;return s.method=Gt.POST,s.path="".concat(tn,"/").concat(encodeURIComponent(i),"/options"),s.params={channel_url:n,channel_type:r,text:a},s}return Be(t,e),t}(hn),Ac=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.poll=new oo(t,n),r}return Be(t,e),t}(fn),kc=function(e){function t(t){var n=t.pollId,r=t.pollOptionId,i=t.optionText,a=e.call(this)||this;return a.method=Gt.PUT,a.path="".concat(tn,"/").concat(encodeURIComponent(n),"/options/").concat(encodeURIComponent(r)),a.params={text:i},a}return Be(t,e),t}(hn),Mc=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.poll=new oo(t,n),r}return Be(t,e),t}(fn),Uc=function(e){function t(t){var n=t.pollId,r=t.pollOptionId,i=e.call(this)||this;return i.method=Gt.DELETE,i.path="".concat(tn,"/").concat(encodeURIComponent(n),"/options/").concat(encodeURIComponent(r)),i}return Be(t,e),t}(hn);!function(e){Be((function(){return null!==e&&e.apply(this,arguments)||this}),e)}(fn);var Oc=function(e){function t(t){var n=t.reqId,r=t.channelType,i=t.channelUrl,a=t.pollId,s=t.pollOptionIds;return e.call(this,{code:"VOTE",ackRequired:!0,payload:qt({req_id:n,channel_type:r===St.OPEN?"open_channels":"group_channels",channel_url:i,poll_id:a,option_ids:s})})||this}return Be(t,e),t}(mn),Dc=function(e){function t(t,n,r){var i=e.call(this,t,"VOTE",r)||this;return i.event=new yo(r),i.channelUrl=r.channel_url,i.channelType=r.channel_type,i}return Be(t,e),t}(vn),Lc="GroupChannel",Rc="Message",xc="NotificationMessage";var Pc,Fc=je(je({},Bu),{fileInfoList:[]}),zc=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._onFileUploaded=Dn,t}return Be(t,e),t.prototype._triggerOnFileUploaded=function(e,t,n,r){this._onFileUploaded(e,t,n,r)},t.prototype.onFileUploaded=function(e){return this._onFileUploaded=e,this},t.prototype.onPending=function(t){return e.prototype.onPending.call(this,t),this},t.prototype.onFailed=function(t){return e.prototype.onFailed.call(this,t),this},t.prototype.onSucceeded=function(t){return e.prototype.onSucceeded.call(this,t),this},t}(Gu);!function(e){e.SEND="send",e.RESEND="resend",e.COPY="copy"}(Pc||(Pc={}));var Hc,qc=function(e){function t(t,n){var r,i,a,s,o,u,l=this;return(l=e.call(this,t)||this)._name="",l._createdAt=0,l.channelType=St.BASE,l.coverUrl="",l.customType="",l.data="",l.isFrozen=!1,l.isEphemeral=!1,l.creator=null,l._messageCollectionLastAccessedAt=0,l._url=n.channel_url,l._name=null!==(r=n.name)&&void 0!==r?r:"",l._createdAt=1e3*n.created_at,l.coverUrl=null!==(i=n.cover_url)&&void 0!==i?i:"",l.customType=null!==(a=n.custom_type)&&void 0!==a?a:"",l.data=null!==(s=n.data)&&void 0!==s?s:"",l.isFrozen=null!==(o=n.freeze)&&void 0!==o&&o,l.isEphemeral=null!==(u=n.is_ephemeral)&&void 0!==u&&u,l.creator=n.created_by?new ps(l._iid,n.created_by):null,n.metadata&&Object.keys(n.metadata).length>0&&n.ts&&(l._cachedMetaData=new Map,Object.keys(n.metadata).forEach((function(e){l._cachedMetaData.set(e,{value:n.metadata[e],isRemoved:!1,updatedAt:n.ts})}))),l}return Be(t,e),Object.defineProperty(t.prototype,"url",{get:function(){return this._url},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return this._name},set:function(e){this._name=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"createdAt",{get:function(){return this._createdAt},enumerable:!1,configurable:!0}),t.prototype.toJSON=function(){return je(je({},this),{url:this._url,name:this._name,createdAt:this._createdAt})},t.payloadify=function(t){return qt(Vt(je(je({},e.payloadify.call(this,t)),{channel_url:t.url,name:t.name,cover_url:t.coverUrl,custom_type:t.customType,data:t.data,freeze:t.isFrozen,is_ephemeral:t.isEphemeral,created_by:t.creator?ps.payloadify(t.creator):null,created_at:t.createdAt/1e3})))},t.prototype.isGroupChannel=function(){return this.channelType===St.GROUP},t.prototype.isOpenChannel=function(){return this.channelType===St.OPEN},t.prototype.isFeedChannel=function(){return this.channelType===St.FEED},Object.defineProperty(t.prototype,"cachedMetaData",{get:function(){var e={};return this._cachedMetaData?(this._cachedMetaData.forEach((function(t,n){t.isRemoved||(e[n]=t.value)})),e):e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"messageCollectionLastAccessedAt",{get:function(){return this._messageCollectionLastAccessedAt},enumerable:!1,configurable:!0}),t.prototype._updateMessageCollectionLastAccessedAt=function(){this._messageCollectionLastAccessedAt=Date.now()},t.prototype._update=function(e){var t=qt(e);Object.assign(this,t)},t.prototype._upsertCachedMetaData=function(e,t){var n=this;Object.keys(e).forEach((function(r){n._cachedMetaData||(n._cachedMetaData=new Map);var i=n._cachedMetaData.get(r);(!i||i.updatedAt<=t)&&n._cachedMetaData.set(r,{value:e[r],isRemoved:!1,updatedAt:t})}))},t.prototype._updateCachedMetaData=function(e,t){var n=this;this._cachedMetaData?this._cachedMetaData.forEach((function(r,i){var a;r.updatedAt<=t&&n._cachedMetaData.set(i,{value:null!==(a=e[i])&&void 0!==a?a:r.value,isRemoved:!e[i],updatedAt:t})})):(this._cachedMetaData=new Map,Object.keys(e).forEach((function(r){n._cachedMetaData.set(r,{value:e[r],isRemoved:!1,updatedAt:t})})))},t.prototype._removeFromCachedMetaData=function(e,t){var n=this;this._cachedMetaData&&e.forEach((function(e){var r=n._cachedMetaData.get(e);r&&r.updatedAt<t&&(r.isRemoved=!0,r.updatedAt=t)}))},t.prototype._runIfHandleableWithGroupChannel=function(e){this.isGroupChannel()?e(this):this.isFeedChannel()&&e(this.groupChannel)},t.prototype._generateRequestId=function(){return"rq-".concat(xt())},t.prototype.isIdentical=function(e){return e&&this.url===e.url},t.prototype.isEqual=function(e){return lt(this,e)},t.prototype.createOperatorListQuery=function(e){return void 0===e&&(e={}),new fl(this._iid,this.url,this.channelType,e)},t.prototype.createMutedUserListQuery=function(e){return void 0===e&&(e={}),new ml(this._iid,this.url,this.channelType,e)},t.prototype.createBannedUserListQuery=function(e){return void 0===e&&(e={}),new El(this._iid,this.url,this.channelType,e)},t.prototype.createPreviousMessageListQuery=function(e){return void 0===e&&(e={}),new pl(this._iid,this.url,this.channelType,e)},t.prototype.addOperators=function(e){return Qe(this,void 0,void 0,(function(){var t,n;return Ke(this,(function(r){switch(r.label){case 0:return hs(ft("string",e)).throw(st.invalidParameters),t=eo.of(this._iid).requestQueue,n=new bl({channelUrl:this.url,channelType:this.channelType,operatorUserIds:e}),[4,t.send(n)];case 1:return r.sent(),[2]}}))}))},t.prototype.removeOperators=function(e){return Qe(this,void 0,void 0,(function(){var t,n;return Ke(this,(function(r){switch(r.label){case 0:return hs(ft("string",e)).throw(st.invalidParameters),t=eo.of(this._iid).requestQueue,n=new Cl({channelUrl:this.url,channelType:this.channelType,operatorUserIds:e}),[4,t.send(n)];case 1:return r.sent(),[2]}}))}))},t.prototype.getMyMutedInfo=function(){return Qe(this,void 0,void 0,(function(){var e,t,n,r,i,a,s,o,u,l,c;return Ke(this,(function(d){switch(d.label){case 0:return e=eo.of(this._iid),t=e.sdkState,n=e.requestQueue,r=new wl({channelUrl:this.url,channelType:this.channelType,userId:t.userId}),[4,n.send(r)];case 1:return i=d.sent(),a=i.as(Sl),s=a.isMuted,o=a.startAt,u=a.endAt,l=a.remainingDuration,c=a.description,[2,{isMuted:s,startAt:o,endAt:u,remainingDuration:l,description:c}]}}))}))},t.prototype.getMetaData=function(e){return Qe(this,void 0,void 0,(function(){var t,n,r,i,a,s;return Ke(this,(function(o){switch(o.label){case 0:return hs(ft("string",e)).throw(st.invalidParameters),t=eo.of(this._iid).requestQueue,n=new Tl({channelUrl:this.url,channelType:this.channelType,keys:e}),[4,t.send(n)];case 1:return r=o.sent(),i=r.as(Il),a=i.metadata,s=i.ts,this._upsertCachedMetaData(a,s),[2,a]}}))}))},t.prototype.getAllMetaData=function(){return Qe(this,void 0,void 0,(function(){var e,t,n,r,i,a;return Ke(this,(function(s){switch(s.label){case 0:return e=eo.of(this._iid).requestQueue,t=new Tl({channelUrl:this.url,channelType:this.channelType,keys:[]}),[4,e.send(t)];case 1:return n=s.sent(),r=n.as(Il),i=r.metadata,a=r.ts,this._updateCachedMetaData(i,a),[2,i]}}))}))},t.prototype.createMetaData=function(e){return Qe(this,void 0,void 0,(function(){var t,n,r,i;return Ke(this,(function(a){switch(a.label){case 0:return t=eo.of(this._iid).requestQueue,n=new Nl({channelUrl:this.url,channelType:this.channelType,metadata:e}),[4,t.send(n)];case 1:return r=a.sent(),i=r.as(Al).metaData,this._upsertCachedMetaData(i,0),[2,i]}}))}))},t.prototype.updateMetaData=function(e,t){return void 0===t&&(t=!1),Qe(this,void 0,void 0,(function(){var n,r,i,a,s,o;return Ke(this,(function(u){switch(u.label){case 0:return n=eo.of(this._iid).requestQueue,r=new kl({channelUrl:this.url,channelType:this.channelType,metadata:e,upsert:t}),[4,n.send(r)];case 1:return i=u.sent(),a=i.as(Ml),s=a.metadata,o=a.ts,this._upsertCachedMetaData(s,o),[2,s]}}))}))},t.prototype.deleteMetaData=function(e){return Qe(this,void 0,void 0,(function(){var t,n,r,i;return Ke(this,(function(a){switch(a.label){case 0:return hs(ct("string",e)).throw(st.invalidParameters),t=eo.of(this._iid).requestQueue,n=new Ol({channelUrl:this.url,channelType:this.channelType,key:e}),[4,t.send(n)];case 1:return r=a.sent(),i=r.as(Dl).ts,this._removeFromCachedMetaData([e],i),[2]}}))}))},t.prototype.deleteAllMetaData=function(){return Qe(this,void 0,void 0,(function(){var e,t,n,r;return Ke(this,(function(i){switch(i.label){case 0:return e=eo.of(this._iid).requestQueue,t=new Ll({channelUrl:this.url,channelType:this.channelType}),[4,e.send(t)];case 1:return n=i.sent(),r=n.as(Rl).ts,this._removeFromCachedMetaData(Ze([],Ye(this._cachedMetaData.keys()),!1),r),[2]}}))}))},t.prototype.getMetaCounters=function(e){return Qe(this,void 0,void 0,(function(){var t,n;return Ke(this,(function(r){switch(r.label){case 0:return hs(ft("string",e)).throw(st.invalidParameters),t=eo.of(this._iid).requestQueue,n=new xl({channelUrl:this.url,channelType:this.channelType,keys:e}),[4,t.send(n)];case 1:return[2,r.sent().as(Pl).metaCounter]}}))}))},t.prototype.getAllMetaCounters=function(){return Qe(this,void 0,void 0,(function(){var e,t;return Ke(this,(function(n){switch(n.label){case 0:return e=eo.of(this._iid).requestQueue,t=new xl({channelUrl:this.url,channelType:this.channelType,keys:[]}),[4,e.send(t)];case 1:return[2,n.sent().as(Pl).metaCounter]}}))}))},t.prototype.createMetaCounters=function(e){return Qe(this,void 0,void 0,(function(){var t,n;return Ke(this,(function(r){switch(r.label){case 0:return t=eo.of(this._iid).requestQueue,n=new Fl({channelUrl:this.url,channelType:this.channelType,metaCounter:e}),[4,t.send(n)];case 1:return[2,r.sent().as(zl).metaCounter]}}))}))},t.prototype.updateMetaCounters=function(e,t){return void 0===t&&(t=!1),Qe(this,void 0,void 0,(function(){var n,r;return Ke(this,(function(i){switch(i.label){case 0:return n=eo.of(this._iid).requestQueue,r=new Hl({channelUrl:this.url,channelType:this.channelType,metaCounter:e,upsert:t}),[4,n.send(r)];case 1:return[2,i.sent().as(ql).metaCounter]}}))}))},t.prototype.increaseMetaCounters=function(e){return Qe(this,void 0,void 0,(function(){var t,n;return Ke(this,(function(r){switch(r.label){case 0:return t=eo.of(this._iid).requestQueue,n=new Hl({channelUrl:this.url,channelType:this.channelType,metaCounter:e,upsert:!1,mode:"increase"}),[4,t.send(n)];case 1:return[2,r.sent().as(ql).metaCounter]}}))}))},t.prototype.decreaseMetaCounters=function(e){return Qe(this,void 0,void 0,(function(){var t,n;return Ke(this,(function(r){switch(r.label){case 0:return t=eo.of(this._iid).requestQueue,n=new Hl({channelUrl:this.url,channelType:this.channelType,metaCounter:e,upsert:!1,mode:"decrease"}),[4,t.send(n)];case 1:return[2,r.sent().as(ql).metaCounter]}}))}))},t.prototype.deleteMetaCounter=function(e){return Qe(this,void 0,void 0,(function(){var t,n;return Ke(this,(function(r){switch(r.label){case 0:return hs(ct("string",e)).throw(st.invalidParameters),t=eo.of(this._iid).requestQueue,n=new Gl({channelUrl:this.url,channelType:this.channelType,key:e}),[4,t.send(n)];case 1:return r.sent(),[2]}}))}))},t.prototype.deleteAllMetaCounters=function(){return Qe(this,void 0,void 0,(function(){var e,t;return Ke(this,(function(n){switch(n.label){case 0:return e=eo.of(this._iid).requestQueue,t=new Bl({channelUrl:this.url,channelType:this.channelType}),[4,e.send(t)];case 1:return n.sent(),[2]}}))}))},t.prototype.muteUser=function(e,t,n){return Qe(this,void 0,void 0,(function(){return Ke(this,(function(r){return[2,this.muteUserWithUserId(e.userId,t,n)]}))}))},t.prototype.muteUserWithUserId=function(e,t,n){return Qe(this,void 0,void 0,(function(){var r,i;return Ke(this,(function(a){switch(a.label){case 0:return hs(ct("string",e)&&ct("number",t,!0)&&ct("string",n,!0)).throw(st.invalidParameters),r=eo.of(this._iid).requestQueue,i=new jl({channelUrl:this.url,channelType:this.channelType,userId:e,seconds:t,description:n}),[4,r.send(i)];case 1:return a.sent(),[2]}}))}))},t.prototype.unmuteUser=function(e){return Qe(this,void 0,void 0,(function(){return Ke(this,(function(t){return[2,this.unmuteUserWithUserId(e.userId)]}))}))},t.prototype.unmuteUserWithUserId=function(e){return Qe(this,void 0,void 0,(function(){var t,n;return Ke(this,(function(r){switch(r.label){case 0:return hs(ct("string",e)).throw(st.invalidParameters),t=eo.of(this._iid).requestQueue,n=new Kl({channelUrl:this.url,channelType:this.channelType,userId:e}),[4,t.send(n)];case 1:return r.sent(),[2]}}))}))},t.prototype.banUser=function(e,t,n){return Qe(this,void 0,void 0,(function(){return Ke(this,(function(r){return[2,this.banUserWithUserId(e.userId,t,n)]}))}))},t.prototype.banUserWithUserId=function(e,t,n){return Qe(this,void 0,void 0,(function(){var r,i;return Ke(this,(function(a){switch(a.label){case 0:return hs(ct("string",e)&&ct("number",t,!0)&&ct("string",n,!0)).throw(st.invalidParameters),r=eo.of(this._iid).requestQueue,i=new Yl({channelUrl:this.url,channelType:this.channelType,userId:e,seconds:t,description:n}),[4,r.send(i)];case 1:return a.sent(),[2]}}))}))},t.prototype.unbanUser=function(e){return Qe(this,void 0,void 0,(function(){return Ke(this,(function(t){return[2,this.unbanUserWithUserId(e.userId)]}))}))},t.prototype.unbanUserWithUserId=function(e){return Qe(this,void 0,void 0,(function(){var t,n;return Ke(this,(function(r){switch(r.label){case 0:return hs(ct("string",e)).throw(st.invalidParameters),t=eo.of(this._iid).requestQueue,n=new Jl({channelUrl:this.url,channelType:this.channelType,userId:e}),[4,t.send(n)];case 1:return r.sent(),[2]}}))}))},t.prototype.freeze=function(){return Qe(this,void 0,void 0,(function(){var e,t;return Ke(this,(function(n){switch(n.label){case 0:return e=eo.of(this._iid).requestQueue,t=new $l({channelUrl:this.url,channelType:this.channelType,freezing:!0}),[4,e.send(t)];case 1:return n.sent(),this.isFrozen=!0,[2]}}))}))},t.prototype.unfreeze=function(){return Qe(this,void 0,void 0,(function(){var e,t;return Ke(this,(function(n){switch(n.label){case 0:return e=eo.of(this._iid).requestQueue,t=new $l({channelUrl:this.url,channelType:this.channelType,freezing:!1}),[4,e.send(t)];case 1:return n.sent(),this.isFrozen=!1,[2]}}))}))},t.prototype.getMessagesByMessageId=function(e,t){return Qe(this,void 0,void 0,(function(){var n;return Ke(this,(function(r){switch(r.label){case 0:return n=je(je({},Au),t),hs(ct("number",e)&&ku(n)).throw(st.invalidParameters),[4,vh.of(this._iid).getMessagesByMessageId(this.url,this.channelType,e,n)];case 1:return[2,r.sent()]}}))}))},t.prototype.getMessagesByTimestamp=function(e,t){return Qe(this,void 0,void 0,(function(){var n;return Ke(this,(function(r){switch(r.label){case 0:return n=je(je({},Au),t),hs(ct("number",e)&&ku(n)).throw(st.invalidParameters),[4,vh.of(this._iid).getMessagesByTimestamp(this.url,this.channelType,e,n)];case 1:return[2,r.sent()]}}))}))},t.prototype.getMessageChangeLogsSinceTimestamp=function(e,t){return void 0===t&&(t={}),Qe(this,void 0,void 0,(function(){var n;return Ke(this,(function(r){switch(r.label){case 0:return n=je(je({},Mu),t),hs(ct("number",e)&&Uu(n)).throw(st.invalidParameters),[4,vh.of(this._iid).getMessageChangelogs(this.url,this.channelType,e,n)];case 1:return[2,r.sent()]}}))}))},t.prototype.getMessageChangeLogsSinceToken=function(e,t){return void 0===t&&(t={}),Qe(this,void 0,void 0,(function(){var n;return Ke(this,(function(r){switch(r.label){case 0:return n=je(je({},Mu),t),hs(ct("string",e)&&Uu(n)).throw(st.invalidParameters),[4,vh.of(this._iid).getMessageChangelogs(this.url,this.channelType,e,n)];case 1:return[2,r.sent()]}}))}))},t.prototype._createPendingSendableMessagePayload=function(e,t,n){var r,i=eo.of(this._iid).sessionManager;return qt(Vt({channel_url:this.url,channel_type:this.channelType,msg_id:0,parent_message_id:e.parentMessageId,data:e.data,custom_type:e.customType,mention_type:e.mentionType,sorted_metaarray:e.metaArrays?e.metaArrays.map((function(e){return $o.payloadify(e)})):null,apple_critical_alert_options:e.appleCriticalAlertOptions?Jo.payloadify(e.appleCriticalAlertOptions):null,created_at:n,user:i.currentUser?Xo.payloadify(i.currentUser):null,req_id:t,request_state:Dt.PENDING,mentioned_user_ids:e.mentionedUserIds,mentioned_users:null===(r=e.mentionedUsers)||void 0===r?void 0:r.map((function(e){return ps.payloadify(e)}))}))},t.prototype._createPendingUserMessage=function(e,t,n){var r,i,a={};if(e.translationTargetLanguages)try{for(var s=We(e.translationTargetLanguages),o=s.next();!o.done;o=s.next())a[o.value]=""}catch(e){r={error:e}}finally{try{o&&!o.done&&(i=s.return)&&i.call(s)}finally{if(r)throw r.error}}var u=qt(je(je({},this._createPendingSendableMessagePayload(e,t,n)),{type:Nt.USER,message:e.message,translations:a})),l=new hu(this._iid,u);return l.messageParams=e,l},t.prototype._createPendingScheduledUserMessage=function(e,t,n){var r=this._createPendingUserMessage(e,t,n);return r.scheduledInfo={scheduledMessageId:0,scheduledAt:e.scheduledAt,scheduledMessageParams:e},r},t.prototype._createPendingFileMessage=function(e,t,n){var r,i,a,s,o,u,l=qt(je(je({},this._createPendingSendableMessagePayload(e,t,n)),{type:Nt.FILE,url:e.fileUrl,file:{name:null!==(r=e.fileName)&&void 0!==r?r:null===(i=e.file)||void 0===i?void 0:i.name,size:null!==(a=e.fileSize)&&void 0!==a?a:null===(s=e.file)||void 0===s?void 0:s.size,type:null!==(o=e.mimeType)&&void 0!==o?o:null===(u=e.file)||void 0===u?void 0:u.type,data:e.data},thumbnails:e.thumbnailSizes?e.thumbnailSizes.map((function(e){return{url:"",width:e.maxWidth,height:e.maxHeight}})):[]})),c=new yu(this._iid,l);return c.messageParams=e,c},t.prototype._createPendingMultipleFilesMessage=function(e,t,n){var r=qt(je(je({},this._createPendingSendableMessagePayload(e,t,n)),{type:Nt.FILE})),i=new pu(this._iid,r);return i.messageParams=e,i},t.prototype._validateFailedFileMessageHasFile=function(e,t){var n;return Boolean(e.url)||vt(t)||vt(null===(n=e.messageParams)||void 0===n?void 0:n.file)},t.prototype._createPendingScheduledFileMessage=function(e,t,n){var r=this._createPendingFileMessage(e,t,n);return r.scheduledInfo={scheduledMessageId:0,scheduledAt:e.scheduledAt,scheduledMessageParams:e},r},t.prototype._markMessageAsFailed=function(e,t,n){void 0===n&&(n=!1),e.errorCode=t.code,t.code===Je.REQUEST_CANCELED||t.code===Je.FILE_UPLOAD_CANCEL_FAILED?e.sendingStatus=Dt.CANCELED:n||(e.sendingStatus=Dt.FAILED)},t.prototype.sendUserMessage=function(e){var t=je(je({},Ku),e);return hs(Ju(t)).throw(st.invalidParameters),this._sendUserMessage(t)},t.prototype._sendUserMessage=function(e,t,n){var r=this;void 0===t&&(t=Pc.SEND);var i=eo.of(this._iid),a=i.dispatcher,s=i.requestQueue,o=null!=n?n:this._generateRequestId(),u=Date.now(),l=new Gu;return Ts(2).then((function(){var n=r._createPendingUserMessage(e,o,u);a.dispatch(new co({messages:[n],source:t===Pc.RESEND?no.LOCAL_MESSAGE_RESEND_STARTED:no.EVENT_MESSAGE_SENT_PENDING})),Es((function(){return Qe(r,void 0,void 0,(function(){return Ke(this,(function(e){return[2,l._trigger(n)]}))}))}));var i=new ic(je(je({},e),{channelUrl:r.url,channelType:r.channelType,reqId:o}));s.send(i).then((function(e){var t=e.as(ac).message;a.dispatch(new co({messages:[t],source:no.EVENT_MESSAGE_SENT_SUCCESS})),Es((function(){return Qe(r,void 0,void 0,(function(){return Ke(this,(function(e){return[2,l._trigger(t)]}))}))}))})).catch((function(t){if(at(t))throw t;Ts(2).then((function(){var n=r._createPendingUserMessage(e,o,u),i=eo.of(r._iid).cacheContext,s=i.localCacheEnabled&&i.localCacheConfig.enableAutoResend&&_t(t.code);r._markMessageAsFailed(n,t,s),a.dispatch(new co({messages:[n],source:n.sendingStatus===Dt.PENDING?no.REQUEST_RESEND_MESSAGE:no.EVENT_MESSAGE_SENT_FAILED})),Es((function(){return Qe(r,void 0,void 0,(function(){return Ke(this,(function(e){return[2,l._triggerFailed(t,n)]}))}))}))}))}))})),l},t.prototype._autoResendUserMessage=function(e){return hs(e instanceof hu&&!!e.messageParams).throw(st.invalidParameters),this._sendUserMessage(e.messageParams,Pc.SEND,e.reqId)},t.prototype.resendUserMessage=function(e){var t;return Qe(this,void 0,void 0,(function(){var n,r;return Ke(this,(function(i){return hs(e instanceof hu&&!e.scheduledInfo).throw(st.invalidParameters),n=new Un,r=null!==(t=e.messageParams)&&void 0!==t?t:Zu(e),this._sendUserMessage(r,Pc.RESEND,e.reqId).onFailed((function(e){return n.reject(e)})).onSucceeded((function(e){return n.resolve(e)})),[2,n.promise]}))}))},t.prototype.updateUserMessage=function(e,t){return Qe(this,void 0,void 0,(function(){var n,r,i;return Ke(this,(function(a){switch(a.label){case 0:return n=je(je({},ul),t),hs(ct("number",e)&&ll(n)).throw(st.invalidParameters),r=eo.of(this._iid).requestQueue,i=new sc(je({channelType:this.channelType,channelUrl:this.url,messageId:e,metaArrayParams:n.metaArrays?{array:n.metaArrays,mode:"add",upsert:!0}:void 0},n)),[4,r.send(i)];case 1:return[2,a.sent().as(oc).message]}}))}))},t.prototype.copyUserMessage=function(e,n){var r,i,a;return Qe(this,void 0,void 0,(function(){var s,o;return Ke(this,(function(u){return hs(e instanceof t&&n instanceof hu&&n.sendingStatus===Dt.SUCCEEDED&&this.url===n.channelUrl&&!n.scheduledInfo).throw(st.invalidParameters),hs(!n.poll).throw(st.notSupportedError),s=new Un,o=null!==(r=n.messageParams)&&void 0!==r?r:Vt(je(je({},n),{mentionType:n.mentionType,mentionedUserIds:null!==(i=n.mentionedUserIds)&&void 0!==i?i:null===(a=n.mentionedUsers)||void 0===a?void 0:a.map((function(e){return e.userId})),translationTargetLanguages:Object.keys(n.translations),pushNotificationDeliveryOption:Ot.DEFAULT,parentMessageId:null,isReplyToChannel:!1,isPinnedMessage:!1})),e._sendUserMessage(o).onSucceeded((function(e){s.resolve(e)})).onFailed((function(e){return s.reject(e)})),[2,s.promise]}))}))},t.prototype.translateUserMessage=function(e,t){return Qe(this,void 0,void 0,(function(){var n,r;return Ke(this,(function(i){switch(i.label){case 0:return hs(e instanceof hu&&e.messageId>0&&ft("string",t)).throw(st.invalidParameters),n=eo.of(this._iid).requestQueue,r=new vc({channelType:this.channelType,channelUrl:this.url,messageId:e.messageId,translationTargetLanguages:t}),[4,n.send(r)];case 1:return[2,i.sent().as(mc).message]}}))}))},t.prototype._createScheduledUserMessage=function(e,t){var n=this,r=eo.of(this._iid).requestQueue,i=Date.now(),a=this._generateRequestId();Ts(2).then((function(){var r=n._createPendingScheduledUserMessage(e,a,i);Es((function(){return Qe(n,void 0,void 0,(function(){return Ke(this,(function(e){return[2,t._trigger(r)]}))}))}))}));var s=new gc(je({reqId:a,channelType:this.channelType,channelUrl:this.url},e));r.send(s).then((function(e){var r=e.as(yc).message;Es((function(){return Qe(n,void 0,void 0,(function(){return Ke(this,(function(e){return[2,t._trigger(r)]}))}))}))})).catch((function(r){if(at(r))throw r;Ts(2).then((function(){var s=n._createPendingScheduledUserMessage(e,a,i);n._markMessageAsFailed(s,r),Es((function(){return Qe(n,void 0,void 0,(function(){return Ke(this,(function(e){return[2,t._trigger(s)]}))}))}))}))}))},t.prototype.sendFileMessage=function(e){var t=je(je({},tl),e);return hs(al(t)).throw(st.invalidParameters),this._sendFileMessage(t)},t.prototype.sendMultipleFilesMessage=function(e){var t,n=je(je({},Fc),e),r=eo.of(this._iid);hs(function(e,t){return void 0===t&&(t=5),ju(e)&&Array.isArray(e.fileInfoList)&&e.fileInfoList.length>=2&&e.fileInfoList.length<=t&&e.fileInfoList.every((function(e){return function(e){return(vt(e.file)||ct("string",e.fileUrl))&&ct("string",e.fileName,!0)&&ct("string",e.mimeType,!0)&&ct("number",e.fileSize,!0)&&(void 0===e.thumbnailSizes||Array.isArray(e.thumbnailSizes)&&e.thumbnailSizes.every((function(e){return e.maxWidth>0&&e.maxHeight>0})))}(e)}))}(n,null===(t=r.appInfo)||void 0===t?void 0:t.multipleFilesMessageFileCountLimit)).throw(st.invalidParameters);var i=!!e.fileInfoList.find((function(e){var t=r.appInfo.uploadSizeLimit;return e.file instanceof Blob&&e.file.size>t||e.fileSize>t}));return hs(!i).throw(st.fileSizeLimitExceededError),this._sendMultipleFilesMessage(n)},t.prototype._sendFileMessage=function(e,t,n){var r=this;void 0===t&&(t=Pc.SEND);var i=eo.of(this._iid).dispatcher,a=vh.of(this._iid).fileMessageQueue,s=null!=n?n:this._generateRequestId(),o=Date.now(),u=new Gu;return Ts(2).then((function(){var n=r._createPendingFileMessage(e,s,o);i.dispatch(new co({messages:[n],source:t===Pc.RESEND?no.LOCAL_MESSAGE_RESEND_STARTED:no.EVENT_MESSAGE_SENT_PENDING})),Es((function(){return Qe(r,void 0,void 0,(function(){return Ke(this,(function(e){return[2,u._trigger(n)]}))}))})),a.request(r,s,e).then((function(e){i.dispatch(new co({messages:[e],source:no.EVENT_MESSAGE_SENT_SUCCESS})),Es((function(){return Qe(r,void 0,void 0,(function(){return Ke(this,(function(t){return[2,u._trigger(e)]}))}))}))})).catch((function(t){if(at(t))throw t;Ts(2).then((function(){var n=r._createPendingFileMessage(e,s,o),a=eo.of(r._iid).cacheContext,l=a.localCacheEnabled&&a.localCacheConfig.enableAutoResend&&_t(t.code);r._markMessageAsFailed(n,t,l),i.dispatch(new co({messages:[n],source:n.sendingStatus===Dt.PENDING?no.REQUEST_RESEND_MESSAGE:t.code===Je.FILE_UPLOAD_CANCEL_FAILED?no.LOCAL_MESSAGE_CANCELED:no.EVENT_MESSAGE_SENT_FAILED})),Es((function(){return Qe(r,void 0,void 0,(function(){return Ke(this,(function(e){return[2,u._triggerFailed(t,n)]}))}))}))}))}))})),u},t.prototype._autoResendFileMessage=function(e){hs(e instanceof yu&&!!e.messageParams).throw(st.invalidParameters);var t=eo.of(this._iid).logger;return t.debug("autoResendFileMessage pending",e),this._sendFileMessage(e.messageParams,Pc.SEND,e.reqId).onFailed((function(e){t.debug("autoResendFileMessage failed",e)})).onSucceeded((function(e){t.debug("autoResendFileMessage success",e)}))},t.prototype._sendMultipleFilesMessage=function(e,t,n){var r=this,i=eo.of(this._iid).dispatcher,a=vh.of(this._iid).fileMessageQueue,s=null!=n?n:this._generateRequestId(),o=Date.now(),u=new zc;return Ts(2).then((function(){var n=r._createPendingMultipleFilesMessage(e,s,o);i.dispatch(new co({messages:[n],source:t===Pc.RESEND?no.LOCAL_MESSAGE_RESEND_STARTED:no.EVENT_MESSAGE_SENT_PENDING})),Es((function(){return Qe(r,void 0,void 0,(function(){return Ke(this,(function(e){return[2,u._trigger(n)]}))}))})),a.request(r,s,e,{requestHandler:u,isCopy:t===Pc.COPY}).then((function(e){i.dispatch(new co({messages:[e],source:no.EVENT_MESSAGE_SENT_SUCCESS})),Es((function(){return Qe(r,void 0,void 0,(function(){return Ke(this,(function(t){return[2,u._trigger(e)]}))}))}))})).catch((function(t){if(at(t))throw t;Ts(2).then((function(){var n=r._createPendingMultipleFilesMessage(e,s,o);r._markMessageAsFailed(n,t),i.dispatch(new co({messages:[n],source:no.EVENT_MESSAGE_SENT_FAILED})),Es((function(){return Qe(r,void 0,void 0,(function(){return Ke(this,(function(e){return[2,u._triggerFailed(t,n)]}))}))}))}))}))})),u},t.prototype._createScheduledFileMessage=function(e,t,n,r){var i=this,a=eo.of(this._iid).requestQueue,s=new Ec(je(je({reqId:n,channelType:this.channelType,channelUrl:this.url},e),{fileUrl:e.fileUrl,requireAuth:e.requireAuth}));a.send(s).then((function(e){var n=e.as(bc).message;Es((function(){return Qe(i,void 0,void 0,(function(){return Ke(this,(function(e){return[2,t._trigger(n)]}))}))}))})).catch((function(a){if(at(a))throw a;Ts(2).then((function(){var s=i._createPendingScheduledFileMessage(e,n,r);i._markMessageAsFailed(s,a),Es((function(){return Qe(i,void 0,void 0,(function(){return Ke(this,(function(e){return[2,t._triggerFailed(a,s)]}))}))}))}))}))},t.prototype.sendFileMessages=function(e){var t,n;hs(e.every((function(e){return al(je(je({},tl),e))}))).throw(st.invalidParameters);var r=new Gu;try{for(var i=We(e),a=i.next();!a.done;a=i.next()){var s=a.value;this.sendFileMessage(s).onPending((function(e){return r._trigger(e)})).onFailed((function(e,t){return r._triggerFailed(e,t)})).onSucceeded((function(e){return r._trigger(e)}))}}catch(e){t={error:e}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return r},t.prototype.resendFileMessage=function(e,t){return Qe(this,void 0,void 0,(function(){var n,r,i;return Ke(this,(function(a){return n=this._validateFailedFileMessageHasFile(e,t),hs(e instanceof yu&&n&&!e.scheduledInfo).throw(st.invalidParameters),r=new Un,i=il(e,t),this._sendFileMessage(i,Pc.RESEND,e.reqId).onFailed((function(e){return r.reject(e)})).onSucceeded((function(e){return r.resolve(e)})),[2,r.promise]}))}))},t.prototype.resendMessage=function(e,t){var n,r;if(hs(e instanceof au&&!e.scheduledInfo&&e.isResendable).throw(st.invalidParameters),e.isUserMessage()){var i=null!==(n=e.messageParams)&&void 0!==n?n:Zu(e);return this._sendUserMessage(i,Pc.RESEND,e.reqId)}if(e.isFileMessage()){var a=this._validateFailedFileMessageHasFile(e,t);return hs(a).throw(st.invalidParameters),i=null!==(r=e.messageParams)&&void 0!==r?r:il(e,t),this._sendFileMessage(i,Pc.RESEND,e.reqId)}if(e.isMultipleFilesMessage())throw st.channelTypeNotSupportedError},t.prototype.updateFileMessage=function(e,t){return Qe(this,void 0,void 0,(function(){var n,r,i;return Ke(this,(function(a){switch(a.label){case 0:return n=je(je({},cl),t),hs(ct("number",e)&&function(e){return ol(e)}(n)).throw(st.invalidParameters),r=eo.of(this._iid).requestQueue,i=new uc(je({channelType:this.channelType,channelUrl:this.url,messageId:e,metaArrayParams:n.metaArrays?{array:n.metaArrays,mode:"add",upsert:!0}:void 0},n)),[4,r.send(i)];case 1:return[2,a.sent().as(lc).message]}}))}))},t.prototype.cancelUploadingFileMessage=function(e){return Qe(this,void 0,void 0,(function(){return Ke(this,(function(t){return hs(ct("string",e)).throw(st.invalidParameters),vh.of(this._iid).fileMessageQueue.cancel(this,e),[2,!0]}))}))},t.prototype.copyFileMessage=function(e,n){var r,i,a;return Qe(this,void 0,void 0,(function(){var s,o;return Ke(this,(function(u){return hs(e instanceof t&&n instanceof yu&&n.sendingStatus===Dt.SUCCEEDED&&this.url===n.channelUrl&&!n.scheduledInfo).throw(st.invalidParameters),s=new Un,o=Vt(je(je({},n),{fileUrl:n.url,fileName:n.name,fileSize:n.size,mimeType:n.type,mentionType:n.mentionType,mentionedUserIds:null!==(r=n.mentionedUserIds)&&void 0!==r?r:null===(i=n.mentionedUsers)||void 0===i?void 0:i.map((function(e){return e.userId})),pushNotificationDeliveryOption:Ot.DEFAULT,parentMessageId:null,isReplyToChannel:!1,thumbnailSizes:null===(a=n.thumbnails)||void 0===a?void 0:a.map((function(e){return{maxWidth:e.width,maxHeight:e.height}})),requireAuth:n.requireAuth,isPinnedMessage:!1})),e._sendFileMessage(o).onSucceeded((function(e){return s.resolve(e)})).onFailed((function(e){return s.reject(e)})),[2,s.promise]}))}))},t.prototype.copyMessage=function(e,n){hs(e instanceof t&&n instanceof au&&n.sendingStatus===Dt.SUCCEEDED&&this.url===n.channelUrl&&!n.scheduledInfo).throw(st.invalidParameters);var r=n,i=e;if(r.isUserMessage()){hs(!r.poll).throw(st.notSupportedError);var a=Wu(r);return i._sendUserMessage(a)}if(r.isFileMessage())return a=nl(r),i._sendFileMessage(a);if(n.isMultipleFilesMessage())throw st.channelTypeNotSupportedError},t.prototype.deleteMessage=function(e){return Qe(this,void 0,void 0,(function(){var t,n;return Ke(this,(function(r){switch(r.label){case 0:return hs(e instanceof iu).throw(st.invalidParameters),e.messageId>0?(t=eo.of(this._iid).requestQueue,n=new cc({channelType:this.channelType,channelUrl:this.url,messageId:e.messageId}),[4,t.send(n)]):[3,2];case 1:r.sent(),r.label=2;case 2:return[2]}}))}))},t.prototype.addReaction=function(e,t){return Qe(this,void 0,void 0,(function(){var n,r;return Ke(this,(function(i){switch(i.label){case 0:return hs(e instanceof iu&&e.messageId>0&&ct("string",t)).throw(st.invalidParameters),n=eo.of(this._iid).requestQueue,r=new hc({channelType:this.channelType,channelUrl:this.url,messageId:e.messageId,reactionKey:t}),[4,n.send(r)];case 1:return[2,i.sent().as(fc).reactionEvent]}}))}))},t.prototype.deleteReaction=function(e,t){return Qe(this,void 0,void 0,(function(){var n,r;return Ke(this,(function(i){switch(i.label){case 0:return hs(e instanceof iu&&e.messageId>0&&ct("string",t)).throw(st.invalidParameters),n=eo.of(this._iid).requestQueue,r=new pc({channelType:this.channelType,channelUrl:this.url,messageId:e.messageId,reactionKey:t}),[4,n.send(r)];case 1:return[2,i.sent().as(_c).reactionEvent]}}))}))},t.prototype._updateUserMessageMetaArray=function(e,t,n,r){return Qe(this,void 0,void 0,(function(){var i,a,s,o,u,l;return Ke(this,(function(c){switch(c.label){case 0:return i=eo.of(this._iid),a=i.dispatcher,s=i.requestQueue,o=new sc({channelType:this.channelType,channelUrl:this.url,messageId:e,metaArrayParams:{array:t,mode:n,upsert:r}}),[4,s.send(o)];case 1:return u=c.sent(),l=u.as(oc).message,a.dispatch(new co({messages:[l],source:no.EVENT_MESSAGE_UPDATED})),[2,l]}}))}))},t.prototype._updateFileMessageMetaArray=function(e,t,n,r){return Qe(this,void 0,void 0,(function(){var i,a,s,o,u,l;return Ke(this,(function(c){switch(c.label){case 0:return i=eo.of(this._iid),a=i.dispatcher,s=i.requestQueue,o=new uc({channelType:this.channelType,channelUrl:this.url,messageId:e,metaArrayParams:{array:t,mode:n,upsert:r}}),[4,s.send(o)];case 1:return u=c.sent(),l=u.as(lc).message,a.dispatch(new co({messages:[l],source:no.EVENT_MESSAGE_UPDATED})),[2,l]}}))}))},t.prototype.createMessageMetaArrayKeys=function(e,t){return Qe(this,void 0,void 0,(function(){var n;return Ke(this,(function(r){return hs(e instanceof iu&&e.messageId>0&&ft("string",t)).throw(st.invalidParameters),n=t.map((function(e){return new $o({key:e})})),e instanceof yu?[2,this._updateFileMessageMetaArray(e.messageId,n,"add",!0)]:[2,this._updateUserMessageMetaArray(e.messageId,n,"add",!0)]}))}))},t.prototype.deleteMessageMetaArrayKeys=function(e,t){return Qe(this,void 0,void 0,(function(){var n;return Ke(this,(function(r){return hs(e instanceof iu&&e.messageId>0&&ft("string",t)).throw(st.invalidParameters),n=t.map((function(e){return new $o({key:e})})),e instanceof yu?[2,this._updateFileMessageMetaArray(e.messageId,n,"remove",!0)]:[2,this._updateUserMessageMetaArray(e.messageId,n,"remove",!0)]}))}))},t.prototype.addMessageMetaArrayValues=function(e,t){return Qe(this,void 0,void 0,(function(){return Ke(this,(function(n){return hs(e instanceof iu&&e.messageId>0&&t.every((function(e){return e instanceof $o}))).throw(st.invalidParameters),e instanceof yu?[2,this._updateFileMessageMetaArray(e.messageId,t,"add",!0)]:[2,this._updateUserMessageMetaArray(e.messageId,t,"add",!0)]}))}))},t.prototype.removeMessageMetaArrayValues=function(e,t){return Qe(this,void 0,void 0,(function(){return Ke(this,(function(n){return hs(e instanceof iu&&e.messageId>0&&t.every((function(e){return e instanceof $o}))).throw(st.invalidParameters),e instanceof yu?[2,this._updateFileMessageMetaArray(e.messageId,t,"remove",!0)]:[2,this._updateUserMessageMetaArray(e.messageId,t,"remove",!0)]}))}))},t.prototype.report=function(e,t){return Qe(this,void 0,void 0,(function(){var n,r,i,a;return Ke(this,(function(s){switch(s.label){case 0:return hs(dt(rl,e)&&ct("string",t)).throw(st.invalidParameters),n=eo.of(this._iid),r=n.sdkState,i=n.requestQueue,a=new tc({channelUrl:this.url,channelType:this.channelType,userId:r.userId,category:e,description:t}),[4,i.send(a)];case 1:return s.sent(),[2]}}))}))},t.prototype.reportUser=function(e,t,n){return Qe(this,void 0,void 0,(function(){var r,i,a,s;return Ke(this,(function(o){switch(o.label){case 0:return hs(e instanceof ps&&dt(rl,t)&&ct("string",n)).throw(st.invalidParameters),r=eo.of(this._iid),i=r.sdkState,a=r.requestQueue,s=new nc({channelUrl:this.url,channelType:this.channelType,userId:i.userId,offendingUserId:e.userId,category:t,description:n}),[4,a.send(s)];case 1:return o.sent(),[2]}}))}))},t.prototype.reportMessage=function(e,t,n){return Qe(this,void 0,void 0,(function(){var r,i,a,s;return Ke(this,(function(o){switch(o.label){case 0:return hs(e instanceof au&&dt(rl,t)&&ct("string",n)).throw(st.invalidParameters),r=eo.of(this._iid),i=r.sdkState,a=r.requestQueue,s=new rc({channelUrl:this.url,channelType:this.channelType,userId:i.userId,offendingUserId:e.sender.userId,messageId:e.messageId,category:t,description:n}),[4,a.send(s)];case 1:return o.sent(),[2]}}))}))},t.prototype.updatePoll=function(e,t){return Qe(this,void 0,void 0,(function(){var n,r;return Ke(this,(function(i){switch(i.label){case 0:return hs(ct("number",e)&&function(e){return ct("string",e.title,!0)&&ao(e.data)&&ct("boolean",e.allowUserSuggestion,!0)&&ct("boolean",e.allowMultipleVotes,!0)&&ct("number",e.closeAt,!0)}(t)).throw(st.invalidParameters),n=eo.of(this._iid).requestQueue,r=new Cc(je({pollId:e},t)),[4,n.send(r)];case 1:return[2,i.sent().as(wc).poll]}}))}))},t.prototype.deletePoll=function(e){return Qe(this,void 0,void 0,(function(){var t,n,r;return Ke(this,(function(i){switch(i.label){case 0:return t=ct("number",e),hs(t).throw(st.invalidParameters),n=eo.of(this._iid).requestQueue,r=new Sc({pollId:e}),[4,n.send(r)];case 1:return i.sent(),[2]}}))}))},t.prototype.closePoll=function(e){return Qe(this,void 0,void 0,(function(){var t,n,r;return Ke(this,(function(i){switch(i.label){case 0:return t=ct("number",e),hs(t).throw(st.invalidParameters),n=eo.of(this._iid).requestQueue,r=new Tc({pollId:e}),[4,n.send(r)];case 1:return[2,i.sent().as(Ic).poll]}}))}))},t.prototype.addPollOption=function(e,t){return Qe(this,void 0,void 0,(function(){var n,r,i;return Ke(this,(function(a){switch(a.label){case 0:return n=ct("number",e)&&ct("string",t)&&""!==t.trim(),hs(n).throw(st.invalidParameters),r=eo.of(this._iid).requestQueue,i=new Nc({channelUrl:this.url,channelType:this.channelType,pollId:e,optionText:t}),[4,r.send(i)];case 1:return[2,a.sent().as(Ac).poll]}}))}))},t.prototype.updatePollOption=function(e,t,n){return Qe(this,void 0,void 0,(function(){var r,i,a;return Ke(this,(function(s){switch(s.label){case 0:return r=ct("number",e)&&ct("number",t)&&ct("string",n)&&""!==n.trim(),hs(r).throw(st.invalidParameters),i=eo.of(this._iid).requestQueue,a=new kc({pollId:e,pollOptionId:t,optionText:n}),[4,i.send(a)];case 1:return[2,s.sent().as(Mc).poll]}}))}))},t.prototype.deletePollOption=function(e,t){return Qe(this,void 0,void 0,(function(){var n,r,i;return Ke(this,(function(a){switch(a.label){case 0:return n=ct("number",e)&&ct("number",t),hs(n).throw(st.invalidParameters),r=eo.of(this._iid).requestQueue,i=new Uc({pollId:e,pollOptionId:t}),[4,r.send(i)];case 1:return a.sent(),[2]}}))}))},t.prototype.votePoll=function(e,t){return Qe(this,void 0,void 0,(function(){var n,r,i,a,s,o,u;return Ke(this,(function(l){switch(l.label){case 0:return n=ct("number",e)&&ft("number",t),hs(n).throw(st.invalidParameters),r=eo.of(this._iid),i=r.requestQueue,a=r.dispatcher,s=new Oc({reqId:this._generateRequestId(),channelUrl:this.url,channelType:this.channelType,pollId:e,pollOptionIds:t}),[4,i.send(s)];case 1:return o=l.sent(),u=o.as(Dc).event,a.dispatch(new vo({event:u,source:no.EVENT_POLL_VOTED})),[2,u]}}))}))},t.prototype.getPollChangeLogsSinceTimestamp=function(e){return Qe(this,void 0,void 0,(function(){return Ke(this,(function(t){switch(t.label){case 0:return hs(ct("number",e)).throw(st.invalidParameters),[4,Ro.of(this._iid).getPollChangeLogs(this.url,this.channelType,e)];case 1:return[2,t.sent()]}}))}))},t.prototype.getPollChangeLogsSinceToken=function(e){return Qe(this,void 0,void 0,(function(){return Ke(this,(function(t){switch(t.label){case 0:return hs(ct("string",e,!0)),[4,Ro.of(this._iid).getPollChangeLogs(this.url,this.channelType,e)];case 1:return[2,t.sent()]}}))}))},t.prototype.createPollListQuery=function(e){return void 0===e&&(e=10),new Fo(this._iid,{channelUrl:this.url,channelType:this.channelType,limit:e})},t.prototype.createPollVoterListQuery=function(e,t,n){return void 0===n&&(n=20),new qo(this._iid,{channelUrl:this.url,channelType:this.channelType,pollId:e,pollOptionId:t,limit:n})},t}(ns),Vc=function(e){function t(t){void 0===t&&(t={});var n=e.call(this)||this;return Object.keys(t).forEach((function(e){n.hasOwnProperty(e)&&(n[e]=t[e])})),n}return Be(t,e),t}((function(){this.onConnected=Dn,this.onReconnectStarted=Dn,this.onReconnectSucceeded=Dn,this.onReconnectFailed=Dn,this.onDisconnected=Dn})),Gc=function(e){function t(t){void 0===t&&(t={});var n=e.call(this)||this;return Object.keys(t).forEach((function(e){n.hasOwnProperty(e)&&(n[e]=t[e])})),n}return Be(t,e),t}((function(){this.onSessionExpired=Dn,this.onSessionTokenRequired=function(e){return e(null)},this.onSessionError=Dn,this.onSessionRefreshed=Dn,this.onSessionClosed=Dn})),Bc=function(e){function t(t){void 0===t&&(t={});var n=e.call(this)||this;return Object.keys(t).forEach((function(e){n.hasOwnProperty(e)&&(n[e]=t[e])})),n}return Be(t,e),t}((function(){this.onFriendsDiscovered=Dn,this.onTotalUnreadMessageCountChanged=Dn,this.onTotalUnreadMessageCountUpdated=Dn})),jc=function(e){function t(t){var n=t.limit,r=t.token,i=t.userIdsFilter,a=t.metaDataKeyFilter,s=t.metaDataValuesFilter,o=t.nicknameStartsWithFilter,u=e.call(this)||this;return u.method=Gt.GET,u.path=jt,u.params=qt({limit:n,token:r,user_ids:i,metadatakey:a,metadatavalues_in:s,nickname_startswith:o}),u}return Be(t,e),t}(hn),Qc=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.users=n.users.map((function(e){return new ps(t,e)})),r.next=n.next,r}return Be(t,e),t}(fn),Kc=function(e){function t(t,n){var r,i,a,s=this;return(s=e.call(this,t,n)||this).userIdsFilter=null,s.metaDataKeyFilter=null,s.metaDataValuesFilter=null,s.nicknameStartsWithFilter=null,s.userIdsFilter=null!==(r=n.userIdsFilter)&&void 0!==r?r:null,s.metaDataKeyFilter=null!==(i=n.metaDataKeyFilter)&&void 0!==i?i:null,s.metaDataValuesFilter=null!==(a=n.metaDataValuesFilter)&&void 0!==a?a:null,s.nicknameStartsWithFilter=n.nicknameStartsWithFilter||null,s}return Be(t,e),t.prototype._validate=function(){return e.prototype._validate.call(this)&&ft("string",this.userIdsFilter,!0)&&ct("string",this.metaDataKeyFilter,!0)&&ft("string",this.metaDataValuesFilter,!0)&&ct("string",this.nicknameStartsWithFilter,!0)},t.prototype.next=function(){return Qe(this,void 0,void 0,(function(){var e,t,n,r,i,a;return Ke(this,(function(s){switch(s.label){case 0:return this._validate()?this._isLoading?[3,3]:this._hasNext?(this._isLoading=!0,e=eo.of(this._iid).requestQueue,t=new jc(Vt(je(je({},this),{token:this._token}))),[4,e.send(t)]):[3,2]:[3,5];case 1:return n=s.sent(),r=n.as(Qc),i=r.users,a=r.next,this._token=a,this._hasNext=!!a,this._isLoading=!1,[2,i];case 2:return[2,[]];case 3:throw st.queryInProgress;case 4:return[3,6];case 5:throw st.invalidParameters;case 6:return[2]}}))}))},t}(mo),Wc=function(e){function t(t){var n=t.userId,r=t.limit,i=t.token,a=t.userIdsFilter,s=e.call(this)||this;return s.method=Gt.GET,s.path="".concat(jt,"/").concat(n,"/block"),s.params=qt({limit:r,token:i,user_ids:a}),s}return Be(t,e),t}(hn),Yc=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.users=n.users.map((function(e){return new ps(t,e)})),r.next=n.next,r}return Be(t,e),t}(fn),Zc=function(e){function t(t,n){var r,i=this;return(i=e.call(this,t,n)||this).userIdsFilter=null,i.userIdsFilter=null!==(r=n.userIdsFilter)&&void 0!==r?r:null,i}return Be(t,e),t.prototype._validate=function(){return e.prototype._validate.call(this)&&ft("string",this.userIdsFilter,!0)},t.prototype.next=function(){return Qe(this,void 0,void 0,(function(){var e,t,n,r,i,a,s,o;return Ke(this,(function(u){switch(u.label){case 0:return this._validate()?this._isLoading?[3,3]:this._hasNext?(this._isLoading=!0,e=eo.of(this._iid),t=e.sdkState,n=e.requestQueue,r=new Wc(Vt(je(je({},this),{userId:t.userId,token:this._token}))),[4,n.send(r)]):[3,2]:[3,5];case 1:return i=u.sent(),a=i.as(Yc),s=a.users,o=a.next,this._token=o,this._hasNext=!!o,this._isLoading=!1,[2,s];case 2:return[2,[]];case 3:throw st.queryInProgress;case 4:return[3,6];case 5:throw st.invalidParameters;case 6:return[2]}}))}))},t}(mo),Jc=function(e){function t(t){var n=t.userId,r=t.limit,i=t.token,a=e.call(this)||this;return a.method=Gt.GET,a.path="".concat(jt,"/").concat(encodeURIComponent(n),"/friends"),a.params={limit:r,token:i},a}return Be(t,e),t}(hn),Xc=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.hasMore=n.has_more,r.users=n.users.map((function(e){return new ps(t,e)})),r.next=n.next,r}return Be(t,e),t}(fn),$c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Be(t,e),t.prototype._validate=function(){return e.prototype._validate.call(this)},t.prototype.next=function(){return Qe(this,void 0,void 0,(function(){var e,t,n,r,i,a,s,o,u;return Ke(this,(function(l){switch(l.label){case 0:return this._validate()?this._isLoading?[3,3]:this._hasNext?(this._isLoading=!0,e=eo.of(this._iid),t=e.sdkState,n=e.requestQueue,r=new Jc(je(je({},this),{userId:t.userId,token:this._token})),[4,n.send(r)]):[3,2]:[3,5];case 1:return i=l.sent(),a=i.as(Xc),s=a.users,o=a.hasMore,u=a.next,this._token=u,this._hasNext=o,this._isLoading=!1,[2,s];case 2:return[2,[]];case 3:throw st.queryInProgress;case 4:return[3,6];case 5:throw st.invalidParameters;case 6:return[2]}}))}))},t}(mo),ed={},td=function(){function e(e){var t=e.dbname,n=e.itemSizeLimit,r=void 0===n?1048576:n,i=e.cacheLimit,a=void 0===i?256:i,s=e.blockHashBase,o=void 0===s?2:s,u=e.blockHashMultiplier,l=void 0===u?10:u,c=e.blockHashConstant,d=void 0===c?11:c,h=e.transactionApplyDelay,f=void 0===h?200:h,p=e.disableLogger,_=void 0!==p&&p;return ed[t]||(this.itemSizeLimit=r,this.cacheLimit=a,this.blockHashBase=o,this.blockHashMultiplier=l,this.blockHashConstant=d,this.transactionApplyDelay=f,this.disableLogger=_,ed[t]=this),ed[t]}return e.get=function(e){return ed[e]},e}();!function(e){e[e.UNKNOWN_ERROR=6e7]="UNKNOWN_ERROR",e[e.STORE_NOT_DEFINED=61001e3]="STORE_NOT_DEFINED",e[e.STORE_NOT_AVAILABLE=61001001]="STORE_NOT_AVAILABLE",e[e.STORE_NOT_AVAILABLE_IN_PRIVATE_BROWSING=61001002]="STORE_NOT_AVAILABLE_IN_PRIVATE_BROWSING",e[e.STORE_IS_FULL=61001003]="STORE_IS_FULL",e[e.STORE_NOT_INITIALIZED=61001004]="STORE_NOT_INITIALIZED",e[e.STORE_INVALID_KEY_TYPE=61002e3]="STORE_INVALID_KEY_TYPE",e[e.STORE_BROKEN_INTEGRITY=61002001]="STORE_BROKEN_INTEGRITY",e[e.STORE_BROKEN_BLOB=61002002]="STORE_BROKEN_BLOB",e[e.STORE_ENCRYPTION_INVALID=61002003]="STORE_ENCRYPTION_INVALID",e[e.STORE_ITEM_SIZE_LIMIT_EXCEEDED=61017e3]="STORE_ITEM_SIZE_LIMIT_EXCEEDED",e[e.STORE_READ_FAILED=61017001]="STORE_READ_FAILED",e[e.STORE_WRITE_FAILED=61017002]="STORE_WRITE_FAILED",e[e.DATABASE_SCHEMA_NOT_ON_UPGRADE=62002e3]="DATABASE_SCHEMA_NOT_ON_UPGRADE",e[e.COLLECTION_NOT_READY=63001e3]="COLLECTION_NOT_READY",e[e.COLLECTION_KEY_NOT_MATCH=63002e3]="COLLECTION_KEY_NOT_MATCH",e[e.COLLECTION_QUERY_NOT_VALID=63002001]="COLLECTION_QUERY_NOT_VALID",e[e.COLLECTION_KEY_NOT_FOUND=63004e3]="COLLECTION_KEY_NOT_FOUND",e[e.COLLECTION_KEY_NOT_GIVEN=63004001]="COLLECTION_KEY_NOT_GIVEN",e[e.COLLECTION_INSERT_DUPLICATE=63009e3]="COLLECTION_INSERT_DUPLICATE",e[e.COLLECTION_WRITE_FAILED=63017e3]="COLLECTION_WRITE_FAILED",e[e.COLLECTION_ITEM_SIZE_LIMIT_EXCEEDED=63017001]="COLLECTION_ITEM_SIZE_LIMIT_EXCEEDED",e[e.INDEX_TABLE_IS_REQUIRED=65001e3]="INDEX_TABLE_IS_REQUIRED",e[e.INDEX_TYPE_NOT_MATCH=65002e3]="INDEX_TYPE_NOT_MATCH",e[e.COMPARE_TYPE_NOT_MATCH=69002001]="COMPARE_TYPE_NOT_MATCH",e[e.CIRCULAR_REFERENCE_FOUND=69002002]="CIRCULAR_REFERENCE_FOUND"}(Hc||(Hc={}));var nd,rd=function(e){function t(n){var r=n.code,i=void 0===r?Hc.UNKNOWN_ERROR:r,a=n.message,s=void 0===a?"Unknown error occurred.":a,o=e.call(this,s)||this;return o.code=i,Object.setPrototypeOf(o,t.prototype),o}return Be(t,e),Object.defineProperty(t,"storeNotDefined",{get:function(){return new t({code:Hc.STORE_NOT_DEFINED,message:"Store is not defined. Specify the store on NestDB()"})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"storeNotAvailable",{get:function(){return new t({code:Hc.STORE_NOT_AVAILABLE,message:"Store is not available. Check your environment settings."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"storeNotAvailableInPrivateBrowsing",{get:function(){return new t({code:Hc.STORE_NOT_AVAILABLE_IN_PRIVATE_BROWSING,message:"Store is not available because it is in private browsing."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"storeIsFull",{get:function(){return new t({code:Hc.STORE_IS_FULL,message:"Store is full."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"storeNotInitialized",{get:function(){return new t({code:Hc.STORE_NOT_INITIALIZED,message:"Store is not initialized."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"storeKeyTypeIsInvalid",{get:function(){return new t({code:Hc.STORE_INVALID_KEY_TYPE,message:"Store key should be string type."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"storeBrokenIntegrity",{get:function(){return new t({code:Hc.STORE_BROKEN_INTEGRITY,message:"Data should be in a store but it does not. Integrity is broken."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"storeBrokenBlob",{get:function(){return new t({code:Hc.STORE_BROKEN_BLOB,message:"Data should be in a store but it does not. Blob data is broken."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"storeEncryptionInvalid",{get:function(){return new t({code:Hc.STORE_ENCRYPTION_INVALID,message:"Encryption algorithm has changed. All the store should reset."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"storeItemSizeExceeded",{get:function(){return new t({code:Hc.STORE_ITEM_SIZE_LIMIT_EXCEEDED,message:"The size of the item exceeds the limit that the store allows."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"storeReadFailed",{get:function(){return new t({code:Hc.STORE_READ_FAILED,message:"Failed to read from store."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"storeWriteFailed",{get:function(){return new t({code:Hc.STORE_WRITE_FAILED,message:"Failed to write to store."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"databaseSchemaNotOnUpgrade",{get:function(){return new t({code:Hc.DATABASE_SCHEMA_NOT_ON_UPGRADE,message:"Committing schema is not allowed when upgrade is not running."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"collectionNotReady",{get:function(){return new t({code:Hc.COLLECTION_NOT_READY,message:"Collection is not ready due to an error during initialization."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"collectionKeyNotMatch",{get:function(){return new t({code:Hc.COLLECTION_KEY_NOT_MATCH,message:"keyName of collection could not change."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"collectionQueryNotValid",{get:function(){return new t({code:Hc.COLLECTION_QUERY_NOT_VALID,message:"Query parameter is not a valid format."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"collectionInsertDuplicate",{get:function(){return new t({code:Hc.COLLECTION_INSERT_DUPLICATE,message:"The key already exists."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"collectionKeyNotFound",{get:function(){return new t({code:Hc.COLLECTION_KEY_NOT_FOUND,message:"The key is not found."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"collectionKeyNotGiven",{get:function(){return new t({code:Hc.COLLECTION_KEY_NOT_GIVEN,message:"The item should contain [keyName] property."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"collectionWriteFailed",{get:function(){return new t({code:Hc.COLLECTION_WRITE_FAILED,message:"Failed to write an item."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"collectionItemSizeExceeded",{get:function(){return new t({code:Hc.COLLECTION_ITEM_SIZE_LIMIT_EXCEEDED,message:"The size of the item exceeds the limit that a collection allows."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"indexTableIsRequired",{get:function(){return new t({code:Hc.INDEX_TABLE_IS_REQUIRED,message:"Index table is required."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"indexTypesNotMatch",{get:function(){return new t({code:Hc.INDEX_TYPE_NOT_MATCH,message:"Indexed column should have primitive type."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"compareTypesNotMatch",{get:function(){return new t({code:Hc.COMPARE_TYPE_NOT_MATCH,message:"Values to compare have different types."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"circularReferenceFound",{get:function(){return new t({code:Hc.CIRCULAR_REFERENCE_FOUND,message:"Cannot handle circular referenced object."})},enumerable:!1,configurable:!0}),t}(Error);!function(e){e.INIT="init",e.READY="ready",e.CLOSED="closed"}(nd||(nd={}));var id,ad=function(e,t){if(void 0===t&&(t=new WeakMap),"object"==typeof e&&null!==e){if(t.has(e))throw rd.circularReferenceFound;t.set(e,!0);var n=void 0;if(Array.isArray(e))n=e.map((function(e){return ad(e,t)}));else if(e instanceof RegExp)n=e;else if(e instanceof Date)n=e;else for(var r in n={},e)n[r]=ad(e[r],t);return t.delete(e),n}return e},sd=function(e,t){if(null==t)return 1;if(null==e)return-1;if(typeof e!=typeof t)throw rd.compareTypesNotMatch;var n=0;switch(typeof e){case"boolean":case"number":n=e-t;break;case"string":n=e.localeCompare(t)}return n},od=function(e,t){for(var n=0,r=0;r<e.length;r++)n=e.charCodeAt(r)+(n<<6)+(n<<16)-n;return(n>>>0)%t},ud=function(e){return new Promise((function(t){setTimeout((function(){return t()}),e)}))},ld=function(e,t){if(!t)return!1;if("function"!=typeof e){for(var n in e)if(["/and","&&"].includes(n)){if(e[n].some((function(e){return!ld(e,t)})))return!1}else if(["/or","||"].includes(n)){if(e[n].every((function(e){return!ld(e,t)})))return!1}else if("/where"===n){if(!(0,e[n])(t))return!1}else{var r=n;if("object"==typeof e[r]){var i=e[r];for(var a in i)switch(a){case"/eq":case"=":if((s=t[r])!==(o=i[a]))return!1;break;case"/neq":case"!=":if((s=t[r])===(o=i[a]))return!1;break;case"/gt":case">":var s=t[r],o=i[a];if(!(sd(s,o)>0))return!1;break;case"/gte":case">=":if(s=t[r],o=i[a],!(sd(s,o)>=0))return!1;break;case"/lt":case"<":if(s=t[r],o=i[a],!(sd(s,o)<0))return!1;break;case"/lte":case"<=":if(s=t[r],o=i[a],!(sd(s,o)<=0))return!1;break;case"/in":if(s=t[r],!(o=i[a]).includes(s))return!1;break;case"/nin":if(s=t[r],(o=i[a]).includes(s))return!1;break;case"/contain":if(s=t[r],o=i[a],!s.includes(o))return!1;break;case"/regex":if(s=t[r],!(o=i[a]).test(s))return!1;break;case"/where":if(s=t[r],!(0,i[a])(s))return!1}}else if("function"==typeof e[r]){if(!e[r](t[r]))return!1}else if(e[r]!==t[r])return!1}return!0}return e(t)},cd=function(){},dd=function(){return Promise.resolve()},hd=function(e){return e},fd=function(e,t){t()};!function(e){e[e.FORWARD=0]="FORWARD",e[e.BACKWARD=1]="BACKWARD"}(id||(id={}));var pd,_d,vd,md=function(){function e(e){var t=e.initialPrevValue,n=void 0===t?null:t,r=e.initialNextValue,i=void 0===r?null:r,a=e.iterator,s=e.map,o=void 0===s?hd:s,u=e.backward,l=void 0===u?dd:u,c=e.forward,d=void 0===c?dd:c,h=e.complete,f=void 0===h?cd:h;this._prevValue=n,this._nextValue=i,this._error=null,this._map=o,this._backward=l,this._forward=d,this._iterator=a,this._complete=f}return Object.defineProperty(e.prototype,"prevValue",{get:function(){return this._map(this._prevValue)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"nextValue",{get:function(){return this._map(this._nextValue)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"error",{get:function(){return this._error},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hasPrevious",{get:function(){return!!this._prevValue},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hasNext",{get:function(){return!!this._nextValue},enumerable:!1,configurable:!0}),e.prototype.prev=function(){return Qe(this,void 0,void 0,(function(){var e,t,n;return Ke(this,(function(r){switch(r.label){case 0:if(!this.hasPrevious)return[3,6];r.label=1;case 1:return r.trys.push([1,3,,4]),e=this._prevValue,t=this,[4,this._backward()];case 2:return t._prevValue=r.sent()||null,this._nextValue=e,[3,4];case 3:return n=r.sent(),this._error=n,[3,4];case 4:return[4,this._iterator(this)];case 5:return[2,r.sent()];case 6:this._complete(),r.label=7;case 7:return[2]}}))}))},e.prototype.next=function(){return Qe(this,void 0,void 0,(function(){var e,t,n;return Ke(this,(function(r){switch(r.label){case 0:if(!this.hasNext)return[3,6];r.label=1;case 1:return r.trys.push([1,3,,4]),e=this._nextValue,t=this,[4,this._forward()];case 2:return t._nextValue=r.sent()||null,this._prevValue=e,[3,4];case 3:return n=r.sent(),this._error=n,[3,4];case 4:return[4,this._iterator(this)];case 5:return[2,r.sent()];case 6:this._complete(),r.label=7;case 7:return[2]}}))}))},e.prototype.stop=function(){this._prevValue=null,this._nextValue=null,this._complete()},e}(),gd=function(){function e(e){var t=e.condition,n=void 0===t?{}:t,r=e.backward,i=void 0!==r&&r,a=e.blockManager,s=e.indexer;this.condition=n,this.backward=i,this._blockManager=a,this._indexer=s}return e.prototype.findOptimizedStartPosition=function(){var e=this,t=["=","/eq",">",">=","/gt","/gte"],n=["=","/eq","<","<=","/lt","/lte"];if(this.backward){var r=this._indexer.origin.length-1;if("function"!=typeof this.condition)for(var i in this._indexer.fields){var a=this._indexer.fields[i],s=1;if("-"===a[0]&&(a=a.slice(1),s=-1),this.condition[a])if("object"==typeof this.condition[a]){var o=s>0?n:t;for(var u in this.condition[a])if(o.includes(u))for(var l=r;l>=0;l--)if(s*sd(this._indexer.origin[l].columnValues[i],this.condition[a][u])<=0){r=l;break}}else for(l=r;l>=0;l--)if(s*sd(this._indexer.origin[l].columnValues[i],this.condition[a])<=0){r=l;break}}return Math.min(r+1,this._indexer.origin.length-1)}var c=0;if("function"!=typeof this.condition){var d=function(r){var i=h._indexer.fields[r],a=1;if("-"===i[0]&&(i=i.slice(1),a=-1),h.condition[i])if("object"==typeof h.condition[i])Object.keys(h.condition[i]).forEach((function(s){if((a>0?t:n).includes(s))for(var o=c;o<e._indexer.origin.length;o++)if(a*sd(e._indexer.origin[o].columnValues[r],e.condition[i][s])>=0){c=o;break}}));else for(var s=c;s<h._indexer.origin.length;s++)if(a*sd(h._indexer.origin[s].columnValues[r],h.condition[i])>=0){c=s;break}},h=this;for(i=0;i<this._indexer.fields.length;i++)d(i)}return Math.max(c-1,0)},e.prototype.each=function(e){return Qe(this,void 0,void 0,(function(){var t,n,r,i,a,s,o,u=this;return Ke(this,(function(l){switch(l.label){case 0:if(t=this.findOptimizedStartPosition(),n=0,this.backward&&this._indexer.origin[t]&&(n=this._indexer.origin[t].keys.length-1),r=function(){if(u._indexer.origin[t]){if(!u._indexer.origin[t].keys[++n]){if(!u._indexer.origin[++t])return!1;n=0}return!0}return!1},i=function(){if(u._indexer.origin[t]){if(!u._indexer.origin[t].keys[--n]){if(!u._indexer.origin[--t])return!1;n=u._indexer.origin[t].keys.length-1}return!0}return!1},a=null,!this._indexer.origin[t])return[3,4];s=this.backward?i:r,l.label=1;case 1:return[4,this._blockManager.getFromBlock(this._indexer.origin[t].keys[n])];case 2:if((o=l.sent())&&ld(this.condition,o))return a=o,[3,4];l.label=3;case 3:if(s())return[3,1];l.label=4;case 4:return[4,new Promise((function(s){var o=new md({initialNextValue:ad(a),iterator:e,forward:function(){return Qe(u,void 0,void 0,(function(){var e,a;return Ke(this,(function(s){switch(s.label){case 0:e=this.backward?i:r,s.label=1;case 1:return e()?[4,this._blockManager.getFromBlock(this._indexer.origin[t].keys[n])]:[3,3];case 2:return(a=s.sent())&&ld(this.condition,a)?[2,ad(a)]:[3,1];case 3:return[2,null]}}))}))},backward:function(){return Qe(u,void 0,void 0,(function(){var e,a;return Ke(this,(function(s){switch(s.label){case 0:e=this.backward?r:i,s.label=1;case 1:return e()?[4,this._blockManager.getFromBlock(this._indexer.origin[t].keys[n])]:[3,3];case 2:return(a=s.sent())&&ld(this.condition,a)?[2,ad(a)]:[3,1];case 3:return[2,null]}}))}))},complete:s});e(o)}))];case 5:return[2,l.sent()]}}))}))},e}(),yd=function(){function e(e){var t=e.condition,n=void 0===t?{}:t,r=e.backward,i=void 0!==r&&r,a=e.mutex,s=e.blockManager,o=e.indexer;this._mutex=a,this._iterator=new gd({condition:n,backward:i,blockManager:s,indexer:o})}return e.prototype.fetch=function(e){return void 0===e&&(e={}),Qe(this,void 0,void 0,(function(){var t,n,r,i,a=this;return Ke(this,(function(s){switch(s.label){case 0:if(t=Math.max(e.offset||0,0),0===(n="number"==typeof e.limit?e.limit:Number.MAX_SAFE_INTEGER))return[2,[]];if(n<0)throw rd.collectionQueryNotValid;s.label=1;case 1:return s.trys.push([1,4,,5]),r=[],[4,this._mutex.lock()];case 2:return s.sent(),[4,this._iterator.each((function(e){return Qe(a,void 0,void 0,(function(){return Ke(this,(function(i){return e.error?e.stop():e.hasNext?0===t?(r.push(e.nextValue),0<n&&n<=r.length?e.stop():e.next()):(t--,e.next()):e.stop(),[2]}))}))}))];case 3:return s.sent(),this._mutex.unlock(),[2,r];case 4:throw i=s.sent(),this._mutex.unlock(),i;case 5:return[2]}}))}))},e.prototype.count=function(){return Qe(this,void 0,void 0,(function(){var e,t,n=this;return Ke(this,(function(r){switch(r.label){case 0:return r.trys.push([0,3,,4]),e=0,[4,this._mutex.lock()];case 1:return r.sent(),[4,this._iterator.each((function(t){return Qe(n,void 0,void 0,(function(){return Ke(this,(function(n){return t.error?t.stop():t.hasNext?(e++,t.next()):t.stop(),[2]}))}))}))];case 2:return r.sent(),this._mutex.unlock(),[2,e];case 3:throw t=r.sent(),this._mutex.unlock(),t;case 4:return[2]}}))}))},e}(),Ed=function(e){return"".concat("nest","@").concat(e)},bd=function(e,t){return"".concat(Ed(e),"/").concat(t)},Cd=function(e,t){return"".concat(bd(e,t),".metadata")},wd=function(e,t){return"".concat(bd(e,t),"/block.")},Sd=function(e,t){return"".concat(bd(e,t),"/blob.")},Td=function(){function e(e){var t=e.dbname,n=e.collectionName,r=e.store;this.dbname=t,this.collectionName=n,this.store=r}return e.prototype.get=function(e){return Qe(this,void 0,void 0,(function(){var t,n,r,i,a,s,o,u,l;return Ke(this,(function(c){switch(c.label){case 0:return[4,this.store.get(e)];case 1:return(t=c.sent())?(n=t.data,r=t.type,"undefined"==typeof fetch?[3,4]:[4,fetch(n)]):[3,5];case 2:return[4,c.sent().blob()];case 3:return[2,c.sent()];case 4:for(i=[],a=atob(n.split(",")[1]),s=0;s<a.length;s+=512){for(o=a.slice(s,s+512),u=new Array(o.length),l=0;l<o.length;l++)u[l]=o.charCodeAt(l);i.push(new Uint8Array(u))}return[2,new Blob(i,{type:r})];case 5:return[2,null]}}))}))},e.prototype.save=function(e,t){return void 0===t&&(t="".concat(Date.now())),Qe(this,void 0,void 0,(function(){var n,r,i,a,s=this;return Ke(this,(function(o){switch(o.label){case 0:return[4,new Promise((function(n){var r=function(e,t,n,r){return void 0===r&&(r=0),"".concat(Sd(e,t)).concat(n,".").concat(r)}(s.dbname,s.collectionName,t),i=new FileReader;i.onload=function(){n({blobId:r,data:i.result,type:e.type})},i.readAsDataURL(e)}))];case 1:return n=o.sent(),r=n.blobId,i=n.data,a=n.type,[4,this.store.set({key:r,value:{data:i,type:a}})];case 2:return o.sent(),[2,r]}}))}))},e.prototype.remove=function(e){return Qe(this,void 0,void 0,(function(){return Ke(this,(function(t){switch(t.label){case 0:return[4,this.store.remove(e)];case 1:return t.sent(),[2]}}))}))},e.prototype.clear=function(){return Qe(this,void 0,void 0,(function(){var e,t,n=this;return Ke(this,(function(r){switch(r.label){case 0:return e=Sd(this.dbname,this.collectionName),[4,this.store.getAllKeys()];case 1:return t=r.sent(),[4,Promise.all(t.filter((function(t){return t.startsWith(e)})).map((function(e){return Qe(n,void 0,void 0,(function(){return Ke(this,(function(t){switch(t.label){case 0:return[4,this.store.remove(e)];case 1:return[2,t.sent()]}}))}))})))];case 2:return r.sent(),[2]}}))}))},e}();!function(e){e[e.COMMIT=0]="COMMIT",e[e.WRITE=1]="WRITE",e[e.ERROR=2]="ERROR"}(pd||(pd={})),function(e){e.PENDING="pending",e.PERSISTENT="persistent",e.VOLATILE="volatile"}(_d||(_d={})),function(e){e[e.NO_CACHE=0]="NO_CACHE",e[e.DEFAULT=1]="DEFAULT",e[e.PERSISTENT=2]="PERSISTENT"}(vd||(vd={}));var Id,Nd,Ad=[_d.PENDING,_d.VOLATILE],kd={},Md=function(){function e(e){var t=e.dbname,n=e.limit,r=void 0===n?256:n;return kd[t]||(this.dbname=t,this._items=[],this._limit=r,kd[t]=this),kd[t]}return e.get=function(e){return kd[e]},Object.defineProperty(e.prototype,"items",{get:function(){return this._items},enumerable:!1,configurable:!0}),e.prototype.find=function(e,t,n){return void 0===n&&(n=vd.DEFAULT),Qe(this,void 0,void 0,(function(){var r,i;return Ke(this,(function(a){switch(a.label){case 0:return(r=this.get(t))?[3,2]:[4,e.get(t)];case 1:return(i=a.sent())&&(r={key:t,value:i,state:n===vd.PERSISTENT?_d.PERSISTENT:_d.VOLATILE},this.put(r)),[3,3];case 2:n===vd.PERSISTENT&&(r.state=_d.PERSISTENT),a.label=3;case 3:return[2,r]}}))}))},e.prototype.get=function(e,t){void 0===t&&(t=vd.DEFAULT);var n=this._items.map((function(e){return e.key})).indexOf(e);if(n>-1){var r=this._items[n];return t===vd.PERSISTENT&&(r.state=_d.PERSISTENT),t!==vd.NO_CACHE&&this.put(r),r}return null},e.prototype.put=function(e){var t,n;if(this._limit>0){var r=this._items.map((function(e){return e.key})).indexOf(e.key);if(r>-1)Ad.includes(this._items[r].state)&&Ad.includes(e.state)?(this._items.splice(r,1),this._items.push(e)):(this._items[r].state=e.state,this._items[r].value=e.value);else{this._items.push(e);var i=this._items.filter((function(e){return e.state===_d.VOLATILE})),a=i.length-this._limit;if(a>0){var s=[];try{for(var o=We(this._items),u=o.next();!u.done;u=o.next()){var l=u.value;l.state===_d.VOLATILE&&a>0?a--:s.push(l)}}catch(e){t={error:e}}finally{try{u&&!u.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}this._items=s}}}},e.prototype.remove=function(e){var t=this._items.map((function(e){return e.key})).indexOf(e);t>-1&&this._items.splice(t,1)},e.prototype.clearByCondition=function(e){this._items=this._items.filter((function(t){return!e(t)}))},e.prototype.clear=function(e){void 0===e&&(e=!1),this._items=e?[]:this._items.filter((function(e){return e.state!==_d.VOLATILE}))},e}(),Ud=function(){function e(e){var t=e.dbname,n=e.collectionName,r=e.store;this._requests=[],this._onCommit=new Map,this._onWrite=new Map,this._onError=new Map,this.dbname=t,this.collectionName=n,this.metadataKey=function(e,t){return"".concat(bd(e,t),"/trans.metadata")}(t,n),this.recordsetKey=function(e,t){return"".concat(bd(e,t),"/trans.recordset")}(t,n),this._store=r}return Object.defineProperty(e.prototype,"generation",{get:function(){return this._metadata?this._metadata.generation:0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"requestCount",{get:function(){return this._requests.length},enumerable:!1,configurable:!0}),e.prototype._getReducedRecordset=function(e){return void 0===e&&(e=[]),Qe(this,void 0,void 0,(function(){var t;return Ke(this,(function(n){switch(n.label){case 0:return[4,this._store.get(this.recordsetKey)];case 1:return(t=n.sent()||[]).push.apply(t,Ze([],Ye(e),!1)),[2,this._reduceRecordSet(t)]}}))}))},e.prototype._reduceRecordSet=function(e){for(var t=[],n={},r=e.length-1;r>=0;r--){for(var i=e[r],a=[],s=i.requests.length-1;s>=0;s--){var o=i.requests[s],u=o.data;n[u.key]||(a.unshift(o),n[u.key]=!0)}a.length>0&&(i.requests=a,t.unshift(i))}return t},e.prototype._applyRecord=function(e,t){return Qe(this,void 0,void 0,(function(){var n,r,i,a,s,o,u,l,c;return Ke(this,(function(d){switch(d.label){case 0:n=Md.get(this.dbname),r=t.generation,i=t.requests,a=null,d.label=1;case 1:return d.trys.push([1,3,,4]),[4,this._store.setMany(i.map((function(e){return je(je({},e.data),{generation:r})})))];case 2:for(s=d.sent(),o=0;o<i.length;o++)s[o]instanceof Error&&(a||(a=s[o]),u=i[o].data,n.put(je(je({},u),{state:_d.PERSISTENT})));return[3,4];case 3:return l=d.sent(),a=l,[3,4];case 4:return a?[3,6]:(c=e.filter((function(e){return e.generation!==r})),[4,this._store.set({key:this.recordsetKey,value:c})]);case 5:return d.sent(),this._onWrite.forEach((function(e){e(i.map((function(e){return e.data})))})),[3,7];case 6:this._onError.forEach((function(e){a&&e(a)})),d.label=7;case 7:return[2]}}))}))},e.prototype.init=function(){return Qe(this,void 0,void 0,(function(){var e,t,n,r,i,a,s,o;return Ke(this,(function(u){switch(u.label){case 0:return e=this,[4,this._store.get(this.metadataKey)];case 1:return e._metadata=u.sent()||{generation:1},[4,this._getReducedRecordset()];case 2:t=u.sent(),u.label=3;case 3:u.trys.push([3,8,9,10]),n=We(t),r=n.next(),u.label=4;case 4:return r.done?[3,7]:(i=r.value,[4,this._applyRecord(t,i)]);case 5:u.sent(),u.label=6;case 6:return r=n.next(),[3,4];case 7:return[3,10];case 8:return a=u.sent(),s={error:a},[3,10];case 9:try{r&&!r.done&&(o=n.return)&&o.call(n)}finally{if(s)throw s.error}return[7];case 10:return[2]}}))}))},e.prototype.on=function(e,t,n){switch(e){case pd.COMMIT:this._onCommit.set(t,n);break;case pd.WRITE:this._onWrite.set(t,n);break;case pd.ERROR:this._onError.set(t,n)}},e.prototype.requestWrite=function(e,t){this._requests.push({data:e,options:t}),Md.get(this.dbname).put(je({state:_d.PENDING},e))},e.prototype.requestMultipleWrite=function(e,t){var n,r,i=Md.get(this.dbname);try{for(var a=We(e),s=a.next();!s.done;s=a.next()){var o=s.value;this._requests.push({data:o,options:t}),i.put(je({state:_d.PENDING},o))}}catch(e){n={error:e}}finally{try{s&&!s.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}},e.prototype.clear=function(){return Qe(this,void 0,void 0,(function(){return Ke(this,(function(e){return Md.get(this.dbname).clearByCondition((function(e){return e.state===_d.PENDING})),this._requests=[],[2]}))}))},e.prototype.commit=function(){return Qe(this,void 0,void 0,(function(){var e,t,n,r,i,a,s,o,u,l,c,d,h=this;return Ke(this,(function(f){switch(f.label){case 0:if(!((e=this._requests).length>0))return[3,4];for(t=[],n={},o=e.length-1;o>=0;o--)r=e[o],l=r.data,n[l.key]||(n[l.key]=!0,t.unshift(r));return i={generation:this.generation,requests:t},[4,this._getReducedRecordset([i])];case 1:return a=f.sent(),[4,this._store.set({key:this.recordsetKey,value:a})];case 2:return f.sent(),this._metadata.generation++,[4,this._store.set({key:this.metadataKey,value:this._metadata})];case 3:for(f.sent(),s=Md.get(this.dbname),o=0;o<t.length;o++)u=t[o],l=u.data,c=u.options,s.put(je(je({},l),{state:c&&c.persistent?_d.PERSISTENT:_d.VOLATILE}));this._requests=[],this._onCommit.forEach((function(t){t(e.map((function(e){return e.data})))})),d=td.get(this.dbname),setTimeout((function(){try{h._applyRecord(a,i)}catch(e){h._onError.forEach((function(n){return n(e)}))}}),d.transactionApplyDelay),f.label=4;case 4:return[2]}}))}))},e}(),Od=function(){function e(e){var t=e.blockId,n=e.keyName,r=e.items,i=void 0===r?[]:r,a=e.limit;this.blockId=t,this.keyName=n,this.limit=a,this._items=Ze([],Ye(i),!1)}return e.createFromCacheItem=function(t){return t?new e(t.value):null},Object.defineProperty(e.prototype,"isEmpty",{get:function(){return 0===this._items.length},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"items",{get:function(){return this._items},enumerable:!1,configurable:!0}),e.prototype.serialize=function(){return{blockId:this.blockId,keyName:this.keyName,limit:this.limit,items:this._items}},e.prototype.getItemByKey=function(e){var t=this,n=this._items.find((function(n){var r=n[t.keyName];return e===r}));return null!=n?n:null},e.prototype.has=function(e){var t=this;return this._items.map((function(e){return e[t.keyName]})).includes(e)},e.prototype.add=function(e){var t=this,n=this._items.map((function(e){return e[t.keyName]})).indexOf(e[this.keyName]);return n<0?this._items.length<this.limit&&(this._items.push(e),!0):(this._items[n]=e,!0)},e.prototype.remove=function(e){for(var t in this._items)if(this._items[t][this.keyName]===e)return this._items.splice(parseInt(t),1),!0;return!1},e.prototype.clear=function(){this._items=[]},e}(),Dd=function(){function e(e){var t=e.dbname,n=e.collectionName,r=e.metadata,i=e.hashFunction,a=void 0===i?od:i,s=e.transaction,o=e.store;this.dbname=t,this.collectionName=n,this.hashFunction=a,this.metadata=r,this._transaction=s,this._store=o}return Object.defineProperty(e.prototype,"keyName",{get:function(){return this.metadata.keyName},enumerable:!1,configurable:!0}),e.prototype.createBlockId=function(e,t){return void 0===t&&(t=this.metadata.blockLevel),n=this.dbname,r=this.collectionName,i=t,a="".concat(function(e,t,n){var r=n.base*Math.pow(n.multiplier,t)+n.constant;return(n.hashFunction||od)(e,r)}(e,t,{hashFunction:this.hashFunction,base:this.metadata.blockHashBase,multiplier:this.metadata.blockHashMultiplier,constant:this.metadata.blockHashConstant})),"".concat(wd(n,r)).concat(i,".").concat(a);var n,r,i,a},e.prototype._findBlock=function(e){return Qe(this,void 0,void 0,(function(){var t,n,r,i,a;return Ke(this,(function(s){switch(s.label){case 0:t=Md.get(this.dbname),n=this.metadata.blockLevel,s.label=1;case 1:return n>0?(r=this.createBlockId(e,n),[4,t.find(this._store,r)]):[3,4];case 2:if((i=s.sent())&&(null==(a=Od.createFromCacheItem(i))?void 0:a.getItemByKey(e)))return[2,a];s.label=3;case 3:return n--,[3,1];case 4:return[2,null]}}))}))},e.prototype.getFromBlock=function(e){return Qe(this,void 0,void 0,(function(){var t;return Ke(this,(function(n){switch(n.label){case 0:return[4,this._findBlock(e)];case 1:return[2,(t=n.sent())?t.getItemByKey(e):null]}}))}))},e.prototype.putToBlock=function(e,t){return Qe(this,void 0,void 0,(function(){var n,r,i,a,s;return Ke(this,(function(o){switch(o.label){case 0:return n=td.get(this.dbname),r=this.createBlockId(e),i=Math.floor(this._store.itemSizeLimit/n.itemSizeLimit),[4,Md.get(this.dbname).find(this._store,r)];case 1:return a=o.sent(),(null==(s=a?Od.createFromCacheItem(a):new Od({blockId:r,keyName:this.keyName,items:[],limit:i}))?void 0:s.add(t))?(this._transaction.requestWrite({key:s.blockId,value:s.serialize()}),[2,!0]):[2,!1]}}))}))},e.prototype.removeFromBlock=function(e){return Qe(this,void 0,void 0,(function(){var t;return Ke(this,(function(n){switch(n.label){case 0:return[4,this._findBlock(e)];case 1:return(t=n.sent())&&t.remove(e)?(this._transaction.requestWrite({key:t.blockId,value:t.serialize()}),[2,!0]):[2,!1]}}))}))},e.prototype.clearAllBlocks=function(){return Qe(this,void 0,void 0,(function(){var e,t,n;return Ke(this,(function(r){switch(r.label){case 0:return e=wd(this.dbname,this.collectionName),[4,this._store.getAllKeys()];case 1:return t=r.sent(),n=t.filter((function(t){return t.startsWith(e)})),[4,this._store.removeMany(n)];case 2:return r.sent(),[4,this._transaction.clear()];case 3:return r.sent(),Md.get(this.dbname).clearByCondition((function(t){return t.key.startsWith(e)})),[2]}}))}))},e}(),Ld={},Rd=function(){function e(e){var t=e.dbname,n=e.collectionName,r=e.keyName,i=e.fields,a=e.transaction,s=e.store,o=this;this._origin=[],this._table=[];var u=function(e,t,n){return"".concat(bd(e,t),"/index.").concat(n)}(t,n,i.join(">"));return Ld[u]||(this.dbname=t,this.collectionName=n,this.keyName=r,this.fields=i,this.indexerKey=u,this._transaction=a,this._store=s,this._transaction.on(pd.COMMIT,this.indexerKey,(function(){return o.commit()})),this._transaction.on(pd.ERROR,this.indexerKey,(function(){return o.abort()}))),Ld[u]}return e.createKey=function(e){return e.join(">")},e.parseKey=function(e){return e.split(">")},e.clearIndexerMap=function(){for(var e in Ld)delete Ld[e]},e.prototype._addItem=function(e){var t=e[this.keyName],n=this.getColumnValues(e),r=Ye(this.indexOf(n),2),i=r[0];return r[1]?!this._table[i].keys.includes(t)&&(this._table[i].keys.push(t),!0):(this._table.splice(i,0,{columnValues:n,keys:[t]}),!0)},e.prototype._removeItem=function(e){var t=e[this.keyName],n=this.getColumnValues(e),r=Ye(this.indexOf(n),2),i=r[0];if(r[1]){var a=this._table[i].keys.indexOf(t);if(a>-1)return this._table[i].keys.splice(a,1),0===this._table[i].keys.length&&this._table.splice(i,1),!0}return!1},Object.defineProperty(e.prototype,"origin",{get:function(){return this._origin},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"table",{get:function(){return this._table},enumerable:!1,configurable:!0}),e.prototype.getColumnValues=function(e){var t,n,r,i,a=[];try{for(var s=We(this.fields),o=s.next();!o.done;o=s.next()){var u=o.value;if("-"===u[0]&&(u=u.slice(1)),r=e[u],void 0,i=typeof r,null!==r&&"undefined"!==i&&"boolean"!==i&&"number"!==i&&"string"!==i)throw rd.indexTypesNotMatch;a.push(e[u])}}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=s.return)&&n.call(s)}finally{if(t)throw t.error}}return a},e.prototype.diff=function(e,t){for(var n in this.fields){var r="-"===this.fields[n][0]?-1:1,i=sd(e[n],t[n]);if(0!==i)return r*i}return 0},e.prototype.indexOf=function(e){if(this._table.length>0){for(var t=0,n=this._table.length-1;t<=n;){var r=Math.floor((t+n)/2),i=this.diff(e,this._table[r].columnValues);if(i>0)t=r+1;else{if(!(i<0))return[r,!0];n=r-1}}return[t,!1]}return[0,!1]},e.prototype.ensure=function(){return Qe(this,void 0,void 0,(function(){var e,t,n,r,i,a,s,o,u,l,c,d,h,f,p,_,v;return Ke(this,(function(m){switch(m.label){case 0:return[4,(e=Md.get(this.dbname)).find(this._store,this.indexerKey,vd.PERSISTENT)];case 1:return(t=m.sent())?[3,11]:(n=wd(this.dbname,this.collectionName),[4,this._store.getAllKeys()]);case 2:r=m.sent(),m.label=3;case 3:m.trys.push([3,8,9,10]),i=We(r),a=i.next(),m.label=4;case 4:return a.done?[3,7]:(s=a.value).startsWith(n)?[4,e.find(this._store,s,vd.NO_CACHE)]:[3,6];case 5:if(o=m.sent(),u=Od.createFromCacheItem(o))try{for(_=void 0,l=We(u.items),c=l.next();!c.done;c=l.next())d=c.value,this._addItem(d)}catch(e){_={error:e}}finally{try{c&&!c.done&&(v=l.return)&&v.call(l)}finally{if(_)throw _.error}}m.label=6;case 6:return a=i.next(),[3,4];case 7:return[3,10];case 8:return h=m.sent(),f={error:h},[3,10];case 9:try{a&&!a.done&&(p=i.return)&&p.call(i)}finally{if(f)throw f.error}return[7];case 10:return this._transaction.requestWrite({key:this.indexerKey,value:this._table},{persistent:!0}),[3,12];case 11:this._origin=t.value,this._table=ad(this._origin),m.label=12;case 12:return Ld[this.indexerKey]=this,[2]}}))}))},e.prototype.drop=function(){return Qe(this,void 0,void 0,(function(){return Ke(this,(function(e){switch(e.label){case 0:return Md.get(this.dbname).remove(this.indexerKey),[4,this._store.remove(this.indexerKey)];case 1:return e.sent(),delete Ld[this.indexerKey],[2]}}))}))},e.prototype.addItem=function(e){return Qe(this,void 0,void 0,(function(){return Ke(this,(function(t){return this._addItem(e)&&this._transaction.requestWrite({key:this.indexerKey,value:this._table},{persistent:!0}),[2]}))}))},e.prototype.removeItem=function(e){return Qe(this,void 0,void 0,(function(){return Ke(this,(function(t){return this._removeItem(e)&&this._transaction.requestWrite({key:this.indexerKey,value:this._table},{persistent:!0}),[2]}))}))},e.prototype.clear=function(){return Qe(this,void 0,void 0,(function(){return Ke(this,(function(e){return this._table=[],this._transaction.requestWrite({key:this.indexerKey,value:this._table},{persistent:!0}),[2]}))}))},e.prototype.commit=function(){this._origin=this._table,this._table=ad(this._origin)},e.prototype.abort=function(){this._table=ad(this._origin)},e}(),xd=function(){return"undefined"!=typeof document&&"undefined"!=typeof navigator&&"ReactNative"!==navigator.product},Pd=function(){var e=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var n=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"===t?n:3&n|8).toString(16)}))};!function(e){e[e.PROCESSING=0]="PROCESSING",e[e.DONE=1]="DONE"}(Id||(Id={})),function(e){e.NEWNODE="newnode",e.REMOVENODE="removenode",e.CLAIM_HOST="claimhost",e.SYNC_HOST="synchost",e.REQUEST_LOCK="requestlock",e.ACQUIRE_LOCK="acquirelock",e.RELEASE_LOCK="releaselock"}(Nd||(Nd={}));var Fd,zd={},Hd=function(){function e(e,t){void 0===t&&(t={});var n=this;return this._state=Id.PROCESSING,this._queue=[],this._activationQueue=[],zd[e]&&!t.forceCreate||(this.nodeId=Pd(),this.key=e,xd()&&(t.startAsInvisible?this.registerNode():"visible"===document.visibilityState?this.claimHost():this.registerNode(),document.addEventListener("visibilitychange",(function(){"visible"===document.visibilityState&&n.claimHost()})),window.addEventListener("message",(function(e){var t,r,i=e.data,a=i.nodeId,s=i.requestId,o=i.key,u=i.op,l=i.data;if(a!==n.nodeId&&o===n.key)switch(u){case Nd.NEWNODE:n._sendSync();break;case Nd.CLAIM_HOST:n._sendSync(),n._hostId=a;break;case Nd.SYNC_HOST:if(!n.isInSync){n._activationTimeout&&clearTimeout(n._activationTimeout);var c=l,d=c.currentItemRequestId,h=c.queue,f=function(e){n._queue.findIndex((function(t){return t.requestId===e.requestId}))<0&&n._requestLock({nodeId:e.nodeId,requestId:e.requestId,key:n.key,op:Nd.REQUEST_LOCK,ts:e.ts})};try{for(var p=We(h),_=p.next();!_.done;_=p.next())f(_.value)}catch(e){t={error:e}}finally{try{_&&!_.done&&(r=p.return)&&r.call(p)}finally{if(t)throw t.error}}n._currentItem=n._queue.find((function(e){return e.requestId===d})),n._completeSync()}break;case Nd.REMOVENODE:n._queue=n._queue.filter((function(e){return e.nodeId!==i.nodeId})),n._currentItem&&n._currentItem.nodeId===i.nodeId&&(n._currentItem=void 0,n._acquire(n._queue[0]));break;case Nd.REQUEST_LOCK:n._requestLock(i);break;case Nd.ACQUIRE_LOCK:var v=n._queue.find((function(e){return e.requestId===s}));n._acquire(v);break;case Nd.RELEASE_LOCK:n._release(s)}})),window.addEventListener("beforeunload",(function(){n._send(Nd.REMOVENODE)}))),zd[e]=this),zd[e]}return Object.defineProperty(e.prototype,"locked",{get:function(){return!!this._currentItem},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isHost",{get:function(){return this._hostId===this.nodeId},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isInSync",{get:function(){return this._state==Id.DONE},enumerable:!1,configurable:!0}),e.prototype._send=function(e,t){var n;void 0===t&&(t={});var r={nodeId:this.nodeId,requestId:null!==(n=null==t?void 0:t.requestId)&&void 0!==n?n:Pd(),key:this.key,op:e,data:t.data,ts:Date.now()};return xd()&&window.postMessage(r,"*"),r},e.prototype._acquire=function(e){e?(this._currentItem=e,this._currentItem.onAcquired&&this._currentItem.onAcquired(e.requestId)):this._currentItem=void 0},e.prototype._release=function(e){if(this._currentItem&&this._currentItem.requestId===e){var t=this._currentItem;this._currentItem=void 0,t.nodeId===this.nodeId&&this._send(Nd.RELEASE_LOCK,{requestId:t.requestId});var n=this._queue.findIndex((function(t){return t.requestId===e}));n>-1&&this._queue.splice(n,1),t.onReleased&&t.onReleased(e)}},e.prototype._requestLock=function(e){var t=this;return new Promise((function(n){var r={nodeId:e.nodeId,requestId:e.requestId,ts:e.ts,onAcquired:function(e){t.isHost&&t._send(Nd.ACQUIRE_LOCK,{requestId:e}),n()},onReleased:function(){t._acquire(t._queue[0])}},i=!1;for(var a in t._queue)if(t._queue[a].ts>r.ts){t._queue.splice(parseInt(a),0,r),i=!0;break}i||t._queue.push(r),t._currentItem||t._acquire(t._queue[0])}))},e.prototype._sendSync=function(){var e;this.isHost&&this._send(Nd.SYNC_HOST,{data:{currentItemRequestId:null===(e=this._currentItem)||void 0===e?void 0:e.requestId,queue:this._queue.map((function(e){return{nodeId:e.nodeId,requestId:e.requestId,ts:e.ts}}))}})},e.prototype._waitUntilSyncCompleted=function(){return Qe(this,void 0,void 0,(function(){var e=this;return Ke(this,(function(t){return this.isHost&&!this.isInSync?[2,new Promise((function(t){e._activationQueue.push(t)}))]:[2]}))}))},e.prototype._waitSync=function(){var e=this;this.isInSync||(this._activationTimeout=setTimeout((function(){e._completeSync()}),8))},e.prototype._completeSync=function(){this.isInSync||(this._state=Id.DONE,this._activationQueue.forEach((function(e){return e()})),this._activationQueue=[])},e.prototype.registerNode=function(){this._send(Nd.NEWNODE),this._waitSync()},e.prototype.claimHost=function(){this._hostId=this.nodeId,this._send(Nd.CLAIM_HOST),this._waitSync()},e.prototype.lock=function(){return Qe(this,void 0,void 0,(function(){var e;return Ke(this,(function(t){switch(t.label){case 0:return[4,this._waitUntilSyncCompleted()];case 1:return t.sent(),e=this._send(Nd.REQUEST_LOCK),[4,this._requestLock(e)];case 2:return t.sent(),[2]}}))}))},e.prototype.unlock=function(){var e;(null===(e=this._currentItem)||void 0===e?void 0:e.requestId)&&this._release(this._currentItem.requestId)},e}(),qd=function(){function e(e){var t=e.dbname,n=e.collectionName,r=e.keyName,i=e.keyHash,a=e.indexes,s=e.store,o=this;this._state=nd.INIT,this._indexers=[],this.dbname=t,this.name=n,this.keyName=r,this.indexes=Ze([[r]],Ye(a.filter((function(e){return Rd.createKey(e)!==o.keyName}))),!1),this._keyHash=i,this._store=s,this._mutex=new Hd(function(e,t){return"".concat(bd(e,t),".lock")}(t,n)),this._blobContainer=new Td({dbname:t,collectionName:n,store:s}),this._transaction=new Ud({dbname:t,collectionName:n,store:s})}return e.metadataOf=function(e,t,n){return Qe(this,void 0,void 0,(function(){var r;return Ke(this,(function(i){switch(i.label){case 0:return r=Cd(e,t),[4,n.get(r)];case 1:return[2,i.sent()]}}))}))},Object.defineProperty(e.prototype,"state",{get:function(){return this._state},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isReady",{get:function(){return this._state===nd.READY},enumerable:!1,configurable:!0}),e.prototype.init=function(){return Qe(this,void 0,void 0,(function(){var t,n,r,i,a,s,o,u,l,c,d,h,f,p,_=this;return Ke(this,(function(v){switch(v.label){case 0:return[4,this._mutex.lock()];case 1:v.sent(),v.label=2;case 2:return v.trys.push([2,9,,10]),t=td.get(this.dbname),[4,e.metadataOf(this.dbname,this.name,this._store)];case 3:return n=v.sent(),this._metadata=n||{keyName:this.keyName,blockLevel:1,blockHashBase:t.blockHashBase,blockHashMultiplier:t.blockHashMultiplier,blockHashConstant:t.blockHashConstant,indexes:this.indexes},[4,this._transaction.init()];case 4:v.sent(),this._blockManager=new Dd({dbname:this.dbname,collectionName:this.name,hashFunction:this._keyHash,metadata:this._metadata,transaction:this._transaction,store:this._store}),r=Ze([],Ye(this.indexes),!1),i=[],a=r.map((function(e){return Rd.createKey(e)})),s=n?n.indexes.map((function(e){return Rd.createKey(e)})):[];try{for(o=We(s),u=o.next();!u.done;u=o.next())l=u.value,a.includes(l)||i.push(Rd.parseKey(l))}catch(e){f={error:e}}finally{try{u&&!u.done&&(p=o.return)&&p.call(o)}finally{if(f)throw f.error}}return(c=[]).push.apply(c,Ze([],Ye(r.map((function(e){var t=new Rd({dbname:_.dbname,collectionName:_.name,keyName:_.keyName,fields:e,transaction:_._transaction,store:_._store});return _._indexers.push(t),t.ensure()}))),!1)),c.push.apply(c,Ze([],Ye(i.map((function(e){return new Rd({dbname:_.dbname,collectionName:_.name,keyName:_.keyName,fields:e,transaction:_._transaction,store:_._store}).drop()}))),!1)),[4,Promise.all(c)];case 5:return v.sent(),[4,this._transaction.commit()];case 6:return v.sent(),a.sort().join(",")===s.sort().join(",")?[3,8]:(d=Cd(this.dbname,this.name),this._metadata.indexes=r,[4,this._store.set({key:d,value:this._metadata})]);case 7:v.sent(),v.label=8;case 8:return this._state=nd.READY,this._mutex.unlock(),[3,10];case 9:throw h=v.sent(),this._mutex.unlock(),h;case 10:return[2]}}))}))},e.prototype.close=function(){this._state=nd.CLOSED},e.prototype._hasPropertyOfKeyName=function(e){var t=e[this.keyName];return"string"==typeof t&&!!t},e.prototype._getIndexerBy=function(e){var t,n;void 0===e&&(e=null),e||(e=[this.keyName]);var r=Rd.createKey(e);try{for(var i=We(this._indexers),a=i.next();!a.done;a=i.next()){var s=a.value;if(r===Rd.createKey(s.fields))return s}}catch(e){t={error:e}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}throw rd.indexTableIsRequired},e.prototype._upgradeBlockLevel=function(){return Qe(this,void 0,void 0,(function(){var e;return Ke(this,(function(t){switch(t.label){case 0:return e=Cd(this.dbname,this.name),this._metadata.blockLevel++,[4,this._store.set({key:e,value:this._metadata})];case 1:return t.sent(),[2]}}))}))},e.prototype._requestInsert=function(e){return Qe(this,void 0,void 0,(function(){var t,n,r,i,a,s;return Ke(this,(function(o){switch(o.label){case 0:return t=e[this.keyName],[4,this._blockManager.getFromBlock(t)];case 1:return o.sent()?[3,13]:[4,this._blockManager.putToBlock(t,e)];case 2:return o.sent()?[3,5]:[4,this._upgradeBlockLevel()];case 3:return o.sent(),[4,this._blockManager.putToBlock(t,e)];case 4:o.sent(),o.label=5;case 5:o.trys.push([5,10,11,12]),n=We(this._indexers),r=n.next(),o.label=6;case 6:return r.done?[3,9]:[4,r.value.addItem(e)];case 7:o.sent(),o.label=8;case 8:return r=n.next(),[3,6];case 9:return[3,12];case 10:return i=o.sent(),a={error:i},[3,12];case 11:try{r&&!r.done&&(s=n.return)&&s.call(n)}finally{if(a)throw a.error}return[7];case 12:return[3,14];case 13:throw rd.collectionInsertDuplicate;case 14:return[2]}}))}))},e.prototype._requestUpsert=function(e){return Qe(this,void 0,void 0,(function(){var t,n,r,i,a,s,o,u,l,c,d,h,f;return Ke(this,(function(p){switch(p.label){case 0:return t=e[this.keyName],[4,this._blockManager.getFromBlock(t)];case 1:return(n=p.sent())?[3,13]:[4,this._blockManager.putToBlock(t,e)];case 2:return p.sent()?[3,5]:[4,this._upgradeBlockLevel()];case 3:return p.sent(),[4,this._blockManager.putToBlock(t,e)];case 4:p.sent(),p.label=5;case 5:p.trys.push([5,10,11,12]),r=We(this._indexers),i=r.next(),p.label=6;case 6:return i.done?[3,9]:[4,(u=i.value).addItem(e)];case 7:p.sent(),p.label=8;case 8:return i=r.next(),[3,6];case 9:return[3,12];case 10:return a=p.sent(),c={error:a},[3,12];case 11:try{i&&!i.done&&(d=r.return)&&d.call(r)}finally{if(c)throw c.error}return[7];case 12:return[3,23];case 13:return[4,this._blockManager.putToBlock(t,e)];case 14:p.sent(),p.label=15;case 15:p.trys.push([15,21,22,23]),s=We(this._indexers),o=s.next(),p.label=16;case 16:return o.done?[3,20]:0===(u=o.value).diff(u.getColumnValues(n),u.getColumnValues(e))?[3,19]:[4,u.removeItem(n)];case 17:return p.sent(),[4,u.addItem(e)];case 18:p.sent(),p.label=19;case 19:return o=s.next(),[3,16];case 20:return[3,23];case 21:return l=p.sent(),h={error:l},[3,23];case 22:try{o&&!o.done&&(f=s.return)&&f.call(s)}finally{if(h)throw h.error}return[7];case 23:return[2]}}))}))},e.prototype._requestUpdate=function(e){return Qe(this,void 0,void 0,(function(){var t,n,r,i,a,s,o,u;return Ke(this,(function(l){switch(l.label){case 0:return t=e[this.keyName],[4,this._blockManager.getFromBlock(t)];case 1:return(n=l.sent())?[4,this._blockManager.putToBlock(t,e)]:[3,11];case 2:l.sent(),l.label=3;case 3:l.trys.push([3,9,10,11]),r=We(this._indexers),i=r.next(),l.label=4;case 4:return i.done?[3,8]:0===(a=i.value).diff(a.getColumnValues(n),a.getColumnValues(e))?[3,7]:[4,a.removeItem(n)];case 5:return l.sent(),[4,a.addItem(e)];case 6:l.sent(),l.label=7;case 7:return i=r.next(),[3,4];case 8:return[3,11];case 9:return s=l.sent(),o={error:s},[3,11];case 10:try{i&&!i.done&&(u=r.return)&&u.call(r)}finally{if(o)throw o.error}return[7];case 11:return[2]}}))}))},e.prototype._requestRemove=function(e){return Qe(this,void 0,void 0,(function(){var t,n,r,i,a,s;return Ke(this,(function(o){switch(o.label){case 0:return[4,this._blockManager.getFromBlock(e)];case 1:return(t=o.sent())?[4,this._blockManager.removeFromBlock(e)]:[3,10];case 2:o.sent(),o.label=3;case 3:o.trys.push([3,8,9,10]),n=We(this._indexers),r=n.next(),o.label=4;case 4:return r.done?[3,7]:[4,r.value.removeItem(t)];case 5:o.sent(),o.label=6;case 6:return r=n.next(),[3,4];case 7:return[3,10];case 8:return i=o.sent(),a={error:i},[3,10];case 9:try{r&&!r.done&&(s=n.return)&&s.call(n)}finally{if(a)throw a.error}return[7];case 10:return[2]}}))}))},e.prototype._requestClear=function(){return Qe(this,void 0,void 0,(function(){var e,t,n,r,i;return Ke(this,(function(a){switch(a.label){case 0:return[4,this._blockManager.clearAllBlocks()];case 1:a.sent(),a.label=2;case 2:a.trys.push([2,7,8,9]),e=We(this._indexers),t=e.next(),a.label=3;case 3:return t.done?[3,6]:[4,t.value.clear()];case 4:a.sent(),a.label=5;case 5:return t=e.next(),[3,3];case 6:return[3,9];case 7:return n=a.sent(),r={error:n},[3,9];case 8:try{t&&!t.done&&(i=e.return)&&i.call(e)}finally{if(r)throw r.error}return[7];case 9:return[2]}}))}))},e.prototype.getByKey=function(e){return Qe(this,void 0,void 0,(function(){var t,n;return Ke(this,(function(r){switch(r.label){case 0:return this.isReady?[4,this._mutex.lock()]:[3,6];case 1:r.sent(),r.label=2;case 2:return r.trys.push([2,4,,5]),[4,this._blockManager.getFromBlock(e)];case 3:return t=r.sent(),this._mutex.unlock(),[2,ad(t)];case 4:throw n=r.sent(),this._mutex.unlock(),n;case 5:return[3,7];case 6:throw rd.collectionNotReady;case 7:return[2]}}))}))},e.prototype.query=function(e){if(void 0===e&&(e={}),this.isReady)return new yd({condition:e.where,mutex:this._mutex,blockManager:this._blockManager,indexer:this._getIndexerBy(e.index),backward:!!e.backward});throw rd.collectionNotReady},e.prototype.insertOne=function(e){return Qe(this,void 0,void 0,(function(){var t;return Ke(this,(function(n){switch(n.label){case 0:return this.isReady?[4,this._mutex.lock()]:[3,8];case 1:n.sent(),n.label=2;case 2:if(n.trys.push([2,5,,7]),!this._hasPropertyOfKeyName(e))throw rd.collectionKeyNotGiven;return[4,this._requestInsert(ad(e))];case 3:return n.sent(),[4,this._transaction.commit()];case 4:return n.sent(),this._mutex.unlock(),[2,e];case 5:return t=n.sent(),[4,this._transaction.clear()];case 6:throw n.sent(),this._mutex.unlock(),t;case 7:return[3,9];case 8:throw rd.collectionNotReady;case 9:return[2]}}))}))},e.prototype.insertMany=function(e){return Qe(this,void 0,void 0,(function(){var t,n,r,i,a,s,o,u=this;return Ke(this,(function(l){switch(l.label){case 0:return this.isReady?[4,this._mutex.lock()]:[3,15];case 1:l.sent(),l.label=2;case 2:if(l.trys.push([2,12,,14]),e.some((function(e){return!u._hasPropertyOfKeyName(e)})))throw rd.collectionKeyNotGiven;l.label=3;case 3:l.trys.push([3,8,9,10]),t=We(e),n=t.next(),l.label=4;case 4:return n.done?[3,7]:(r=n.value,[4,this._requestInsert(ad(r))]);case 5:l.sent(),l.label=6;case 6:return n=t.next(),[3,4];case 7:return[3,10];case 8:return i=l.sent(),s={error:i},[3,10];case 9:try{n&&!n.done&&(o=t.return)&&o.call(t)}finally{if(s)throw s.error}return[7];case 10:return[4,this._transaction.commit()];case 11:return l.sent(),this._mutex.unlock(),[2,e];case 12:return a=l.sent(),[4,this._transaction.clear()];case 13:throw l.sent(),this._mutex.unlock(),a;case 14:return[3,16];case 15:throw rd.collectionNotReady;case 16:return[2]}}))}))},e.prototype.upsertOne=function(e){return Qe(this,void 0,void 0,(function(){var t;return Ke(this,(function(n){switch(n.label){case 0:return this.isReady?[4,this._mutex.lock()]:[3,8];case 1:n.sent(),n.label=2;case 2:if(n.trys.push([2,5,,7]),!this._hasPropertyOfKeyName(e))throw rd.collectionKeyNotGiven;return[4,this._requestUpsert(ad(e))];case 3:return n.sent(),[4,this._transaction.commit()];case 4:return n.sent(),this._mutex.unlock(),[2,e];case 5:return t=n.sent(),[4,this._transaction.clear()];case 6:throw n.sent(),this._mutex.unlock(),t;case 7:return[3,9];case 8:throw rd.collectionNotReady;case 9:return[2]}}))}))},e.prototype.upsertMany=function(e){return Qe(this,void 0,void 0,(function(){var t,n,r,i,a,s,o,u=this;return Ke(this,(function(l){switch(l.label){case 0:return this.isReady?[4,this._mutex.lock()]:[3,15];case 1:l.sent(),l.label=2;case 2:if(l.trys.push([2,12,,14]),e.some((function(e){return!u._hasPropertyOfKeyName(e)})))throw rd.collectionKeyNotGiven;l.label=3;case 3:l.trys.push([3,8,9,10]),t=We(e),n=t.next(),l.label=4;case 4:return n.done?[3,7]:(r=n.value,[4,this._requestUpsert(ad(r))]);case 5:l.sent(),l.label=6;case 6:return n=t.next(),[3,4];case 7:return[3,10];case 8:return i=l.sent(),s={error:i},[3,10];case 9:try{n&&!n.done&&(o=t.return)&&o.call(t)}finally{if(s)throw s.error}return[7];case 10:return[4,this._transaction.commit()];case 11:return l.sent(),this._mutex.unlock(),[2,e];case 12:return a=l.sent(),[4,this._transaction.clear()];case 13:throw l.sent(),this._mutex.unlock(),a;case 14:return[3,16];case 15:throw rd.collectionNotReady;case 16:return[2]}}))}))},e.prototype.update=function(e){return Qe(this,void 0,void 0,(function(){var t;return Ke(this,(function(n){switch(n.label){case 0:return this.isReady?[4,this._mutex.lock()]:[3,8];case 1:n.sent(),n.label=2;case 2:if(n.trys.push([2,5,,7]),!this._hasPropertyOfKeyName(e))throw rd.collectionKeyNotGiven;return[4,this._requestUpdate(ad(e))];case 3:return n.sent(),[4,this._transaction.commit()];case 4:return n.sent(),this._mutex.unlock(),[2,e];case 5:return t=n.sent(),[4,this._transaction.clear()];case 6:throw n.sent(),this._mutex.unlock(),t;case 7:return[3,9];case 8:throw rd.collectionNotReady;case 9:return[2]}}))}))},e.prototype.updateIf=function(e,t){return Qe(this,void 0,void 0,(function(){var n,r,i,a,s,o,u,l,c,d,h,f,p,_,v=this;return Ke(this,(function(m){switch(m.label){case 0:return this.isReady?[4,this._mutex.lock()]:[3,16];case 1:m.sent(),m.label=2;case 2:return m.trys.push([2,13,,15]),n=e.where,r=void 0===n?{}:n,i=e.index,a=void 0===i?null:i,s=e.backward,o=void 0!==s&&s,u=[],[4,new gd({condition:r,blockManager:this._blockManager,backward:o,indexer:this._getIndexerBy(a)}).each((function(e){return Qe(v,void 0,void 0,(function(){var n,i;return Ke(this,(function(a){if(e.error)throw e.stop(),e.error;if(e.hasNext){if(n=e.nextValue,ld(r,n)&&t.set){if("function"!=typeof t.set)for(i in t.set)n[i]=t.set[i];else t.set(n);u.push(n)}e.next()}else e.stop();return[2]}))}))}))];case 3:m.sent(),m.label=4;case 4:m.trys.push([4,9,10,11]),l=We(u),c=l.next(),m.label=5;case 5:return c.done?[3,8]:(d=c.value,[4,this._requestUpdate(ad(d))]);case 6:m.sent(),m.label=7;case 7:return c=l.next(),[3,5];case 8:return[3,11];case 9:return h=m.sent(),p={error:h},[3,11];case 10:try{c&&!c.done&&(_=l.return)&&_.call(l)}finally{if(p)throw p.error}return[7];case 11:return[4,this._transaction.commit()];case 12:return m.sent(),this._mutex.unlock(),[2,u];case 13:return f=m.sent(),[4,this._transaction.clear()];case 14:throw m.sent(),this._mutex.unlock(),f;case 15:return[3,17];case 16:throw this._transaction.clear(),rd.collectionNotReady;case 17:return[2]}}))}))},e.prototype.remove=function(e){return Qe(this,void 0,void 0,(function(){var t;return Ke(this,(function(n){switch(n.label){case 0:return this.isReady?[4,this._mutex.lock()]:[3,8];case 1:n.sent(),n.label=2;case 2:return n.trys.push([2,5,,7]),[4,this._requestRemove(e)];case 3:return n.sent(),[4,this._transaction.commit()];case 4:return n.sent(),this._mutex.unlock(),[3,7];case 5:return t=n.sent(),[4,this._transaction.clear()];case 6:throw n.sent(),this._mutex.unlock(),t;case 7:return[3,9];case 8:throw rd.collectionNotReady;case 9:return[2]}}))}))},e.prototype.removeIf=function(e){return Qe(this,void 0,void 0,(function(){var t,n,r,i,a,s,o,u,l,c,d,h,f,p,_=this;return Ke(this,(function(v){switch(v.label){case 0:return this.isReady?[4,this._mutex.lock()]:[3,15];case 1:v.sent(),v.label=2;case 2:return v.trys.push([2,13,,14]),t=e.where,n=void 0===t?{}:t,r=e.index,i=void 0===r?null:r,a=e.backward,s=void 0!==a&&a,o=[],[4,new gd({condition:n,blockManager:this._blockManager,backward:s,indexer:this._getIndexerBy(i)}).each((function(e){return Qe(_,void 0,void 0,(function(){var t,r;return Ke(this,(function(i){if(e.error)throw e.stop(),e.error;return e.hasNext?(t=e.nextValue,ld(n,t)&&(r=t[this.keyName],o.push(r)),e.next()):e.stop(),[2]}))}))}))];case 3:v.sent(),v.label=4;case 4:v.trys.push([4,9,10,11]),u=We(o),l=u.next(),v.label=5;case 5:return l.done?[3,8]:(c=l.value,[4,this._requestRemove(c)]);case 6:v.sent(),v.label=7;case 7:return l=u.next(),[3,5];case 8:return[3,11];case 9:return d=v.sent(),f={error:d},[3,11];case 10:try{l&&!l.done&&(p=u.return)&&p.call(u)}finally{if(f)throw f.error}return[7];case 11:return[4,this._transaction.commit()];case 12:return v.sent(),this._mutex.unlock(),[2,o];case 13:throw h=v.sent(),this._mutex.unlock(),h;case 14:return[3,16];case 15:throw this._transaction.clear(),rd.collectionNotReady;case 16:return[2]}}))}))},e.prototype.clear=function(){return Qe(this,void 0,void 0,(function(){var e;return Ke(this,(function(t){switch(t.label){case 0:return this.isReady?[4,this._mutex.lock()]:[3,8];case 1:t.sent(),t.label=2;case 2:return t.trys.push([2,5,,7]),[4,this._requestClear()];case 3:return t.sent(),[4,this._transaction.commit()];case 4:return t.sent(),this._mutex.unlock(),[3,7];case 5:return e=t.sent(),[4,this._transaction.clear()];case 6:throw t.sent(),this._mutex.unlock(),e;case 7:return[3,9];case 8:throw rd.collectionNotReady;case 9:return[2]}}))}))},e.prototype.getBlob=function(e){return Qe(this,void 0,void 0,(function(){return Ke(this,(function(t){switch(t.label){case 0:return[4,this._blobContainer.get(e)];case 1:return[2,t.sent()]}}))}))},e.prototype.saveBlob=function(e,t){return Qe(this,void 0,void 0,(function(){return Ke(this,(function(n){switch(n.label){case 0:return[4,this._blobContainer.save(e,t)];case 1:return[2,n.sent()]}}))}))},e.prototype.removeBlob=function(e){return Qe(this,void 0,void 0,(function(){return Ke(this,(function(t){switch(t.label){case 0:return[4,this._blobContainer.remove(e)];case 1:return t.sent(),[2]}}))}))},e.prototype.removeAllBlobs=function(){return Qe(this,void 0,void 0,(function(){return Ke(this,(function(e){switch(e.label){case 0:return[4,this._blobContainer.clear()];case 1:return e.sent(),[2]}}))}))},e}(),Vd="[NESTDB]",Gd=!0,Bd=function(){function e(){}return e.off=function(){Gd=!1},e.log=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];Gd&&console.log.apply(console,Ze(["".concat(Vd,"[LOG]")],Ye(e),!1))},e.warning=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];Gd&&console.warn.apply(console,Ze(["".concat(Vd,"[WARNING]")],Ye(e),!1))},e.error=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];Gd&&console.error.apply(console,Ze(["".concat(Vd,"[ERROR]")],Ye(e),!1))},e}(),jd=[{},{a:700400,n:"error"}],Qd=function(){function e(e){var t,n,r;this.encryption=null!==(t=e.encryption)&&void 0!==t?t:gt,this.itemSizeLimit=null!==(n=e.itemSizeLimit)&&void 0!==n?n:4194304,this.metadataBuffer=null!==(r=e.metadataBuffer)&&void 0!==r?r:256}return Object.defineProperty(e.prototype,"_encryptionCheckKey",{get:function(){return"".concat(this.dbname,".encrypt")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"_reservedKeys",{get:function(){return[this._encryptionCheckKey]},enumerable:!1,configurable:!0}),e.prototype._getRawKey=function(e,t){return void 0===t&&(t=""),"".concat(e).concat(t)},e.prototype._generateShardPostfixArray=function(e){return void 0===e&&(e=1),Ze([],Ye(Array(e).keys()),!1)},e.prototype._shardify=function(e){var t=this,n=e.key,r=e.value,i=JSON.stringify(this.encryption.encrypt(r)),a=Math.ceil(i.length/this.adjustedItemSizeLimit);return this._generateShardPostfixArray(a).map((function(e){var r={key:t._getRawKey(n,".".concat(e)),data:i.substring(e*t.adjustedItemSizeLimit,(e+1)*t.adjustedItemSizeLimit)};return 0===e&&(r.metadata={shards:a}),r}))},e.prototype._resetIfEncryptionChanged=function(){return Qe(this,void 0,void 0,(function(){var e,t,n,r,i,a,s,o,u,l=this;return Ke(this,(function(c){switch(c.label){case 0:return[4,this.get(this._encryptionCheckKey)];case 1:if(e=c.sent(),t={encrypted:jd.map((function(e){var t;return null===(t=l.encryption)||void 0===t?void 0:t.encrypt(e)}))},!(e&&e.encrypted&&Array.isArray(e.encrypted)))return[3,6];for(i in n=e.encrypted,r=[],n)r.push(i);a=0,c.label=2;case 2:return a<r.length?(i=r[a])in n?(s=i,o=JSON.stringify(e.encrypted[s]),u=JSON.stringify(t.encrypted[s]),o===u?[3,4]:(Bd.warning("Encryption algorithm has changed. Stored data would be cleared."),[4,this.clear()])):[3,4]:[3,5];case 3:return c.sent(),[3,5];case 4:return a++,[3,2];case 5:return[3,8];case 6:return[4,this.clear()];case 7:c.sent(),c.label=8;case 8:return[4,this.set({key:this._encryptionCheckKey,value:t})];case 9:return c.sent(),[2]}}))}))},Object.defineProperty(e.prototype,"adjustedItemSizeLimit",{get:function(){return Math.max(this.itemSizeLimit-this.metadataBuffer,4)},enumerable:!1,configurable:!0}),e.prototype.usage=function(){return Qe(this,void 0,void 0,(function(){var e,t,n,r,i,a,s,o,u;return Ke(this,(function(l){switch(l.label){case 0:return e=0,[4,this._getAllRawKeys()];case 1:t=l.sent(),l.label=2;case 2:l.trys.push([2,7,8,9]),n=We(t),r=n.next(),l.label=3;case 3:return r.done?[3,6]:(i=r.value,[4,this._getRaw(i)]);case 4:(a=l.sent())&&(e+=JSON.stringify(a).length),l.label=5;case 5:return r=n.next(),[3,3];case 6:return[3,9];case 7:return s=l.sent(),o={error:s},[3,9];case 8:try{r&&!r.done&&(u=n.return)&&u.call(n)}finally{if(o)throw o.error}return[7];case 9:return[2,e]}}))}))},e.prototype.getAllKeys=function(){return Qe(this,void 0,void 0,(function(){var e=this;return Ke(this,(function(t){switch(t.label){case 0:return[4,this._getAllRawKeys()];case 1:return[2,t.sent().filter((function(e){return e.endsWith(".0")})).map((function(e){return e.replace(/\.0$/,"")})).filter((function(t){return!e._reservedKeys.includes(t)}))]}}))}))},e.prototype.get=function(e){return Qe(this,void 0,void 0,(function(){var t,n,r,i,a,s,o=this;return Ke(this,(function(u){switch(u.label){case 0:return t=this._getRawKey(e,".0"),[4,this._getRaw(t)];case 1:if(!(n=u.sent()))return[3,7];u.label=2;case 2:return u.trys.push([2,6,,7]),r=n.data,(null==(i=n.metadata)?void 0:i.shards)&&i.shards>1?[4,Promise.all(this._generateShardPostfixArray(null==i?void 0:i.shards).map((function(t){return Qe(o,void 0,void 0,(function(){var n,i;return Ke(this,(function(a){switch(a.label){case 0:return t>0?(n=this._getRawKey(e,".".concat(t)),[4,this._getRaw(n)]):[3,2];case 1:if(!(i=a.sent()))throw rd.storeBrokenIntegrity;return[2,i.data];case 2:return[2,r]}}))}))})))]:[3,4];case 3:return s=u.sent(),[3,5];case 4:s=[r],u.label=5;case 5:return a=s,[2,this.encryption.decrypt(JSON.parse(a.join("")))];case 6:return u.sent(),[2,null];case 7:return[2,null]}}))}))},e.prototype.set=function(e){return Qe(this,void 0,void 0,(function(){var t;return Ke(this,(function(n){switch(n.label){case 0:return t=this._shardify(e),[4,this._setRaw(t)];case 1:return n.sent(),[2,je({},e.value)]}}))}))},e.prototype.setMany=function(e){return Qe(this,void 0,void 0,(function(){var t,n=this;return Ke(this,(function(r){switch(r.label){case 0:return t=[],[4,this._setRaw(t.concat.apply(t,Ze([],Ye(e.map((function(e){return n._shardify(e)}))),!1)))];case 1:return r.sent(),[2,e.map((function(e){return e.value}))]}}))}))},e.prototype.remove=function(e){return Qe(this,void 0,void 0,(function(){var t,n,r,i=this;return Ke(this,(function(a){switch(a.label){case 0:return t=this._getRawKey(e,".0"),[4,this._getRaw(t)];case 1:return(n=a.sent())?(r=n.metadata,[4,this._removeRaw(this._generateShardPostfixArray(null==r?void 0:r.shards).map((function(t){return i._getRawKey(e,".".concat(t))})))]):[3,3];case 2:return a.sent(),[2,!0];case 3:return[2,!1]}}))}))},e.prototype.removeMany=function(e){return Qe(this,void 0,void 0,(function(){var t,n,r,i,a,s,o,u,l,c=this;return Ke(this,(function(d){switch(d.label){case 0:t=[],n=function(e){var n,i,a;return Ke(this,(function(s){switch(s.label){case 0:return n=r._getRawKey(e,".0"),[4,r._getRaw(n)];case 1:return(i=s.sent())&&(a=i.metadata,t.push.apply(t,Ze([],Ye(r._generateShardPostfixArray(null==a?void 0:a.shards).map((function(t){return c._getRawKey(e,".".concat(t))}))),!1))),[2]}}))},r=this,d.label=1;case 1:d.trys.push([1,6,7,8]),i=We(e),a=i.next(),d.label=2;case 2:return a.done?[3,5]:(s=a.value,[5,n(s)]);case 3:d.sent(),d.label=4;case 4:return a=i.next(),[3,2];case 5:return[3,8];case 6:return o=d.sent(),u={error:o},[3,8];case 7:try{a&&!a.done&&(l=i.return)&&l.call(i)}finally{if(u)throw u.error}return[7];case 8:return t.length>0?[4,this._removeRaw(t)]:[3,10];case 9:d.sent(),d.label=10;case 10:return[2,e]}}))}))},e}(),Kd={},Wd=function(e){function t(t){void 0===t&&(t={});var n,r=this;r=e.call(this,je(je({},t),{itemSizeLimit:null!==(n=t.itemSizeLimit)&&void 0!==n?n:4194304}))||this;var i=t.delay,a=void 0===i?1:i;return r.delay=a,r.observer={},r}return Be(t,e),Object.defineProperty(t.prototype,"rawData",{get:function(){return Kd[this.dbname]},set:function(e){Kd[this.dbname]=e},enumerable:!1,configurable:!0}),t.prototype._getAllRawKeys=function(){return Qe(this,void 0,void 0,(function(){return Ke(this,(function(e){if(Kd[this.dbname])return[2,Object.keys(Kd[this.dbname])];throw rd.storeNotAvailable}))}))},t.prototype._getRaw=function(e){return Qe(this,void 0,void 0,(function(){return Ke(this,(function(t){switch(t.label){case 0:return Kd[this.dbname]?[4,ud(this.delay)]:[3,2];case 1:return t.sent(),[2,Kd[this.dbname][e]?je({key:e},Kd[this.dbname][e]):null];case 2:throw rd.storeNotAvailable}}))}))},t.prototype._setRaw=function(e){return Qe(this,void 0,void 0,(function(){var t,n,r,i,a,s,o,u;return Ke(this,(function(l){switch(l.label){case 0:return Kd[this.dbname]?[4,ud(this.delay)]:[3,2];case 1:l.sent();try{for(t=We(e),n=t.next();!n.done;n=t.next())r=n.value,i=r.key,a=r.data,s=r.metadata,Kd[this.dbname][i]=Object.freeze({data:a,metadata:s})}catch(e){o={error:e}}finally{try{n&&!n.done&&(u=t.return)&&u.call(t)}finally{if(o)throw o.error}}return[3,3];case 2:throw rd.storeNotAvailable;case 3:return[2]}}))}))},t.prototype._removeRaw=function(e){return Qe(this,void 0,void 0,(function(){var t,n,r,i,a;return Ke(this,(function(s){switch(s.label){case 0:return Kd[this.dbname]?[4,ud(this.delay)]:[3,2];case 1:s.sent();try{for(t=We(e),n=t.next();!n.done;n=t.next())r=n.value,Kd[this.dbname][r]&&delete Kd[this.dbname][r]}catch(e){i={error:e}}finally{try{n&&!n.done&&(a=t.return)&&a.call(t)}finally{if(i)throw i.error}}return[3,3];case 2:throw rd.storeNotAvailable;case 3:return[2]}}))}))},t.prototype.observe=function(e,t,n){var r=this;this.observer[e]||(this.observer[e]={}),t.forEach((function(t){return r.observer[e][t]=n}))},t.prototype.checkAvailability=function(){return Qe(this,void 0,void 0,(function(){return Ke(this,(function(e){return[2]}))}))},t.prototype.init=function(e){return Qe(this,void 0,void 0,(function(){return Ke(this,(function(t){switch(t.label){case 0:return this.dbname=e,Kd[this.dbname]||(Kd[this.dbname]={}),[4,this._resetIfEncryptionChanged()];case 1:return t.sent(),[2]}}))}))},t.prototype.set=function(t){return Qe(this,void 0,void 0,(function(){var n,r;return Ke(this,(function(i){if((n=this.observer[t.key])&&"function"==typeof n.set&&(r=n.set()))throw r;return[2,e.prototype.set.call(this,t)]}))}))},t.prototype.setMany=function(t){return Qe(this,void 0,void 0,(function(){var n,r,i,a,s,o,u;return Ke(this,(function(l){try{for(n=We(t),r=n.next();!r.done;r=n.next())if(i=r.value,(a=this.observer[i.key])&&"function"==typeof a.set&&(s=a.set()))throw s}catch(t){o={error:t}}finally{try{r&&!r.done&&(u=n.return)&&u.call(n)}finally{if(o)throw o.error}}return[2,e.prototype.setMany.call(this,t)]}))}))},t.prototype.clear=function(){return Qe(this,void 0,void 0,(function(){return Ke(this,(function(e){switch(e.label){case 0:return[4,ud(this.delay)];case 1:return e.sent(),Kd[this.dbname]={},[2]}}))}))},t}(Qd),Yd="NestDBStore";!function(e){e[e.UNINITIALIZED=0]="UNINITIALIZED",e[e.OPENING=1]="OPENING",e[e.OPEN=2]="OPEN",e[e.CLOSED=3]="CLOSED"}(Fd||(Fd={}));var Zd,Jd=function(e){function t(t){void 0===t&&(t={});var n,r=this;return(r=e.call(this,je(je({},t),{itemSizeLimit:null!==(n=t.itemSizeLimit)&&void 0!==n?n:104857600}))||this)._storeName=Yd,r._state=Fd.UNINITIALIZED,r._openJobQueue=[],r._window="undefined"!=typeof window?window:void 0,r._indexedDb=r._window?r._window.indexedDB||r._window.mozIndexedDB||r._window.webkitIndexedDB||r._window.msIndexedDB:void 0,r}return Be(t,e),Object.defineProperty(t.prototype,"state",{get:function(){return this._state},enumerable:!1,configurable:!0}),t.prototype._openDatabase=function(e){var t=this;return new Promise((function(n,r){if(t._indexedDb){t._state=Fd.OPENING;var i=t._indexedDb.open(e);i.addEventListener("upgradeneeded",(function(e){e.target.result.createObjectStore(Yd,{keyPath:"key"})})),i.addEventListener("success",(function(r){t._state=Fd.OPEN,t._database=r.target.result,t._openJobQueue.forEach((function(e){return e()})),t._openJobQueue=[],t._database.onclose=function(){t._database=void 0,t._state=Fd.OPENING,setTimeout((function(){t._openDatabase(e)}),5)},n(t._database)})),i.addEventListener("error",(function(e){t._state=Fd.UNINITIALIZED,r(e.target.error)}))}else r(rd.storeNotAvailable)}))},t.prototype._getObjectStore=function(e){return Qe(this,void 0,void 0,(function(){var t=this;return Ke(this,(function(n){switch(n.label){case 0:return this._database?[2,this._database.transaction(this._storeName,e).objectStore(this._storeName)]:[3,1];case 1:switch(this._state){case Fd.UNINITIALIZED:case Fd.OPEN:return[3,2];case Fd.OPENING:case Fd.CLOSED:return[3,3]}return[3,4];case 2:throw rd.storeNotInitialized;case 3:return[2,new Promise((function(n){t._openJobQueue.push((function(){return n(t._getObjectStore(e))}))}))];case 4:return[4,this._getObjectStore(e)];case 5:return[2,n.sent()]}}))}))},t.prototype._getAllRawKeys=function(){return Qe(this,void 0,void 0,(function(){var e;return Ke(this,(function(t){switch(t.label){case 0:return[4,this._getObjectStore("readonly")];case 1:return e=t.sent(),[4,new Promise((function(t,n){var r=e.getAllKeys();r.addEventListener("success",(function(e){t(e.target.result)})),r.addEventListener("error",(function(e){return n(e.target.error)}))}))];case 2:return[2,t.sent()]}}))}))},t.prototype._getRaw=function(e){return Qe(this,void 0,void 0,(function(){var t;return Ke(this,(function(n){switch(n.label){case 0:return[4,this._getObjectStore("readonly")];case 1:return t=n.sent(),[4,new Promise((function(n,r){var i=t.get(e);i.addEventListener("success",(function(e){var t;n(null===(t=null==e?void 0:e.target)||void 0===t?void 0:t.result)})),i.addEventListener("error",(function(e){return r(e.target.error)}))}))];case 2:return[2,n.sent()]}}))}))},t.prototype._setRaw=function(e){return Qe(this,void 0,void 0,(function(){var t;return Ke(this,(function(n){switch(n.label){case 0:return[4,this._getObjectStore("readwrite")];case 1:return t=n.sent(),[4,Promise.all(e.map((function(e){return new Promise((function(n,r){var i=t.put(e);i.addEventListener("success",(function(e){n(e.target.result)})),i.addEventListener("error",(function(){r("Failed to write.")}))}))})))];case 2:return n.sent(),[2]}}))}))},t.prototype._removeRaw=function(e){return Qe(this,void 0,void 0,(function(){var t;return Ke(this,(function(n){switch(n.label){case 0:return[4,this._getObjectStore("readwrite")];case 1:return t=n.sent(),[4,Promise.all(e.map((function(e){return new Promise((function(n,r){var i=t.delete(e);i.addEventListener("success",(function(){return n(e)})),i.addEventListener("error",(function(e){return r(e.target.error)}))}))})))];case 2:return n.sent(),[2]}}))}))},t.prototype._triggerDatabaseClose=function(){this._database&&this._database.onclose&&this._database.onclose(new Event("dummy"))},t.prototype.checkAvailability=function(){return Qe(this,void 0,void 0,(function(){var e,t=this;return Ke(this,(function(n){switch(n.label){case 0:if(!((null==(e="undefined"!=typeof window?window:null)?void 0:e.indexedDB)||(null==e?void 0:e.mozIndexedDB)||(null==e?void 0:e.webkitIndexedDB)||(null==e?void 0:e.msIndexedDB)))return[3,6];if(this._indexedDb=e.indexedDB||e.mozIndexedDB||e.webkitIndexedDB||e.msIndexedDB,!this._window||!xd())return[3,4];if(!(xd()&&navigator.userAgent&&navigator.userAgent.includes("Edge/")))return[3,1];if(!this._window.indexedDB&&(e.PointerEvent||e.MSPointerEvent))throw rd.storeNotAvailableInPrivateBrowsing;return[3,3];case 1:return[4,new Promise((function(e,n){if(t._indexedDb)try{var r=t._indexedDb.open("_testMozilla");r.onerror=function(){return n(rd.storeNotAvailableInPrivateBrowsing)},r.onsuccess=function(){return e()}}catch(e){n(rd.storeNotAvailableInPrivateBrowsing)}else n(rd.storeNotAvailable)}))];case 2:n.sent(),n.label=3;case 3:return[3,5];case 4:throw rd.storeNotAvailable;case 5:return[3,7];case 6:throw rd.storeNotAvailable;case 7:return[2]}}))}))},t.prototype.init=function(e){return Qe(this,void 0,void 0,(function(){return Ke(this,(function(t){switch(t.label){case 0:return this.dbname=e,[4,this.checkAvailability()];case 1:return t.sent(),[4,this._openDatabase(e)];case 2:return t.sent(),[4,this._resetIfEncryptionChanged()];case 3:return t.sent(),[2]}}))}))},t.prototype.clear=function(){return Qe(this,void 0,void 0,(function(){var e;return Ke(this,(function(t){switch(t.label){case 0:return[4,this._getObjectStore("readwrite")];case 1:return e=t.sent(),[4,new Promise((function(t,n){var r=e.clear();r.addEventListener("success",(function(){return t()})),r.addEventListener("error",(function(e){return n(e.target.error)}))}))];case 2:return[2,t.sent()]}}))}))},t}(Qd),Xd=function(e){function t(t){var n=this,r=t.AsyncStorage,i=t.itemSizeLimit,a=void 0===i?6291456:i,s=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}(t,["AsyncStorage","itemSizeLimit"]);return(n=e.call(this,je(je({},s),{itemSizeLimit:a}))||this)._asyncStorage=r,n}return Be(t,e),t.prototype._isBelonging=function(e){return e.startsWith("".concat(this.dbname,"/"))},t.prototype._getActualKey=function(e){return"".concat(this.dbname,"/").concat(e)},t.prototype._getAllRawKeys=function(){return Qe(this,void 0,void 0,(function(){var e=this;return Ke(this,(function(t){switch(t.label){case 0:return[4,this._asyncStorage.getAllKeys()];case 1:return[2,t.sent().filter((function(t){return e._isBelonging(t)})).map((function(t){return t.substring("".concat(e.dbname,"/").length)}))]}}))}))},t.prototype._getRaw=function(e){return Qe(this,void 0,void 0,(function(){var t;return Ke(this,(function(n){switch(n.label){case 0:return[4,this._asyncStorage.getItem(this._getActualKey(e))];case 1:return[2,(t=n.sent())?JSON.parse(t):null]}}))}))},t.prototype._setRaw=function(e){return Qe(this,void 0,void 0,(function(){var t,n,r,i,a,s,o;return Ke(this,(function(u){switch(u.label){case 0:t=[];try{for(n=We(e),r=n.next();!r.done;r=n.next())i=r.value,a=i.key,i.data.length<=this.adjustedItemSizeLimit&&t.push([this._getActualKey(a),JSON.stringify(i)])}catch(e){s={error:e}}finally{try{r&&!r.done&&(o=n.return)&&o.call(n)}finally{if(s)throw s.error}}return[4,this._asyncStorage.multiSet(t)];case 1:return u.sent(),[2]}}))}))},t.prototype._removeRaw=function(e){return Qe(this,void 0,void 0,(function(){var t=this;return Ke(this,(function(n){switch(n.label){case 0:return[4,this._asyncStorage.multiRemove(e.map((function(e){return t._getActualKey(e)})))];case 1:return n.sent(),[2]}}))}))},t.prototype.checkAvailability=function(){return Qe(this,void 0,void 0,(function(){return Ke(this,(function(e){if(!this._asyncStorage)throw rd.storeNotAvailable;return[2]}))}))},t.prototype.init=function(e){return Qe(this,void 0,void 0,(function(){return Ke(this,(function(t){switch(t.label){case 0:return this.dbname=e,[4,this._resetIfEncryptionChanged()];case 1:return t.sent(),[2]}}))}))},t.prototype.clear=function(){return Qe(this,void 0,void 0,(function(){var e;return Ke(this,(function(t){switch(t.label){case 0:return[4,this.getAllKeys()];case 1:return e=t.sent(),[4,this.removeMany(e)];case 2:return t.sent(),[2]}}))}))},t}(Qd);!function(e){function t(t){var n,r=this;return(r=e.call(this,je(je({},t),{itemSizeLimit:null!==(n=t.itemSizeLimit)&&void 0!==n?n:6291456}))||this)._mmkv=t.MMKV,r}Be(t,e),t.prototype._isBelonging=function(e){return e.startsWith("".concat(this.dbname,"/"))},t.prototype._getActualKey=function(e){return"".concat(this.dbname,"/").concat(e)},t.prototype._getAllRawKeys=function(){return Qe(this,void 0,void 0,(function(){var e=this;return Ke(this,(function(t){switch(t.label){case 0:return[4,this._mmkv.getAllKeys()];case 1:return[2,t.sent().filter((function(t){return e._isBelonging(t)})).map((function(t){return t.substring("".concat(e.dbname,"/").length)}))]}}))}))},t.prototype._getRaw=function(e){return Qe(this,void 0,void 0,(function(){var t;return Ke(this,(function(n){switch(n.label){case 0:return[4,this._mmkv.getString(this._getActualKey(e))];case 1:return[2,(t=n.sent())?JSON.parse(t):null]}}))}))},t.prototype._setRaw=function(e){return Qe(this,void 0,void 0,(function(){var t,n,r,i,a,s;return Ke(this,(function(o){try{for(t=We(e),n=t.next();!n.done;n=t.next())r=n.value,i=r.key,r.data.length<=this.adjustedItemSizeLimit&&this._mmkv.set(this._getActualKey(i),JSON.stringify(r))}catch(e){a={error:e}}finally{try{n&&!n.done&&(s=t.return)&&s.call(t)}finally{if(a)throw a.error}}return[2]}))}))},t.prototype._removeRaw=function(e){return Qe(this,void 0,void 0,(function(){var t,n,r,i,a;return Ke(this,(function(s){try{for(t=We(e),n=t.next();!n.done;n=t.next())r=n.value,this._mmkv.delete(this._getActualKey(r))}catch(e){i={error:e}}finally{try{n&&!n.done&&(a=t.return)&&a.call(t)}finally{if(i)throw i.error}}return[2]}))}))},t.prototype.checkAvailability=function(){return Qe(this,void 0,void 0,(function(){return Ke(this,(function(e){if(!this._mmkv)throw rd.storeNotAvailable;return[2]}))}))},t.prototype.init=function(e){return Qe(this,void 0,void 0,(function(){return Ke(this,(function(t){switch(t.label){case 0:return this.dbname=e,[4,this._resetIfEncryptionChanged()];case 1:return t.sent(),[2]}}))}))},t.prototype.clear=function(){return Qe(this,void 0,void 0,(function(){var e;return Ke(this,(function(t){switch(t.label){case 0:return[4,this.getAllKeys()];case 1:return e=t.sent(),[4,this.removeMany(e)];case 2:return t.sent(),[2]}}))}))}}(Qd),function(e){e.INIT="INIT",e.OPENING="OPENING",e.OPENED="OPENED",e.CLOSED="CLOSED"}(Zd||(Zd={}));var $d,eh=function(){function e(e){var t=e.name,n=e.version,r=e.store,i=e.config;this.name=t,this._version=n,this._state=Zd.INIT,this._config=i||new td({dbname:t}),this._store=r,this._event={success:cd,error:cd,storeReplaced:cd,upgrade:fd},this._collections=new Map,this._globalMutex=new Hd("".concat(this.name,".lock")),this._config.disableLogger&&Bd.off(),new Md({dbname:t,limit:this._config.cacheLimit})}return Object.defineProperty(e.prototype,"version",{get:function(){return this._version},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"state",{get:function(){return this._state},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"store",{get:function(){return this._store},enumerable:!1,configurable:!0}),e.prototype.estimateUsage=function(){return Qe(this,void 0,void 0,(function(){return Ke(this,(function(e){switch(e.label){case 0:return[4,(t=this._store,Qe(void 0,void 0,void 0,(function(){return Ke(this,(function(e){switch(e.label){case 0:return[4,t.usage()];case 1:return[2,e.sent()]}}))})))];case 1:return[2,e.sent()]}var t}))}))},e.prototype.commitSchema=function(e){return Qe(this,void 0,void 0,(function(){var t=this;return Ke(this,(function(n){switch(n.label){case 0:return this._state!==Zd.OPENING?[3,2]:[4,Promise.all(e.map((function(e){return Qe(t,void 0,void 0,(function(){var t,n,r,i,a;return Ke(this,(function(s){switch(s.label){case 0:return t=e.collectionName,n=e.keyName,r=e.index,i=void 0===r?[]:r,this._collections.has(t)||this._collections.set(t,new qd({dbname:this.name,collectionName:t,keyName:n,indexes:i,store:this._store})),(a=this._collections.get(t))?[4,a.init()]:[3,2];case 1:s.sent(),s.label=2;case 2:return[2]}}))}))})))];case 1:return n.sent(),[3,3];case 2:throw rd.databaseSchemaNotOnUpgrade;case 3:return[2]}}))}))},e.prototype.open=function(){var e;return Qe(this,void 0,void 0,(function(){var t,n,r,i,a=this;return Ke(this,(function(s){switch(s.label){case 0:return[4,this._globalMutex.lock()];case 1:if(s.sent(),this._state===Zd.OPENED)return[3,12];this._state=Zd.OPENING,s.label=2;case 2:return s.trys.push([2,5,,12]),[4,this._store.init(this.name)];case 3:return s.sent(),o=this.name,t="".concat(Ed(o),".metadata"),n={version:0,collectionNames:[]},[4,this._store.get(t)];case 4:return r=null!==(e=s.sent())&&void 0!==e?e:n,[2,new Promise((function(e,n){var i=function(e){r.version<a._version?a._event.upgrade(r.version,(function(n){return Qe(a,void 0,void 0,(function(){var i;return Ke(this,(function(a){switch(a.label){case 0:if(n)return[3,5];r.version++,r.collectionNames=Array.from(this._collections.keys()),a.label=1;case 1:return a.trys.push([1,3,,4]),[4,this._store.set({key:t,value:r})];case 2:return a.sent(),e({continued:!0}),[3,4];case 3:return i=a.sent(),e({continued:!1,err:i}),[3,4];case 4:return[3,6];case 5:e({continued:!1,err:n}),a.label=6;case 6:return[2]}}))}))})):e({continued:!1})},s=function(t){var o=t.continued,u=void 0!==o&&o,l=t.err,c=void 0===l?null:l;if(u)setTimeout((function(){return i(s)}),10);else if(c)Bd.error(c.message),a._globalMutex.unlock(),a._event.error(c),n(c);else{var d=[];r.collectionNames.forEach((function(e){var t=a._collections.get(e);t&&t.state===nd.READY||d.push(Qe(a,void 0,void 0,(function(){var t,n;return Ke(this,(function(r){switch(r.label){case 0:return[4,qd.metadataOf(this.name,e,this._store)];case 1:return(t=r.sent())?(n=new qd({dbname:this.name,collectionName:e,keyName:t.keyName,indexes:t.indexes,store:this._store}),this._collections.set(e,n),[4,n.init()]):[3,3];case 2:r.sent(),r.label=3;case 3:return[2]}}))})))})),Promise.all(d).then((function(){a._state=Zd.OPENED,a._globalMutex.unlock(),a._event.success(),e()})).catch((function(e){Bd.error(e.message),a._globalMutex.unlock(),a._event.error(e),n(e)}))}};i(s)}))];case 5:switch((i=s.sent()).code){case Hc.STORE_NOT_AVAILABLE_IN_PRIVATE_BROWSING:return[3,6];case Hc.STORE_NOT_AVAILABLE:return[3,8]}return[3,10];case 6:return Bd.warning("Access to the local storage is not allowed. Switched to MemoryStore automatically."),this._store=new Wd({}),this._globalMutex.unlock(),this._event.error(i),this._event.storeReplaced(this._store),[4,this.open()];case 7:return s.sent(),[3,11];case 8:return Bd.warning("IndexedDB is not available in this environment. Switched to MemoryStore automatically. Consider using other store to save data persistently (e.g. AsyncStorage)."),this._store=new Wd({}),this._globalMutex.unlock(),this._event.error(i),this._event.storeReplaced(this._store),[4,this.open()];case 9:return s.sent(),[3,11];case 10:throw Bd.error(i.message),this._globalMutex.unlock(),this._event.error(i),i;case 11:return[3,12];case 12:return[2]}var o}))}))},e.prototype.close=function(){this._collections.forEach((function(e){return e.close()})),this._state=Zd.CLOSED},e.prototype.clear=function(){return Qe(this,void 0,void 0,(function(){return Ke(this,(function(e){switch(e.label){case 0:return[4,Promise.all(Array.from(this._collections.values()).map((function(e){return e.clear()})))];case 1:return e.sent(),[2]}}))}))},e.prototype.reset=function(){return Qe(this,void 0,void 0,(function(){var e,t=this;return Ke(this,(function(n){switch(n.label){case 0:return this.close(),(e=Md.get(this.name))&&e.clearByCondition((function(e){return e.key.startsWith(Ed(t.name))})),[4,this._store.clear()];case 1:return n.sent(),[2]}}))}))},e.prototype.on=function(e,t){this._event[e]=t},e.prototype.off=function(e){"function"==typeof this._event[e]&&(this._event[e]="upgrade"===e?fd:cd)},e.prototype.collection=function(e){var t=this._collections.get(e);if(t)return t;throw rd.collectionNotReady},e}(),th=function(){function e(){this.messageTypeFilter=At.ALL,this.customTypesFilter=null,this.senderUserIdsFilter=null,this.replyType=Ut.NONE}return e.prototype.clone=function(){var t=new e,n=JSON.parse(JSON.stringify(this));return Object.keys(n).forEach((function(e){t[e]=n[e]})),t},e.prototype.match=function(e){switch(this.messageTypeFilter){case At.USER:if(e.messageType!==Nt.USER)return!1;break;case At.FILE:if(e.messageType!==Nt.FILE)return!1;break;case At.ADMIN:if(e.messageType!==Nt.ADMIN)return!1}if(this.customTypesFilter&&this.customTypesFilter.length>0&&!this.customTypesFilter.includes("*")&&!this.customTypesFilter.includes(e.customType))return!1;if(this.senderUserIdsFilter&&this.senderUserIdsFilter.length>0){if(!(e instanceof au))return!1;if(!this.senderUserIdsFilter.includes(e.sender.userId))return!1}if(e instanceof iu)switch(this.replyType){case Ut.NONE:if(e.parentMessageId>0)return!1;break;case Ut.ONLY_REPLY_TO_CHANNEL:if(e instanceof au&&e.parentMessageId>0&&!e.replyToChannel)return!1}return!0},e}();!function(e){e.CHANNEL_LATEST="channel_latest",e.NEWEST_CHILD_MESSAGE="newest_child_message"}($d||($d={}));var nh,rh=function(e){switch(e){case $d.CHANNEL_LATEST:return["channelUrl","-createdAt","-messageId"];case $d.NEWEST_CHILD_MESSAGE:return["channelUrl","-parentMessageId","-createdAt","-messageId"]}},ih=je(je({},Ku),{scheduledAt:void 0}),ah=je(je({},Bu),{scheduledAt:0,file:void 0,fileUrl:void 0,fileName:void 0,mimeType:void 0,fileSize:void 0,thumbnailSizes:void 0,requireAuth:!1}),sh="UnsentMessage",oh={},uh=function(e){function t(t){var n=e.call(this,t)||this;return n._mutex=new Hd("unsendmessagecache.lock"),oh[t]=n,n}return Be(t,e),Object.defineProperty(t.prototype,"_cacheContext",{get:function(){return eo.of(this._iid).cacheContext},enumerable:!1,configurable:!0}),t.of=function(e,n){return void 0===n&&(n=!1),oh[e]&&!n||(oh[e]=new t(e)),oh[e]},Object.defineProperty(t.prototype,"collection",{get:function(){var e=this._cacheContext.nestdb,t=null==e?void 0:e.collection(sh);if(!t)throw st.databaseError;return t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"localCacheEnabled",{get:function(){return this._cacheContext.localCacheEnabled&&!!this.collection},enumerable:!1,configurable:!0}),t.prototype._serialize=function(e){if(e.messageId>0)throw st.invalidParameters;var t,n=je({},e.serialize());return e instanceof hu?(e.messageParams&&(n.messageParams=Qu(e.messageParams)),e.scheduledInfo&&e.scheduledInfo.scheduledMessageParams&&(n.scheduledInfo.scheduledMessageParams=(t=e.scheduledInfo.scheduledMessageParams,je(je({},Qu(t)),{scheduledAt:t.scheduledAt})))):e instanceof yu?(e.messageParams&&(n.messageParams=el(e.messageParams)),e.scheduledInfo&&e.scheduledInfo.scheduledMessageParams&&(n.scheduledInfo.scheduledMessageParams=function(e){return je(je({},el(e)),{scheduledAt:e.scheduledAt})}(e.scheduledInfo.scheduledMessageParams))):e instanceof pu&&e.messageParams&&(n.messageParams=function(e){return qt({fileInfoList:e.fileInfoList,isReplyToChannel:e.isReplyToChannel,pushNotificationDeliveryOption:e.pushNotificationDeliveryOption})}(e.messageParams)),n},t.prototype._deserialize=function(e){return e=je(je({},e),{messageId:parseInt(e.messageId)}),vh.of(this._iid).buildMessageFromSerializedData(e)},t.prototype._deserializeWithMessageCreateParams=function(e){var t,n,r;return Qe(this,void 0,void 0,(function(){var i,a,s,o,u,l,c=this;return Ke(this,(function(d){switch(d.label){case 0:return i=vh.of(this._iid),a=this._deserialize(e),e.messageParams?a instanceof hu?(o=e.messageParams,a.messageParams=i.buildUserMessageCreateParamsFromSerializedData(o,a),[3,6]):[3,1]:[3,6];case 1:return a instanceof yu?(o=e.messageParams).fileKey&&"string"==typeof o.fileKey&&$u(null!==(t=o.fileType)&&void 0!==t?t:"")?(s=o,[4,this.collection.getBlob(o.fileKey)]):[3,3]:[3,4];case 2:s.file=null!==(n=d.sent())&&void 0!==n?n:void 0,d.label=3;case 3:return a.messageParams=i.buildFileMessageCreateParamsFromSerializedData(o,a),[3,6];case 4:return a instanceof pu&&(o=e.messageParams)&&o.fileInfoList?(a.messageParams=i.buildMultipleFilesMessageCreateParamsFromSerializedData(o,a),[4,Promise.all(a.messageParams.fileInfoList.map((function(e){return Qe(c,void 0,void 0,(function(){var t,n,r,i,a;return Ke(this,(function(s){switch(s.label){case 0:return"string"==typeof(null===(n=e._uploadedMetaData)||void 0===n?void 0:n.fileKey)&&$u(null!==(i=null===(r=e._uploadedMetaData)||void 0===r?void 0:r.fileType)&&void 0!==i?i:"")?(t=e,[4,this.collection.getBlob(e._uploadedMetaData.fileKey)]):[3,2];case 1:t.file=null!==(a=s.sent())&&void 0!==a?a:void 0,s.label=2;case 2:return[2]}}))}))})))]):[3,6];case 5:d.sent(),d.label=6;case 6:return a.scheduledInfo&&e.scheduledInfo&&e.scheduledInfo.scheduledMessageParams?a instanceof hu?(u=e.scheduledInfo.scheduledMessageParams,a.scheduledInfo.scheduledMessageParams=i.buildScheduledUserMessageCreateParamsFromSerializedData(u,a),[3,10]):[3,7]:[3,10];case 7:return a instanceof yu?(u=e.scheduledInfo.scheduledMessageParams).fileKey&&"string"==typeof u.fileKey&&"string"==typeof u.fileType&&$u(u.fileType)?(l=u,[4,this.collection.getBlob(u.fileKey)]):[3,9]:[3,10];case 8:l.file=null!==(r=d.sent())&&void 0!==r?r:void 0,d.label=9;case 9:a.scheduledInfo.scheduledMessageParams=i.buildScheduledFileMessageCreateParamsFromSerializedData(u,a),d.label=10;case 10:return[2,a]}}))}))},t.prototype._getFileInfoBlobKey=function(e,t){return"".concat(e,".").concat(t)},t.prototype.get=function(e){return Qe(this,void 0,void 0,(function(){var t;return Ke(this,(function(n){switch(n.label){case 0:return this.localCacheEnabled?[4,this.collection.getByKey("".concat(e))]:[3,2];case 1:if(t=n.sent())return[2,this._deserializeWithMessageCreateParams(t)];n.label=2;case 2:return[2,void 0]}}))}))},t.prototype.fetch=function(e){var t=e.channelUrl,n=e.filter,r=void 0===n?new th:n,i=e.order,a=void 0===i?$d.CHANNEL_LATEST:i,s=e.sendingStatus,o=e.backward,u=void 0!==o&&o,l=e.parentMessageId;return Qe(this,void 0,void 0,(function(){var e,n,i,o,c=this;return Ke(this,(function(d){switch(d.label){case 0:return this.localCacheEnabled?(e=rh(a),n={"/where":function(e){return!!(a!==$d.NEWEST_CHILD_MESSAGE||l&&0!==e.parentMessageId&&e.parentMessageId===l)&&r.match(c._deserialize(e))}},t&&(n.channelUrl=t),s&&(n.sendingStatus=s),i={where:n,index:e,backward:u},[4,this.collection.query(i)]):[3,3];case 1:return[4,d.sent().fetch({})];case 2:return o=d.sent(),[2,Promise.all(o.map((function(e){return Qe(c,void 0,void 0,(function(){return Ke(this,(function(t){switch(t.label){case 0:return[4,this._deserializeWithMessageCreateParams(e)];case 1:return[2,t.sent()]}}))}))})))];case 3:return[2,[]]}}))}))},t.prototype.getAllChildMessages=function(e,t){return void 0===t&&(t=new th),Qe(this,void 0,void 0,(function(){return Ke(this,(function(n){switch(n.label){case 0:return[4,this.fetch({filter:t,order:$d.NEWEST_CHILD_MESSAGE,channelUrl:e.channelUrl,backward:!1,parentMessageId:e.messageId})];case 1:return[2,n.sent()]}}))}))},t.prototype.upsert=function(e){return Qe(this,void 0,void 0,(function(){var t=this;return Ke(this,(function(n){switch(n.label){case 0:return this.localCacheEnabled?[4,Promise.all(e.map((function(e){return Qe(t,void 0,void 0,(function(){var t;return Ke(this,(function(n){switch(n.label){case 0:return e instanceof yu||e instanceof pu?[4,this._mutex.lock()]:[3,4];case 1:return n.sent(),[4,this.saveBlob(e)];case 2:return n.sent(),[4,this._mutex.unlock()];case 3:n.sent(),n.label=4;case 4:return t=this._serialize(e),[4,this.collection.upsertOne(t)];case 5:return n.sent(),[2]}}))}))})))]:[3,2];case 1:n.sent(),n.label=2;case 2:return[2]}}))}))},t.prototype.upsertChildMessages=function(e){return Qe(this,void 0,void 0,(function(){var t=this;return Ke(this,(function(n){switch(n.label){case 0:return this.localCacheEnabled?[4,Promise.all(e.map((function(e){return Qe(t,void 0,void 0,(function(){var t;return Ke(this,(function(n){switch(n.label){case 0:return t=[],e.threadInfo&&e.threadInfo.replyCount>0?[4,this.getAllChildMessages(e)]:[3,2];case 1:t=n.sent(),n.label=2;case 2:return t.length>0?(t.forEach((function(t){return t.applyParentMessage(e)})),[4,this.upsert(t)]):[3,4];case 3:n.sent(),n.label=4;case 4:return[2]}}))}))})))]:[3,2];case 1:n.sent(),n.label=2;case 2:return[2]}}))}))},t.prototype.remove=function(e){return Qe(this,void 0,void 0,(function(){var t,n,r,i,a,s;return Ke(this,(function(o){switch(o.label){case 0:if(!this.localCacheEnabled)return[3,8];o.label=1;case 1:o.trys.push([1,6,7,8]),t=We(e),n=t.next(),o.label=2;case 2:return n.done?[3,5]:(r=n.value,[4,this.collection.remove(r)]);case 3:o.sent(),o.label=4;case 4:return n=t.next(),[3,2];case 5:return[3,8];case 6:return i=o.sent(),a={error:i},[3,8];case 7:try{n&&!n.done&&(s=t.return)&&s.call(t)}finally{if(a)throw a.error}return[7];case 8:return[2]}}))}))},t.prototype.removeMessagesOfChannel=function(e){return Qe(this,void 0,void 0,(function(){return Ke(this,(function(t){switch(t.label){case 0:return this.localCacheEnabled?[4,this.collection.removeIf({where:{channelUrl:e}})]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))},t.prototype.clear=function(){return Qe(this,void 0,void 0,(function(){return Ke(this,(function(e){switch(e.label){case 0:return this.localCacheEnabled?[4,this.collection.clear()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))}))},t.prototype.saveBlob=function(e){return Qe(this,void 0,void 0,(function(){var t,n,r,i=this;return Ke(this,(function(a){switch(a.label){case 0:return e instanceof yu?e.messageParams&&(r=e.messageParams).file&&Xu(r.file)?[4,this.collection.saveBlob(r.file,e.reqId)]:[3,2]:[3,5];case 1:n=a.sent(),r.fileKey=n,r.fileType=Yu.BLOB,a.label=2;case 2:return e.scheduledInfo&&e.scheduledInfo.scheduledMessageParams&&(t=e.scheduledInfo.scheduledMessageParams).file&&Xu(t.file)?[4,this.collection.saveBlob(t.file,e.reqId)]:[3,4];case 3:n=a.sent(),t.fileKey=n,t.fileType=Yu.BLOB,a.label=4;case 4:return[3,7];case 5:return e instanceof pu&&(r=e.messageParams)&&r.fileInfoList&&Array.isArray(r.fileInfoList)?[4,Promise.all(r.fileInfoList.map((function(t,n){return Qe(i,void 0,void 0,(function(){var r;return Ke(this,(function(i){switch(i.label){case 0:return t.file&&Xu(t.file)?[4,this.collection.saveBlob(t.file,this._getFileInfoBlobKey(e.reqId,n))]:[3,2];case 1:r=i.sent(),t._uploadedMetaData||(t._uploadedMetaData={}),t._uploadedMetaData.fileKey=r,t._uploadedMetaData.fileType=Yu.BLOB,i.label=2;case 2:return[2]}}))}))})))]:[3,7];case 6:a.sent(),a.label=7;case 7:return[2]}}))}))},t}(ns),lh={},ch=function(e){function t(t){var n=e.call(this,t)||this;return lh[t]=n,n}return Be(t,e),Object.defineProperty(t.prototype,"_sdkState",{get:function(){return eo.of(this._iid).sdkState},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_cacheContext",{get:function(){return eo.of(this._iid).cacheContext},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_unsentMessageCache",{get:function(){return uh.of(this._iid)},enumerable:!1,configurable:!0}),t.of=function(e,n){return void 0===n&&(n=!1),lh[e]&&!n||(lh[e]=new t(e)),lh[e]},Object.defineProperty(t.prototype,"collection",{get:function(){var e=this._cacheContext.nestdb;return hs(!!e).throw(st.databaseError),e.collection(Rc)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"localCacheEnabled",{get:function(){return this._cacheContext.localCacheEnabled&&!!this.collection},enumerable:!1,configurable:!0}),t.prototype._serialize=function(e){return je(je({},e.serialize()),{messageId:"".concat(e.messageId)})},t.prototype._deserialize=function(e){return e=je(je({},e),{messageId:parseInt(e.messageId)}),vh.of(this._iid).buildMessageFromSerializedData(e)},t.prototype.get=function(e){return Qe(this,void 0,void 0,(function(){var t;return Ke(this,(function(n){switch(n.label){case 0:return this.localCacheEnabled?[4,this.collection.getByKey("".concat(e))]:[3,2];case 1:if(t=n.sent())return[2,this._deserialize(t)];n.label=2;case 2:return[2,void 0]}}))}))},t.prototype.fetch=function(e){var t=e.channelUrl,n=e.token,r=e.limit,i=void 0===r?100:r,a=e.filter,s=void 0===a?new th:a,o=e.order,u=void 0===o?$d.CHANNEL_LATEST:o,l=e.backward,c=void 0!==l&&l,d=e.parentMessageId,h=e.isPollOnly,f=void 0!==h&&h,p=e.exactMatch,_=void 0!==p&&p,v=e.inclusive,m=void 0===v||v;return Qe(this,void 0,void 0,(function(){var e,r,a,o=this;return Ke(this,(function(l){switch(l.label){case 0:return this.localCacheEnabled?(e=rh(u),r={where:{channelUrl:t,"/where":function(e){if(n)switch(u){case $d.CHANNEL_LATEST:if(_&&e.createdAt!==n)return!1;if(c){if(m&&e.createdAt<n||!m&&e.createdAt<=n)return!1}else if(m&&e.createdAt>n||!m&&e.createdAt>=n)return!1;break;case $d.NEWEST_CHILD_MESSAGE:if(!d||0===e.parentMessageId||e.parentMessageId!==d)return!1}return!(f&&!e._poll)&&s.match(o._deserialize(e))}},index:e,backward:c},[4,this.collection.query(r)]):[3,3];case 1:return[4,l.sent().fetch({limit:null!=i?i:void 0})];case 2:return a=l.sent(),[2,Promise.all(a.map((function(e){return Qe(o,void 0,void 0,(function(){return Ke(this,(function(t){return[2,this._deserialize(e)]}))}))})))];case 3:return[2,[]]}}))}))},t.prototype.getAllChildMessages=function(e,t){return void 0===t&&(t=new th),Qe(this,void 0,void 0,(function(){return Ke(this,(function(n){switch(n.label){case 0:return[4,this.fetch({channelUrl:e.channelUrl,token:Date.now(),limit:null,backward:!1,filter:t,order:$d.NEWEST_CHILD_MESSAGE,parentMessageId:e.messageId})];case 1:return[2,n.sent()]}}))}))},t.prototype.upsert=function(e){return Qe(this,void 0,void 0,(function(){var t,n=this;return Ke(this,(function(r){switch(r.label){case 0:return this.localCacheEnabled?[4,this.saveBlobs(e)]:[3,5];case 1:return r.sent(),t=e.map((function(e){return n._serialize(e)})),[4,this.collection.upsertMany(t)];case 2:return r.sent(),[4,this.upsertChildMessages(e)];case 3:return r.sent(),[4,this._unsentMessageCache.upsertChildMessages(e)];case 4:r.sent(),r.label=5;case 5:return[2]}}))}))},t.prototype.upsertChildMessages=function(e){return Qe(this,void 0,void 0,(function(){var t=this;return Ke(this,(function(n){switch(n.label){case 0:return this.localCacheEnabled?[4,Promise.all(e.map((function(e){return Qe(t,void 0,void 0,(function(){var t,n;return Ke(this,(function(r){switch(r.label){case 0:return t=[],(null===(n=e.threadInfo)||void 0===n?void 0:n.replyCount)&&e.threadInfo.replyCount>0?[4,this.getAllChildMessages(e)]:[3,2];case 1:t=r.sent(),r.label=2;case 2:return t.length>0?(t.forEach((function(t){return t.applyParentMessage(e)})),[4,this.upsert(t)]):[3,4];case 3:r.sent(),r.label=4;case 4:return[2]}}))}))})))]:[3,2];case 1:n.sent(),n.label=2;case 2:return[2]}}))}))},t.prototype.remove=function(e){return Qe(this,void 0,void 0,(function(){var t,n,r,i,a,s;return Ke(this,(function(o){switch(o.label){case 0:if(!this.localCacheEnabled)return[3,8];o.label=1;case 1:o.trys.push([1,6,7,8]),t=We(e),n=t.next(),o.label=2;case 2:return n.done?[3,5]:(r=n.value,[4,this.collection.remove("".concat(r))]);case 3:o.sent(),o.label=4;case 4:return n=t.next(),[3,2];case 5:return[3,8];case 6:return i=o.sent(),a={error:i},[3,8];case 7:try{n&&!n.done&&(s=t.return)&&s.call(t)}finally{if(a)throw a.error}return[7];case 8:return[2]}}))}))},t.prototype.removeMessagesOfChannel=function(e){return Qe(this,void 0,void 0,(function(){var t;return Ke(this,(function(n){switch(n.label){case 0:return this.localCacheEnabled?[4,this.collection.removeIf({where:{channelUrl:e},index:rh($d.CHANNEL_LATEST)})]:[3,6];case 1:return n.sent(),[4,(t=this._cacheContext.preference).remove("sendbird:".concat(this._sdkState.userId,"@groupchannel/").concat(e,"/message/sync"))];case 2:return n.sent(),[4,t.remove("sendbird:".concat(this._sdkState.userId,"@groupchannel/").concat(e,"/message/sync.meta"))];case 3:return n.sent(),[4,t.remove("sendbird:".concat(this._sdkState.userId,"@groupchannel/").concat(e,"/message/changelogs"))];case 4:return n.sent(),[4,t.remove("sendbird:".concat(this._sdkState.userId,"@groupchannel/").concat(e,"/message/changelogs.meta"))];case 5:n.sent(),n.label=6;case 6:return[2]}}))}))},t.prototype.removeUnderOffset=function(e,t){return Qe(this,void 0,void 0,(function(){return Ke(this,(function(n){switch(n.label){case 0:return this.localCacheEnabled?[4,this.collection.removeIf({where:{channelUrl:e,createdAt:{"<":t}},index:rh($d.CHANNEL_LATEST)})]:[3,2];case 1:n.sent(),n.label=2;case 2:return[2]}}))}))},t.prototype.clear=function(){return Qe(this,void 0,void 0,(function(){return Ke(this,(function(e){switch(e.label){case 0:return this.localCacheEnabled?[4,this.collection.clear()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))}))},t.prototype.countBetween=function(e,t,n){return Qe(this,void 0,void 0,(function(){var r,i=this;return Ke(this,(function(a){switch(a.label){case 0:return this.localCacheEnabled?(r=rh($d.CHANNEL_LATEST),[4,this.collection.query({where:{channelUrl:e,"/where":function(e){var r=i._deserialize(e);return n.includes(r.createdAt)&&t.match(r)}},index:r}).count()]):[3,2];case 1:return[2,a.sent()];case 2:return[2,0]}}))}))},t.prototype.saveBlobs=function(e){return Qe(this,void 0,void 0,(function(){var t=this;return Ke(this,(function(n){switch(n.label){case 0:return[4,Promise.all(e.map((function(e){return Qe(t,void 0,void 0,(function(){var t,n;return Ke(this,(function(r){switch(r.label){case 0:return e instanceof yu&&e.messageParams&&(t=e.messageParams).file&&Xu(t.file)?[4,this.collection.saveBlob(t.file,e.reqId)]:[3,2];case 1:n=r.sent(),t.fileKey=n,r.label=2;case 2:return[2]}}))}))})))];case 1:return n.sent(),[2]}}))}))},t.prototype._getGroupChannelPreferenceSize=function(e){return Qe(this,void 0,void 0,(function(){var t,n,r,i,a,s;return Ke(this,(function(o){switch(o.label){case 0:return t=0,[4,(n=this._cacheContext.preference).get("sendbird:".concat(this._sdkState.userId,"@groupchannel/").concat(e,"/message/sync"))];case 1:return r=o.sent(),[4,n.get("sendbird:".concat(this._sdkState.userId,"@groupchannel/").concat(e,"/message/sync.meta"))];case 2:return i=o.sent(),[4,n.get("sendbird:".concat(this._sdkState.userId,"@groupchannel/").concat(e,"/message/changelogs"))];case 3:return a=o.sent(),[4,n.get("sendbird:".concat(this._sdkState.userId,"@groupchannel/").concat(e,"/message/changelogs.meta"))];case 4:return s=o.sent(),r&&(t+=JSON.stringify(r).length),i&&(t+=JSON.stringify(i).length),a&&(t+=JSON.stringify(a).length),s&&(t+=JSON.stringify(s).length),[2,t]}}))}))},t}(ns),dh={},hh=function(e){function t(t){var n=e.call(this,t)||this;return dh[t]=n,n}return Be(t,e),Object.defineProperty(t.prototype,"_sdkState",{get:function(){return eo.of(this._iid).sdkState},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_cacheContext",{get:function(){return eo.of(this._iid).cacheContext},enumerable:!1,configurable:!0}),t.of=function(e,n){return void 0===n&&(n=!1),dh[e]&&!n||(dh[e]=new t(e)),dh[e]},Object.defineProperty(t.prototype,"collection",{get:function(){var e=this._cacheContext.nestdb;return hs(!!e).throw(st.databaseError),e.collection(xc)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"localCacheEnabled",{get:function(){return this._cacheContext.localCacheEnabled&&!!this.collection},enumerable:!1,configurable:!0}),t.prototype._serialize=function(e){return je({},e.serialize())},t.prototype._deserialize=function(e){return vh.of(this._iid).buildMessageFromSerializedData(e)},t.prototype.get=function(e){return Qe(this,void 0,void 0,(function(){var t;return Ke(this,(function(n){switch(n.label){case 0:return this.localCacheEnabled?[4,this.collection.getByKey(e)]:[3,2];case 1:if(t=n.sent())return[2,this._deserialize(t)];n.label=2;case 2:return[2,void 0]}}))}))},t.prototype.fetch=function(e){var t=e.channelUrl,n=e.token,r=e.limit,i=void 0===r?100:r,a=e.filter,s=void 0===a?new th:a,o=e.backward,u=void 0!==o&&o,l=e.exactMatch,c=void 0!==l&&l,d=e.inclusive,h=void 0===d||d;return Qe(this,void 0,void 0,(function(){var e,r=this;return Ke(this,(function(a){switch(a.label){case 0:return this.localCacheEnabled?(e={where:{channelUrl:t,"/where":function(e){if(n){if(c&&e.createdAt!==n)return!1;if(u){if(h&&e.createdAt<n||!h&&e.createdAt<=n)return!1}else if(h&&e.createdAt>n||!h&&e.createdAt>=n)return!1}return s.match(r._deserialize(e))}},index:["channelUrl","-createdAt","-notificationId"],backward:u},[4,this.collection.query(e)]):[3,3];case 1:return[4,a.sent().fetch({limit:null!=i?i:void 0})];case 2:return[2,a.sent().map((function(e){return r._deserialize(e)}))];case 3:return[2,[]]}}))}))},t.prototype.upsert=function(e){return Qe(this,void 0,void 0,(function(){var t,n=this;return Ke(this,(function(r){switch(r.label){case 0:return this.localCacheEnabled?(t=e.map((function(e){return n._serialize(e)})),[4,this.collection.upsertMany(t)]):[3,2];case 1:r.sent(),r.label=2;case 2:return[2]}}))}))},t.prototype.remove=function(e){return Qe(this,void 0,void 0,(function(){var t,n,r,i,a,s;return Ke(this,(function(o){switch(o.label){case 0:if(!this.localCacheEnabled)return[3,8];o.label=1;case 1:o.trys.push([1,6,7,8]),t=We(e),n=t.next(),o.label=2;case 2:return n.done?[3,5]:(r=n.value,[4,this.collection.remove(r)]);case 3:o.sent(),o.label=4;case 4:return n=t.next(),[3,2];case 5:return[3,8];case 6:return i=o.sent(),a={error:i},[3,8];case 7:try{n&&!n.done&&(s=t.return)&&s.call(t)}finally{if(a)throw a.error}return[7];case 8:return[2]}}))}))},t.prototype.markAsReadByTimestamp=function(e,t){return Qe(this,void 0,void 0,(function(){return Ke(this,(function(n){switch(n.label){case 0:return this.localCacheEnabled?[4,this.collection.updateIf({where:{channelUrl:e,messageStatus:ru.SENT,createdAt:{"<":t}}},{set:{messageStatus:ru.READ}})]:[3,2];case 1:n.sent(),n.label=2;case 2:return[2]}}))}))},t.prototype.markAsReadByMessageIds=function(e,t){return Qe(this,void 0,void 0,(function(){return Ke(this,(function(n){switch(n.label){case 0:return this.localCacheEnabled?[4,this.collection.updateIf({where:{channelUrl:e,notificationId:{"/in":t},messageStatus:ru.SENT}},{set:{messageStatus:ru.READ}})]:[3,2];case 1:return[2,n.sent().length];case 2:return[2,0]}}))}))},t.prototype.removeMessagesOfChannel=function(e){return Qe(this,void 0,void 0,(function(){var t;return Ke(this,(function(n){switch(n.label){case 0:return this.localCacheEnabled?[4,this.collection.removeIf({where:{channelUrl:e},index:["channelUrl","-createdAt","-notificationId"]})]:[3,6];case 1:return n.sent(),[4,(t=this._cacheContext.preference).remove("sendbird:".concat(this._sdkState.userId,"@groupchannel/").concat(e,"/message/sync"))];case 2:return n.sent(),[4,t.remove("sendbird:".concat(this._sdkState.userId,"@groupchannel/").concat(e,"/message/sync.meta"))];case 3:return n.sent(),[4,t.remove("sendbird:".concat(this._sdkState.userId,"@groupchannel/").concat(e,"/message/changelogs"))];case 4:return n.sent(),[4,t.remove("sendbird:".concat(this._sdkState.userId,"@groupchannel/").concat(e,"/message/changelogs.meta"))];case 5:n.sent(),n.label=6;case 6:return[2]}}))}))},t.prototype.removeUnderOffset=function(e,t){return Qe(this,void 0,void 0,(function(){return Ke(this,(function(n){switch(n.label){case 0:return this.localCacheEnabled?[4,this.collection.removeIf({where:{channelUrl:e,createdAt:{"<":t}},index:rh($d.CHANNEL_LATEST)})]:[3,2];case 1:n.sent(),n.label=2;case 2:return[2]}}))}))},t.prototype.clear=function(){return Qe(this,void 0,void 0,(function(){return Ke(this,(function(e){switch(e.label){case 0:return this.localCacheEnabled?[4,this.collection.clear()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))}))},t.prototype.countBetween=function(e,t,n){return Qe(this,void 0,void 0,(function(){var r,i=this;return Ke(this,(function(a){switch(a.label){case 0:return this.localCacheEnabled?(r=["channelUrl","-createdAt","-notificationId"],[4,this.collection.query({where:{channelUrl:e,"/where":function(e){var r=i._deserialize(e);return n.includes(r.createdAt)&&t.match(r)}},index:r}).count()]):[3,2];case 1:return[2,a.sent()];case 2:return[2,0]}}))}))},t}(ns),fh={},ph=function(e){function t(t){var n=e.call(this,t)||this;return n._observers=new Map,n._dispatcherContext=n._dispatcher.on((function(e){return Qe(n,void 0,void 0,(function(){var t,n,r,i,a,s,o,u,l,c,d,h,f,p,_,v,m,g=this;return Ke(this,(function(y){switch(y.label){case 0:return e instanceof co?(t=e.messages,v=e.source,s=e.isWebSocketEventComing,n=t.filter((function(e){return e instanceof iu&&e.messageId>0})),r=t.filter((function(e){return e instanceof iu&&0===e.messageId})),i=t.filter((function(e){return e instanceof vu})),n.length>0?[4,bs((function(){return Qe(g,void 0,void 0,(function(){return Ke(this,(function(e){switch(e.label){case 0:return[4,this._messageCache.upsert(n)];case 1:return e.sent(),[4,this._unsentMessageCache.remove(n.map((function(e){return e instanceof au?e.reqId:null})).filter((function(e){return null!==e})))];case 2:return e.sent(),[2]}}))}))}))]:[3,2]):[3,7];case 1:y.sent(),s||this._broadcastUpdateEvent(n,v),y.label=2;case 2:return r.length>0?[4,bs((function(){return Qe(g,void 0,void 0,(function(){return Ke(this,(function(e){switch(e.label){case 0:return[4,this._unsentMessageCache.upsert(r)];case 1:return e.sent(),[2]}}))}))}))]:[3,4];case 3:y.sent(),s||this._broadcastUpdateEvent(r,v),y.label=4;case 4:return i.length>0?[4,bs((function(){return Qe(g,void 0,void 0,(function(){return Ke(this,(function(e){switch(e.label){case 0:return[4,this._notificationCache.upsert(i)];case 1:return e.sent(),[2]}}))}))}))]:[3,6];case 5:y.sent(),s||this._broadcastUpdateEvent(i,v),y.label=6;case 6:return[3,23];case 7:return e instanceof ho?(a=e.messageIds,v=e.source,s=e.isWebSocketEventComing,o=a.filter((function(e){return"number"==typeof e})),u=a.filter((function(e){return"string"==typeof e})),[4,bs((function(){return Qe(g,void 0,void 0,(function(){return Ke(this,(function(e){switch(e.label){case 0:return o.length>0?[4,this._messageCache.remove(o)]:[3,2];case 1:e.sent(),e.label=2;case 2:return u.length>0?[4,this._notificationCache.remove(u)]:[3,4];case 3:e.sent(),e.label=4;case 4:return[2]}}))}))}))]):[3,9];case 8:return y.sent(),s||this._broadcastRemoveEvent(a,v),[3,23];case 9:return e instanceof fo?(l=e.reqId,v=e.source,[4,bs((function(){return Qe(g,void 0,void 0,(function(){return Ke(this,(function(e){switch(e.label){case 0:return[4,this._unsentMessageCache.remove([l])];case 1:return e.sent(),[2]}}))}))}))]):[3,11];case 10:return y.sent(),this._broadcastRemoveUnsentEvent(l,v),[3,23];case 11:return e instanceof po?(c=e.polls,v=e.source,this._cacheContext.localCacheEnabled?(d=c.map((function(e){return e.messageId})),[4,Promise.all(d.map((function(e){return g._messageCache.get(e)})))]):[3,14]):[3,15];case 12:return(h=y.sent().filter((function(e){return e}))).length>0&&c.forEach((function(e){var t=h.find((function(t){return t.messageId===e.messageId}));t&&t.applyPoll(e)})),[4,bs((function(){return Qe(g,void 0,void 0,(function(){return Ke(this,(function(e){switch(e.label){case 0:return[4,this._messageCache.upsert(h)];case 1:return[2,e.sent()]}}))}))}))];case 13:y.sent(),y.label=14;case 14:return this._broadcastPollChangeLogEvent(c,v),[3,23];case 15:return e instanceof _o?(f=e.event,v=e.source,[4,this._messageCache.get(f.messageId)]):[3,19];case 16:return(p=y.sent())&&p.isUserMessage()&&p.poll&&p.poll.applyPollUpdateEvent(f)?[4,bs((function(){return Qe(g,void 0,void 0,(function(){return Ke(this,(function(e){switch(e.label){case 0:return[4,this._messageCache.upsert([p])];case 1:return[2,e.sent()]}}))}))}))]:[3,18];case 17:y.sent(),y.label=18;case 18:return this._broadcastPollUpdateEvent(f,v),[3,23];case 19:return e instanceof vo?(_=e.event,v=e.source,[4,this._messageCache.get(_.messageId)]):[3,23];case 20:return(m=y.sent())&&m.isUserMessage()&&m.poll&&m.poll.applyPollVoteEvent(_)?[4,bs((function(){return Qe(g,void 0,void 0,(function(){return Ke(this,(function(e){switch(e.label){case 0:return[4,this._messageCache.upsert([m])];case 1:return[2,e.sent()]}}))}))}))]:[3,22];case 21:y.sent(),y.label=22;case 22:this._broadcastPollVoteEvent(_,v),y.label=23;case 23:return[2]}}))}))})),n}return Be(t,e),Object.defineProperty(t.prototype,"_cacheContext",{get:function(){return eo.of(this._iid).cacheContext},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_dispatcher",{get:function(){return eo.of(this._iid).dispatcher},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_messageCache",{get:function(){return ch.of(this._iid)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_unsentMessageCache",{get:function(){return uh.of(this._iid)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_notificationCache",{get:function(){return hh.of(this._iid)},enumerable:!1,configurable:!0}),t.of=function(e,n){var r;return void 0===n&&(n=!1),fh[e]&&!n||(fh[e]&&(null===(r=fh[e]._dispatcherContext)||void 0===r||r.close()),fh[e]=new t(e)),fh[e]},t.prototype._broadcastUpdateEvent=function(e,t){var n,r;try{for(var i=We(this._observers.values()),a=i.next();!a.done;a=i.next()){var s=a.value;s.onUpdate&&s.onUpdate(e,t)}}catch(e){n={error:e}}finally{try{a&&!a.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}},t.prototype._broadcastPollChangeLogEvent=function(e,t){var n,r;try{for(var i=We(this._observers.values()),a=i.next();!a.done;a=i.next()){var s=a.value;s.onPollChangeLogUpdate&&s.onPollChangeLogUpdate(e,t)}}catch(e){n={error:e}}finally{try{a&&!a.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}},t.prototype._broadcastPollUpdateEvent=function(e,t){var n,r;try{for(var i=We(this._observers.values()),a=i.next();!a.done;a=i.next()){var s=a.value;s.onPollUpdate&&s.onPollUpdate(e,t)}}catch(e){n={error:e}}finally{try{a&&!a.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}},t.prototype._broadcastPollVoteEvent=function(e,t){var n,r;try{for(var i=We(this._observers.values()),a=i.next();!a.done;a=i.next()){var s=a.value;s.onPollVote&&s.onPollVote(e,t)}}catch(e){n={error:e}}finally{try{a&&!a.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}},t.prototype._broadcastRemoveEvent=function(e,t){var n,r;try{for(var i=We(this._observers.values()),a=i.next();!a.done;a=i.next()){var s=a.value;s.onRemove&&s.onRemove(e,t)}}catch(e){n={error:e}}finally{try{a&&!a.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}},t.prototype._broadcastRemoveUnsentEvent=function(e,t){var n,r;try{for(var i=We(this._observers.values()),a=i.next();!a.done;a=i.next()){var s=a.value;s.onRemoveUnsent&&s.onRemoveUnsent(e,t)}}catch(e){n={error:e}}finally{try{a&&!a.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}},t.prototype.subscribe=function(e,t){this._observers.set(e,t)},t.prototype.unsubscribe=function(e){this._observers.delete(e)},t.prototype.unsubscribeAll=function(){this._observers.clear()},t}(ns),_h={},vh=function(){function e(e,t){var n=t.sdkState,r=t.dispatcher,i=t.requestQueue,a=t.onlineDetector,s=t.cacheContext;this._iid=e,this._sdkState=n,this._requestQueue=i,this._dispatcher=r,this._cacheContext=s,ch.of(e),uh.of(e),ph.of(e),this.fileMessageQueue=new Nu(e,{sdkState:n,dispatcher:r,requestQueue:i,onlineDetector:a,cacheContext:s}),_h[e]=this}return e.of=function(e){return _h[e]},e.prototype.buildMessageFromSerializedData=function(e){var t=ds(e);if(t.notificationId)return new vu(this._iid,vu.payloadify(t));switch(t.messageType){case Nt.USER:return new hu(this._iid,hu.payloadify(t));case Nt.FILE:return pu._isMultipleFilesMessageSerializedData(t)?new pu(this._iid,pu.payloadify(t)):new yu(this._iid,yu.payloadify(t));case Nt.ADMIN:return new lu(this._iid,lu.payloadify(t))}throw st.invalidParameters},e.prototype.buildUserMessageCreateParamsFromSerializedData=function(e,t){return qt(Vt({data:t.data,customType:t.customType,mentionType:t.mentionType,mentionedUserIds:t.mentionedUserIds,mentionedUsers:t.mentionedUsers,mentionedMessageTemplate:t.mentionedMessageTemplate,metaArrays:t.metaArrays,parentMessageId:t.parentMessageId,isReplyToChannel:e.isReplyToChannel,pushNotificationDeliveryOption:e.pushNotificationDeliveryOption,appleCriticalAlertOptions:t.appleCriticalAlertOptions,reqId:t.reqId,message:t.message,translationTargetLanguages:Object.keys(t.translations),pollId:e.pollId}))},e.prototype.buildFileMessageCreateParamsFromSerializedData=function(e,t){var n;return qt(Vt({data:t.data,customType:t.customType,mentionType:t.mentionType,mentionedUserIds:t.mentionedUserIds,mentionedUsers:t.mentionedUsers,mentionedMessageTemplate:t.mentionedMessageTemplate,metaArrays:t.metaArrays,parentMessageId:t.parentMessageId,isReplyToChannel:e.isReplyToChannel,pushNotificationDeliveryOption:e.pushNotificationDeliveryOption,appleCriticalAlertOptions:t.appleCriticalAlertOptions,reqId:t.reqId,file:e.file,fileKey:e.fileKey,fileUrl:t.plainUrl,fileName:t.name,fileSize:t.size,mimeType:t.type,thumbnailSizes:null===(n=t.thumbnails)||void 0===n?void 0:n.map((function(e){return{maxWidth:e.width,maxHeight:e.height}})),fileType:e.fileType,requireAuth:t.requireAuth}))},e.prototype.buildMultipleFilesMessageCreateParamsFromSerializedData=function(e,t){var n=this;return qt({data:t.data,customType:t.customType,mentionType:t.mentionType,mentionedUserIds:t.mentionedUserIds,mentionedUsers:t.mentionedUsers,mentionedMessageTemplate:t.mentionedMessageTemplate,metaArrays:t.metaArrays,parentMessageId:t.parentMessageId,isReplyToChannel:e.isReplyToChannel,pushNotificationDeliveryOption:e.pushNotificationDeliveryOption,appleCriticalAlertOptions:t.appleCriticalAlertOptions,reqId:t.reqId,fileInfoList:e.fileInfoList.map((function(e){return new Eu(n._iid,e)}))})},e.prototype.buildScheduledUserMessageCreateParamsFromSerializedData=function(e,t){return je(je({},this.buildUserMessageCreateParamsFromSerializedData(e,t)),{scheduledAt:e.scheduledAt})},e.prototype.buildScheduledFileMessageCreateParamsFromSerializedData=function(e,t){return je(je({},this.buildFileMessageCreateParamsFromSerializedData(e,t)),{scheduledAt:e.scheduledAt})},e.prototype.buildSenderFromSerializedData=function(e){var t=ds(e);return new Xo(this._iid,Xo.payloadify(t))},e.prototype.getMessage=function(e){return Qe(this,void 0,void 0,(function(){var t;return Ke(this,(function(n){switch(n.label){case 0:return t=new Ou(e),[4,this._requestQueue.send(t)];case 1:return[2,n.sent().as(Du).message]}}))}))},e.prototype.getScheduledMessage=function(e){return Qe(this,void 0,void 0,(function(){var t;return Ke(this,(function(n){switch(n.label){case 0:return t=new Fu(e),[4,this._requestQueue.send(t)];case 1:return[2,n.sent().as(zu).message]}}))}))},e.prototype.getMessagesByMessageId=function(e,t,n,r,i){return void 0===i&&(i=no.REQUEST_MESSAGE),Qe(this,void 0,void 0,(function(){var a,s,o;return Ke(this,(function(u){switch(u.label){case 0:return a=new Lu(je(je({channelType:t,channelUrl:e,token:String(n)},Au),r)),[4,this._requestQueue.send(a)];case 1:return s=u.sent(),o=s.as(Ru).messages,this._dispatcher.dispatch(new co({messages:o,source:i})),[2,o]}}))}))},e.prototype.getMessagesByTimestamp=function(e,t,n,r,i){return void 0===i&&(i=no.REQUEST_MESSAGE),Qe(this,void 0,void 0,(function(){var a,s,o;return Ke(this,(function(u){switch(u.label){case 0:return a=new Lu(je(je({channelType:t,channelUrl:e,timestamp:n},Au),r)),[4,this._requestQueue.send(a)];case 1:return s=u.sent(),o=s.as(Ru).messages,this._dispatcher.dispatch(new co({messages:o,source:i})),[2,o]}}))}))},e.prototype._getMessagesByTimestampForCollection=function(e,t,n,r,i,a,s){return void 0===i&&(i=no.REQUEST_MESSAGE),Qe(this,void 0,void 0,(function(){var o,u,l,c,d,h;return Ke(this,(function(f){switch(f.label){case 0:return o=new Lu(je(je(je({channelType:t,channelUrl:e,timestamp:n},Au),r),{checkingHasNext:a,checkingContinuousMessages:s})),[4,this._requestQueue.send(o)];case 1:return u=f.sent(),l=u.as(Ru),c=l.messages,d=l.isContinuousMessages,h=l.hasNext,this._dispatcher.dispatch(new co({messages:c,source:i})),[2,{messages:c,isContinuousMessages:d,hasNext:h}]}}))}))},e.prototype.getThreadedMessagesByTimestamp=function(e,t,n,r){return void 0===r&&(r=no.REQUEST_THREADED_MESSAGE),Qe(this,void 0,void 0,(function(){var i,a,s,o;return Ke(this,(function(u){switch(u.label){case 0:return i=new Lu(je(je(je({channelUrl:e.channelUrl,channelType:e.channelType,timestamp:t},ou),n),{replyType:Ut.ALL,parentMessageId:e.messageId,includeThreadInfo:!0})),[4,this._requestQueue.send(i)];case 1:return a=u.sent(),s=a.as(Ru).messages,(o=s.slice(1)).forEach((function(t){t.parentMessage=e})),this._dispatcher.dispatch(new co({messages:o,source:r})),[2,{parentMessage:s[0],threadedMessages:o}]}}))}))},e.prototype.getMessageChangelogs=function(e,t,n,r,i){return void 0===i&&(i=no.REQUEST_MESSAGE_CHANGELOGS),Qe(this,void 0,void 0,(function(){var a,s,o,u,l,c,d,h;return Ke(this,(function(f){switch(f.label){case 0:return a=new xu(qt(Vt(je(je({channelType:t,channelUrl:e,timestamp:"number"==typeof n?n:null,token:"string"==typeof n?n:null},Mu),r)))),[4,this._requestQueue.send(a)];case 1:return s=f.sent(),o=s.as(Pu),u=o.updatedMessages,l=o.deletedMessagesInfo,c=o.hasMore,d=o.nextToken,h=l.map((function(e){return e.messageId})),u.length>0&&this._dispatcher.dispatch(new co({messages:u,source:i})),h.length>0&&this._dispatcher.dispatch(new ho({messageIds:h,source:i})),[2,{updatedMessages:u,deletedMessageIds:h,hasMore:c,token:d}]}}))}))},e}(),mh=function(e){function t(t,n){var r=e.call(this,t)||this;r.targetMessageId=0;var i=n.thread_info,a=n.parent_message_id,s=n.channel_url,o=n.channel_type;return i&&ct("object",i)&&ct("number",a)&&ct("string",s)&&ct("string",o)&&(r.threadInfo=new Bo(t,i),r.targetMessageId=a,r.channelUrl=s,r.channelType=o),r}return Be(t,e),t}(ns),gh={channelUrl:"",channelType:St.BASE,messageId:0,includeReactions:!1,includeMetaArray:!1,includeParentMessageInfo:!1,includeThreadInfo:!1},yh=function(e){function t(t){var n=t.channelCustomType,r=t.keyword,i=t.limit,a=t.reverse,s=t.exactMatch,o=t.channelUrl,u=t.order,l=t.messageTimestampFrom,c=t.messageTimestampTo,d=t.advancedQuery,h=t.targetFields,f=t.nextToken,p=e.call(this)||this;return p.method=Gt.GET,p.path="".concat(Jt,"/messages"),p.params={custom_type:n,query:r,limit:i,reverse:a,exact_match:s,channel_url:o,message_ts_from:l,message_ts_to:c,sort_field:u,advanced_query:d,target_fields:h,after:f},p}return Be(t,e),t}(hn),Eh=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.messages=n.results.map((function(e){return gu(t,e)})),r.hasNext=n.has_next,r.nextToken=n.end_cursor,r.totalCount=n.total_count,r}return Be(t,e),t}(fn);!function(e){e.SCORE="score",e.TIMESTAMP="ts"}(nh||(nh={}));var bh,Ch,wh,Sh=function(e){function t(t,n){var r,i,a,s,o,u,l,c,d,h=this;return(h=e.call(this,t,n)||this).keyword="",h.reverse=!1,h.exactMatch=!1,h.channelUrl="",h.channelCustomType="",h.messageTimestampFrom=null,h.messageTimestampTo=null,h.order=nh.SCORE,h.advancedQuery=!1,h.targetFields=null,h._nextToken="",h.totalCount=-1,h.keyword=n.keyword,h.reverse=null!==(r=n.reverse)&&void 0!==r&&r,h.exactMatch=null!==(i=n.exactMatch)&&void 0!==i&&i,h.channelUrl=null!==(a=n.channelUrl)&&void 0!==a?a:"",h.channelCustomType=null!==(s=n.channelCustomType)&&void 0!==s?s:"",h.messageTimestampFrom=null!==(o=n.messageTimestampFrom)&&void 0!==o?o:null,h.messageTimestampTo=null!==(u=n.messageTimestampTo)&&void 0!==u?u:null,h.order=null!==(l=n.order)&&void 0!==l?l:nh.SCORE,h.advancedQuery=null!==(c=n.advancedQuery)&&void 0!==c&&c,h.targetFields=null!==(d=n.targetFields)&&void 0!==d?d:null,h}return Be(t,e),t.prototype._validate=function(){return e.prototype._validate.call(this)&&ct("string",this.keyword)&&this.keyword.length>0&&ct("boolean",this.reverse)&&ct("boolean",this.exactMatch)&&ct("string",this.channelUrl)&&ct("string",this.channelCustomType)&&(ct("number",this.messageTimestampFrom)||null===this.messageTimestampFrom)&&(ct("number",this.messageTimestampTo)||null===this.messageTimestampTo)&&dt(nh,this.order)&&ct("boolean",this.advancedQuery)&&ft("string",this.targetFields,!0)},t.prototype.next=function(){return Qe(this,void 0,void 0,(function(){var e,t,n,r,i,a,s,o;return Ke(this,(function(u){switch(u.label){case 0:return this._validate()?this._isLoading?[3,3]:this._hasNext?(this._isLoading=!0,e=eo.of(this._iid).requestQueue,t=new yh(Vt(je(je({},this),{nextToken:this._nextToken?this._nextToken:null}))),[4,e.send(t)]):[3,2]:[3,5];case 1:return n=u.sent(),r=n.as(Eh),i=r.messages,a=r.hasNext,s=r.nextToken,o=r.totalCount,this._nextToken=s,this._hasNext=a,this._isLoading=!1,this.totalCount=o,[2,i];case 2:return[2,[]];case 3:throw st.queryInProgress;case 4:return[3,6];case 5:throw st.invalidParameters;case 6:return[2]}}))}))},t}(mo),Th={channelUrl:"",scheduledMessageId:0},Ih=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.name="message",t}return Be(t,e),t.prototype.init=function(t,n){var r=n.sdkState,i=n.dispatcher,a=n.sessionManager,s=n.requestQueue,o=n.logger,u=n.onlineDetector,l=n.cacheContext;e.prototype.init.call(this,t,{sdkState:r,dispatcher:i,sessionManager:a,requestQueue:s,logger:o,onlineDetector:u,cacheContext:l}),this._manager=new vh(t,{sdkState:r,dispatcher:i,requestQueue:s,onlineDetector:u,cacheContext:l})},t.prototype.buildMessageFromSerializedData=function(e){return this._manager.buildMessageFromSerializedData(e)},t.prototype.buildSenderFromSerializedData=function(e){return this._manager.buildSenderFromSerializedData(e)},t.prototype.getMessage=function(e){return Qe(this,void 0,void 0,(function(){var t,n;return Ke(this,(function(r){switch(r.label){case 0:return t=je(je({},gh),e),hs(function(e){return ct("string",e.channelUrl)&&dt(St,e.channelType)&&ct("number",e.messageId)&&ct("boolean",e.includeReactions,!0)&&ct("boolean",e.includeMetaArray,!0)&&ct("boolean",e.includeParentMessageInfo,!0)&&ct("boolean",e.includeThreadInfo,!0)}(t)).throw(st.invalidParameters),[4,this._manager.getMessage(t)];case 1:if((n=r.sent())instanceof iu||n instanceof vu||null===n)return[2,n];throw"Unknown message type is given."}}))}))},t.prototype.getScheduledMessage=function(e){return Qe(this,void 0,void 0,(function(){var t;return Ke(this,(function(n){return t=je(je({},Th),e),hs(function(e){return ct("string",e.channelUrl)&&""!==e.channelUrl&&ct("number",e.scheduledMessageId)&&e.scheduledMessageId>0}(t)).throw(st.invalidParameters),[2,this._manager.getScheduledMessage(t)]}))}))},t}(to),Nh=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.name="poll",t}return Be(t,e),t.prototype.init=function(t,n){var r=n.sdkState,i=n.dispatcher,a=n.sessionManager,s=n.requestQueue,o=n.logger,u=n.onlineDetector,l=n.cacheContext;e.prototype.init.call(this,t,{sdkState:r,dispatcher:i,sessionManager:a,requestQueue:s,logger:o,onlineDetector:u,cacheContext:l}),this._manager=new Ro(t,{sdkState:r,dispatcher:i,sessionManager:a,requestQueue:s,logger:o,onlineDetector:u,cacheContext:l})},t.prototype.create=function(e){return Qe(this,void 0,void 0,(function(){var t;return Ke(this,(function(n){return t=je(je({},Ao),e),hs(ko(t)).throw(st.invalidParameters),[2,this._manager.create(t)]}))}))},t.prototype.get=function(e){return Qe(this,void 0,void 0,(function(){var t;return Ke(this,(function(n){return t=je(je({},Oo),e),hs(Do(t)).throw(st.invalidParameters),[2,this._manager.get(t)]}))}))},t.prototype.getOption=function(e){return Qe(this,void 0,void 0,(function(){var t;return Ke(this,(function(n){return t=je(je({},Mo),e),hs(Uo(t)).throw(st.invalidParameters),[2,this._manager.getOption(t)]}))}))},t.prototype.buildPollFromSerializedData=function(e){return this._manager.buildPollFromSerializedData(e)},t}(to);!function(e){e.LATEST_LAST_MESSAGE="latest_last_message",e.CHRONOLOGICAL="chronological",e.CHANNEL_NAME_ALPHABETICAL="channel_name_alphabetical",e.METADATA_VALUE_ALPHABETICAL="metadata_value_alphabetical"}(bh||(bh={})),function(e){e.CHRONOLOGICAL="chronological",e.CHANNEL_NAME_ALPHABETICAL="channel_name_alphabetical",e.METADATA_VALUE_ALPHABETICAL="metadata_value_alphabetical"}(Ch||(Ch={})),function(e){e.CREATED_AT="created_at",e.SCHEDULED_AT="scheduled_at"}(wh||(wh={}));var Ah,kh=function(e){switch(e){case bh.LATEST_LAST_MESSAGE:return["-lastMessageUpdatedAt","-createdAt","syncIndex"];case bh.CHRONOLOGICAL:return["-createdAt","syncIndex"];case bh.CHANNEL_NAME_ALPHABETICAL:return["name"];default:return["-lastMessageUpdatedAt","-createdAt","syncIndex"]}},Mh=function(e){function t(t){var n=t.message,r=e.call(this)||this;return r.message=n,r}return Be(t,e),t}(Ht),Uh={},Oh=function(){function e(e,t){var n=t.localCacheEnabled,r=t.enableAutoResend,i=t.dispatcher,a=t.sdkState,s=t.logger,o=this;this._iid=e,Uh[e]=this,this._localCacheEnabled=n,this._enableAutoResend=r,this._isProcessingAutoResend=!1,this._autoResendQueue=[],this._dispatcher=i,this._logger=s,this._sdkState=a,this._localCacheEnabled&&i.on((function(e){if(e instanceof Ka)switch(e.stateType){case Ga.CONNECTED:o._isProcessingAutoResend||o.processAutoResendRegisteredPendingMessages().then((function(){return o._processNextAutoResend()}));break;case Ga.INTERNAL_DISCONNECTED:case Ga.EXTERNAL_DISCONNECTED:o._isProcessingAutoResend=!1}}))}return e.of=function(e){return Uh[e]},e.prototype.processNonAutoResendRegisteredPendingMessages=function(){return Qe(this,void 0,void 0,(function(){var e,t,n,r,i,a;return Ke(this,(function(s){switch(s.label){case 0:return this._enableAutoResend?[4,this._fetchAllCachedPendingMessages()]:[2];case 1:e=s.sent();try{for(t=We(e),n=t.next();!n.done;n=t.next())0===(r=n.value).errorCode&&(this._logger.debug("cached pending message is not auto-resend registered. changing its sending status to failed: ",r.reqId),r.sendingStatus=Dt.FAILED,r.errorCode=Je.ACK_TIMEOUT,this._dispatcher.dispatch(new co({messages:[r],source:no.LOCAL_MESSAGE_FAILED})))}catch(e){i={error:e}}finally{try{n&&!n.done&&(a=t.return)&&a.call(t)}finally{if(i)throw i.error}}return[2]}}))}))},e.prototype.processAutoResendRegisteredPendingMessages=function(){return Qe(this,void 0,void 0,(function(){var e,t,n,r,i,a,s,o;return Ke(this,(function(u){switch(u.label){case 0:return[4,this._fetchAllCachedPendingMessages()];case 1:e=u.sent();try{for(t=We(e),n=t.next();!n.done;n=t.next())r=n.value,this._enableAutoResend&&r.errorCode&&_t(r.errorCode)&&(i=(new Date).getTime(),a=r.createdAt+2592e5,this._enableAutoResend&&i<=a?this._autoResendQueue.map((function(e){return e.reqId})).indexOf(r.reqId)<0&&this._autoResendQueue.push(r):(this._logger.debug("auto-resend registered pending messaged expired. expiration date: ",new Date(a).toLocaleString()),r.sendingStatus=Dt.FAILED,this._dispatcher.dispatch(new co({messages:[r],source:no.LOCAL_MESSAGE_FAILED}))))}catch(e){s={error:e}}finally{try{n&&!n.done&&(o=t.return)&&o.call(t)}finally{if(s)throw s.error}}return[2]}}))}))},e.prototype.completeCurrentAndProcessNextAutoResend=function(e){if(this._localCacheEnabled&&this._enableAutoResend&&(e.sendingStatus===Dt.SUCCEEDED||e.sendingStatus===Dt.FAILED&&!_t(e.errorCode))){var t=this.indexOf(e);t>=0&&this._autoResendQueue.splice(t,1),0===t&&this._processNextAutoResend()}},e.prototype._fetchAllCachedPendingMessages=function(){return Qe(this,void 0,void 0,(function(){var e,t;return Ke(this,(function(n){switch(n.label){case 0:return e=uh.of(this._iid),(t=new th).replyType=Ut.ALL,[4,e.fetch({sendingStatus:Dt.PENDING,backward:!0,filter:t})];case 1:return[2,n.sent()]}}))}))},e.prototype.indexOf=function(e){return this._autoResendQueue.length>0?this._autoResendQueue.map((function(e){return e.reqId})).indexOf(e.reqId):-1},e.prototype._isNotInQueue=function(e){return-1===this._autoResendQueue.map((function(e){return e.reqId})).indexOf(e.reqId)},e.prototype._processNextAutoResend=function(){return Qe(this,void 0,void 0,(function(){var e;return Ke(this,(function(t){if(this._localCacheEnabled&&this._enableAutoResend&&"foreground"===this._sdkState.appState)try{this._autoResendQueue.length>0?(this._isProcessingAutoResend||(this._logger.debug("auto-resend queue started."),this._isProcessingAutoResend=!0),e=this._autoResendQueue[0],this._dispatcher.dispatch(new Mh({message:e})),this._logger.debug("processing auto-resend for message request id: ",e.reqId)):(this._logger.debug("auto-resend queue finished."),this._isProcessingAutoResend=!1)}catch(e){this._logger.warn("process auto-resend error: ",e),this._isProcessingAutoResend=!1}return[2]}))}))},e}();!function(e){e[e.USER_BLOCK=20001]="USER_BLOCK",e[e.USER_UNBLOCK=2e4]="USER_UNBLOCK",e[e.FRIEND_DISCOVERED=20900]="FRIEND_DISCOVERED"}(Ah||(Ah={}));var Dh=function(){function e(e){this.category=e.cat,this.data=e.data}return e.getDataAsUserBlockEvent=function(e,t){var n=t.data,r=n.blocker,i=n.blockee;return{blocker:new ps(e,r),blockee:new ps(e,i)}},e.getDataAsFriendDiscoveredEvent=function(e,t){var n=t.data.friend_discoveries;return{friendDiscoveries:Array.isArray(n)?n.map((function(t){return new ps(e,t)})):[]}},e}(),Lh=function(e){function t(t,n){var r=n.userId,i=e.call(this)||this;return i._iid=t,i.userId=r,i}return Be(t,e),t}(Ht),Rh=function(e){function t(){return e.call(this)||this}return Be(t,e),t}(Ht),xh=function(e){function t(t,n,r){var i=e.call(this,t,"USEV",r)||this;return i.event=new Dh(r),i}return Be(t,e),t}(vn),Ph=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Be(t,e),t}(Ht),Fh=function(e){this.key=e.key,this.url=e.url},zh=function(e){this.id=e.id,this.name=e.name,this.url=e.url,this.emojis=e.emojis?e.emojis.map((function(e){return new Fh(e)})):[]},Hh=function(e){this.emojiHash=e.emoji_hash||"",this.emojiCategories=e.emoji_categories?e.emoji_categories.map((function(e){return new zh(e)})):[]},qh={profileImage:void 0,profileUrl:void 0,nickname:void 0},Vh=function(e){return function(t,n){return Qe(void 0,void 0,void 0,(function(){var r,i,a,s,o;return Ke(this,(function(u){switch(u.label){case 0:switch(t){case 1:case 2:case 3:return[3,1];case 4:return[3,2]}return[3,9];case 1:return n(),[3,10];case 2:return u.trys.push([2,7,,8]),[4,e.clear()];case 3:return u.sent(),r=function(e){return{v2:function(){return Qe(void 0,void 0,void 0,(function(){return Ke(this,(function(t){switch(t.label){case 0:return[4,e.commitSchema([{collectionName:Lc,keyName:"url",index:[kh(bh.LATEST_LAST_MESSAGE),kh(bh.CHRONOLOGICAL),kh(bh.CHANNEL_NAME_ALPHABETICAL)]},{collectionName:Rc,keyName:"messageId",index:[rh($d.CHANNEL_LATEST),rh($d.NEWEST_CHILD_MESSAGE)]},{collectionName:sh,keyName:"reqId",index:[rh($d.CHANNEL_LATEST),rh($d.NEWEST_CHILD_MESSAGE)]},{collectionName:"Poll",keyName:"pollId"}])];case 1:return[2,t.sent()]}}))}))},v3:function(){return Qe(void 0,void 0,void 0,(function(){return Ke(this,(function(t){switch(t.label){case 0:return[4,e.commitSchema([{collectionName:"FeedChannel",keyName:"url",index:[["-lastMessageUpdatedAt","-createdAt","syncIndex"]]}])];case 1:return[2,t.sent()]}}))}))},v4:function(){return Qe(void 0,void 0,void 0,(function(){return Ke(this,(function(t){switch(t.label){case 0:return[4,e.commitSchema([{collectionName:xc,keyName:"notificationId",index:[["channelUrl","-createdAt","-notificationId"]]}])];case 1:return[2,t.sent()]}}))}))}}}(e),i=r.v2,a=r.v3,s=r.v4,[4,i()];case 4:return u.sent(),[4,a()];case 5:return u.sent(),[4,s()];case 6:return u.sent(),n(),[3,8];case 7:return o=u.sent(),n(o),[3,8];case 8:return[3,10];case 9:n(),u.label=10;case 10:return[2]}}))}))}},Gh=function(){return"undefined"!=typeof document?document.visibilityState:"visible"},Bh=function(e){function t(t){var n=t.getVisibilityState,r=void 0===n?Gh:n,i=t.initialState,a=void 0===i?"visible":i,s=t.isEnabled,o=void 0===s||s,u=t.pauseCheckDelay,l=void 0===u?3e4:u,c=e.call(this)||this;return c._pauseCheckDelay=3e4,c._currentState="visible",c._getVisibilityState=r,c._pauseCheckDelay=l,c._currentState=a,c._isEnabled=o,c._boundToggleState=c._toggleState.bind(c),c}return Be(t,e),Object.defineProperty(t.prototype,"currentState",{get:function(){return this._currentState},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isAvailable",{get:function(){return"undefined"!=typeof window&&!!window.addEventListener&&!!window.removeEventListener},enumerable:!1,configurable:!0}),t.prototype._toggleState=function(){var e=this,t=this._getVisibilityState();"hidden"!==t?"hidden"===this._currentState&&(this._pauseDelayTimer&&(clearTimeout(this._pauseDelayTimer),this._pauseDelayTimer=void 0),this.dispatch("resume")):"hidden"!==this._currentState&&(this._pauseDelayTimer=setTimeout((function(){e._pauseDelayTimer=void 0,e.dispatch("pause")}),this._pauseCheckDelay)),this._currentState=t},t.prototype.start=function(){this._isEnabled&&this.isAvailable&&(this._boundToggleState=this._toggleState.bind(this),window.addEventListener("visibilitychange",this._boundToggleState,{capture:!0}))},t.prototype.stop=function(){this._isEnabled&&this.isAvailable&&this._boundToggleState&&window.removeEventListener("visibilitychange",this._boundToggleState,{capture:!0})},t}(Ft),jh=function(){function e(e){var t=e.logger,n=e.connectionDelegate,r=void 0===n?null:n,i=this;this._onlineWorker=function(){var e;return null===(e=i.connectionDelegate)||void 0===e?void 0:e.reconnect()},this._offlineWorker=function(){var e;return null===(e=i.connectionDelegate)||void 0===e?void 0:e.disconnect()},this.unsubscribes=[],this._onlineListener=function(e){if(i.isAvailableOnWeb)return window.addEventListener("online",e),function(){return window.removeEventListener("online",e,!1)}},this._offlineListener=function(e){if(i.isAvailableOnWeb)return window.addEventListener("offline",e),function(){return window.removeEventListener("offline",e,!1)}},this.logger=t,r&&(this.connectionDelegate=r)}return Object.defineProperty(e.prototype,"isAvailableOnWeb",{get:function(){return"undefined"!=typeof window&&!!window.addEventListener&&"ononline"in window&&"onoffline"in window&&"undefined"!=typeof navigator&&void 0!==navigator.onLine},enumerable:!1,configurable:!0}),e.prototype.setOnlineListener=function(e){Boolean(e)&&"function"==typeof e&&(this._onlineListener=e)},e.prototype.setOfflineListener=function(e){Boolean(e)&&"function"==typeof e&&(this._offlineListener=e)},e.prototype.start=function(){this.unsubscribes=[this._onlineListener(this._onlineWorker),this._offlineListener(this._offlineWorker)]},e.prototype.stop=function(){var e=this;this.unsubscribes.forEach((function(t){try{null==t||t()}catch(t){e.logger.warn(t.message)}})),this.unsubscribes=[]},e.prototype.isOnline=function(){return Qe(this,void 0,void 0,(function(){return Ke(this,(function(e){return this.isAvailableOnWeb?[2,navigator.onLine]:[2,new Promise((function(e){fetch("https://www.google.com",{method:Gt.GET,mode:"no-cors"}).then((function(){return e(!0)})).catch((function(){return e(!1)}))}))]}))}))},e}(),Qh=function(e){function t(t){var n=t.userId,r=t.nickname,i=t.profileUrl,a=t.profileImage,s=t.preferredLanguages,o=e.call(this)||this;return o.method=Gt.PUT,o.path="".concat(jt,"/").concat(encodeURIComponent(n)),o.params=qt(Vt({nickname:r,profile_url:i,profile_file:a,preferred_languages:s})),o}return Be(t,e),t}(hn),Kh=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.user=new ps(t,je({},n)),r}return Be(t,e),t}(fn),Wh=function(e){function t(t){var n=t.userId,r=t.token,i=e.call(this)||this;return i.method=Gt.POST,i.path="".concat(jt,"/").concat(encodeURIComponent(n),"/push/apns"),i.params={apns_device_token:r,always_push:!0},i}return Be(t,e),t}(hn);!function(e){Be((function(t,n){var r=e.call(this,t,n)||this;return r.token=n.token,r.type=n.type?nt[n.type.toLowerCase()]:nt.UNKNOWN,r.user=new ps(t,n.user),r}),e)}(fn);var Yh=function(e){function t(t){var n=t.userId,r=t.token,i=e.call(this)||this;return i.method=Gt.POST,i.path="".concat(jt,"/").concat(encodeURIComponent(n),"/push/gcm"),i.params={gcm_reg_token:r,always_push:!0},i}return Be(t,e),t}(hn);!function(e){Be((function(t,n){var r=e.call(this,t,n)||this;return r.token=n.token,r.type=n.type?nt[n.type.toLowerCase()]:nt.UNKNOWN,r.user=new ps(t,n.user),r}),e)}(fn);var Zh=function(e){function t(t){var n=t.userId,r=t.token,i=e.call(this)||this;return i.method=Gt.DELETE,i.path="".concat(jt,"/").concat(encodeURIComponent(n),"/push/apns/").concat(encodeURIComponent(r)),i}return Be(t,e),t}(hn);!function(e){Be((function(t,n){var r=e.call(this,t,n)||this;return r.token=n.token,r.user=new ps(t,n.user),r.lastDeletedAt=n.device_token_last_deleted_at,r}),e)}(fn);var Jh=function(e){function t(t){var n=t.userId,r=t.token,i=e.call(this)||this;return i.method=Gt.DELETE,i.path="".concat(jt,"/").concat(encodeURIComponent(n),"/push/gcm/").concat(encodeURIComponent(r)),i}return Be(t,e),t}(hn);!function(e){Be((function(t,n){var r=e.call(this,t,n)||this;return r.token=n.token,r.user=new ps(t,n.user),r.lastDeletedAt=n.device_token_last_deleted_at,r}),e)}(fn);var Xh=function(e){function t(t){var n=t.userId,r=e.call(this)||this;return r.method=Gt.DELETE,r.path="".concat(jt,"/").concat(encodeURIComponent(n),"/push/apns"),r}return Be(t,e),t}(hn);!function(e){Be((function(t,n){var r=e.call(this,t,n)||this;return r.type=n.type?nt[n.type.toLowerCase()]:nt.UNKNOWN,r.user=new ps(t,n.user),r.lastDeletedAt=n.device_token_last_deleted_at,r}),e)}(fn);var $h=function(e){function t(t){var n=t.userId,r=e.call(this)||this;return r.method=Gt.DELETE,r.path="".concat(jt,"/").concat(encodeURIComponent(n),"/push/gcm"),r}return Be(t,e),t}(hn);!function(e){Be((function(t,n){var r=e.call(this,t,n)||this;return r.type=n.type?nt[n.type.toLowerCase()]:nt.UNKNOWN,r.user=new ps(t,n.user),r.lastDeletedAt=n.device_token_last_deleted_at,r}),e)}(fn);var ef=function(e){function t(t){var n=t.userId,r=t.type,i=t.token,a=t.ts,s=e.call(this)||this;return s.method=Gt.GET,s.path="".concat(jt,"/").concat(encodeURIComponent(n),"/push/").concat(encodeURIComponent(r),"/device_tokens"),s.params={created_ts:a,token:i},s}return Be(t,e),t}(hn),tf=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.pushTokens={type:n.type?nt[n.type.toLowerCase()]:nt.UNKNOWN,deviceTokens:n.device_tokens,hasMore:n.has_more,token:n.token},r}return Be(t,e),t}(fn),nf=function(e){function t(t){var n=t.userId,r=e.call(this)||this;return r.method=Gt.GET,r.path="".concat(jt,"/").concat(encodeURIComponent(n),"/channel_invitation_preference"),r}return Be(t,e),t}(hn),rf=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.autoAccept=n.auto_accept,r}return Be(t,e),t}(fn),af=function(e){function t(t){var n=t.userId,r=t.willAutoAccept,i=e.call(this)||this;return i.method=Gt.PUT,i.path="".concat(jt,"/").concat(encodeURIComponent(n),"/channel_invitation_preference"),i.params={auto_accept:r},i}return Be(t,e),t}(hn),sf=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.autoAccept=n.auto_accept,r}return Be(t,e),t}(fn),of=function(e){function t(t){var n=t.userId,r=e.call(this)||this;return r.method=Gt.GET,r.path="".concat(jt,"/").concat(encodeURIComponent(n),"/push_preference"),r}return Be(t,e),t}(hn),uf=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.preference={doNotDisturbOn:n.do_not_disturb,startHour:n.start_hour,startMin:n.start_min,endHour:n.end_hour,endMin:n.end_min,timezone:n.timezone},r}return Be(t,e),t}(fn),lf=function(e){function t(t){var n=t.userId,r=t.doNotDisturbOn,i=t.startHour,a=t.startMin,s=t.endHour,o=t.endMin,u=t.timezone,l=e.call(this)||this;return l.method=Gt.PUT,l.path="".concat(jt,"/").concat(encodeURIComponent(n),"/push_preference"),l.params={do_not_disturb:r,start_hour:i,start_min:a,end_hour:s,end_min:o,timezone:u},l}return Be(t,e),t}(hn),cf=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.preference={doNotDisturbOn:n.do_not_disturb,startHour:n.start_hour,startMin:n.start_min,endHour:n.end_hour,endMin:n.end_min,timezone:n.timezone},r}return Be(t,e),t}(fn),df=function(e){function t(t){var n=t.userId,r=e.call(this)||this;return r.method=Gt.GET,r.path="".concat(jt,"/").concat(encodeURIComponent(n),"/push_preference"),r}return Be(t,e),t}(hn),hf=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.snoozePeriod={isSnoozeOn:n.snooze_enabled},"number"==typeof n.snooze_start_ts&&(r.snoozePeriod.startTs=n.snooze_start_ts),"number"==typeof n.snooze_end_ts&&(r.snoozePeriod.endTs=n.snooze_end_ts),r}return Be(t,e),t}(fn),ff=function(e){function t(t){var n=t.userId,r=t.snoozeOn,i=t.startTs,a=t.endTs,s=e.call(this)||this;return s.method=Gt.PUT,s.path="".concat(jt,"/").concat(encodeURIComponent(n),"/push_preference"),s.params={snooze_enabled:r,snooze_start_ts:i,snooze_end_ts:a},s}return Be(t,e),t}(hn),pf=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.snoozePeriod={isSnoozeOn:n.snooze_enabled},"number"==typeof n.snooze_start_ts&&(r.snoozePeriod.startTs=n.snooze_start_ts),"number"==typeof n.snooze_end_ts&&(r.snoozePeriod.endTs=n.snooze_end_ts),r}return Be(t,e),t}(fn),_f=function(e){function t(t){var n=t.userId,r=t.blockedUserId,i=e.call(this)||this;return i.method=Gt.POST,i.path="".concat(jt,"/").concat(encodeURIComponent(n),"/block"),i.params={target_id:r},i}return Be(t,e),t}(hn);!function(e){Be((function(t,n){var r=e.call(this,t,n)||this;return r.user=new ps(t,n),r}),e)}(fn);var vf=function(e){function t(t){var n=t.userId,r=t.unblockedUserId,i=e.call(this)||this;return i.method=Gt.DELETE,i.path="".concat(jt,"/").concat(encodeURIComponent(n),"/block/").concat(encodeURIComponent(r)),i}return Be(t,e),t}(hn);!function(e){Be((function(){return null!==e&&e.apply(this,arguments)||this}),e)}(fn);var mf=function(e){function t(t){var n=t.userId,r=e.call(this)||this;return r.method=Gt.GET,r.path="".concat(jt,"/").concat(encodeURIComponent(n),"/push_preference"),r}return Be(t,e),t}(hn),gf=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.pushTriggerOption=n.push_trigger_option,r}return Be(t,e),t}(fn),yf=function(e){function t(t){var n=t.userId,r=t.pushTriggerOption,i=e.call(this)||this;return i.method=Gt.PUT,i.path="".concat(jt,"/").concat(encodeURIComponent(n),"/push_preference"),i.params={push_trigger_option:r},i}return Be(t,e),t}(hn),Ef=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.pushTriggerOption=n.push_trigger_option,r}return Be(t,e),t}(fn),bf=function(e){function t(t){var n=t.userId,r=e.call(this)||this;return r.method=Gt.GET,r.path="".concat(jt,"/").concat(encodeURIComponent(n),"/push/template"),r}return Be(t,e),t}(hn),Cf=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.name=n.name,r}return Be(t,e),t}(fn),wf=function(e){function t(t){var n=t.userId,r=t.templateName,i=e.call(this)||this;return i.method=Gt.PUT,i.path="".concat(jt,"/").concat(encodeURIComponent(n),"/push/template"),i.params={name:r},i}return Be(t,e),t}(hn),Sf=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.name=n.name,r}return Be(t,e),t}(fn),Tf=function(e){function t(t){var n=t.userId,r=t.token,i=e.call(this)||this;return i.method=Gt.GET,i.path="".concat(jt,"/").concat(encodeURIComponent(n),"/friends/changelogs"),i.params={token:r},i}return Be(t,e),t}(hn),If=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.changelogs={addedUsers:n.added.map((function(e){return new ps(t,e)})),updatedUsers:n.updated.map((function(e){return new ps(t,e)})),deletedUserIds:n.deleted,hasMore:n.has_more,token:n.next},r}return Be(t,e),t}(fn),Nf=function(e){function t(t){var n=t.userId,r=t.discoveries,i=e.call(this)||this;return i.method=Gt.PUT,i.path="".concat(jt,"/").concat(encodeURIComponent(n),"/friend_discoveries"),i.params={friend_discoveries:r.map((function(e){return{friend_discovery_key:e.friendDiscoveryKey,friend_name:e.friendName}}))},i}return Be(t,e),t}(hn),Af=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.friendDiscoveryRequestId=n.friend_discovery_request_id,r}return Be(t,e),t}(fn),kf=function(e){function t(t){var n=t.userId,r=t.discoveryKeys,i=e.call(this)||this;return i.method=Gt.DELETE,i.path="".concat(jt,"/").concat(encodeURIComponent(n),"/friend_discoveries"),i.params={friend_discovery_keys:r},i}return Be(t,e),t}(hn);!function(e){Be((function(){return null!==e&&e.apply(this,arguments)||this}),e)}(fn);var Mf=function(e){function t(t){var n=t.userId,r=t.userIds,i=e.call(this)||this;return i.method=Gt.POST,i.path="".concat(jt,"/").concat(encodeURIComponent(n),"/friends"),i.params={user_ids:r},i}return Be(t,e),t}(hn),Uf=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.users=n.users.map((function(e){return new ps(t,e)})),r}return Be(t,e),t}(fn),Of=function(e){function t(t){var n=t.userId,r=t.userIds,i=e.call(this)||this;return i.method=Gt.DELETE,i.path="".concat(jt,"/").concat(encodeURIComponent(n),"/friends"),i.params={user_ids:r},i}return Be(t,e),t}(hn);!function(e){Be((function(){return null!==e&&e.apply(this,arguments)||this}),e)}(fn);var Df=function(e){function t(t){var n=t.userId,r=e.call(this)||this;return r.method=Gt.GET,r.path="".concat(jt,"/").concat(n,"/allow_friend_discovery"),r.params={},r}return Be(t,e),t}(hn),Lf=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.allowFriendDiscovery=n.allow_friend_discovery,r}return Be(t,e),t}(fn),Rf=function(e){function t(t){var n=t.userId,r=t.allowFriendDiscovery,i=e.call(this)||this;return i.method=Gt.PUT,i.path="".concat(jt,"/").concat(n,"/allow_friend_discovery"),i.params={allow_friend_discovery:r},i}return Be(t,e),t}(hn);!function(e){Be((function(){return null!==e&&e.apply(this,arguments)||this}),e)}(fn);var xf,Pf,Ff=function(e){function t(){var t=e.call(this)||this;return t.method=Gt.GET,t.path=en,t}return Be(t,e),t}(hn),zf=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.emojiContainer=new Hh(n),r}return Be(t,e),t}(fn),Hf=function(e){function t(t){var n=t.categoryId,r=e.call(this)||this;return r.method=Gt.GET,r.path="".concat(en,"/").concat(n),r}return Be(t,e),t}(hn),qf=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.emojiCategory=new zh(n),r}return Be(t,e),t}(fn),Vf=function(e){function t(t){var n=t.key,r=e.call(this)||this;return r.method=Gt.GET,r.path="".concat($t,"/").concat(n),r}return Be(t,e),t}(hn),Gf=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.emoji=new Fh(n),r}return Be(t,e),t}(fn),Bf=function(e){function t(){var t=e.call(this)||this;return t.method=Gt.GET,t.path="".concat(rn),t}return Be(t,e),t}(hn),jf=function(e){function t(t,n){var r,i=this,a=null!=n?n:{};return(i=e.call(this,t,n)||this).uikitConfiguration={string:JSON.stringify(a),json:a},i.updatedAt=null!==(r=null==n?void 0:n.updated_at)&&void 0!==r?r:0,i}return Be(t,e),t}(fn),Qf=function(){function e(e,t,n){var r=this;this._storeInitialized=!1,this._iid=e,this.options=t;var i=eo.of(e),a=i.sdkState,s=i.cacheContext,o=i.dispatcher,u=i.sessionManager,l=i.requestQueue,c=i.logger,d=i.userEventHandlers,h=i.appStateToggleEnabled;this._onlineDetector=new jh({logger:c,connectionDelegate:{reconnect:function(){return Qe(r,void 0,void 0,(function(){var t,n,r,i,a,s;return Ke(this,(function(u){switch(u.label){case 0:if(t=eo.of(e),n=t.sdkState,r=t.connectionManager,(i=t.sessionManager).session.hasSession)return[3,5];u.label=1;case 1:return u.trys.push([1,3,,4]),[4,r.connect(i.session.authToken)];case 2:return u.sent(),[3,4];case 3:if(a=u.sent(),at(a))throw a;return c.debug("connect failed by reconnect event = ",a),[3,4];case 4:return[3,9];case 5:if("foreground"!==n.appState)return[3,9];u.label=6;case 6:return u.trys.push([6,8,,9]),[4,r.resetAndReconnect()];case 7:return u.sent(),[3,9];case 8:if(s=u.sent(),at(s))throw s;return c.debug("resetAndReconnect failed by reconnect event = ",s),[3,9];case 9:return o.dispatch(new Ph),[2]}}))}))},disconnect:function(){bs((function(){return Qe(r,void 0,void 0,(function(){return Ke(this,(function(t){switch(t.label){case 0:return[4,eo.of(e).connectionManager.disconnect()];case 1:return t.sent(),[2]}}))}))}))}}});var f=new Oh(e,{localCacheEnabled:s.localCacheEnabled,enableAutoResend:s.localCacheConfig.enableAutoResend,dispatcher:o,sdkState:a,logger:c});n.forEach((function(t){t.init(e,{sdkState:a,cacheContext:s,dispatcher:o,sessionManager:u,requestQueue:l,logger:c,onlineDetector:r._onlineDetector}),r[t.name]=t})),this._appStateChangeDetector=new Bh({isEnabled:h}),this._appStateChangeDetector.on("resume",(function(){c.debug("the page resumes from freeze"),r.setForegroundState()})).on("pause",(function(){c.debug("the page freezes"),r.setBackgroundState()})),o.on((function(t){var n;if(t instanceof Ka)t.stateType===Ga.CONNECTED&&f.processNonAutoResendRegisteredPendingMessages();else if(t instanceof vn){if("USEV"===t.code){var i=t.as(xh).event;if(i.category===Ah.FRIEND_DISCOVERED){var o=Dh.getDataAsFriendDiscoveredEvent(e,i).friendDiscoveries;Es((function(){return Qe(r,void 0,void 0,(function(){return Ke(this,(function(e){return[2,d.forEach((function(e){e.onFriendsDiscovered&&e.onFriendsDiscovered(o)}))]}))}))}))}}}else if(t instanceof ja){var u=eo.of(r._iid).subscribedUnreadMessageCount,l=!1,h=t.ts;if("number"==typeof h&&h>u.ts){if(u.all!==t.all&&(l=!0),u.all=t.all>=0?t.all:0,t.customTypes)for(var p in t.customTypes)u.customTypes[p]!==t.customTypes[p]&&(l=!0),u.customTypes[p]=t.customTypes[p];l=l&&u.ts>0,u.ts=h}l&&Es((function(){return Qe(r,void 0,void 0,(function(){return Ke(this,(function(e){return[2,d.forEach((function(e){e.onTotalUnreadMessageCountChanged&&e.onTotalUnreadMessageCountChanged({groupChannelCount:u.all,feedChannelCount:u.feed,customTypeUnreadCount:u.customTypes}),e.onTotalUnreadMessageCountUpdated&&e.onTotalUnreadMessageCountUpdated(u.all,u.customTypes)}))]}))}))}))}else t instanceof _s?(s.preference.set(r._getUserProfileCacheKey(a.userId),vs.payloadify(t.userProfile)),(null===(n=t.userProfile.appInfo.notificationInfo)||void 0===n?void 0:n.isEnabled)&&s.preference.set(Xa(r.appId),{value:!0})):t instanceof _n&&t.error&&t.error.isSessionInvalidatedError&&(c.debug("session revoked."),r.disconnect())}))}return e.init=function(t){var n=t.appId,r=t.appVersion,i=t.modules,a=void 0===i?[]:i,s=t.options,o=void 0===s?new mt:s,u=t.debugMode,l=void 0!==u&&u,c=t.customApiHost,d=t.customWebSocketHost,h=t.newInstance,f=void 0!==h&&h,p=t.logLevel,_=t.localCacheEnabled,v=void 0!==_&&_,m=t.localCacheConfig,g=void 0===m?new wt:m,y=t.localCacheEncryption,E=t.useAsyncStorageStore,b=void 0===E?null:E,C=t.appStateToggleEnabled,w=void 0===C||C;if(!xf||f){var S="su-".concat(xt()),T=null!=y?y:{encrypt:function(e){return e},decrypt:function(e){return e}},I=new Wd({encryption:T});l||(I=An()?b?new Xd({AsyncStorage:b,encryption:T}):new Wd({encryption:T}):new Jd({encryption:T})),new eo(S,{appId:n,appVersion:r,options:o,apiHost:null!=c?c:"https://api-".concat(n,".sendbird.com"),websocketHost:null!=d?d:"wss://ws-".concat(n,".sendbird.com"),store:I,encryption:T,logLevel:p,localCacheEnabled:v,localCacheConfig:g,debugMode:l,appStateToggleEnabled:w});var N=[new Ih,new Nh],A=new e(S,o,Ze(Ze([],Ye(a),!1),Ye(N),!1));return xf||(xf=A),A}return xf},Object.defineProperty(e,"instance",{get:function(){return xf},enumerable:!1,configurable:!0}),Object.defineProperty(e,"version",{get:function(){return Xe},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"appId",{get:function(){return eo.of(this._iid).sdkState.appId},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"appInfo",{get:function(){var e=eo.of(this._iid).appInfo;return null!=e?e:null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"appVersion",{get:function(){var e;return null!==(e=eo.of(this._iid).sdkState.appVersion)&&void 0!==e?e:""},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"debugMode",{get:function(){return!!eo.of(this._iid).debugMode},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"logLevel",{get:function(){return eo.of(this._iid).logger.level},set:function(e){eo.of(this._iid).logger.level=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isCacheEnabled",{get:function(){return eo.of(this._iid).cacheContext.localCacheEnabled},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"localCacheConfig",{get:function(){var e=eo.of(this._iid).cacheContext;return e.localCacheEnabled?e.localCacheConfig:null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"ekey",{get:function(){return eo.of(this._iid).sessionManager.ekey},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"currentUser",{get:function(){var e;return null!==(e=eo.of(this._iid).sessionManager.currentUser)&&void 0!==e?e:null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"connectionState",{get:function(){var e=eo.of(this._iid).connectionManager;return e.isConnected?qa.OPEN:e.isConnecting?qa.CONNECTING:qa.CLOSED},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lastConnectedAt",{get:function(){var e=eo.of(this._iid),t=e.connectedAt;return e.connectionManager.isConnected?t:0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fcmPushToken",{get:function(){var e;return null!==(e=this._fcmPushToken)&&void 0!==e?e:null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"apnsPushToken",{get:function(){var e;return null!==(e=this._apnsPushToken)&&void 0!==e?e:null},enumerable:!1,configurable:!0}),e.prototype._getNestDBVersion=function(){return 5},e.prototype._getPreferenceCacheKey=function(e){return"sendbird@".concat(this.appId,"/").concat(e,".pref")},e.prototype._getUserProfileCacheKey=function(e){return"sendbird@".concat(this.appId,"/").concat(e,".profile")},e.prototype.getMemoryStoreForDebugging=function(){var e=eo.of(this._iid),t=e.debugMode,n=e.cacheContext;if(t)return n.store instanceof Wd?n.store:null;throw st.debugModeRequired},e.prototype.addExtension=function(e,t){var n=eo.of(this._iid).sdkState;["sb_uikit","sb_syncmanager","device-os-platform"].indexOf(e)>-1&&n.extensions&&(n.extensions[e]=t)},e.prototype.addSendbirdExtensions=function(e,t,n){var r,i,a=eo.of(this._iid),s=a.logger,o=a.sdkState,u=new RegExp("^(0|[1-9]\\d*)\\.(0|[1-9]\\d*)\\.(0|[1-9]\\d*)(?:-((?:0|[1-9]\\d*|\\d*[a-zA-Z-][0-9a-zA-Z-]*)(?:\\.(?:0|[1-9]\\d*|\\d*[a-zA-Z-][0-9a-zA-Z-]*))*))?(?:\\+([0-9a-zA-Z-]+(?:\\.[0-9a-zA-Z-]+)*))?$");if(0===e.length)return s.debug("sb.addSendbirdExtensions() has failed because the given sendbirdExtensions is empty."),!1;if(e.find((function(e){return!u.test(e.version)})))return s.debug("sb.addSendbirdExtensions() has failed because the given version did not satisfy the SemVer specification."),!1;if(n)try{for(var l=We(Object.entries(n)),c=l.next();!c.done;c=l.next()){var d=Ye(c.value,2),h=d[0],f=d[1];if(/&|=/.test(h)||/&|=/.test(f))return s.debug("sb.addSendbirdExtensions() has failed because the given customData includes at least one invalid character: = or &."),!1}}catch(e){r={error:e}}finally{try{c&&!c.done&&(i=l.return)&&i.call(l)}finally{if(r)throw r.error}}return o.sendbirdRuntimeEnvironment={sendbirdExtensions:e,deviceOS:t,customData:n},!0},e.prototype.setOnlineListener=function(e){this._onlineDetector.setOnlineListener(e)},e.prototype.setOfflineListener=function(e){this._onlineDetector.setOfflineListener(e)},e.prototype._safeInitializeStore=function(e){return Qe(this,void 0,void 0,(function(){var t;return Ke(this,(function(n){switch(n.label){case 0:t=eo.of(this._iid).cacheContext,n.label=1;case 1:return n.trys.push([1,3,,5]),[4,t.store.init(e)];case 2:return n.sent(),this._storeInitialized=!0,[3,5];case 3:return n.sent(),t.replaceStore(new Wd),[4,this._safeInitializeStore(e)];case 4:return n.sent(),[3,5];case 5:return[2]}}))}))},e.prototype.initializeCache=function(e){return Qe(this,void 0,void 0,(function(){var t,n,r,i,a,s,o,u,l;return Ke(this,(function(c){switch(c.label){case 0:if(t=eo.of(this._iid),n=t.sdkState,r=t.cacheContext,i=t.dispatcher,a=t.logger,n.userId&&n.userId===e)return[3,9];if(s="sendbird@".concat(n.appId,"/").concat(e,".db"),!r.localCacheEnabled)return[3,7];c.label=1;case 1:return c.trys.push([1,4,,6]),r.nestdb&&r.nestdb.state!==Zd.CLOSED&&r.nestdb.name===s?[3,3]:(o="sendbird@".concat(n.appId,"/").concat(e,".db"),(u=r.nestdb=new eh({name:o,version:this._getNestDBVersion(),store:r.store,config:new td({dbname:o,itemSizeLimit:61440})})).on("upgrade",Vh(u)),u.on("storeReplaced",(function(e){r.replaceStore(e),r.localCacheEnabled=!1,u.on("upgrade",Vh(u))})),[4,u.open()]);case 2:c.sent(),this._storeInitialized=!0,i.dispatch(new Lh(this._iid,{userId:e})),c.label=3;case 3:return n.userId=e,[3,6];case 4:return l=c.sent(),a.warn("Nest DB Open Failed. ",l),r.store instanceof Wd||(r.replaceStore(new Wd),r.localCacheEnabled=!1),[4,this._safeInitializeStore(s)];case 5:throw c.sent(),n.userId=e,st.databaseError;case 6:return[3,9];case 7:return[4,this._safeInitializeStore(s)];case 8:c.sent(),n.userId=e,c.label=9;case 9:return[2]}}))}))},e.prototype.getCacheDataSize=function(){return Qe(this,void 0,void 0,(function(){var e;return Ke(this,(function(t){switch(t.label){case 0:return(e=eo.of(this._iid).cacheContext).localCacheEnabled&&e.nestdb?[4,e.nestdb.estimateUsage()]:[3,2];case 1:return[2,t.sent()];case 2:return[2,0]}}))}))},e.prototype.clearCachedData=function(){return Qe(this,void 0,void 0,(function(){var e;return Ke(this,(function(t){switch(t.label){case 0:return(e=eo.of(this._iid).cacheContext).localCacheEnabled&&e.nestdb?[4,e.nestdb.clear()]:[3,2];case 1:t.sent(),t.label=2;case 2:return this._storeInitialized?[4,e.preference.clear()]:[3,4];case 3:t.sent(),t.label=4;case 4:return[2]}}))}))},e.prototype.clearCachedMessages=function(e){return Qe(this,void 0,void 0,(function(){var t,n,r=this;return Ke(this,(function(i){switch(i.label){case 0:return hs(ft("string",e)).throw(st.invalidParameters),t=ch.of(this._iid),n=uh.of(this._iid),t&&n?[4,Promise.all(e.map((function(e){return Qe(r,void 0,void 0,(function(){return Ke(this,(function(r){switch(r.label){case 0:return[4,t.removeMessagesOfChannel(e)];case 1:return r.sent(),[4,n.removeMessagesOfChannel(e)];case 2:return r.sent(),[2]}}))}))})))]:[3,2];case 1:i.sent(),i.label=2;case 2:return[2]}}))}))},e.prototype._setupPreference=function(e){return Qe(this,void 0,void 0,(function(){var t,n,r,i,a;return Ke(this,(function(s){switch(s.label){case 0:return t=eo.of(this._iid),n=t.sdkState,r=t.cacheContext,i=t.statLogCollector,[4,r.preference.init(this._getPreferenceCacheKey(e),this._getNestDBVersion())];case 1:return s.sent(),[4,r.preference.get(this._getUserProfileCacheKey(e))];case 2:return(a=s.sent())&&new vs(this._iid,a).apply(),[4,i.init("sendbird@".concat(n.appId,"/").concat(e,".statlog"))];case 3:return s.sent(),[2]}}))}))},e.prototype._ready=function(e,t,n){return void 0===n&&(n={}),Qe(this,void 0,void 0,(function(){var r,i,a,s,o,u;return Ke(this,(function(l){switch(l.label){case 0:return hs(ct("string",e)&&ct("string",t,!0)).throw(st.invalidParameters),r=eo.of(this._iid),i=r.sdkState,a=r.cacheContext,s=r.connectionManager,o=n.errorForOtherUser,i.userId&&i.userId!==e?o?[3,2]:[4,s.logout()]:[3,3];case 1:return l.sent(),[3,3];case 2:throw o;case 3:return l.trys.push([3,5,6,8]),[4,this.initializeCache(e)];case 4:return l.sent(),eo.of(this._iid).dispatcher.dispatch(new Rh),[3,8];case 5:return l.sent(),u=eo.of(this._iid).logger,a.localCacheEnabled=!1,u.warn("Cache initialization failed - cache is not available."),[3,8];case 6:return[4,this._setupPreference(e)];case 7:return l.sent(),[7];case 8:return[2]}}))}))},e.prototype.authenticateFeed=function(e,t){return Qe(this,void 0,void 0,(function(){var n,r,i;return Ke(this,(function(a){switch(a.label){case 0:return n=eo.of(this._iid),r=n.sessionManager,i=n.connectionManager,[4,this._ready(e,t,{errorForOtherUser:i.isConnected?st.alreadyConnectedAsAnotherUser:void 0})];case 1:return a.sent(),r.session.hasLessServiceScopeThan([bt.FEED])?[4,r.authenticateFeed(e,t)]:[3,3];case 2:a.sent(),a.label=3;case 3:return[2,this.currentUser]}}))}))},e.prototype.connect=function(e,t){return Qe(this,void 0,void 0,(function(){return Ke(this,(function(n){switch(n.label){case 0:return[4,this._ready(e,t)];case 1:n.sent(),n.label=2;case 2:return n.trys.push([2,,4,5]),[4,eo.of(this._iid).connectionManager.connect(t)];case 3:return n.sent(),[3,5];case 4:return this._onlineDetector.start(),this._appStateChangeDetector.start(),[7];case 5:return[2,this.currentUser]}}))}))},e.prototype.reconnect=function(){var e=eo.of(this._iid),t=e.connectionManager,n=e.sdkState,r=e.sessionManager.session.hasSession;return r&&(this._appStateChangeDetector.start(),this._onlineDetector.start(),t.resetAndReconnect().then((function(){n.appState="foreground"})).catch((function(){}))),r},e.prototype.disconnect=function(){return Qe(this,void 0,void 0,(function(){var e,t,n;return Ke(this,(function(r){switch(r.label){case 0:return e=eo.of(this._iid),t=e.connectionManager,n=e.requestQueue,this._appStateChangeDetector.stop(),this._onlineDetector.stop(),n.cancelAll(),[4,t.logout()];case 1:return r.sent(),[4,this.clearCachedData()];case 2:return r.sent(),[2]}}))}))},e.prototype.disconnectWebSocket=function(){return Qe(this,void 0,void 0,(function(){var e,t,n;return Ke(this,(function(r){switch(r.label){case 0:return e=eo.of(this._iid),t=e.connectionManager,n=e.requestQueue,this._appStateChangeDetector.stop(),this._onlineDetector.stop(),n.cancelAll(),[4,t.disconnectWebSocket()];case 1:return r.sent(),[2]}}))}))},e.prototype.setBackgroundState=function(){var e=eo.of(this._iid),t=e.connectionManager,n=e.sdkState,r=e.logger;"foreground"===n.appState&&(n.appState="background",r.debug("going background state"),t.background().catch((function(e){r.debug("setBackgroundState error = ",e)})))},e.prototype.setForegroundState=function(){var e=eo.of(this._iid),t=e.connectionManager,n=e.sdkState,r=e.dispatcher,i=e.logger;"background"===n.appState&&(n.appState="foreground",i.debug("going foreground state"),t.resetAndReconnect().catch((function(e){i.debug("setForgroundState error = ",e)})),r.dispatch(new Ph))},e.prototype.setSessionHandler=function(e){hs(e instanceof Gc).throw(st.invalidParameters),eo.of(this._iid).sessionManager.handler=e},e.prototype.addUserEventHandler=function(e,t){hs(ct("string",e)&&t instanceof Bc).throw(st.invalidParameters),eo.of(this._iid).userEventHandlers.set(e,t)},e.prototype.removeUserEventHandler=function(e){eo.of(this._iid).userEventHandlers.delete(e)},e.prototype.removeAllUserEventHandler=function(){eo.of(this._iid).userEventHandlers.clear()},e.prototype.addConnectionHandler=function(e,t){hs(ct("string",e)&&t instanceof Vc).throw(st.invalidParameters),eo.of(this._iid).connectionHandlers.set(e,t)},e.prototype.removeConnectionHandler=function(e){eo.of(this._iid).connectionHandlers.delete(e)},e.prototype.removeAllConnectionHandler=function(){eo.of(this._iid).connectionHandlers.clear()},e.prototype.createApplicationUserListQuery=function(e){return void 0===e&&(e={}),new Kc(this._iid,e)},e.prototype.createBlockedUserListQuery=function(e){return void 0===e&&(e={}),new Zc(this._iid,e)},e.prototype.createFriendListQuery=function(e){return void 0===e&&(e={}),new $c(this._iid,e)},e.prototype.createMessageSearchQuery=function(e){return new Sh(this._iid,e)},e.prototype.createPollListQuery=function(e){return new Fo(this._iid,je({},e))},e.prototype.createPollVoterListQuery=function(e){return new qo(this._iid,je({},e))},e.prototype.buildUserFromSerializedData=function(e){var t=ds(e);return new ps(this._iid,ps.payloadify(t))},e.prototype.updateCurrentUserInfo=function(e){return void 0===e&&(e={}),Qe(this,void 0,void 0,(function(){var t,n,r,i,a,s,o;return Ke(this,(function(u){switch(u.label){case 0:return t=je(je({},qh),e),hs(function(e){return vt(e.profileImage,!0)&&ct("string",e.profileUrl,!0)&&ct("string",e.nickname,!0)}(t)).throw(st.invalidParameters),this.currentUser?(n=eo.of(this._iid),r=n.sdkState,i=n.requestQueue,a=new Qh(je({userId:r.userId},t)),[4,i.send(a)]):[3,2];case 1:return s=u.sent(),o=s.as(Kh).user,this.currentUser&&(t.nickname&&(this.currentUser.nickname=o.nickname),(t.profileUrl||t.profileImage)&&(this.currentUser.plainProfileUrl=o.profileUrl)),[2,o];case 2:throw st.connectionRequired}}))}))},e.prototype.updateCurrentUserInfoWithPreferredLanguages=function(e){return Qe(this,void 0,void 0,(function(){var t,n,r,i,a,s;return Ke(this,(function(o){switch(o.label){case 0:return hs(ft("string",e)).throw(st.invalidParameters),this.currentUser?(t=eo.of(this._iid),n=t.sdkState,r=t.requestQueue,i=new Qh({userId:n.userId,preferredLanguages:e}),[4,r.send(i)]):[3,2];case 1:return a=o.sent(),s=a.as(Kh).user,this.currentUser&&(this.currentUser.preferredLanguages=s.preferredLanguages),[2,s];case 2:throw st.connectionRequired}}))}))},e.prototype.registerFCMPushTokenForCurrentUser=function(e){return Qe(this,void 0,void 0,(function(){var t,n,r,i,a,s=this;return Ke(this,(function(o){switch(o.label){case 0:if(hs(ct("string",e)).throw(st.invalidParameters),!this.currentUser)return[3,6];o.label=1;case 1:return o.trys.push([1,4,,5]),t=eo.of(this._iid),n=t.sessionManager,r=t.sdkState,i=t.requestQueue,n.hasDeviceToken(nt.FCM,e)?[2,et.SUCCESS]:(a=new Yh({userId:r.userId,token:e}),[4,i.send(a)]);case 2:return o.sent(),[4,bs((function(){return Qe(s,void 0,void 0,(function(){return Ke(this,(function(t){switch(t.label){case 0:return n.setDeviceToken(nt.FCM,e),[4,n.saveDeviceToken()];case 1:return t.sent(),[2]}}))}))}))];case 3:return o.sent(),this._fcmPushToken="",[2,et.SUCCESS];case 4:return o.sent(),[2,et.ERROR];case 5:return[3,7];case 6:return this._fcmPushToken=e,[2,et.PENDING];case 7:return[2]}}))}))},e.prototype.unregisterFCMPushTokenForCurrentUser=function(e){return Qe(this,void 0,void 0,(function(){var t,n,r,i,a,s,o=this;return Ke(this,(function(u){switch(u.label){case 0:if(hs(ct("string",e)).throw(st.invalidParameters),!this.currentUser)return[3,6];u.label=1;case 1:return u.trys.push([1,4,,5]),t=eo.of(this._iid),n=t.sessionManager,r=t.sdkState,i=t.requestQueue,a=new Jh({userId:r.userId,token:e}),[4,i.send(a)];case 2:return s=u.sent().lastDeletedAt,[4,bs((function(){return Qe(o,void 0,void 0,(function(){return Ke(this,(function(t){switch(t.label){case 0:return n.unsetDeviceToken(nt.FCM,e),n.setDeviceTokenDeletedAt(s),[4,n.saveDeviceToken()];case 1:return t.sent(),[2]}}))}))}))];case 3:return u.sent(),this._fcmPushToken="",[2,et.SUCCESS];case 4:return u.sent(),[2,et.ERROR];case 5:return[3,7];case 6:return this._fcmPushToken=e,[2,et.PENDING];case 7:return[2]}}))}))},e.prototype.unregisterFCMPushTokenAllForCurrentUser=function(){return Qe(this,void 0,void 0,(function(){var e,t,n,r,i,a,s=this;return Ke(this,(function(o){switch(o.label){case 0:return this.currentUser?(e=eo.of(this._iid),t=e.sessionManager,n=e.sdkState,r=e.requestQueue,i=new $h({userId:n.userId}),[4,r.send(i)]):[3,3];case 1:return a=o.sent().lastDeletedAt,[4,bs((function(){return Qe(s,void 0,void 0,(function(){return Ke(this,(function(e){switch(e.label){case 0:return t.unsetDeviceTokens(nt.FCM),t.setDeviceTokenDeletedAt(a),[4,t.saveDeviceToken()];case 1:return e.sent(),[2]}}))}))}))];case 2:o.sent(),o.label=3;case 3:return[2]}}))}))},e.prototype.registerAPNSPushTokenForCurrentUser=function(e){return Qe(this,void 0,void 0,(function(){var t,n,r,i,a,s=this;return Ke(this,(function(o){switch(o.label){case 0:if(hs(ct("string",e)).throw(st.invalidParameters),!this.currentUser)return[3,6];o.label=1;case 1:return o.trys.push([1,4,,5]),t=eo.of(this._iid),n=t.sessionManager,r=t.sdkState,i=t.requestQueue,n.hasDeviceToken(nt.APNS,e)?[2,et.SUCCESS]:(a=new Wh({userId:r.userId,token:e}),[4,i.send(a)]);case 2:return o.sent(),[4,bs((function(){return Qe(s,void 0,void 0,(function(){return Ke(this,(function(t){switch(t.label){case 0:return n.setDeviceToken(nt.APNS,e),[4,n.saveDeviceToken()];case 1:return t.sent(),[2]}}))}))}))];case 3:return o.sent(),this._apnsPushToken="",[2,et.SUCCESS];case 4:return o.sent(),[2,et.ERROR];case 5:return[3,7];case 6:return this._apnsPushToken=e,[2,et.PENDING];case 7:return[2]}}))}))},e.prototype.unregisterAPNSPushTokenForCurrentUser=function(e){return Qe(this,void 0,void 0,(function(){var t,n,r,i,a,s,o=this;return Ke(this,(function(u){switch(u.label){case 0:if(hs(ct("string",e)).throw(st.invalidParameters),!this.currentUser)return[3,6];u.label=1;case 1:return u.trys.push([1,4,,5]),t=eo.of(this._iid),n=t.sessionManager,r=t.sdkState,i=t.requestQueue,a=new Zh({userId:r.userId,token:e}),[4,i.send(a)];case 2:return s=u.sent().lastDeletedAt,[4,bs((function(){return Qe(o,void 0,void 0,(function(){return Ke(this,(function(t){switch(t.label){case 0:return n.unsetDeviceToken(nt.APNS,e),n.setDeviceTokenDeletedAt(s),[4,n.saveDeviceToken()];case 1:return t.sent(),[2]}}))}))}))];case 3:return u.sent(),this._apnsPushToken="",[2,et.SUCCESS];case 4:return u.sent(),[2,et.ERROR];case 5:return[3,7];case 6:return this._apnsPushToken=e,[2,et.PENDING];case 7:return[2]}}))}))},e.prototype.unregisterAPNSPushTokenAllForCurrentUser=function(){return Qe(this,void 0,void 0,(function(){var e,t,n,r,i,a,s=this;return Ke(this,(function(o){switch(o.label){case 0:return this.currentUser?(e=eo.of(this._iid),t=e.sessionManager,n=e.sdkState,r=e.requestQueue,i=new Xh({userId:n.userId}),[4,r.send(i)]):[3,3];case 1:return a=o.sent().lastDeletedAt,[4,bs((function(){return Qe(s,void 0,void 0,(function(){return Ke(this,(function(e){switch(e.label){case 0:return t.unsetDeviceTokens(nt.APNS),t.setDeviceTokenDeletedAt(a),[4,t.saveDeviceToken()];case 1:return e.sent(),[2]}}))}))}))];case 2:o.sent(),o.label=3;case 3:return[2]}}))}))},e.prototype.getChannelInvitationPreference=function(){return Qe(this,void 0,void 0,(function(){var e,t,n,r;return Ke(this,(function(i){switch(i.label){case 0:return e=eo.of(this._iid),t=e.sdkState,n=e.requestQueue,r=new nf({userId:t.userId}),[4,n.send(r)];case 1:return[2,{autoAccept:i.sent().as(rf).autoAccept}]}}))}))},e.prototype.setChannelInvitationPreference=function(e){return Qe(this,void 0,void 0,(function(){var t,n,r,i;return Ke(this,(function(a){switch(a.label){case 0:return hs(ct("boolean",e)).throw(st.invalidParameters),t=eo.of(this._iid),n=t.sdkState,r=t.requestQueue,i=new af({userId:n.userId,willAutoAccept:e}),[4,r.send(i)];case 1:return[2,{autoAccept:a.sent().as(sf).autoAccept}]}}))}))},e.prototype.getDoNotDisturb=function(){return Qe(this,void 0,void 0,(function(){var e,t,n,r;return Ke(this,(function(i){switch(i.label){case 0:return e=eo.of(this._iid),t=e.sdkState,n=e.requestQueue,r=new of({userId:t.userId}),[4,n.send(r)];case 1:return[2,i.sent().as(uf).preference]}}))}))},e.prototype.setDoNotDisturb=function(e,t,n,r,i,a){return void 0===t&&(t=0),void 0===n&&(n=0),void 0===r&&(r=0),void 0===i&&(i=0),void 0===a&&(a=""),Qe(this,void 0,void 0,(function(){var s,o,u,l;return Ke(this,(function(c){switch(c.label){case 0:return hs(ct("boolean",e)&&ct("number",t)&&ct("number",n)&&ct("number",r)&&ct("number",i)&&ct("string",a)).throw(st.invalidParameters),s=eo.of(this._iid),o=s.sdkState,u=s.requestQueue,l=new lf({userId:o.userId,doNotDisturbOn:e,startHour:t,startMin:n,endHour:r,endMin:i,timezone:a}),[4,u.send(l)];case 1:return[2,c.sent().as(cf).preference]}}))}))},e.prototype.getSnoozePeriod=function(){return Qe(this,void 0,void 0,(function(){var e,t,n,r;return Ke(this,(function(i){switch(i.label){case 0:return e=eo.of(this._iid),t=e.sdkState,n=e.requestQueue,r=new df({userId:t.userId}),[4,n.send(r)];case 1:return[2,i.sent().as(hf).snoozePeriod]}}))}))},e.prototype.setSnoozePeriod=function(e,t,n){return void 0===t&&(t=0),void 0===n&&(n=0),Qe(this,void 0,void 0,(function(){var r,i,a,s;return Ke(this,(function(o){switch(o.label){case 0:return hs(ct("boolean",e)&&ct("number",t)&&ct("number",n)).throw(st.invalidParameters),r=eo.of(this._iid),i=r.sdkState,a=r.requestQueue,s=new ff({userId:i.userId,snoozeOn:e,startTs:t,endTs:n}),[4,a.send(s)];case 1:return[2,o.sent().as(pf).snoozePeriod]}}))}))},e.prototype.getMyPushTokensByToken=function(e,t){return Qe(this,void 0,void 0,(function(){var n,r,i,a,s,o,u,l,c,d,h,f;return Ke(this,(function(p){switch(p.label){case 0:return hs(ct("string",e)&&dt(nt,t)).throw(st.invalidParameters),n=eo.of(this._iid),r=n.sdkState,i=n.requestQueue,a=n.sessionManager,s=new ef({userId:r.userId,type:t,token:e}),[4,i.send(s)];case 1:o=p.sent(),u=o.as(tf).pushTokens;try{for(l=We(u.deviceTokens),c=l.next();!c.done;c=l.next())d=c.value,a.setDeviceToken(u.type,d)}catch(e){h={error:e}}finally{try{c&&!c.done&&(f=l.return)&&f.call(l)}finally{if(h)throw h.error}}return[4,a.saveDeviceToken()];case 2:return p.sent(),[2,u]}}))}))},e.prototype.getPushTriggerOption=function(){return Qe(this,void 0,void 0,(function(){var e,t,n,r;return Ke(this,(function(i){switch(i.label){case 0:return e=eo.of(this._iid),t=e.sdkState,n=e.requestQueue,r=new mf({userId:t.userId}),[4,n.send(r)];case 1:return[2,i.sent().as(gf).pushTriggerOption]}}))}))},e.prototype.setPushTriggerOption=function(e){return Qe(this,void 0,void 0,(function(){var t,n,r,i;return Ke(this,(function(a){switch(a.label){case 0:return hs(dt(tt,e)).throw(st.invalidParameters),t=eo.of(this._iid),n=t.sdkState,r=t.requestQueue,i=new yf({userId:n.userId,pushTriggerOption:e}),[4,r.send(i)];case 1:return[2,a.sent().as(Ef).pushTriggerOption]}}))}))},e.prototype.getPushTemplate=function(){return Qe(this,void 0,void 0,(function(){var e,t,n,r;return Ke(this,(function(i){switch(i.label){case 0:return e=eo.of(this._iid),t=e.sdkState,n=e.requestQueue,r=new bf({userId:t.userId}),[4,n.send(r)];case 1:return[2,i.sent().as(Cf).name]}}))}))},e.prototype.setPushTemplate=function(e){return Qe(this,void 0,void 0,(function(){var t,n,r,i;return Ke(this,(function(a){switch(a.label){case 0:return hs(dt(rt,e)).throw(st.invalidParameters),t=eo.of(this._iid),n=t.sdkState,r=t.requestQueue,i=new wf({userId:n.userId,templateName:e}),[4,r.send(i)];case 1:return[2,a.sent().as(Sf).name]}}))}))},e.prototype.blockUser=function(e){return Qe(this,void 0,void 0,(function(){var t,n,r,i;return Ke(this,(function(a){switch(a.label){case 0:return hs(e instanceof ps||ct("string",e)).throw(st.invalidParameters),t=eo.of(this._iid),n=t.sdkState,r=t.requestQueue,i=new _f({userId:n.userId,blockedUserId:e instanceof ps?e.userId:e}),[4,r.send(i)];case 1:return a.sent(),[2]}}))}))},e.prototype.blockUserWithUserId=function(e){return Qe(this,void 0,void 0,(function(){return Ke(this,(function(t){return[2,this.blockUser(e)]}))}))},e.prototype.unblockUser=function(e){return Qe(this,void 0,void 0,(function(){var t,n,r,i;return Ke(this,(function(a){switch(a.label){case 0:return hs(e instanceof ps||ct("string",e)).throw(st.invalidParameters),t=eo.of(this._iid),n=t.sdkState,r=t.requestQueue,i=new vf({userId:n.userId,unblockedUserId:e instanceof ps?e.userId:e}),[4,r.send(i)];case 1:return a.sent(),[2]}}))}))},e.prototype.unblockUserWithUserId=function(e){return Qe(this,void 0,void 0,(function(){return Ke(this,(function(t){return[2,this.unblockUser(e)]}))}))},e.prototype.getFriendChangeLogsByToken=function(e){return Qe(this,void 0,void 0,(function(){var t,n,r,i;return Ke(this,(function(a){switch(a.label){case 0:return hs(ct("string",e)).throw(st.invalidParameters),t=eo.of(this._iid),n=t.sdkState,r=t.requestQueue,i=new Tf({userId:n.userId,token:e}),[4,r.send(i)];case 1:return[2,a.sent().as(If).changelogs]}}))}))},e.prototype.getAllowFriendDiscovery=function(){return Qe(this,void 0,void 0,(function(){var e,t,n,r;return Ke(this,(function(i){switch(i.label){case 0:return e=eo.of(this._iid),t=e.sdkState,n=e.requestQueue,r=new Df({userId:t.userId}),[4,n.send(r)];case 1:return[2,i.sent().as(Lf).allowFriendDiscovery]}}))}))},e.prototype.setAllowFriendDiscovery=function(e){return Qe(this,void 0,void 0,(function(){var t,n,r,i;return Ke(this,(function(a){switch(a.label){case 0:return hs(ct("boolean",e)).throw(st.invalidParameters),t=eo.of(this._iid),n=t.sdkState,r=t.requestQueue,i=new Rf({userId:n.userId,allowFriendDiscovery:e}),[4,r.send(i)];case 1:return a.sent(),[2,e]}}))}))},e.prototype.uploadFriendDiscoveries=function(e){return Qe(this,void 0,void 0,(function(){var t,n,r,i;return Ke(this,(function(a){switch(a.label){case 0:return t=eo.of(this._iid),n=t.sdkState,r=t.requestQueue,i=new Nf({userId:n.userId,discoveries:e}),[4,r.send(i)];case 1:return[2,a.sent().as(Af).friendDiscoveryRequestId]}}))}))},e.prototype.deleteFriendDiscovery=function(e){return Qe(this,void 0,void 0,(function(){return Ke(this,(function(t){return[2,this.deleteFriendDiscoveries([e])]}))}))},e.prototype.deleteFriendDiscoveries=function(e){return Qe(this,void 0,void 0,(function(){var t,n,r,i;return Ke(this,(function(a){switch(a.label){case 0:return hs(ft("string",e)).throw(st.invalidParameters),t=eo.of(this._iid),n=t.sdkState,r=t.requestQueue,i=new kf({userId:n.userId,discoveryKeys:e}),[4,r.send(i)];case 1:return a.sent(),[2]}}))}))},e.prototype.addFriends=function(e){return Qe(this,void 0,void 0,(function(){var t,n,r,i;return Ke(this,(function(a){switch(a.label){case 0:return hs(ft("string",e)).throw(st.invalidParameters),t=eo.of(this._iid),n=t.sdkState,r=t.requestQueue,i=new Mf({userId:n.userId,userIds:e}),[4,r.send(i)];case 1:return[2,a.sent().as(Uf).users]}}))}))},e.prototype.deleteFriend=function(e){return Qe(this,void 0,void 0,(function(){return Ke(this,(function(t){return[2,this.deleteFriends([e])]}))}))},e.prototype.deleteFriends=function(e){return Qe(this,void 0,void 0,(function(){var t,n,r,i;return Ke(this,(function(a){switch(a.label){case 0:return hs(ft("string",e)).throw(st.invalidParameters),t=eo.of(this._iid),n=t.sdkState,r=t.requestQueue,i=new Of({userId:n.userId,userIds:e}),[4,r.send(i)];case 1:return a.sent(),[2]}}))}))},e.prototype.getAllEmoji=function(){return Qe(this,void 0,void 0,(function(){var e,t;return Ke(this,(function(n){switch(n.label){case 0:return e=eo.of(this._iid).requestQueue,t=new Ff,[4,e.send(t)];case 1:return[2,n.sent().as(zf).emojiContainer]}}))}))},e.prototype.getEmojiCategory=function(e){return Qe(this,void 0,void 0,(function(){var t,n;return Ke(this,(function(r){switch(r.label){case 0:return t=eo.of(this._iid).requestQueue,n=new Hf({categoryId:e}),[4,t.send(n)];case 1:return[2,r.sent().as(qf).emojiCategory]}}))}))},e.prototype.getEmoji=function(e){return Qe(this,void 0,void 0,(function(){var t,n;return Ke(this,(function(r){switch(r.label){case 0:return t=eo.of(this._iid).requestQueue,n=new Vf({key:e}),[4,t.send(n)];case 1:return[2,r.sent().as(Gf).emoji]}}))}))},e.prototype.getUIKitConfiguration=function(){return Qe(this,void 0,void 0,(function(){var e,t,n;return Ke(this,(function(r){switch(r.label){case 0:return e=eo.of(this._iid),hs(e.hasExtension("sb_uikit")).throw(st.notSupportedError),t=e.requestQueue,n=new Bf,[4,t.send(n)];case 1:return[2,r.sent().as(jf).uikitConfiguration]}}))}))},e}(),Kf=function(e,t){this.pollId=0,this.messageId=0,this.pollId=t.poll.id,this.messageId=t.poll.message_id,this._iid=e,this._payload=t};!function(e){e[e.NONE=0]="NONE",e[e.CHANNEL_ENTER=10102]="CHANNEL_ENTER",e[e.CHANNEL_EXIT=10103]="CHANNEL_EXIT",e[e.USER_CHANNEL_MUTE=10201]="USER_CHANNEL_MUTE",e[e.USER_CHANNEL_UNMUTE=10200]="USER_CHANNEL_UNMUTE",e[e.USER_CHANNEL_BAN=10601]="USER_CHANNEL_BAN",e[e.USER_CHANNEL_UNBAN=10600]="USER_CHANNEL_UNBAN",e[e.CHANNEL_FREEZE=10701]="CHANNEL_FREEZE",e[e.CHANNEL_UNFREEZE=10700]="CHANNEL_UNFREEZE",e[e.TYPING_START=10900]="TYPING_START",e[e.TYPING_END=10901]="TYPING_END",e[e.CHANNEL_JOIN=1e4]="CHANNEL_JOIN",e[e.CHANNEL_LEAVE=10001]="CHANNEL_LEAVE",e[e.CHANNEL_OPERATOR_UPDATE=10002]="CHANNEL_OPERATOR_UPDATE",e[e.CHANNEL_INVITE=10020]="CHANNEL_INVITE",e[e.CHANNEL_ACCEPT_INVITE=10021]="CHANNEL_ACCEPT_INVITE",e[e.CHANNEL_DECLINE_INVITE=10022]="CHANNEL_DECLINE_INVITE",e[e.CHANNEL_PROP_CHANGED=11e3]="CHANNEL_PROP_CHANGED",e[e.CHANNEL_DELETED=12e3]="CHANNEL_DELETED",e[e.CHANNEL_META_DATA_CHANGED=11100]="CHANNEL_META_DATA_CHANGED",e[e.CHANNEL_META_COUNTERS_CHANGED=11200]="CHANNEL_META_COUNTERS_CHANGED",e[e.CHANNEL_HIDE=13e3]="CHANNEL_HIDE",e[e.CHANNEL_UNHIDE=13001]="CHANNEL_UNHIDE",e[e.PINNED_MESSAGE_CHANGED=11300]="PINNED_MESSAGE_CHANGED"}(Pf||(Pf={}));var Wf,Yf=function(){function e(e){var t;this.channelUrl=e.channel_url,this.channelType=e.channel_type,this.category=e.cat,this.data=null!==(t=e.data)&&void 0!==t?t:{},this.ts=e.ts}return Object.defineProperty(e.prototype,"isGroupChannelEvent",{get:function(){return this.channelType===St.GROUP},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isOpenChannelEvent",{get:function(){return this.channelType===St.OPEN},enumerable:!1,configurable:!0}),e}(),Zf=function(e){function t(t,n,r){var i=e.call(this,t,"SYEV",r)||this;return i.event=new Yf(r),i}return Be(t,e),t}(vn),Jf=function(e){function t(t,n,r){var i=e.call(this,t,n,r)||this,a=r.data.operators,s=void 0===a?[]:a;return i.operators=s.map((function(e){return new ps(i._iid,e)})),i}return Be(t,e),t}(Zf),Xf=function(e){function t(t,n){var r=e.call(this,t)||this;return r._logger=n.logger,r._sdkState=n.sdkState,r._sessionManager=n.sessionManager,r._requestQueue=n.requestQueue,r._dispatcher=n.dispatcher,r._cacheContext=n.cacheContext,r._channelType=n.channelType,r}return Be(t,e),Object.defineProperty(t.prototype,"_messageBroadcast",{get:function(){return ph.of(this._iid)},enumerable:!1,configurable:!0}),t.prototype.subscribeMessageEvent=function(e,t){this._messageBroadcast.subscribe(e,t)},t.prototype.unsubscribeMessageEvent=function(e){this._messageBroadcast.unsubscribe(e)},t.prototype.getMessageFromCache=function(e){return Qe(this,void 0,void 0,(function(){return Ke(this,(function(e){return[2,null]}))}))},t.prototype.getExactlyMatchingMessagesForTokenFromCache=function(e,t,n){return Qe(this,void 0,void 0,(function(){return Ke(this,(function(e){return[2,[]]}))}))},t.prototype.getMessagesFromCache=function(e,t,n,r,i,a){return Qe(this,void 0,void 0,(function(){return Ke(this,(function(e){return[2,[]]}))}))},t.prototype.getPollMessagesFromCache=function(e,t,n,r){return Qe(this,void 0,void 0,(function(){return Ke(this,(function(e){return[2,[]]}))}))},t.prototype.getCachedMessageCountBetween=function(e,t,n,r){return Qe(this,void 0,void 0,(function(){return Ke(this,(function(e){return[2,0]}))}))},t.prototype.getUnsentMessagesFromCache=function(e,t){return Qe(this,void 0,void 0,(function(){return Ke(this,(function(e){return[2,[]]}))}))},t.prototype.removeFailedMessageFromCache=function(e){return Qe(this,void 0,void 0,(function(){return Ke(this,(function(e){return[2]}))}))},t}(ns),$f=function(e){function t(t,n,r){var i,a,s,o,u=this;(u=e.call(this,t,"ADMM",r)||this).message=new lu(t,r);var l=eo.of(t).sdkState;return u.isMentioned=un(u.message.mentionType,null!==(s=null!==(i=u.message.mentionedUserIds)&&void 0!==i?i:null===(a=u.message.mentionedUsers)||void 0===a?void 0:a.map((function(e){return e.userId})))&&void 0!==s?s:[],l.userId),u.forceUpdateLastMessage=null!==(o=r.force_update_last_message)&&void 0!==o&&o,u}return Be(t,e),t}(vn),ep=function(e){function t(t,n,r){var i,a,s,o,u,l=this;(l=e.call(this,t,"AEDI",r)||this).message=new lu(t,r);var c=eo.of(t).sdkState;return l.mentionCountChange=ln({mentionType:null===(i=r.old_values)||void 0===i?void 0:i.mention_type,mentionedUserIds:null!==(s=null===(a=r.old_values)||void 0===a?void 0:a.mentioned_user_ids)&&void 0!==s?s:[]},Vt({mentionType:l.message.mentionType,mentionedUserIds:null!==(o=l.message.mentionedUserIds)&&void 0!==o?o:null===(u=l.message.mentionedUsers)||void 0===u?void 0:u.map((function(e){return e.userId}))}),c.userId),l}return Be(t,e),t}(vn),tp=function(e){function t(t,n,r){var i=e.call(this,t,"MRCT",r)||this;return i.channelUrl=r.channel_url,i.channelType=r.channel_type,i.event=new Ko(r),i}return Be(t,e),t}(vn),np=function(e){function t(t,n,r){var i=e.call(this,t,"MTHD",r)||this;return i.event=new mh(t,r),i}return Be(t,e),t}(vn),rp=function(e){function t(t,n,r){var i=e.call(this,t,"MCNT",r)||this;return i.groupChannelMemberCounts=r.group_channels.map((function(e){return{channelUrl:e.channel_url,memberCount:e.member_count,joinedMemberCount:e.joined_member_count,updatedAt:e.ts}})),i.openChannelMemberCounts=r.open_channels.map((function(e){return{channelUrl:e.channel_url,participantCount:e.participant_count,updatedAt:e.ts}})),i}return Be(t,e),t}(vn),ip=function(e){function t(t,n,r){var i=e.call(this,t,"PEDI",r)||this;return i.event=new Kf(t,r),i.status=io(r.poll.status)||r.poll.status,i.channelUrl=r.channel_url,i.channelType=r.channel_type,i}return Be(t,e),t}(vn),ap=function(){this.onUserMuted=Dn,this.onUserUnmuted=Dn,this.onUserBanned=Dn,this.onUserUnbanned=Dn,this.onChannelChanged=Dn,this.onChannelDeleted=Dn,this.onChannelFrozen=Dn,this.onChannelUnfrozen=Dn,this.onOperatorUpdated=Dn,this.onChannelMemberCountChanged=Dn,this.onMetaDataCreated=Dn,this.onMetaDataUpdated=Dn,this.onMetaDataDeleted=Dn,this.onMetaCounterCreated=Dn,this.onMetaCounterUpdated=Dn,this.onMetaCounterDeleted=Dn,this.onMessageReceived=Dn,this.onMessageUpdated=Dn,this.onMessageDeleted=Dn,this.onMentionReceived=Dn,this.onReactionUpdated=Dn,this.onThreadInfoUpdated=Dn},sp=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._channels=new Map,t._enteredChannelUrls=[],t}return Be(t,e),Object.defineProperty(t.prototype,"enteredChannels",{get:function(){var e=this;return this._enteredChannelUrls.map((function(t){return e._channels.get(t)})).filter((function(e){return!!e}))},enumerable:!1,configurable:!0}),t.prototype.isEnteredChannel=function(e){return this._enteredChannelUrls.includes(e)},t.prototype.enter=function(e){this._enteredChannelUrls.indexOf(e)<0&&this._enteredChannelUrls.push(e)},t.prototype.exit=function(e){var t=this._enteredChannelUrls.indexOf(e);t>=0&&this._enteredChannelUrls.splice(t,1)},t.prototype.exitAll=function(){this._enteredChannelUrls=[]},t.prototype.get=function(e){return Qe(this,void 0,void 0,(function(){return Ke(this,(function(t){return[2,this._channels.get(e)]}))}))},t.prototype.upsert=function(e){return Qe(this,void 0,void 0,(function(){var t,n=this;return Ke(this,(function(r){return t=[],e.forEach((function(e){if(n._channels.has(e.url)){var r=n._channels.get(e.url);Object.assign(r,e),t.push(r)}else n._channels.set(e.url,e),t.push(e)})),[2,t]}))}))},t.prototype.remove=function(e){return Qe(this,void 0,void 0,(function(){return Ke(this,(function(t){return this._channels.delete(e),this.exit(e),[2]}))}))},t.prototype.clear=function(){return Qe(this,void 0,void 0,(function(){return Ke(this,(function(e){return this._channels.clear(),this._enteredChannelUrls=[],[2]}))}))},t}(ns),op={channelUrl:void 0,name:void 0,coverUrlOrImage:void 0,data:void 0,customType:void 0,operatorUserIds:void 0,isEphemeral:void 0},up=function(e){function t(t){var n=t.channelUrl,r=t.isInternalCall,i=e.call(this)||this;return i.method=Gt.GET,i.path="".concat(r?Zt:Yt,"/").concat(encodeURIComponent(n)),i}return Be(t,e),t}(hn),lp=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.channel=new Sp(t,n),r}return Be(t,e),t}(fn),cp=function(e){function t(t){var n=this,r=t.channelUrl,i=t.coverUrlOrImage,a=t.name,s=t.data,o=t.customType,u=t.operatorUserIds,l=t.isEphemeral;return(n=e.call(this)||this).method=Gt.POST,n.path=Yt,n.params=qt(Vt({channel_url:r,cover_url:ct("string",i)?i:null,cover_file:vt(i)?i:null,name:a,data:s,custom_type:o,operators:u,is_ephemeral:l})),n}return Be(t,e),t}(hn);Be((function(e,t){var n=Wf.call(this,e,t)||this;return n.channel=new Sp(e,t),n}),Wf=fn);var dp=function(e){function t(t){var n=t.channelUrl;return e.call(this,{code:"ENTR",payload:{channel_url:n},ackRequired:!0})||this}return Be(t,e),t}(mn),hp=function(e){function t(t,n,r){var i,a,s=this;return s=e.call(this,t,"SYEV",r)||this,r.data&&(s.participantCount=null!==(i=r.data.participant_count)&&void 0!==i?i:0,s.user=new ps(t,r.data),s.ts=null!==(a=r.data.edge_ts)&&void 0!==a?a:0),s}return Be(t,e),t}(Zf),fp=function(e){function t(t){var n=t.channelUrl;return e.call(this,{code:"EXIT",payload:{channel_url:n},ackRequired:!0})||this}return Be(t,e),t}(mn),pp=function(e){function t(t,n,r){var i,a,s=this;return s=e.call(this,t,"EXIT",r)||this,r.data&&(s.participantCount=null!==(i=r.data.participant_count)&&void 0!==i?i:0,s.user=new ps(t,r.data),s.ts=null!==(a=r.data.edge_ts)&&void 0!==a?a:0),s}return Be(t,e),t}(Zf),_p={},vp=function(e){function t(t,n){var r=e.call(this,t,je(je({},n),{channelType:St.OPEN}))||this;return r.subscribeChannelEvent=Dn,r.unsubscribeChannelEvent=Dn,r.refreshChannel=function(){return Qe(r,void 0,void 0,(function(){return Ke(this,(function(e){return[2,void 0]}))}))},r._openChannelCache=new sp(t),r._openChannelHandlers=new Map,r._dispatcher.on((function(e){var t,n;if(e instanceof vn)r._handleEvent(e);else if(e instanceof Ka&&e.stateType===Ga.CONNECTED){var i=r._openChannelCache.enteredChannels;try{for(var a=We(i),s=a.next();!s.done;s=a.next())s.value.enter()}catch(e){t={error:e}}finally{try{s&&!s.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}}})),_p[t]||(_p[t]=r),r}return Be(t,e),t.of=function(e){return _p[e]},t.prototype.buildOpenChannelFromSerializedData=function(e){var t=ds(e);return new Sp(this._iid,Sp.payloadify(t))},t.prototype.getChannelFromCache=function(e){var t;return Qe(this,void 0,void 0,(function(){return Ke(this,(function(n){switch(n.label){case 0:return[4,this._openChannelCache.get(e)];case 1:return[2,null!==(t=n.sent())&&void 0!==t?t:null]}}))}))},t.prototype.upsertChannelsToCache=function(e){return Qe(this,void 0,void 0,(function(){return Ke(this,(function(t){switch(t.label){case 0:return[4,this._openChannelCache.upsert(e)];case 1:return[2,t.sent()]}}))}))},t.prototype.removeChannelsFromCache=function(e){return Qe(this,void 0,void 0,(function(){var t,n,r,i,a,s;return Ke(this,(function(o){switch(o.label){case 0:o.trys.push([0,5,6,7]),t=We(e),n=t.next(),o.label=1;case 1:return n.done?[3,4]:(r=n.value,[4,this._openChannelCache.remove(r)]);case 2:o.sent(),o.label=3;case 3:return n=t.next(),[3,1];case 4:return[3,7];case 5:return i=o.sent(),a={error:i},[3,7];case 6:try{n&&!n.done&&(s=t.return)&&s.call(t)}finally{if(a)throw a.error}return[7];case 7:return[2]}}))}))},t.prototype.setEnteredToCache=function(e){this._openChannelCache.enter(e.url)},t.prototype.setExitedToCache=function(e){this._openChannelCache.exit(e.url)},t.prototype._handleEvent=function(e){return Qe(this,void 0,void 0,(function(){var t,n,r,i,a,s,o,u,l,c,d,h,f,p,_,v,m,g,y,E,b,C,w,S,T,I,N,A,k,M,U,O,D,L,R,x,P,F,z,H,q,V,G,B,j,Q,K,W,Y,Z,J,X,$,ee,te,ne,re,ie,ae,se,oe,ue,le,ce,de,he,fe,pe,_e=this;return Ke(this,(function(ve){switch(ve.label){case 0:switch(ve.trys.push([0,57,,58]),e.code){case"MESG":case"FILE":case"ADMM":case"BRDM":return[3,1];case"MEDI":case"FEDI":case"AEDI":return[3,4];case"DELM":return[3,7];case"MRCT":return[3,10];case"MTHD":return[3,13];case"MCNT":return[3,16];case"PEDI":return[3,27];case"VOTE":return[3,30];case"SYEV":return[3,33]}return[3,56];case 1:return i=null,"MESG"===e.code?i=e.as(ac):"FILE"===e.code?i=e.as(wu):"ADMM"!==e.code&&"BRDM"!=e.code||(i=e.as($f)),i?(t=i.message,n=i.isMentioned,t.channelType!==St.OPEN?[3,3]:[4,this.getChannel(t.channelUrl,!0)]):[3,3];case 2:r=ve.sent(),Es((function(){return Qe(_e,void 0,void 0,(function(){var e,i,a,s,o;return Ke(this,(function(u){try{for(e=We(this._openChannelHandlers.values()),i=e.next();!i.done;i=e.next())a=i.value,this._openChannelCache.isEnteredChannel(r.url)&&(a.onMessageReceived&&a.onMessageReceived(r,t),n&&a.onMentionReceived&&a.onMentionReceived(r,t))}catch(e){s={error:e}}finally{try{i&&!i.done&&(o=e.return)&&o.call(e)}finally{if(s)throw s.error}}return[2]}))}))})),ve.label=3;case 3:return[3,56];case 4:return i=null,"MEDI"===e.code?i=e.as(oc):"FEDI"===e.code?i=e.as(lc):"AEDI"===e.code&&(i=e.as(ep)),i?(a=i.message,s=i.mentionCountChange,a.channelType!==St.OPEN?[3,6]:[4,this.getChannel(a.channelUrl,!0)]):[3,6];case 5:o=ve.sent(),Es((function(){return Qe(_e,void 0,void 0,(function(){var e,t,n,r,i;return Ke(this,(function(u){try{for(e=We(this._openChannelHandlers.values()),t=e.next();!t.done;t=e.next())n=t.value,this._openChannelCache.isEnteredChannel(o.url)&&(n.onMessageUpdated&&n.onMessageUpdated(o,a),s>0&&n.onMentionReceived&&n.onMentionReceived(o,a))}catch(e){r={error:e}}finally{try{t&&!t.done&&(i=e.return)&&i.call(e)}finally{if(r)throw r.error}}return[2]}))}))})),ve.label=6;case 6:return[3,56];case 7:return u=e.as(dc),U=u.channelUrl,O=u.channelType,l=u.messageId,O!==St.OPEN?[3,9]:[4,this.getChannel(U,!0)];case 8:c=ve.sent(),Es((function(){return Qe(_e,void 0,void 0,(function(){var e,t,n,r,i;return Ke(this,(function(a){try{for(e=We(this._openChannelHandlers.values()),t=e.next();!t.done;t=e.next())n=t.value,this._openChannelCache.isEnteredChannel(c.url)&&n.onMessageDeleted&&n.onMessageDeleted(c,l)}catch(e){r={error:e}}finally{try{t&&!t.done&&(i=e.return)&&i.call(e)}finally{if(r)throw r.error}}return[2]}))}))})),ve.label=9;case 9:return[3,56];case 10:return d=e.as(tp),U=d.channelUrl,O=d.channelType,h=d.event,O!==St.OPEN?[3,12]:[4,this.getChannel(U,!0)];case 11:f=ve.sent(),Es((function(){return Qe(_e,void 0,void 0,(function(){var e,t,n,r,i;return Ke(this,(function(a){try{for(e=We(this._openChannelHandlers.values()),t=e.next();!t.done;t=e.next())n=t.value,this._openChannelCache.isEnteredChannel(f.url)&&n.onReactionUpdated&&n.onReactionUpdated(f,h)}catch(e){r={error:e}}finally{try{t&&!t.done&&(i=e.return)&&i.call(e)}finally{if(r)throw r.error}}return[2]}))}))})),ve.label=12;case 12:return[3,56];case 13:return(p=e.as(np).event).channelType!==St.OPEN?[3,15]:[4,this.getChannel(p.channelUrl,!0)];case 14:_=ve.sent(),Es((function(){return Qe(_e,void 0,void 0,(function(){var e,t,n,r,i;return Ke(this,(function(a){try{for(e=We(this._openChannelHandlers.values()),t=e.next();!t.done;t=e.next())n=t.value,this._openChannelCache.isEnteredChannel(_.url)&&n.onThreadInfoUpdated&&n.onThreadInfoUpdated(_,p)}catch(e){r={error:e}}finally{try{t&&!t.done&&(i=e.return)&&i.call(e)}finally{if(r)throw r.error}}return[2]}))}))})),ve.label=15;case 15:return[3,56];case 16:v=e.as(rp).openChannelMemberCounts,m=[],ve.label=17;case 17:ve.trys.push([17,22,23,24]),g=We(v),y=g.next(),ve.label=18;case 18:return y.done?[3,21]:(E=y.value,U=E.channelUrl,q=E.participantCount,b=E.updatedAt,[4,this.getChannelFromCache(U)]);case 19:(C=ve.sent())&&C._updateParticipantCount(q,b)&&m.push(C),ve.label=20;case 20:return y=g.next(),[3,18];case 21:return[3,24];case 22:return w=ve.sent(),fe={error:w},[3,24];case 23:try{y&&!y.done&&(pe=g.return)&&pe.call(g)}finally{if(fe)throw fe.error}return[7];case 24:return m.length>0?[4,this.upsertChannelsToCache(m)]:[3,26];case 25:S=ve.sent(),Es((function(){return Qe(_e,void 0,void 0,(function(){var e,t,n,r,i;return Ke(this,(function(a){try{for(e=We(this._openChannelHandlers.values()),t=e.next();!t.done;t=e.next())(n=t.value).onChannelMemberCountChanged&&n.onChannelMemberCountChanged(S)}catch(e){r={error:e}}finally{try{t&&!t.done&&(i=e.return)&&i.call(e)}finally{if(r)throw r.error}}return[2]}))}))})),ve.label=26;case 26:return[3,56];case 27:return T=e.as(ip),I=T.event,N=T.status,U=T.channelUrl,O=T.channelType,U&&O===St.OPEN?[4,this.getChannel(U,!0)]:[3,29];case 28:A=ve.sent(),this._dispatcher.dispatch(new _o({event:I,source:no.EVENT_POLL_UPDATED})),Es(N===ro?function(){return Qe(_e,void 0,void 0,(function(){var e,t,n,r,i;return Ke(this,(function(a){try{for(e=We(this._openChannelHandlers.values()),t=e.next();!t.done;t=e.next())(n=t.value).onPollDeleted&&n.onPollDeleted(A,I.pollId)}catch(e){r={error:e}}finally{try{t&&!t.done&&(i=e.return)&&i.call(e)}finally{if(r)throw r.error}}return[2]}))}))}:function(){return Qe(_e,void 0,void 0,(function(){var e,t,n,r,i;return Ke(this,(function(a){try{for(e=We(this._openChannelHandlers.values()),t=e.next();!t.done;t=e.next())(n=t.value).onPollUpdated&&n.onPollUpdated(A,I)}catch(e){r={error:e}}finally{try{t&&!t.done&&(i=e.return)&&i.call(e)}finally{if(r)throw r.error}}return[2]}))}))}),ve.label=29;case 29:return[3,56];case 30:return k=e.as(Dc),M=k.event,U=k.channelUrl,O=k.channelType,U&&O===St.OPEN?[4,this.getChannel(U,!0)]:[3,32];case 31:D=ve.sent(),this._dispatcher.dispatch(new vo({event:M,source:no.EVENT_POLL_VOTED})),Es((function(){return Qe(_e,void 0,void 0,(function(){var e,t,n,r,i;return Ke(this,(function(a){try{for(e=We(this._openChannelHandlers.values()),t=e.next();!t.done;t=e.next())(n=t.value).onPollVoted&&n.onPollVoted(D,M)}catch(e){r={error:e}}finally{try{t&&!t.done&&(i=e.return)&&i.call(e)}finally{if(r)throw r.error}}return[2]}))}))})),ve.label=32;case 32:return[3,56];case 33:if(!(L=e.as(Zf).event).isOpenChannelEvent)return[3,55];switch(L.category){case Pf.CHANNEL_ENTER:return[3,34];case Pf.CHANNEL_EXIT:return[3,36];case Pf.CHANNEL_OPERATOR_UPDATE:return[3,38];case Pf.USER_CHANNEL_MUTE:case Pf.USER_CHANNEL_UNMUTE:return[3,40];case Pf.USER_CHANNEL_BAN:case Pf.USER_CHANNEL_UNBAN:return[3,42];case Pf.CHANNEL_FREEZE:case Pf.CHANNEL_UNFREEZE:return[3,44];case Pf.CHANNEL_DELETED:return[3,46];case Pf.CHANNEL_PROP_CHANGED:return[3,49];case Pf.CHANNEL_META_DATA_CHANGED:return[3,51];case Pf.CHANNEL_META_COUNTERS_CHANGED:return[3,53]}return[3,55];case 34:return[4,this.getChannel(L.channelUrl,!0)];case 35:return R=ve.sent(),x=e.as(hp),q=x.participantCount,P=x.user,F=R._updateParticipantCount(q,L.ts),Es((function(){return Qe(_e,void 0,void 0,(function(){return Ke(this,(function(e){return this._openChannelHandlers.forEach((function(e){e.onUserEntered&&e.onUserEntered(R,P),F&&e.onChannelParticipantCountChanged&&e.onChannelParticipantCountChanged(R)})),[2]}))}))})),[3,55];case 36:return[4,this.getChannel(L.channelUrl,!0)];case 37:return z=ve.sent(),H=e.as(pp),q=H.participantCount,V=H.user,G=z._updateParticipantCount(q,L.ts),Es((function(){return Qe(_e,void 0,void 0,(function(){return Ke(this,(function(e){return this._openChannelHandlers.forEach((function(e){e.onUserExited&&e.onUserExited(z,V),G&&e.onChannelParticipantCountChanged&&e.onChannelParticipantCountChanged(z)})),[2]}))}))})),[3,55];case 38:return[4,this.getChannel(L.channelUrl,!0)];case 39:return B=ve.sent(),j=e.as(Jf).operators,B.operators=j,this.upsertChannelsToCache([B]),Es((function(){return Qe(_e,void 0,void 0,(function(){return Ke(this,(function(e){return this._openChannelHandlers.forEach((function(e){e.onOperatorUpdated&&e.onOperatorUpdated(B,j)})),[2]}))}))})),[3,55];case 40:return[4,this.getChannel(L.channelUrl,!0)];case 41:return Q=ve.sent(),K=L.category===Pf.USER_CHANNEL_MUTE,W=e.as(K?Ql:Wl).user,Es((function(){return Qe(_e,void 0,void 0,(function(){return Ke(this,(function(e){return this._openChannelHandlers.forEach((function(e){K?e.onUserMuted&&e.onUserMuted(Q,W):e.onUserUnmuted&&e.onUserUnmuted(Q,W)})),[2]}))}))})),[3,55];case 42:return[4,this.getChannel(L.channelUrl,!0)];case 43:return Y=ve.sent(),Z=L.category===Pf.USER_CHANNEL_BAN,J=e.as(Z?Zl:Xl).user,Es((function(){return Qe(_e,void 0,void 0,(function(){return Ke(this,(function(e){return this._openChannelHandlers.forEach((function(e){Z?e.onUserBanned&&e.onUserBanned(Y,J):e.onUserUnbanned&&e.onUserUnbanned(Y,J)})),[2]}))}))})),[3,55];case 44:return[4,this.getChannel(L.channelUrl,!0)];case 45:return X=ve.sent(),$=e.as(ec).freeze,X.isFrozen=$,this.upsertChannelsToCache([X]),Es((function(){return Qe(_e,void 0,void 0,(function(){return Ke(this,(function(e){return this._openChannelHandlers.forEach((function(e){$?e.onChannelFrozen&&e.onChannelFrozen(X):e.onChannelUnfrozen&&e.onChannelUnfrozen(X)})),[2]}))}))})),[3,55];case 46:return[4,this.getChannel(L.channelUrl,!0)];case 47:return ee=ve.sent(),[4,this.removeChannelsFromCache([ee.url])];case 48:return ve.sent(),Es((function(){return Qe(_e,void 0,void 0,(function(){return Ke(this,(function(e){return this._openChannelHandlers.forEach((function(e){e.onChannelDeleted&&e.onChannelDeleted(ee.url,ee.channelType)})),[2]}))}))})),[3,55];case 49:return[4,this.getChannelWithoutCache(L.channelUrl,!0)];case 50:return te=ve.sent(),Es((function(){return Qe(_e,void 0,void 0,(function(){return Ke(this,(function(e){return this._openChannelHandlers.forEach((function(e){e.onChannelChanged&&e.onChannelChanged(te)})),[2]}))}))})),[3,55];case 51:return[4,this.getChannel(L.channelUrl,!0)];case 52:return ne=ve.sent(),re=e.as(Ul),ie=re.created,ae=re.updated,se=re.deleted,ie&&ne._upsertCachedMetaData(ie,L.ts),ae&&ne._upsertCachedMetaData(ae,L.ts),se&&ne._removeFromCachedMetaData(se,L.ts),Es((function(){return Qe(_e,void 0,void 0,(function(){return Ke(this,(function(e){return this._openChannelHandlers.forEach((function(e){ie&&e.onMetaDataCreated&&e.onMetaDataCreated(ne,ie),ae&&e.onMetaDataUpdated&&e.onMetaDataUpdated(ne,ae),se&&e.onMetaDataDeleted&&e.onMetaDataDeleted(ne,se)})),[2]}))}))})),[3,55];case 53:return[4,this.getChannel(L.channelUrl,!0)];case 54:return oe=ve.sent(),ue=e.as(Vl),le=ue.created,ce=ue.updated,de=ue.deleted,Es((function(){return Qe(_e,void 0,void 0,(function(){return Ke(this,(function(e){return this._openChannelHandlers.forEach((function(e){le&&e.onMetaCounterCreated&&e.onMetaCounterCreated(oe,le),ce&&e.onMetaCounterUpdated&&e.onMetaCounterUpdated(oe,ce),de&&e.onMetaCounterDeleted&&e.onMetaCounterDeleted(oe,de)})),[2]}))}))})),[3,55];case 55:return[3,56];case 56:return[3,58];case 57:if(he=ve.sent(),at(he))throw he;return[3,58];case 58:return[2]}}))}))},t.prototype.addHandler=function(e,t){this._openChannelHandlers.set(e,t)},t.prototype.removeHandler=function(e){this._openChannelHandlers.delete(e)},t.prototype.clearHandler=function(){this._openChannelHandlers.clear()},t.prototype.getChannel=function(e,t){return Qe(this,void 0,void 0,(function(){var t;return Ke(this,(function(n){switch(n.label){case 0:hs(ct("string",e)).throw(st.invalidParameters),n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.getChannelFromCache(e)];case 2:return(t=n.sent())?[2,t]:[3,4];case 3:return n.sent(),[3,4];case 4:return[4,this.getChannelWithoutCache(e)];case 5:return[2,n.sent()]}}))}))},t.prototype.getChannelWithoutCache=function(e,t){return void 0===t&&(t=!1),Qe(this,void 0,void 0,(function(){var n,r,i;return Ke(this,(function(a){switch(a.label){case 0:return hs(ct("string",e)).throw(st.invalidParameters),n=new up({channelUrl:e,isInternalCall:t}),[4,this._requestQueue.send(n)];case 1:return r=a.sent(),i=r.as(lp).channel,[4,this.upsertChannelsToCache([i])];case 2:return[2,a.sent()[0]]}}))}))},t.prototype.createChannel=function(e){return Qe(this,void 0,void 0,(function(){var t,n,r,i;return Ke(this,(function(a){switch(a.label){case 0:return t=je(je({},op),e),hs(function(e){return ft("string",e.operatorUserIds,!0)&&(ct("string",e.coverUrlOrImage,!0)||vt(e.coverUrlOrImage,!0))&&ct("string",e.name,!0)&&ct("string",e.data,!0)&&ct("string",e.customType,!0)&&(ct("string",e.channelUrl)&&/^\w+$/.test(e.channelUrl)||null===e.channelUrl||void 0===e.channelUrl)&&ct("boolean",e.isEphemeral,!0)}(t)).throw(st.invalidParameters),n=new cp(t),[4,this._requestQueue.send(n)];case 1:return r=a.sent(),i=r.as(lp).channel,this.upsertChannelsToCache([i]),[2,i]}}))}))},t}(Xf),mp={name:void 0,coverUrlOrImage:void 0,data:void 0,customType:void 0,operatorUserIds:void 0},gp=function(e){function t(t){var n=this,r=t.channelUrl,i=t.token,a=t.limit;return(n=e.call(this)||this).method=Gt.GET,n.path="".concat(Yt,"/").concat(encodeURIComponent(r),"/participants"),n.params={token:i,limit:a},n}return Be(t,e),t}(hn),yp=function(e){function t(t,n){var r=e.call(this,t,n)||this;r.participants=[];var i=n.next,a=n.participants;return r.token=i,r.participants=a.map((function(e){return new Vu(t,e)})),r}return Be(t,e),t}(fn),Ep=function(e){function t(t,n,r){return e.call(this,t,n,St.OPEN,r)||this}return Be(t,e),t.prototype._validate=function(){return e.prototype._validate.call(this)},t.prototype.next=function(){return Qe(this,void 0,void 0,(function(){var e,t,n,r,i,a;return Ke(this,(function(s){switch(s.label){case 0:return this._validate()?this._isLoading?[3,3]:this._hasNext?(this._isLoading=!0,e=eo.of(this._iid).requestQueue,t=new gp(je(je({},this),{token:this._token})),[4,e.send(t)]):[3,2]:[3,5];case 1:return n=s.sent(),r=n.as(yp),i=r.participants,a=r.token,this._token=a,this._hasNext=!!a,this._isLoading=!1,[2,i];case 2:return[2,[]];case 3:throw st.queryInProgress;case 4:return[3,6];case 5:throw st.invalidParameters;case 6:return[2]}}))}))},t}(go),bp=function(e){function t(t){var n=this,r=t.channelUrl,i=t.coverUrlOrImage,a=t.name,s=t.data,o=t.customType,u=t.operatorUserIds;return(n=e.call(this)||this).method=Gt.PUT,n.path="".concat(Yt,"/").concat(encodeURIComponent(r)),n.params=qt(Vt({cover_url:ct("string",i)?i:null,cover_file:vt(i)?i:null,name:a,data:s,custom_type:o,operators:u})),n}return Be(t,e),t}(hn),Cp=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.channel=new Sp(t,n),r}return Be(t,e),t}(fn),wp=function(e){function t(t){var n=this,r=t.channelUrl;return(n=e.call(this)||this).method=Gt.DELETE,n.path="".concat(Yt,"/").concat(encodeURIComponent(r)),n}return Be(t,e),t}(hn);!function(e){Be((function(t,n){return e.call(this,t,n)||this}),e)}(fn);var Sp=function(e){function t(t,n){var r,i=this;return(i=e.call(this,t,n)||this)._lastParticipantCountUpdated=0,i.participantCount=0,i.operators=[],i.channelType=St.OPEN,i.participantCount=null!==(r=n.participant_count)&&void 0!==r?r:0,i.operators=Array.isArray(n.operators)?n.operators.map((function(e){return new ps(t,e)})):[],i}return Be(t,e),t.payloadify=function(e){return qt(Vt(je(je({},qc.payloadify(e)),{participant_count:e.participantCount,operators:e.operators.map((function(e){return ps.payloadify(e)}))})))},t.prototype.serialize=function(){return cs(this)},t.prototype.isOperator=function(e){return e instanceof ps?this.isOperator(e.userId):this.operators.some((function(t){return t.userId===e}))},t.prototype._updateParticipantCount=function(e,t){return t>this._lastParticipantCountUpdated&&(this.participantCount=e,this._lastParticipantCountUpdated=t,!0)},t.prototype.createParticipantListQuery=function(e){return new Ep(this._iid,this.url,e)},t.prototype.refresh=function(){return Qe(this,void 0,void 0,(function(){return Ke(this,(function(e){switch(e.label){case 0:return[4,vp.of(this._iid).getChannelWithoutCache(this.url)];case 1:return[2,e.sent()]}}))}))},t.prototype.enter=function(){return Qe(this,void 0,void 0,(function(){var e,t,n,r,i,a;return Ke(this,(function(s){switch(s.label){case 0:return e=eo.of(this._iid).requestQueue,t=new dp({channelUrl:this.url}),[4,e.send(t)];case 1:return n=s.sent(),r=n.as(hp),i=r.participantCount,a=r.ts,this._updateParticipantCount(i,a),vp.of(this._iid).setEnteredToCache(this),[2]}}))}))},t.prototype.exit=function(){return Qe(this,void 0,void 0,(function(){var e,t,n,r,i,a;return Ke(this,(function(s){switch(s.label){case 0:return e=eo.of(this._iid).requestQueue,t=new fp({channelUrl:this.url}),[4,e.send(t)];case 1:return n=s.sent(),r=n.as(pp),i=r.participantCount,a=r.ts,this._updateParticipantCount(i,a),vp.of(this._iid).setExitedToCache(this),vh.of(this._iid).fileMessageQueue.cancel(this),[2]}}))}))},t.prototype.updateChannel=function(e){return Qe(this,void 0,void 0,(function(){var t,n,r,i,a;return Ke(this,(function(s){switch(s.label){case 0:return t=je(je({},mp),e),hs(function(e){return ft("string",e.operatorUserIds,!0)&&(ct("string",e.coverUrlOrImage)||vt(e.coverUrlOrImage)||null===e.coverUrlOrImage)&&ct("string",e.name,!0)&&ct("string",e.data,!0)&&ct("string",e.customType,!0)}(t)).throw(st.invalidParameters),n=eo.of(this._iid).requestQueue,r=new bp(je({channelUrl:this.url},t)),[4,n.send(r)];case 1:return i=s.sent(),a=i.as(Cp).channel,this._update(a),[4,vp.of(this._iid).upsertChannelsToCache([a])];case 2:return s.sent(),[2,this]}}))}))},t.prototype.updateChannelWithOperatorUserIds=function(e,t,n,r,i){return Qe(this,void 0,void 0,(function(){var a;return Ke(this,(function(s){return a=je(je({},mp),{name:e,coverUrlOrImage:t,data:n,operatorUserIds:r,customType:i}),[2,this.updateChannel(a)]}))}))},t.prototype.delete=function(){return Qe(this,void 0,void 0,(function(){var e,t;return Ke(this,(function(n){switch(n.label){case 0:return e=eo.of(this._iid).requestQueue,t=new wp({channelUrl:this.url}),[4,e.send(t)];case 1:return n.sent(),[4,vp.of(this._iid).removeChannelsFromCache([this.url])];case 2:return n.sent(),[2]}}))}))},t.prototype.sendUserMessage=function(t){return hs(!t.isPinnedMessage).throw(st.notSupportedError),e.prototype.sendUserMessage.call(this,t)},t.prototype.sendFileMessage=function(t){return hs(!t.isPinnedMessage).throw(st.notSupportedError),e.prototype.sendFileMessage.call(this,t)},t}(qc),Tp=(function(e){function t(t){void 0===t&&(t={});var n=e.call(this)||this;return Object.keys(t).forEach((function(e){n.hasOwnProperty(e)&&(n[e]=t[e])})),n}Be(t,e)}(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onUserEntered=Dn,t.onUserExited=Dn,t.onChannelParticipantCountChanged=Dn,t.onPollUpdated=Dn,t.onPollVoted=Dn,t.onPollDeleted=Dn,t}return Be(t,e),t}(ap)),function(e){function t(t){var n=this,r=t.token,i=t.limit,a=t.nameKeyword,s=t.urlKeyword,o=t.customTypes,u=t.includeFrozen,l=t.includeMetaData;return(n=e.call(this)||this).method=Gt.GET,n.path=Yt,n.params=qt({token:r,limit:i,name_contains:a,url_contains:s,custom_types:o,show_frozen:u,show_metadata:l}),n}return Be(t,e),t}(hn)),Ip=function(e){function t(t,n){var r=e.call(this,t,n)||this;r.channels=[];var i=n.next,a=n.channels,s=n.ts;return r.token=i,a&&a.length>0&&(r.channels=a.map((function(e){return new Sp(t,e)}))),r.ts="number"==typeof s?s:null,r}return Be(t,e),t}(fn),Np=function(e){function t(t,n){var r,i,a,s,o,u=this;return(u=e.call(this,t,n)||this).includeFrozen=!0,u.includeMetaData=!0,u.nameKeyword=null,u.urlKeyword=null,u.customTypes=null,u.includeFrozen=null===(r=n.includeFrozen)||void 0===r||r,u.includeMetaData=null===(i=n.includeMetaData)||void 0===i||i,u.nameKeyword=null!==(a=n.nameKeyword)&&void 0!==a?a:null,u.urlKeyword=null!==(s=n.urlKeyword)&&void 0!==s?s:null,u.customTypes=null!==(o=n.customTypes)&&void 0!==o?o:null,u}return Be(t,e),t.prototype._validate=function(){return e.prototype._validate.call(this)&&ct("boolean",this.includeFrozen)&&ct("boolean",this.includeMetaData)&&ct("string",this.nameKeyword,!0)&&ct("string",this.urlKeyword,!0)&&ft("string",this.customTypes,!0)},t.prototype.next=function(){return Qe(this,void 0,void 0,(function(){var e,t,n,r,i,a;return Ke(this,(function(s){switch(s.label){case 0:return this._validate()?this._isLoading?[3,4]:this._hasNext?(this._isLoading=!0,e=eo.of(this._iid).requestQueue,t=new Tp(Vt(je(je({},this),{token:this._token}))),[4,e.send(t)]):[3,3]:[3,6];case 1:return n=s.sent(),r=n.as(Ip),i=r.channels,a=r.token,this._token=a,this._hasNext=!!a,[4,vp.of(this._iid).upsertChannelsToCache(i)];case 2:return s.sent(),this._isLoading=!1,[2,i];case 3:return[2,[]];case 4:throw st.queryInProgress;case 5:return[3,7];case 6:throw st.invalidParameters;case 7:return[2]}}))}))},t}(mo),Ap=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.name="openChannel",t}return Be(t,e),t.prototype.init=function(t,n){var r=n.sdkState,i=n.dispatcher,a=n.sessionManager,s=n.requestQueue,o=n.logger,u=n.onlineDetector,l=n.cacheContext;e.prototype.init.call(this,t,{sdkState:r,dispatcher:i,sessionManager:a,requestQueue:s,logger:o,onlineDetector:u,cacheContext:l}),this._manager=new vp(t,{sdkState:r,dispatcher:i,requestQueue:s,logger:o,cacheContext:l,sessionManager:a})},t.prototype.createOpenChannelListQuery=function(e){return void 0===e&&(e={}),new Np(this._iid,e)},t.prototype.addOpenChannelHandler=function(e,t){this._manager.addHandler(e,t)},t.prototype.removeOpenChannelHandler=function(e){this._manager.removeHandler(e)},t.prototype.removeAllOpenChannelHandlers=function(){this._manager.clearHandler()},t.prototype.buildOpenChannelFromSerializedData=function(e){return this._manager.buildOpenChannelFromSerializedData(e)},t.prototype.getChannel=function(e){return Qe(this,void 0,void 0,(function(){return Ke(this,(function(t){return[2,this._manager.getChannel(e)]}))}))},t.prototype.getChannelWithoutCache=function(e){return Qe(this,void 0,void 0,(function(){return Ke(this,(function(t){return[2,this._manager.getChannelWithoutCache(e)]}))}))},t.prototype.createChannel=function(e){return void 0===e&&(e={}),Qe(this,void 0,void 0,(function(){return Ke(this,(function(t){return[2,this._manager.createChannel(e)]}))}))},t.prototype.createChannelWithOperatorUserIds=function(e,t,n,r,i){return Qe(this,void 0,void 0,(function(){var a;return Ke(this,(function(s){return(a=je({},op)).name=e,a.coverUrlOrImage=t,a.data=n,a.operatorUserIds=r,a.customType=i,[2,this._manager.createChannel(a)]}))}))},t}(to);var kp;!function(e){e.NONE="none",e.JOINED="joined",e.INVITED="invited",e.LEFT="left"}(kp||(kp={}));var Mp,Up,Op,Dp,Lp,Rp,xp,Pp,Fp=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.state=null,r.role=null,r.isMuted=!1,r.isBlockedByMe=!1,r.isBlockingMe=!1,r.state=dt(kp,n.state)?n.state:null,r.role=dt(Tt,n.role)?n.role:null,"boolean"==typeof n.is_muted&&(r.isMuted=n.is_muted),"boolean"==typeof n.is_blocked_by_me&&(r.isBlockedByMe=n.is_blocked_by_me),"boolean"==typeof n.is_blocking_me&&(r.isBlockingMe=n.is_blocking_me),r}return Be(t,e),t.payloadify=function(t){return qt(Vt(je(je({},e.payloadify.call(this,t)),{state:t.state,role:t.role,is_muted:t.isMuted,is_blocked_by_me:t.isBlockedByMe,is_blocking_me:t.isBlockingMe})))},t}(qu),zp=function(e){function t(t,n){var r,i,a=this;return(a=e.call(this,t)||this).channelUrl=null!==(r=n.channel_url)&&void 0!==r?r:"",a.channelType=null!==(i=n.channel_type)&&void 0!==i?i:St.GROUP,a.reader=new ps(a._iid,n.user),a.readAt=n.ts,a}return Be(t,e),t}(ns);!function(e){e.ALL="all",e.PUBLIC="public",e.PRIVATE="private"}(Mp||(Mp={})),function(e){e.ALL="all",e.JOINED="joined_only",e.INVITED="invited_only",e.INVITED_BY_FRIEND="invited_by_friend",e.INVITED_BY_NON_FRIEND="invited_by_non_friend"}(Up||(Up={})),function(e){e.ALL="all",e.SUPER="super",e.NON_SUPER="nonsuper",e.BROADCAST_ONLY="broadcast_only",e.EXCLUSIVE_ONLY="exclusive_only"}(Op||(Op={})),function(e){e.ALL="all",e.UNREAD_MESSAGE="unread_message"}(Dp||(Dp={})),function(e){e.ALL="all",e.UNHIDDEN="unhidden_only",e.HIDDEN="hidden_only",e.HIDDEN_ALLOW_AUTO_UNHIDE="hidden_allow_auto_unhide",e.HIDDEN_PREVENT_AUTO_UNHIDE="hidden_prevent_auto_unhide"}(Lp||(Lp={})),function(e){e.ALL="all",e.OPERATOR="operator",e.NONOPERATOR="nonoperator"}(Rp||(Rp={})),function(e){e.AND="AND",e.OR="OR"}(xp||(xp={})),function(e){e.MEMBER_NICKNAME="member_nickname",e.CHANNEL_NAME="channel_name"}(Pp||(Pp={}));var Hp,qp=function(){function e(){this._searchFilter=null,this._userIdsFilter=null,this.includeEmpty=!1,this.nicknameContainsFilter=null,this.nicknameStartsWithFilter=null,this.nicknameExactMatchFilter=null,this.channelNameContainsFilter="",this.myMemberStateFilter=Up.ALL,this.customTypesFilter=null,this.channelUrlsFilter=null,this.superChannelFilter=Op.ALL,this.publicChannelFilter=Mp.ALL,this.customTypeStartsWithFilter=null,this.unreadChannelFilter=Dp.ALL,this.hiddenChannelFilter=Lp.UNHIDDEN,this.includeFrozen=!0}return e.prototype._isFriend=function(e){return!(!e||!e.friendDiscoveryKey&&!e.friendName)},Object.defineProperty(e.prototype,"searchFilter",{get:function(){return this._searchFilter},enumerable:!1,configurable:!0}),e.prototype.setSearchFilter=function(e,t){Array.isArray(e)&&0!==e.length&&"string"==typeof t&&t&&(this._searchFilter={query:t,fields:e})},Object.defineProperty(e.prototype,"userIdsFilter",{get:function(){return this._userIdsFilter},enumerable:!1,configurable:!0}),e.prototype.setUserIdsFilter=function(e,t,n){void 0===n&&(n=xp.AND),this._userIdsFilter={userIds:e,includeMode:t,queryType:n}},e.prototype.clone=function(){var t,n=new e;this.searchFilter&&n.setSearchFilter(this.searchFilter.fields,null!==(t=this.searchFilter.query)&&void 0!==t?t:void 0),this.userIdsFilter&&n.setUserIdsFilter(this.userIdsFilter.userIds,this.userIdsFilter.includeMode,this.userIdsFilter.queryType);var r=JSON.parse(JSON.stringify(this));return Object.keys(r).forEach((function(e){n[e]=r[e]})),n},e.prototype.match=function(e,t){if(this._searchFilter){var n=this._searchFilter,r=n.query,i=n.fields;if(r&&i&&i.length>0&&!i.some((function(t){switch(t){case Pp.CHANNEL_NAME:return e.name.toLowerCase().includes(r.toLowerCase());case Pp.MEMBER_NICKNAME:return e.members.some((function(e){return e.nickname.toLowerCase().includes(r.toLowerCase())}));default:return!0}})))return!1}if(this._userIdsFilter){var a=this._userIdsFilter,s=a.userIds,o=a.includeMode,u=a.queryType,l=e.members.map((function(e){return e.userId}));if(o){if(s.length>0)switch(u){case xp.AND:if(s.some((function(e){return!l.includes(e)})))return!1;break;case xp.OR:if(s.every((function(e){return!l.includes(e)})))return!1}}else{if(s.includes(t)||s.push(t),e.members.length>s.length)return!1;if(!function(e,t){if(e===t)return!0;if(null==e||null==t)return!1;if(e.length!==t.length)return!1;for(var n=Ze([],Ye(e),!1).sort(),r=Ze([],Ye(t),!1).sort(),i=0;i<n.length;++i)if(n[i]!==r[i])return!1;return!0}(s,l))return!1}}if(!this.includeEmpty&&!e.lastMessage)return!1;if(!this.includeFrozen&&e.isFrozen)return!1;if(this.customTypesFilter&&this.customTypesFilter.length>0&&!this.customTypesFilter.includes("*")&&!this.customTypesFilter.includes(e.customType))return!1;if(this.customTypeStartsWithFilter&&!new RegExp("^".concat(this.customTypeStartsWithFilter)).test(e.customType))return!1;if(this.channelNameContainsFilter&&!e.name.toLowerCase().includes(this.channelNameContainsFilter.toLowerCase()))return!1;if(this.nicknameContainsFilter){var c=this.nicknameContainsFilter.toLowerCase();if(!e.members.some((function(e){return e.userId!==t&&e.nickname.toLowerCase().includes(c)})))return!1}if(this.nicknameStartsWithFilter){var d=this.nicknameStartsWithFilter.toLowerCase();if(!e.members.some((function(e){return e.userId!==t&&e.nickname.toLowerCase().startsWith(d)})))return!1}if(this.nicknameExactMatchFilter){var h=this.nicknameExactMatchFilter.toLowerCase();if(!e.members.some((function(e){return e.userId!==t&&e.nickname.toLowerCase()!=h})))return!1}if(this.channelUrlsFilter&&this.channelUrlsFilter.length>0&&!this.channelUrlsFilter.includes(e.url))return!1;if(this.myMemberStateFilter)switch(this.myMemberStateFilter){case Up.JOINED:if("joined"!==e.myMemberState)return!1;break;case Up.INVITED:if("invited"!==e.myMemberState)return!1;break;case Up.INVITED_BY_FRIEND:if("invited"!==e.myMemberState||!this._isFriend(e.inviter))return!1;break;case Up.INVITED_BY_NON_FRIEND:if("invited"!==e.myMemberState||this._isFriend(e.inviter))return!1}if(this.hiddenChannelFilter)switch(this.hiddenChannelFilter){case Lp.UNHIDDEN:if(e.isHidden||"unhidden"!==e.hiddenState)return!1;break;case Lp.HIDDEN:if(!e.isHidden)return!1;break;case Lp.HIDDEN_ALLOW_AUTO_UNHIDE:if(!e.isHidden||"hidden_allow_auto_unhide"!==e.hiddenState)return!1;break;case Lp.HIDDEN_PREVENT_AUTO_UNHIDE:if(!e.isHidden||"hidden_prevent_auto_unhide"!==e.hiddenState)return!1}if(this.unreadChannelFilter&&this.unreadChannelFilter===Dp.UNREAD_MESSAGE&&0===e.unreadMessageCount)return!1;if(this.publicChannelFilter)switch(this.publicChannelFilter){case Mp.PUBLIC:if(!e.isPublic)return!1;break;case Mp.PRIVATE:if(e.isPublic)return!1}if(this.superChannelFilter)switch(this.superChannelFilter){case Op.SUPER:if(!e.isSuper)return!1;break;case Op.NON_SUPER:if(e.isSuper)return!1}return!(this.createdAfter&&e.createdAt<this.createdAfter)&&!(this.createdBefore&&e.createdAt>this.createdBefore)},e}(),Vp=function(e){function t(t,n){var r=n.sdkState,i=n.cacheContext,a=e.call(this,t)||this;return a._channels=new Map,a._sdkState=r,a._cacheContext=i,a}return Be(t,e),Object.defineProperty(t.prototype,"collection",{get:function(){var e=this._cacheContext.nestdb;return hs(!!e).throw(st.databaseError),e.collection(Lc)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"localCacheEnabled",{get:function(){return this._cacheContext.localCacheEnabled&&!!this.collection},enumerable:!1,configurable:!0}),t.prototype._serialize=function(e,t){return void 0===t&&(t=0),je(je({},e.serialize()),{lastMessageUpdatedAt:e.lastMessage?e.lastMessage.createdAt:0,syncIndex:t})},t.prototype._deserialize=function(e){return J_.of(this._iid).buildGroupChannelFromSerializedData(e)},Object.defineProperty(t.prototype,"channels",{get:function(){return Ze([],Ye(this._channels.values()),!1)},enumerable:!1,configurable:!0}),t.prototype.isCachedInMemory=function(e){return this._channels.has(e)},t.prototype.filterOffsetChanged=function(e){var t=this;return e.filter((function(e){if(t._channels.has(e.url))return t._channels.get(e.url).messageOffsetTimestamp<e.messageOffsetTimestamp}))},t.prototype.get=function(e){return Qe(this,void 0,void 0,(function(){var t,n;return Ke(this,(function(r){switch(r.label){case 0:return this._channels.has(e)?[3,3]:this.localCacheEnabled?[4,this.collection.getByKey(e)]:[3,2];case 1:if(t=r.sent())return n=this._deserialize(t),this._channels.set(e,n),[2,n];r.label=2;case 2:return[2,void 0];case 3:return[2,this._channels.get(e)]}}))}))},t.prototype.fetch=function(e){var t=e.token,n=e.limit,r=void 0===n?100:n,i=e.backward,a=void 0!==i&&i,s=e.filter,o=void 0===s?new qp:s,u=e.order,l=void 0===u?bh.LATEST_LAST_MESSAGE:u,c=e.borderlineChannelUrl;return Qe(this,void 0,void 0,(function(){var e,n,i,s,u=this;return Ke(this,(function(d){switch(d.label){case 0:return this.localCacheEnabled?(e=kh(l),n={where:function(e){if(t)switch(l){case bh.CHANNEL_NAME_ALPHABETICAL:if(!a&&e.name.localeCompare(t)<0||a&&e.name.localeCompare(t)>0)return!1;if(c&&c===e.url)return!1;break;case bh.CHRONOLOGICAL:if(!a&&e.createdAt>t||a&&e.createdAt<t)return!1;if(c&&c===e.url)return!1;break;case bh.LATEST_LAST_MESSAGE:if(!a&&e.lastMessageUpdatedAt>t||a&&e.lastMessageUpdatedAt<t)return!1;if(c&&c===e.url)return!1}return o.match(u._deserialize(e),u._sdkState.userId)},index:e,backward:a},[4,this.collection.query(n)]):[3,3];case 1:return[4,d.sent().fetch({limit:r})];case 2:return i=d.sent(),(s=i.map((function(e){return u._deserialize(e)}))).forEach((function(e){u._channels.has(e.url)||u._channels.set(e.url,e)})),[2,s];case 3:return[2,[]]}}))}))},t.prototype.upsert=function(e,t){return Qe(this,void 0,void 0,(function(){var n,r,i,a=this;return Ke(this,(function(s){switch(s.label){case 0:if(n=[],e.forEach((function(e){if(a._channels.has(e.url)){var r=a._channels.get(e.url);r._pinnedMessagesUpdatedAt<e._pinnedMessagesUpdatedAt&&(r._pinnedMessagesUpdatedAt=e._pinnedMessagesUpdatedAt),r._messageCollectionLastAccessedAt>e._messageCollectionLastAccessedAt&&Object.assign(e,{_messageCollectionLastAccessedAt:void 0}),e.cachedMetaData&&t&&(r._updateCachedMetaData(e.cachedMetaData,t),Object.assign(e,{_cachedMetaData:void 0})),r._update(e),n.push(r)}else a._channels.set(e.url,e),n.push(e)})),!this.localCacheEnabled)return[3,2];for(i in r=[],n)r.push(this._serialize(n[i],parseInt(i)));return[4,this.collection.upsertMany(r)];case 1:s.sent(),s.label=2;case 2:return[2,n]}}))}))},t.prototype.remove=function(e){return Qe(this,void 0,void 0,(function(){var t,n,r,i,a,s;return Ke(this,(function(o){switch(o.label){case 0:o.trys.push([0,5,6,7]),t=We(e),n=t.next(),o.label=1;case 1:return n.done?[3,4]:(r=n.value,this._channels.delete(r),this.localCacheEnabled?[4,this.collection.remove(r)]:[3,3]);case 2:o.sent(),o.label=3;case 3:return n=t.next(),[3,1];case 4:return[3,7];case 5:return i=o.sent(),a={error:i},[3,7];case 6:try{n&&!n.done&&(s=t.return)&&s.call(t)}finally{if(a)throw a.error}return[7];case 7:return[2]}}))}))},t.prototype.clear=function(){return Qe(this,void 0,void 0,(function(){return Ke(this,(function(e){switch(e.label){case 0:return this.clearMemoryCache(),this.localCacheEnabled?[4,this.collection.clear()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))}))},t.prototype.clearMemoryCache=function(){this._channels.clear()},t.prototype._setBlockStateOfAllChannels=function(e,t,n){return Qe(this,void 0,void 0,(function(){var r,i,a,s,o,u,l,c,d,h,f,p,_,v,m,g,y,E,b;return Ke(this,(function(C){switch(C.label){case 0:if(r=[],e===this._sdkState.userId)try{for(i=We(this._channels.values()),a=i.next();!a.done;a=i.next()){c=a.value;try{for(v=void 0,s=We(c.members),o=s.next();!o.done;o=s.next())if((f=o.value).userId===t){f.isBlockedByMe=n,r.push(c);break}}catch(e){v={error:e}}finally{try{o&&!o.done&&(m=s.return)&&m.call(s)}finally{if(v)throw v.error}}}}catch(e){p={error:e}}finally{try{a&&!a.done&&(_=i.return)&&_.call(i)}finally{if(p)throw p.error}}else if(t===this._sdkState.userId)try{for(u=We(this._channels.values()),l=u.next();!l.done;l=u.next()){c=l.value;try{for(E=void 0,d=We(c.members),h=d.next();!h.done;h=d.next())if((f=h.value).userId===e){f.isBlockingMe=n,r.push(c);break}}catch(e){E={error:e}}finally{try{h&&!h.done&&(b=d.return)&&b.call(d)}finally{if(E)throw E.error}}}}catch(e){g={error:e}}finally{try{l&&!l.done&&(y=u.return)&&y.call(u)}finally{if(g)throw g.error}}return r.length>0?[4,this.upsert(r)]:[3,2];case 1:C.sent(),C.label=2;case 2:return[2]}}))}))},t.prototype.block=function(e,t){return Qe(this,void 0,void 0,(function(){return Ke(this,(function(n){switch(n.label){case 0:return[4,this._setBlockStateOfAllChannels(e,t,!0)];case 1:return n.sent(),[2]}}))}))},t.prototype.unblock=function(e,t){return Qe(this,void 0,void 0,(function(){return Ke(this,(function(n){switch(n.label){case 0:return[4,this._setBlockStateOfAllChannels(e,t,!1)];case 1:return n.sent(),[2]}}))}))},t.prototype.markAsRead=function(e,t){return void 0===t&&(t=Ze([],Ye(this._channels.keys()),!1)),Qe(this,void 0,void 0,(function(){var n,r,i,a,s,o,u,l;return Ke(this,(function(c){switch(c.label){case 0:n=[],c.label=1;case 1:c.trys.push([1,6,7,8]),r=We(t),i=r.next(),c.label=2;case 2:return i.done?[3,5]:(a=i.value,[4,this.get(a)]);case 3:(null==(s=c.sent())?void 0:s._updateUnreadMemberState(this._sdkState.userId,e))&&(s._updateUnreadCount(0,0),n.push(s)),c.label=4;case 4:return i=r.next(),[3,2];case 5:return[3,8];case 6:return o=c.sent(),u={error:o},[3,8];case 7:try{i&&!i.done&&(l=r.return)&&l.call(r)}finally{if(u)throw u.error}return[7];case 8:return n.length>0?[4,this.upsert(n)]:[3,10];case 9:c.sent(),c.label=10;case 10:return[2]}}))}))},t}(ns),Gp={invitedUserIds:void 0,channelUrl:void 0,coverUrl:void 0,coverImage:void 0,isDistinct:void 0,isSuper:void 0,isBroadcast:void 0,isExclusive:void 0,isPublic:void 0,isDiscoverable:void 0,isStrict:void 0,isEphemeral:void 0,accessCode:void 0,name:void 0,data:void 0,customType:void 0,operatorUserIds:void 0,messageSurvivalSeconds:void 0},Bp=function(e){return ft("string",e.invitedUserIds,!0)&&ct("string",e.channelUrl,!0)&&ct("string",e.coverUrl,!0)&&(vt(e.coverImage)||ct("string",e.coverImage,!0))&&ct("boolean",e.isDistinct,!0)&&ct("boolean",e.isSuper,!0)&&ct("boolean",e.isBroadcast,!0)&&ct("boolean",e.isExclusive,!0)&&ct("boolean",e.isPublic,!0)&&ct("boolean",e.isStrict,!0)&&ct("boolean",e.isDiscoverable,!0)&&ct("boolean",e.isEphemeral,!0)&&ct("string",e.accessCode,!0)&&ct("string",e.name,!0)&&ct("string",e.data,!0)&&ct("string",e.customType,!0)&&ft("string",e.operatorUserIds,!0)&&ct("number",e.messageSurvivalSeconds,!0)},jp={customTypes:void 0,includeEmpty:!1,includeFrozen:!0,includeChatNotification:!1},Qp=function(e){return ft("string",e.customTypes,!0)&&ct("boolean",e.includeEmpty)&&ct("boolean",e.includeFrozen)&&ct("boolean",e.includeChatNotification)},Kp={myMemberStateFilter:Up.ALL},Wp=function(e){return dt(Up,e.myMemberStateFilter)};!function(e){e.GROUP_CHANNEL_UNREAD_MENTION_COUNT="group_channel_unread_mention_count",e.NONSUPER_UNREAD_MENTION_COUNT="non_super_group_channel_unread_mention_count",e.SUPER_UNREAD_MENTION_COUNT="super_group_channel_unread_mention_count",e.GROUP_CHANNEL_UNREAD_MESSAGE_COUNT="group_channel_unread_message_count",e.NONSUPER_UNREAD_MESSAGE_COUNT="non_super_group_channel_unread_message_count",e.SUPER_UNREAD_MESSAGE_COUNT="super_group_channel_unread_message_count",e.GROUP_CHANNEL_INVITATION_COUNT="group_channel_invitation_count",e.NONSUPER_INVITATION_COUNT="non_super_group_channel_invitation_count",e.SUPER_INVITATION_COUNT="super_group_channel_invitation_count"}(Hp||(Hp={}));var Yp={keys:[]},Zp={channelCustomTypesFilter:void 0,superChannelFilter:Op.ALL},Jp={channelUrl:void 0,scheduledStatus:void 0,messageTypeFilter:At.ALL},Xp=(je({},no),function(e){return e.startsWith("EVENT_")||e===no.SYNC_CHANNEL_CHANGELOGS||e===no.REFRESH_CHANNEL}),$p=function(e){function t(t){var n=t.channels,r=t.source,i=t.isWebSocketEventComing,a=void 0!==i&&i,s=t.data,o=void 0===s?null:s,u=t.ts,l=e.call(this)||this;return l.channels=n,l.source=r,l.isWebSocketEventComing=a,l.data=o,l.ts=u,l}return Be(t,e),t}(Ht),e_=function(e){function t(t){var n=t.channelUrls,r=t.source,i=t.isWebSocketEventComing,a=void 0!==i&&i,s=e.call(this)||this;return s.channelUrls=n,s.source=r,s.isWebSocketEventComing=a,s}return Be(t,e),t}(Ht),t_=function(){function e(e){var t=e.groupChannelCache,n=e.messageCache,r=e.unsentMessageCache,i=e.dispatcher,a=this;this._observers=new Map,i.on((function(e){return Qe(a,void 0,void 0,(function(){var i,a,s,o,u,l,c,d,h,f,p,_,v,m,g=this;return Ke(this,(function(y){switch(y.label){case 0:if(!(e instanceof $p))return[3,10];i=e.channels,p=e.source,_=e.isWebSocketEventComing,a=e.data,s=i.filter((function(e){return e instanceof om})),o=t.filterOffsetChanged(s),y.label=1;case 1:y.trys.push([1,6,7,8]),u=We(o),l=u.next(),y.label=2;case 2:return l.done?[3,5]:(c=l.value,[4,n.removeUnderOffset(c.url,c.messageOffsetTimestamp)]);case 3:y.sent(),y.label=4;case 4:return l=u.next(),[3,2];case 5:return[3,8];case 6:return d=y.sent(),v={error:d},[3,8];case 7:try{l&&!l.done&&(m=u.return)&&m.call(u)}finally{if(v)throw v.error}return[7];case 8:return[4,t.upsert(s,e.ts)];case 9:return h=y.sent(),_||this._broadcastUpdateEvent(h,p,a),[3,15];case 10:return e instanceof e_?(f=e.channelUrls,p=e.source,_=e.isWebSocketEventComing,[4,t.remove(f)]):[3,13];case 11:return y.sent(),[4,bs((function(){return Qe(g,void 0,void 0,(function(){var e,t,i,a,s,o;return Ke(this,(function(u){switch(u.label){case 0:u.trys.push([0,6,7,8]),e=We(f),t=e.next(),u.label=1;case 1:return t.done?[3,5]:(i=t.value,[4,n.removeMessagesOfChannel(i)]);case 2:return u.sent(),[4,r.removeMessagesOfChannel(i)];case 3:u.sent(),u.label=4;case 4:return t=e.next(),[3,1];case 5:return[3,8];case 6:return a=u.sent(),s={error:a},[3,8];case 7:try{t&&!t.done&&(o=e.return)&&o.call(e)}finally{if(s)throw s.error}return[7];case 8:return[2]}}))}))}))];case 12:return y.sent(),_||this._broadcastRemoveEvent(f,p),[3,15];case 13:return e instanceof Lh?[4,t.fetch({token:Number.MAX_SAFE_INTEGER,limit:Number.MAX_SAFE_INTEGER})]:[3,15];case 14:y.sent(),y.label=15;case 15:return[2]}}))}))}))}return e.prototype._broadcastUpdateEvent=function(e,t,n){var r,i;try{for(var a=We(this._observers.values()),s=a.next();!s.done;s=a.next()){var o=s.value;o.onUpdate&&o.onUpdate(e,t,n)}}catch(e){r={error:e}}finally{try{s&&!s.done&&(i=a.return)&&i.call(a)}finally{if(r)throw r.error}}},e.prototype._broadcastRemoveEvent=function(e,t){var n,r;try{for(var i=We(this._observers.values()),a=i.next();!a.done;a=i.next()){var s=a.value;s.onRemove&&s.onRemove(e,t)}}catch(e){n={error:e}}finally{try{a&&!a.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}},e.prototype.subscribe=function(e,t){this._observers.set(e,t)},e.prototype.unsubscribe=function(e){this._observers.delete(e)},e.prototype.unsubscribeAll=function(){this._observers.clear()},e}(),n_=function(e){function t(t){var n=t.userId,r=t.ts,i=t.token,a=t.filter,s=t.includeChatNotification,o=void 0!==s&&s,u=e.call(this)||this,l=je(je({},jp),a),c=l.customTypes,d=l.includeEmpty,h=l.includeFrozen;return u.method=Gt.GET,u.path="".concat(jt,"/").concat(encodeURIComponent(n),"/my_group_channels/changelogs"),u.params=qt(Vt({show_delivery_receipt:!0,show_member:!0,show_read_receipt:!0,change_ts:r||null,token:i,custom_types:c,show_empty:d,show_frozen:h,include_chat_notification:o})),u}return Be(t,e),t}(hn),r_=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.updatedChannels=n.updated.map((function(e){return new om(t,Object.assign(e,{ts:n.ts}))})),r.deletedChannelUrls=n.deleted,r.hasMore=n.has_more,r.token=n.next,r.ts=n.ts,r}return Be(t,e),t}(fn),i_=function(e){function t(t){var n=t.channelUrl,r=t.isInternalCall,i=e.call(this)||this;return i.method=Gt.GET,i.path="".concat(r?Wt:Kt,"/").concat(encodeURIComponent(n)),i.params={show_member:!0,show_read_receipt:!0,show_delivery_receipt:!0},i}return Be(t,e),t}(hn),a_=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.channel=new om(t,n),r}return Be(t,e),t}(fn),s_={includeEmpty:!1,includeFrozen:!0,includeMetaData:!0,includeChatNotification:!1,channelUrlsFilter:void 0,customTypesFilter:void 0,customTypeStartsWithFilter:void 0,nicknameContainsFilter:void 0,nicknameStartsWithFilter:void 0,nicknameExactMatchFilter:void 0,channelNameContainsFilter:void 0,myMemberStateFilter:Up.ALL,unreadChannelFilter:Dp.ALL,superChannelFilter:Op.ALL,publicChannelFilter:Mp.ALL,hiddenChannelFilter:Lp.ALL,userIdsFilter:{userIds:[],includeMode:!0,queryType:xp.AND},searchFilter:{query:void 0,fields:[]},metadataKey:void 0,metadataValues:void 0,metadataOrderKeyFilter:void 0,metadataValueStartsWith:void 0,order:bh.LATEST_LAST_MESSAGE,createdAfter:void 0,createdBefore:void 0},o_=function(e){function t(t){var n=this,r=t.userId,i=t.token,a=t.limit,s=t.order,o=t.includeEmpty,u=t.myMemberStateFilter,l=t.superChannelFilter,c=t.publicChannelFilter,d=t.unreadChannelFilter,h=t.nicknameContainsFilter,f=t.nicknameStartsWithFilter,p=t.nicknameExactMatchFilter,_=t.channelNameContainsFilter,v=t.channelUrlsFilter,m=t.customTypesFilter,g=t.customTypeStartsWithFilter,y=t.hiddenChannelFilter,E=t.metadataOrderKeyFilter,b=t.metadataKey,C=t.metadataValues,w=t.metadataValueStartsWith,S=t.includeFrozen,T=t.includeMetaData,I=t.searchFilter,N=t.userIdsFilter,A=t.includeChatNotification,k=void 0!==A&&A,M=t.createdAfter,U=t.createdBefore;return(n=e.call(this)||this).method=Gt.GET,n.path="".concat(jt,"/").concat(encodeURIComponent(r),"/my_group_channels"),n.params=qt({token:i,limit:a,order:null!=s?s:s_.order,show_member:!0,show_read_receipt:!0,show_delivery_receipt:!0,show_empty:null!=o?o:s_.includeEmpty,member_state_filter:null!=u?u:s_.myMemberStateFilter,super_mode:null!=l?l:s_.superChannelFilter,public_mode:null!=c?c:s_.publicChannelFilter,unread_filter:null!=d?d:s_.unreadChannelFilter,members_nickname_contains:h,members_nickname_startswith:f,members_nickname:p,name_contains:_,channel_urls:v,custom_types:m,custom_type_startswith:g,hidden_mode:y,metadata_order_key:E,metadata_key:b,metadata_values:C,metadata_value_startswith:w,show_frozen:S,show_metadata:T,include_chat_notification:k,created_after:M,created_before:U}),I&&I.query&&I.fields&&(n.params.search_query=I.query,n.params.search_fields=I.fields),N&&N.userIds&&N.userIds.length>0&&(N.includeMode?(n.params.members_include_in=N.userIds,n.params.query_type=N.queryType.toUpperCase()):n.params.members_exactly_in=N.userIds),n}return Be(t,e),t}(hn),u_=function(e){function t(t,n){var r=e.call(this,t,n)||this;r.channels=[];var i=n.next,a=n.channels,s=n.ts;return r.token=i,a&&a.length>0&&(r.channels=a.map((function(e){return e.ts=s,new om(t,e)}))),r.ts=null!=s?s:0,r}return Be(t,e),t}(fn),l_=function(e){function t(t){var n=t.userId,r=t.filter,i=e.call(this)||this,a=r.myMemberStateFilter;return i.method=Gt.GET,i.path="".concat(jt,"/").concat(encodeURIComponent(n),"/group_channel_count"),i.params={state:null!=a?a:Up.ALL},i}return Be(t,e),t}(hn),c_=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.groupChannelCount=n.group_channel_count,r}return Be(t,e),t}(fn),d_=function(e){function t(t){var n=t.userId,r=t.filter,i=e.call(this)||this,a=r.keys;return i.method=Gt.GET,i.path="".concat(jt,"/").concat(encodeURIComponent(n),"/unread_item_count"),i.params=qt({item_keys:a}),i}return Be(t,e),t}(hn),h_=function(e){function t(t,n){var r=e.call(this,t,n)||this;return"number"==typeof n[Hp.GROUP_CHANNEL_UNREAD_MENTION_COUNT]&&(r.groupChannelUnreadMentionCount=n[Hp.GROUP_CHANNEL_UNREAD_MENTION_COUNT]),"number"==typeof n[Hp.GROUP_CHANNEL_UNREAD_MESSAGE_COUNT]&&(r.groupChannelUnreadMessageCount=n[Hp.GROUP_CHANNEL_UNREAD_MESSAGE_COUNT]),"number"==typeof n[Hp.GROUP_CHANNEL_INVITATION_COUNT]&&(r.groupChannelInvitationCount=n[Hp.GROUP_CHANNEL_INVITATION_COUNT]),"number"==typeof n[Hp.SUPER_UNREAD_MENTION_COUNT]&&(r.superGroupChannelUnreadMentionCount=n[Hp.SUPER_UNREAD_MENTION_COUNT]),"number"==typeof n[Hp.SUPER_UNREAD_MESSAGE_COUNT]&&(r.superGroupChannelUnreadMessageCount=n[Hp.SUPER_UNREAD_MESSAGE_COUNT]),"number"==typeof n[Hp.SUPER_INVITATION_COUNT]&&(r.superGroupChannelInvitationCount=n[Hp.SUPER_INVITATION_COUNT]),"number"==typeof n[Hp.NONSUPER_UNREAD_MENTION_COUNT]&&(r.nonSuperGroupChannelUnreadMentionCount=n[Hp.NONSUPER_UNREAD_MENTION_COUNT]),"number"==typeof n[Hp.NONSUPER_UNREAD_MESSAGE_COUNT]&&(r.nonSuperGroupChannelUnreadMessageCount=n[Hp.NONSUPER_UNREAD_MESSAGE_COUNT]),"number"==typeof n[Hp.NONSUPER_INVITATION_COUNT]&&(r.nonSuperGroupChannelInvitationCount=n[Hp.NONSUPER_INVITATION_COUNT]),r}return Be(t,e),t}(fn),f_=function(e){function t(t){var n=t.userId,r=e.call(this)||this;return r.method=Gt.GET,r.path="".concat(jt,"/").concat(encodeURIComponent(n),"/unread_channel_count"),r}return Be(t,e),t}(hn),p_=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.unreadCount=n.unread_count,r}return Be(t,e),t}(fn),__=function(e){function t(t){var n=t.userId,r=t.filter,i=t.includeFeedChannel,a=void 0!==i&&i,s=e.call(this)||this,o=r.channelCustomTypesFilter,u=r.superChannelFilter;return s.method=Gt.GET,s.path="".concat(jt,"/").concat(encodeURIComponent(n),"/unread_message_count"),s.params={super_mode:null!=u?u:Op.ALL,custom_types:o,include_feed_channel:a},s}return Be(t,e),t}(hn),v_=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.unreadCount=n.unread_count,r.unreadFeedCount=n.unread_feed_count,r}return Be(t,e),t}(fn),m_=function(e){function t(t){var n=t.channelUrl,r=t.scheduledStatus,i=t.messageTypeFilter,a=e.call(this)||this;return a.method=Gt.GET,a.path="".concat(nn,"/count"),a.params={channel_url:n,status:y_(r)},i&&(a.params.message_type=i),a}return Be(t,e),t}(hn),g_=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.count=n.count,r}return Be(t,e),t}(fn),y_=function(e){if(!e)return[];var t=[];return e.forEach((function(e){switch(e){case jo.PENDING:t.push(Qo.PENDING);break;case jo.SENT:t.push(Qo.IN_QUEUE),t.push(Qo.SENT);break;case jo.CANCELED:t.push(Qo.CANCELED);break;case jo.FAILED:t.push(Qo.FAILED)}})),t},E_=function(e){function t(t){var n=this,r=t.userId,i=t.channelUrl,a=t.coverUrl,s=t.coverImage,o=t.isDistinct,u=t.isSuper,l=t.isBroadcast,c=t.isPublic,d=t.isExclusive,h=t.isDiscoverable,f=t.isStrict,p=t.isEphemeral,_=t.accessCode,v=t.name,m=t.data,g=t.customType,y=t.messageSurvivalSeconds,E=t.invitedUserIds,b=t.operatorUserIds;return(n=e.call(this)||this).method=Gt.POST,n.path=Kt,n.params=qt({user_ids:Ze([r],Ye(null!=E?E:[]),!1).filter((function(e,t,n){return t===n.indexOf(e)})),channel_url:i,cover_url:a,cover_file:s,is_distinct:o,is_super:u,is_broadcast:l,is_exclusive:d,is_public:c,is_discoverable:h,strict:f,is_ephemeral:p,access_code:_,name:v,data:m,custom_type:g,operator_ids:b,message_survival_seconds:y}),n}return Be(t,e),t}(hn),b_=function(e){function t(t,n){var r,i=this;return(i=e.call(this,t,n)||this).channel=new om(t,n),i.isCreated=null===(r=n.is_created)||void 0===r||r,i}return Be(t,e),t}(fn),C_=function(e){function t(t){var n=t.userId,r=t.channelUrls,i=e.call(this)||this;return i.method=Gt.PUT,i.path="".concat(jt,"/").concat(encodeURIComponent(n),"/mark_as_read_all"),i.params={channel_urls:r},i}return Be(t,e),t}(hn);!function(e){Be((function(){return null!==e&&e.apply(this,arguments)||this}),e)}(fn);var w_=function(e){function t(t){var n=this,r=t.channelUrl,i=t.userId,a=t.accessCode;return(n=e.call(this)||this).method=Gt.PUT,n.path="".concat(Kt,"/").concat(encodeURIComponent(r),"/join"),n.params={user_id:i,access_code:a},n}return Be(t,e),t}(hn),S_=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.channel=new om(t,n),r}return Be(t,e),t}(fn),T_=function(e){function t(t,n,r){var i=e.call(this,t,n,r)||this,a=r.data,s=a.member_count,o=void 0===s?0:s,u=a.joined_member_count,l=void 0===u?0:u,c=a.users,d=void 0===c?null:c;return i.memberCount=o,i.joinedMemberCount=l,i.members=Array.isArray(d)?d.map((function(e){return new Fp(t,e)})):[new Fp(t,r.data)],i}return Be(t,e),t}(Zf),I_=function(e){function t(t){var n=this,r=t.channelUrl,i=t.userId,a=t.shouldRemoveOperatorStatus;return(n=e.call(this)||this).method=Gt.PUT,n.path="".concat(Kt,"/").concat(encodeURIComponent(r),"/leave"),n.params={user_id:i,should_remove_operator_status:a},n}return Be(t,e),t}(hn);!function(e){Be((function(t,n){return e.call(this,t,n)||this}),e)}(fn);var N_=function(e){function t(t,n,r){var i=e.call(this,t,n,r)||this,a=r.data,s=a.member_count,o=void 0===s?0:s,u=a.joined_member_count,l=void 0===u?0:u;return i.memberCount=o,i.joinedMemberCount=l,i.member=new Fp(i._iid,r.data),i}return Be(t,e),t}(Zf),A_=function(e){function t(t){var n=this,r=t.channelUrl,i=t.userIds;return(n=e.call(this)||this).method=Gt.POST,n.path="".concat(Kt,"/").concat(encodeURIComponent(r),"/invite"),n.params={user_ids:i},n}return Be(t,e),t}(hn),k_=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.channel=new om(t,n),r}return Be(t,e),t}(fn),M_=function(e){function t(t,n,r){var i=e.call(this,t,n,r)||this;i.inviter=null;var a=r.data,s=a.member_count,o=void 0===s?0:s,u=a.joined_member_count,l=void 0===u?0:u,c=a.inviter,d=a.invitees,h=void 0===d?[]:d;return i.memberCount=o,i.joinedMemberCount=l,c&&Object.keys(c).length>0&&(i.inviter=new ps(t,c)),i.invitees=h.map((function(e){return new Fp(t,e)})),i}return Be(t,e),t}(Zf),U_=function(e){function t(t){var n=this,r=t.channelUrl,i=t.userId;return(n=e.call(this)||this).method=Gt.PUT,n.path="".concat(Kt,"/").concat(encodeURIComponent(r),"/decline"),n.params={user_id:i},n}return Be(t,e),t}(hn);!function(e){Be((function(t,n){var r=e.call(this,t,n)||this;return r.channel=new om(t,n),r.channel.myMemberState=kp.NONE,r}),e)}(fn);var O_=function(e){function t(t,n,r){var i=e.call(this,t,n,r)||this,a=r.data,s=a.member_count,o=a.joined_member_count,u=a.inviter,l=a.invitee;return i.memberCount=null!=s?s:0,i.joinedMemberCount=null!=o?o:0,i.inviter=new ps(t,u),i.invitee=new Fp(t,l),i}return Be(t,e),t}(Zf),D_={hidePreviousMessages:!1,allowAutoUnhide:!0},L_=function(e){function t(t){var n=this,r=t.channelUrl,i=t.userId,a=t.hidePreviousMessages,s=t.allowAutoUnhide;return(n=e.call(this)||this).method=Gt.PUT,n.path="".concat(Kt,"/").concat(encodeURIComponent(r),"/hide"),n.params={user_id:i,hide_previous_messages:null!=a?a:D_.hidePreviousMessages,allow_auto_unhide:null!=s?s:D_.allowAutoUnhide},n}return Be(t,e),t}(hn),R_=function(e){function t(t,n){var r=e.call(this,t,n)||this,i=n.ts_message_offset;return r.messageOffsetTimestamp=i,r}return Be(t,e),t}(fn),x_=function(e){function t(t,n,r){var i,a,s,o=this;return(o=e.call(this,t,"SYEV",r)||this).allowAutoUnhide=null,o.hidePreviousMessages=null,o.messageOffsetTimestamp=null,r.data&&(o.allowAutoUnhide=null!==(i=r.data.allow_auto_unhide)&&void 0!==i?i:null,o.hidePreviousMessages=null!==(a=r.data.hide_previous_messages)&&void 0!==a?a:null),o.messageOffsetTimestamp=null!==(s=r.ts_message_offset)&&void 0!==s?s:null,o}return Be(t,e),t}(vn),P_=function(e){function t(t){var n=t.channelUrl,r=t.time;return e.call(this,{code:"TPST",ackRequired:!1,payload:{channel_url:n,time:r}})||this}return Be(t,e),t}(mn),F_=function(e){function t(t,n,r){var i=e.call(this,t,"SYEV",r)||this;return i.user=new ps(t,r.data),i}return Be(t,e),t}(vn),z_=function(e){function t(t){var n=t.channelUrl,r=t.time;return e.call(this,{code:"TPEN",ackRequired:!1,payload:{channel_url:n,time:r}})||this}return Be(t,e),t}(mn),H_=function(e){function t(t,n,r){var i=e.call(this,t,"SYEV",r)||this;return i.user=new ps(t,r.data),i}return Be(t,e),t}(vn),q_=function(e){function t(t){var n=t.channelUrl,r=t.messageId;return e.call(this,{code:"MACK",ackRequired:!1,payload:{channel_url:n,msg_id:r}})||this}return Be(t,e),t}(mn),V_=function(e){function t(t,n){var r,i,a,s,o,u,l,c,d,h,f,p,_,v,m,g,y,E,b,C,w,S,T,I=this;return(I=e.call(this,t,n)||this).includeEmpty=!1,I.includeFrozen=!0,I.includeMetaData=!0,I.includeChatNotification=!1,I.channelUrlsFilter=null,I.customTypesFilter=null,I.customTypeStartsWithFilter=null,I.nicknameContainsFilter=null,I.nicknameStartsWithFilter=null,I.nicknameExactMatchFilter=null,I.channelNameContainsFilter="",I.myMemberStateFilter=Up.ALL,I.unreadChannelFilter=Dp.ALL,I.superChannelFilter=Op.ALL,I.publicChannelFilter=Mp.ALL,I.hiddenChannelFilter=Lp.UNHIDDEN,I.searchFilter={fields:[],query:null},I.userIdsFilter={userIds:[],includeMode:!0,queryType:xp.AND},I.metadataKey=null,I.metadataValues=null,I.metadataOrderKeyFilter=null,I.metadataValueStartsWith=null,I.order=bh.LATEST_LAST_MESSAGE,I.includeEmpty=null!==(r=n.includeEmpty)&&void 0!==r&&r,I.includeFrozen=null===(i=n.includeFrozen)||void 0===i||i,I.includeMetaData=null===(a=n.includeMetaData)||void 0===a||a,I.includeChatNotification=null!==(s=n.includeChatNotification)&&void 0!==s&&s,I.channelUrlsFilter=null!==(o=n.channelUrlsFilter)&&void 0!==o?o:null,I.customTypesFilter=null!==(u=n.customTypesFilter)&&void 0!==u?u:null,I.customTypeStartsWithFilter=null!==(l=n.customTypeStartsWithFilter)&&void 0!==l?l:"",I.nicknameContainsFilter=null!==(c=n.nicknameContainsFilter)&&void 0!==c?c:null,I.nicknameStartsWithFilter=null!==(d=n.nicknameStartsWithFilter)&&void 0!==d?d:null,I.nicknameExactMatchFilter=null!==(h=n.nicknameExactMatchFilter)&&void 0!==h?h:null,I.channelNameContainsFilter=null!==(f=n.channelNameContainsFilter)&&void 0!==f?f:"",I.myMemberStateFilter=null!==(p=n.myMemberStateFilter)&&void 0!==p?p:Up.ALL,I.unreadChannelFilter=null!==(_=n.unreadChannelFilter)&&void 0!==_?_:Dp.ALL,I.superChannelFilter=null!==(v=n.superChannelFilter)&&void 0!==v?v:Op.ALL,I.publicChannelFilter=null!==(m=n.publicChannelFilter)&&void 0!==m?m:Mp.ALL,I.hiddenChannelFilter=null!==(g=n.hiddenChannelFilter)&&void 0!==g?g:Lp.UNHIDDEN,I.searchFilter=null!==(y=n.searchFilter)&&void 0!==y?y:{fields:[],query:null},I.userIdsFilter=null!==(E=n.userIdsFilter)&&void 0!==E?E:{userIds:[],includeMode:!0,queryType:xp.AND},I.metadataKey=null!==(b=n.metadataKey)&&void 0!==b?b:null,I.metadataValues=null!==(C=n.metadataValues)&&void 0!==C?C:null,I.metadataOrderKeyFilter=null!==(w=n.metadataOrderKeyFilter)&&void 0!==w?w:null,I.metadataValueStartsWith=null!==(S=n.metadataValueStartsWith)&&void 0!==S?S:null,I.order=null!==(T=n.order)&&void 0!==T?T:bh.LATEST_LAST_MESSAGE,n.createdAfter&&(I.createdAfter=n.createdAfter),n.createdBefore&&(I.createdBefore=n.createdBefore),I}return Be(t,e),t.prototype._validate=function(){return e.prototype._validate.call(this)&&ct("boolean",this.includeEmpty)&&ct("boolean",this.includeFrozen)&&ct("boolean",this.includeMetaData)&&ct("string",this.channelNameContainsFilter)&&ft("string",this.channelUrlsFilter,!0)&&ft("string",this.customTypesFilter,!0)&&ct("string",this.customTypeStartsWithFilter)&&ct("string",this.nicknameContainsFilter,!0)&&ct("string",this.nicknameStartsWithFilter,!0)&&ct("string",this.nicknameExactMatchFilter,!0)&&dt(Up,this.myMemberStateFilter)&&dt(Op,this.superChannelFilter)&&dt(Mp,this.publicChannelFilter)&&dt(Dp,this.unreadChannelFilter)&&dt(Lp,this.hiddenChannelFilter)&&ft(Pp,this.searchFilter.fields)&&ct("string",this.searchFilter.query,!0)&&ft("string",this.userIdsFilter.userIds)&&ct("boolean",this.userIdsFilter.includeMode)&&dt(xp,this.userIdsFilter.queryType)&&dt(bh,this.order)&&ct("string",this.metadataOrderKeyFilter,!0)&&ct("string",this.metadataKey,!0)&&ft("string",this.metadataValues,!0)&&ct("string",this.metadataValueStartsWith,!0)&&pt(this.createdAfter,!0)&&pt(this.createdBefore,!0)},t.prototype.serialize=function(){return cs(this)},t.prototype.next=function(){return Qe(this,void 0,void 0,(function(){var e,t,n;return Ke(this,(function(r){switch(r.label){case 0:return this._validate()?this._isLoading?[3,3]:this._hasNext?(this._isLoading=!0,[4,J_.of(this._iid).getMyGroupChannels(this._token,Vt(je({},this)),this.limit)]):[3,2]:[3,5];case 1:return e=r.sent(),t=e.channels,n=e.token,this._token=n,this._hasNext=!!n,this._isLoading=!1,[2,t];case 2:return[2,[]];case 3:throw st.queryInProgress;case 4:return[3,6];case 5:throw st.invalidParameters;case 6:return[2]}}))}))},t}(mo),G_=function(e){function t(t,n,r){var i,a=this;return(a=e.call(this,t,"SYEV",r)||this).pinnedMessageIds=[],a.latestPinnedMessage=null,a.ts=0,r.data&&(a.pinnedMessageIds=null!==(i=r.data.pinned_message_ids)&&void 0!==i?i:[],a.latestPinnedMessage=r.data.latest_pinned_message?gu(t,je({},r.data.latest_pinned_message)):null),a.ts=r.ts,a}return Be(t,e),t}(vn),B_=function(e){function t(t){var n=t.channelUrl;return e.call(this,{code:"READ",ackRequired:!0,payload:{channel_url:n}})||this}return Be(t,e),t}(mn),j_=(function(e){function t(t){var n=t.channelUrl,r=t.channelType,i=t.userId,a=e.call(this)||this;return a.method=Gt.PUT,a.path="".concat(sn(r),"/").concat(encodeURIComponent(n),"/messages/mark_as_read"),a.params=qt(Vt({user_id:encodeURIComponent(i)})),a}Be(t,e)}(hn),function(e){function t(t){var n=t.channelUrl,r=t.channelType,i=t.userId,a=t.notificationIds,s=e.call(this)||this;return s.method=Gt.PUT,s.path="".concat(sn(r),"/").concat(encodeURIComponent(n),"/messages/mark_as_read"),s.params=qt(Vt({user_id:encodeURIComponent(i),message_ids:a})),s}Be(t,e)}(hn),function(e){function t(t,n,r){var i=e.call(this,t,"READ",r)||this;return i.readStatus=new zp(t,r),i}return Be(t,e),t}(vn)),Q_=(function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.readAt=n.ts,r.unreadMessageCount=n.unread_message_count,r}Be(t,e)}(fn),function(e){function t(t){var n=t.channelUrl,r=t.userId,i=e.call(this)||this;return(i=e.call(this)||this).method=Gt.PUT,i.path="".concat(Kt,"/").concat(encodeURIComponent(n),"/messages/mark_as_delivered"),i.params=qt({userId:r}),i}return Be(t,e),t}(hn));!function(e){Be((function(){return null!==e&&e.apply(this,arguments)||this}),e)}(fn);var K_,W_=function(e){function t(t,n,r){var i=e.call(this,t,"DLVR",r)||this;return i.channelUrl=r.channel_url,i.deliveredStateUpdate=r.updated,i}return Be(t,e),t}(vn),Y_=function(){function e(e){var t=e.top,n=void 0===t?Number.MAX_SAFE_INTEGER:t,r=e.bottom,i=void 0===r?0:r;this.top=n,this.bottom=i}return e.prototype.includes=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return t.every((function(t){return e.top<=t&&t<=e.bottom}))},e.prototype.overlap=function(e){return this.includes(e.top)||this.includes(e.bottom)},e.prototype.intersect=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return t.some((function(t){return e.top<=t&&t<=e.bottom}))},e.prototype.extends=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.top=Math.min.apply(Math,Ze([this.top],Ye(e),!1)),this.bottom=Math.max.apply(Math,Ze([this.bottom],Ye(e),!1))},e}(),Z_={},J_=function(e){function t(t,n){var r,i=this;return(i=e.call(this,t,je(je({},n),{channelType:St.GROUP}))||this)._leftChannels=new Map,i._disableMack=!1,i._markAsReadAllLastSentAt=0,i._disableMack=null!==(r=n.disableMack)&&void 0!==r&&r,i._groupChannelHandlers=new Map,i._groupChannelCache=new Vp(i._iid,{sdkState:n.sdkState,cacheContext:n.cacheContext}),i._groupChannelBroadcast=new t_({dispatcher:n.dispatcher,groupChannelCache:i._groupChannelCache,messageCache:ch.of(i._iid),unsentMessageCache:uh.of(i._iid)}),setInterval((function(){var e,t,n=function(e){e.invalidateTypingStatus()&&(i._dispatcher.dispatch(new $p({channels:[e],source:no.EVENT_CHANNEL_TYPING_STATUS_UPDATE})),i._groupChannelHandlers.forEach((function(t){t.onTypingStatusUpdated&&t.onTypingStatusUpdated(e)})))};try{for(var r=We(i._groupChannelCache.channels),a=r.next();!a.done;a=r.next())n(a.value)}catch(t){e={error:t}}finally{try{a&&!a.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}}),1e3),i._dispatcher.on((function(e){e instanceof vn?i._handleEvent(e):e instanceof Mh?Qe(i,void 0,void 0,(function(){var t,n;return Ke(this,(function(r){switch(r.label){case 0:return t=e.message,[4,this.getChannel(t.channelUrl,!0)];case 1:return n=r.sent(),t instanceof hu?n._autoResendUserMessage(t):t instanceof yu&&n._autoResendFileMessage(t),[2]}}))})):e instanceof Rh&&i.reduceDBSize()})),Z_[t]||(Z_[t]=i),i}return Be(t,e),Object.defineProperty(t.prototype,"_messageCache",{get:function(){return ch.of(this._iid)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_unsentMessageCache",{get:function(){return uh.of(this._iid)},enumerable:!1,configurable:!0}),t.of=function(e){return Z_[e]||(Z_[e]=new t(e,eo.of(e))),Z_[e]},t.clear=function(e){Z_[e]&&delete Z_[e]},Object.defineProperty(t.prototype,"handlers",{get:function(){return Ze([],Ye(this._groupChannelHandlers.values()),!1)},enumerable:!1,configurable:!0}),t.prototype.buildGroupChannelFromSerializedData=function(e){var t=ds(e);return new om(this._iid,om.payloadify(t))},t.prototype.buildGroupChannelListQueryFromSerializedData=function(e){var t=ds(e);return new V_(this._iid,t)},t.prototype.buildMemberFromSerializedData=function(e){var t=ds(e);return new Fp(this._iid,Fp.payloadify(t))},t.prototype.getChannelFromCache=function(e){var t;return Qe(this,void 0,void 0,(function(){return Ke(this,(function(n){switch(n.label){case 0:return[4,this._groupChannelCache.get(e)];case 1:return[2,null!==(t=n.sent())&&void 0!==t?t:null]}}))}))},t.prototype.getChannelsFromCache=function(e,t,n,r,i){return Qe(this,void 0,void 0,(function(){return Ke(this,(function(a){switch(a.label){case 0:return[4,this._groupChannelCache.fetch({token:e,filter:t,order:n,limit:r,borderlineChannelUrl:i})];case 1:return[2,a.sent()]}}))}))},t.prototype.upsertChannelsToCache=function(e){return Qe(this,void 0,void 0,(function(){return Ke(this,(function(t){switch(t.label){case 0:return[4,this._groupChannelCache.upsert(e)];case 1:return[2,t.sent()]}}))}))},t.prototype.removeChannelsFromCache=function(e){return Qe(this,void 0,void 0,(function(){return Ke(this,(function(t){switch(t.label){case 0:return[4,this._groupChannelCache.remove(e)];case 1:return t.sent(),[2]}}))}))},t.prototype.clearChannelsFromCache=function(){return Qe(this,void 0,void 0,(function(){return Ke(this,(function(e){switch(e.label){case 0:return[4,this._groupChannelCache.clear()];case 1:return e.sent(),[2]}}))}))},t.prototype.reduceDBSize=function(){return Qe(this,void 0,void 0,(function(){var e,t,n,r,i,a,s,o,u,l,c,d,h,f,p;return Ke(this,(function(_){switch(_.label){case 0:return e=ch.of(this._iid),t=eo.of(this._iid).cacheContext,n=t.localCacheConfig,r=t.nestdb,t.localCacheEnabled&&r&&r.state==Zd.OPENED?(i=1024*n.maxSize*1024,[4,r.estimateUsage()]):[2];case 1:if((a=_.sent())<i)return[2];s=[],o=this._groupChannelCache.channels,u={},h=0,_.label=2;case 2:return h<o.length?[4,this.getMessagesFromCache(o[h].url,0,"prev",new th)]:[3,5];case 3:l=_.sent(),u[o[h].url]=JSON.stringify(l).length,c=new Ct({channel:o[h],cachedMessageCount:l.length}),s.push(c),_.label=4;case 4:return h++,[3,2];case 5:d=s.sort(n.clearOrderComparator),h=0,_.label=6;case 6:return h<d.length?[4,e.removeMessagesOfChannel(d[h].channel.url)]:[3,10];case 7:return _.sent(),[4,e._getGroupChannelPreferenceSize(d[h].channel.url)];case 8:if(f=_.sent(),p=u[d[h].channel.url]+f,(a-=p)<i)return[3,10];_.label=9;case 9:return h++,[3,6];case 10:return[2]}}))}))},t.prototype._handleEvent=function(e){var t;return Qe(this,void 0,void 0,(function(){var n,r,i,a,s,o,u,l,c,d,h,f,p,_,v,m,g,y,E,b,C,w,S,T,I,N,A,k,M,U,O,D,L,R,x,P,F,z,H,q,V,G,B,j,Q,K,W,Y,Z,J,X,$,ee,te,ne,re,ie,ae,se,oe,ue,le,ce,de,he,fe,pe,_e,ve,me,ge,ye,Ee,be,Ce,we,Se,Te,Ie,Ne,Ae,ke,Me,Ue,Oe,De,Le,Re,xe,Pe,Fe,ze,He,qe,Ve,Ge,Be,je,Ye,Ze,Je,Xe,$e,et,tt,nt,rt,it,st,ot,ut,lt,ct,dt,ht,ft,pt,_t,vt,mt,gt,yt,Et,bt,Ct,wt,Nt,At,kt,Mt,Ut,Ot,Dt,Lt,Rt,xt,Pt,Ft,zt=this;return Ke(this,(function(Ht){switch(Ht.label){case 0:switch(Ht.trys.push([0,80,,81]),e.code){case"MESG":case"FILE":case"ADMM":case"BRDM":return[3,1];case"MEDI":case"FEDI":case"AEDI":return[3,4];case"DELM":return[3,7];case"READ":return[3,10];case"DLVR":return[3,13];case"MRCT":return[3,15];case"MTHD":return[3,19];case"MCNT":return[3,23];case"PEDI":return[3,32];case"VOTE":return[3,35];case"SYEV":return[3,38];case"USEV":return[3,78]}return[3,79];case 1:return l=null,"MESG"===e.code?l=e.as(ac):"FILE"===e.code?l=e.as(wu):"ADMM"!==e.code&&"BRDM"!=e.code||(l=e.as($f)),l?(n=l.message,r=l.isMentioned,i=l.forceUpdateLastMessage,n.channelType!==St.GROUP?[3,3]:(this._disableMack||bs((function(){return Qe(zt,void 0,void 0,(function(){var e;return Ke(this,(function(t){return e=new q_(n),this._requestQueue.send(e),[2]}))}))})),I=this._groupChannelCache.isCachedInMemory(n.channelUrl),f=n instanceof au&&n.sender.userId===this._sdkState.userId,[4,this.getChannel(n.channelUrl,!0)])):[3,3];case 2:if((a=Ht.sent()).hiddenState===em.HIDDEN_ALLOW_AUTO_UNHIDE&&(a.hiddenState=em.UNHIDDEN),n instanceof au){s=eo.of(this._iid).useMemberInfoInMessage;try{for(o=We(a.members),u=o.next();!u.done;u=o.next())if((Fe=u.value).userId===n.sender.userId){s||(n.sender.nickname=Fe.nickname,n.sender.plainProfileUrl=Fe.plainProfileUrl,n.sender.metaData=Fe.metaData,n.sender.isBlockedByMe=Fe.isBlockedByMe);break}}catch(e){kt={error:e}}finally{try{u&&!u.done&&(Mt=o.return)&&Mt.call(o)}finally{if(kt)throw kt.error}}!s&&r&&(null===(t=n.mentionedUsers)||void 0===t||t.forEach((function(e){var t,n;try{for(var r=We(a.members),i=r.next();!i.done;i=r.next()){var s=i.value;if(e.userId===s.userId){e.nickname=s.nickname,e.plainProfileUrl=s.plainProfileUrl,e.metaData=s.metaData;break}}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}}))),f&&(v=this._sessionManager.currentUser)&&(v.nickname=n.sender.nickname,v.plainProfileUrl=n.sender.plainProfileUrl,v.metaData=n.sender.metaData)}n.silent&&!f||(a.isEphemeral||I)&&((!a.lastMessage||a.lastMessage.createdAt<n.createdAt)&&(a.lastMessage=n),f||a._updateUnreadCount(a.unreadMessageCount+1,a.unreadMentionCount+(r?1:0))),i&&(!a.lastMessage||a.lastMessage.createdAt<n.createdAt)&&(a.lastMessage=n),this._dispatcher.dispatch(new $p({channels:[a],source:no.EVENT_MESSAGE_RECEIVED})),n.silent&&!f||Es((function(){return Qe(zt,void 0,void 0,(function(){var e,t,n,r,i;return Ke(this,(function(s){try{for(e=We(this._groupChannelHandlers.values()),t=e.next();!t.done;t=e.next())(n=t.value).onChannelChanged&&n.onChannelChanged(a)}catch(e){r={error:e}}finally{try{t&&!t.done&&(i=e.return)&&i.call(e)}finally{if(r)throw r.error}}return[2]}))}))})),this._dispatcher.dispatch(new co({messages:[n],source:no.EVENT_MESSAGE_RECEIVED})),Es((function(){return Qe(zt,void 0,void 0,(function(){var e,t,i,s,o;return Ke(this,(function(u){try{for(e=We(this._groupChannelHandlers.values()),t=e.next();!t.done;t=e.next())(i=t.value).onMessageReceived&&i.onMessageReceived(a,n),r&&i.onMentionReceived&&i.onMentionReceived(a,n)}catch(e){s={error:e}}finally{try{t&&!t.done&&(o=e.return)&&o.call(e)}finally{if(s)throw s.error}}return[2]}))}))})),Ht.label=3;case 3:return[3,79];case 4:return l=null,"MEDI"===e.code?l=e.as(oc):"FEDI"===e.code?l=e.as(lc):"AEDI"===e.code&&(l=e.as(ep)),l?(c=l.message,d=l.mentionCountChange,c.channelType!==St.GROUP?[3,6]:(I=this._groupChannelCache.isCachedInMemory(c.channelUrl),[4,this.getChannel(c.channelUrl,!0)])):[3,6];case 5:h=Ht.sent(),f=c instanceof au&&c.sender.userId===this._sdkState.userId,p=!1,f?(_=c.sender,(v=this._sessionManager.currentUser)&&(v.nickname=_.nickname,v.plainProfileUrl=_.plainProfileUrl,v.metaData=_.metaData)):h.isReadMessage(c)||0!==d&&!c.silent&&I&&(h._updateUnreadCount(h.unreadMessageCount,h.unreadMentionCount+d),p=!0),!h.lastMessage||h.lastMessage.createdAt<c.createdAt?(h.lastMessage=c,p=!0):h.lastMessage.isIdentical(c)&&(I?h.lastMessage.updatedAt<c.updatedAt&&(h.lastMessage=c,p=!0):p=!0),m=!1,h.lastPinnedMessage&&h.lastPinnedMessage.messageId===c.messageId&&(h.lastPinnedMessage=c,p=!0,m=!0),p&&(this._dispatcher.dispatch(new $p({channels:[h],source:m?no.EVENT_PINNED_MESSAGE_UPDATED:no.EVENT_MESSAGE_UPDATED})),c.silent&&!f||Es((function(){return Qe(zt,void 0,void 0,(function(){var e,t,n,r,i;return Ke(this,(function(a){try{for(e=We(this._groupChannelHandlers.values()),t=e.next();!t.done;t=e.next())(n=t.value).onChannelChanged&&n.onChannelChanged(h)}catch(e){r={error:e}}finally{try{t&&!t.done&&(i=e.return)&&i.call(e)}finally{if(r)throw r.error}}return[2]}))}))})),m&&Es((function(){return Qe(zt,void 0,void 0,(function(){var e,t,n,r,i;return Ke(this,(function(a){try{for(e=We(this._groupChannelHandlers.values()),t=e.next();!t.done;t=e.next())(n=t.value).onPinnedMessageUpdated&&n.onPinnedMessageUpdated(h)}catch(e){r={error:e}}finally{try{t&&!t.done&&(i=e.return)&&i.call(e)}finally{if(r)throw r.error}}return[2]}))}))}))),this._dispatcher.dispatch(new co({messages:[c],source:no.EVENT_MESSAGE_UPDATED})),Es((function(){return Qe(zt,void 0,void 0,(function(){var e,t,n,r,i;return Ke(this,(function(a){try{for(e=We(this._groupChannelHandlers.values()),t=e.next();!t.done;t=e.next())(n=t.value).onMessageUpdated&&n.onMessageUpdated(h,c),0!==d&&n.onMentionReceived&&n.onMentionReceived(h,c)}catch(e){r={error:e}}finally{try{t&&!t.done&&(i=e.return)&&i.call(e)}finally{if(r)throw r.error}}return[2]}))}))})),Ht.label=6;case 6:return[3,79];case 7:return g=e.as(dc),Y=g.channelUrl,Z=g.channelType,y=g.messageId,Z!==St.GROUP?[3,9]:[4,this.getChannel(Y,!0)];case 8:E=Ht.sent(),this._dispatcher.dispatch(new ho({messageIds:[y],source:no.EVENT_MESSAGE_DELETED})),Es((function(){return Qe(zt,void 0,void 0,(function(){var e,t,n,r,i;return Ke(this,(function(a){try{for(e=We(this._groupChannelHandlers.values()),t=e.next();!t.done;t=e.next())(n=t.value).onMessageDeleted&&n.onMessageDeleted(E,y)}catch(e){r={error:e}}finally{try{t&&!t.done&&(i=e.return)&&i.call(e)}finally{if(r)throw r.error}}return[2]}))}))})),Ht.label=9;case 9:return[3,79];case 10:return(b=e.as(j_).readStatus).channelType!==St.GROUP?[3,12]:(I=this._groupChannelCache.isCachedInMemory(b.channelUrl),[4,this.getChannel(b.channelUrl,!0)]);case 11:C=Ht.sent(),I&&C._updateUnreadMemberState(b.reader.userId,b.readAt),b.reader.userId===this._sdkState.userId?I?(C.unreadMessageCount>0||C.unreadMentionCount>0)&&(C._updateUnreadCount(0,0),this._dispatcher.dispatch(new $p({channels:[C],source:no.EVENT_CHANNEL_READ})),Es((function(){return Qe(zt,void 0,void 0,(function(){var e,t,n,r,i;return Ke(this,(function(a){try{for(e=We(this._groupChannelHandlers.values()),t=e.next();!t.done;t=e.next())(n=t.value).onChannelChanged&&n.onChannelChanged(C)}catch(e){r={error:e}}finally{try{t&&!t.done&&(i=e.return)&&i.call(e)}finally{if(r)throw r.error}}return[2]}))}))}))):0!==C.unreadMessageCount&&0!==C.unreadMentionCount||(this._dispatcher.dispatch(new $p({channels:[C],source:no.EVENT_CHANNEL_READ})),Es((function(){return Qe(zt,void 0,void 0,(function(){var e,t,n,r,i;return Ke(this,(function(a){try{for(e=We(this._groupChannelHandlers.values()),t=e.next();!t.done;t=e.next())(n=t.value).onChannelChanged&&n.onChannelChanged(C)}catch(e){r={error:e}}finally{try{t&&!t.done&&(i=e.return)&&i.call(e)}finally{if(r)throw r.error}}return[2]}))}))}))):(this._dispatcher.dispatch(new $p({channels:[C],source:no.EVENT_CHANNEL_READ})),Es((function(){return Qe(zt,void 0,void 0,(function(){var e,t,n,r,i;return Ke(this,(function(a){try{for(e=We(this._groupChannelHandlers.values()),t=e.next();!t.done;t=e.next())(n=t.value).onUnreadMemberStatusUpdated&&n.onUnreadMemberStatusUpdated(C)}catch(e){r={error:e}}finally{try{t&&!t.done&&(i=e.return)&&i.call(e)}finally{if(r)throw r.error}}return[2]}))}))}))),Ht.label=12;case 12:return[3,79];case 13:return w=e.as(W_),Y=w.channelUrl,S=w.deliveredStateUpdate,T=void 0===S?{}:S,I=this._groupChannelCache.isCachedInMemory(Y),[4,this.getChannel(Y,!0)];case 14:if(N=Ht.sent(),I)for(A in T)N._updateUndeliveredMemberState(A,T[A]);return Object.keys(T).some((function(e){return e!==zt._sdkState.userId}))&&(this._dispatcher.dispatch(new $p({channels:[N],source:no.EVENT_CHANNEL_DELIVERED})),Es((function(){return Qe(zt,void 0,void 0,(function(){var e,t,n,r,i;return Ke(this,(function(a){try{for(e=We(this._groupChannelHandlers.values()),t=e.next();!t.done;t=e.next())(n=t.value).onUndeliveredMemberStatusUpdated&&n.onUndeliveredMemberStatusUpdated(N)}catch(e){r={error:e}}finally{try{t&&!t.done&&(i=e.return)&&i.call(e)}finally{if(r)throw r.error}}return[2]}))}))}))),[3,79];case 15:return k=e.as(tp),Y=k.channelUrl,Z=k.channelType,M=k.event,Z!==St.GROUP?[3,18]:[4,this.getChannel(Y,!0)];case 16:return U=Ht.sent(),[4,this.getMessageFromCache(M.messageId)];case 17:(L=Ht.sent())instanceof iu&&(L.applyReactionEvent(M),this._dispatcher.dispatch(new co({messages:[L],source:no.EVENT_MESSAGE_REACTION_UPDATED}))),Es((function(){return Qe(zt,void 0,void 0,(function(){var e,t,n,r,i;return Ke(this,(function(a){try{for(e=We(this._groupChannelHandlers.values()),t=e.next();!t.done;t=e.next())(n=t.value).onReactionUpdated&&n.onReactionUpdated(U,M)}catch(e){r={error:e}}finally{try{t&&!t.done&&(i=e.return)&&i.call(e)}finally{if(r)throw r.error}}return[2]}))}))})),Ht.label=18;case 18:return[3,79];case 19:return(O=e.as(np).event).channelType!==St.GROUP?[3,22]:[4,this.getChannel(O.channelUrl,!0)];case 20:return D=Ht.sent(),[4,this.getMessageFromCache(O.targetMessageId)];case 21:(L=Ht.sent())instanceof iu&&(L.applyThreadInfoUpdateEvent(O),this._dispatcher.dispatch(new co({messages:[L],source:no.EVENT_MESSAGE_THREADINFO_UPDATED}))),Es((function(){return Qe(zt,void 0,void 0,(function(){var e,t,n,r,i;return Ke(this,(function(a){try{for(e=We(this._groupChannelHandlers.values()),t=e.next();!t.done;t=e.next())(n=t.value).onThreadInfoUpdated&&n.onThreadInfoUpdated(D,O)}catch(e){r={error:e}}finally{try{t&&!t.done&&(i=e.return)&&i.call(e)}finally{if(r)throw r.error}}return[2]}))}))})),Ht.label=22;case 22:return[3,79];case 23:R=e.as(rp).groupChannelMemberCounts,x=[],Ht.label=24;case 24:Ht.trys.push([24,29,30,31]),P=We(R),F=P.next(),Ht.label=25;case 25:return F.done?[3,28]:(z=F.value,Y=z.channelUrl,Ie=z.memberCount,Ne=z.joinedMemberCount,H=z.updatedAt,[4,this.getChannelFromCache(Y)]);case 26:(q=Ht.sent())&&q._setLatestMemberCount(Ie,Ne,H)&&x.push(q),Ht.label=27;case 27:return F=P.next(),[3,25];case 28:return[3,31];case 29:return V=Ht.sent(),Ut={error:V},[3,31];case 30:try{F&&!F.done&&(Ot=P.return)&&Ot.call(P)}finally{if(Ut)throw Ut.error}return[7];case 31:return x.length>0&&(this._dispatcher.dispatch(new $p({channels:x,source:no.EVENT_CHANNEL_MEMBER_COUNT_UPDATED})),Es((function(){return Qe(zt,void 0,void 0,(function(){var e,t,n,r,i;return Ke(this,(function(a){try{for(e=We(this._groupChannelHandlers.values()),t=e.next();!t.done;t=e.next())(n=t.value).onChannelMemberCountChanged&&n.onChannelMemberCountChanged(x)}catch(e){r={error:e}}finally{try{t&&!t.done&&(i=e.return)&&i.call(e)}finally{if(r)throw r.error}}return[2]}))}))}))),[3,79];case 32:return G=e.as(ip),B=G.event,j=G.status,Y=G.channelUrl,Z=G.channelType,Y&&Z===St.GROUP?[4,this.getChannel(Y,!0)]:[3,34];case 33:Q=Ht.sent(),this._dispatcher.dispatch(new _o({event:B,source:no.EVENT_POLL_UPDATED})),Es(j===ro?function(){return Qe(zt,void 0,void 0,(function(){var e,t,n,r,i;return Ke(this,(function(a){try{for(e=We(this._groupChannelHandlers.values()),t=e.next();!t.done;t=e.next())(n=t.value).onPollDeleted&&n.onPollDeleted(Q,B.pollId)}catch(e){r={error:e}}finally{try{t&&!t.done&&(i=e.return)&&i.call(e)}finally{if(r)throw r.error}}return[2]}))}))}:function(){return Qe(zt,void 0,void 0,(function(){var e,t,n,r,i;return Ke(this,(function(a){try{for(e=We(this._groupChannelHandlers.values()),t=e.next();!t.done;t=e.next())(n=t.value).onPollUpdated&&n.onPollUpdated(Q,B)}catch(e){r={error:e}}finally{try{t&&!t.done&&(i=e.return)&&i.call(e)}finally{if(r)throw r.error}}return[2]}))}))}),Ht.label=34;case 34:return[3,79];case 35:return K=e.as(Dc),W=K.event,Y=K.channelUrl,Z=K.channelType,Y&&Z===St.GROUP?[4,this.getChannel(Y,!0)]:[3,37];case 36:J=Ht.sent(),this._dispatcher.dispatch(new vo({event:W,source:no.EVENT_POLL_VOTED})),Es((function(){return Qe(zt,void 0,void 0,(function(){var e,t,n,r,i;return Ke(this,(function(a){try{for(e=We(this._groupChannelHandlers.values()),t=e.next();!t.done;t=e.next())(n=t.value).onPollVoted&&n.onPollVoted(J,W)}catch(e){r={error:e}}finally{try{t&&!t.done&&(i=e.return)&&i.call(e)}finally{if(r)throw r.error}}return[2]}))}))})),Ht.label=37;case 37:return[3,79];case 38:if(!(X=e.as(Zf).event).isGroupChannelEvent)return[3,77];switch(X.category){case Pf.CHANNEL_JOIN:return[3,39];case Pf.CHANNEL_LEAVE:return[3,41];case Pf.CHANNEL_OPERATOR_UPDATE:return[3,45];case Pf.CHANNEL_INVITE:return[3,47];case Pf.CHANNEL_DECLINE_INVITE:return[3,49];case Pf.TYPING_START:case Pf.TYPING_END:return[3,51];case Pf.USER_CHANNEL_MUTE:case Pf.USER_CHANNEL_UNMUTE:return[3,53];case Pf.USER_CHANNEL_BAN:return[3,55];case Pf.USER_CHANNEL_UNBAN:return[3,59];case Pf.CHANNEL_FREEZE:case Pf.CHANNEL_UNFREEZE:return[3,61];case Pf.CHANNEL_HIDE:return[3,63];case Pf.CHANNEL_UNHIDE:return[3,65];case Pf.CHANNEL_DELETED:return[3,67];case Pf.CHANNEL_PROP_CHANGED:return[3,69];case Pf.CHANNEL_META_DATA_CHANGED:return[3,71];case Pf.CHANNEL_META_COUNTERS_CHANGED:return[3,73];case Pf.PINNED_MESSAGE_CHANGED:return[3,75]}return[3,77];case 39:return[4,this.getChannel(X.channelUrl,!0)];case 40:return $=Ht.sent(),ee=e.as(T_),te=ee.memberCount,ne=ee.joinedMemberCount,re=ee.members,ie=!1,re.forEach((function(e){$.isExclusive||$.isSuper||$.isBroadcast?ie=ie||$._setLatestMemberCount(te,ne,X.ts):(e.state=kp.JOINED,$.addMember(e,X.ts),zt._updateJoinedMemberCount($)),e.userId===zt._sdkState.userId&&($.myMemberState=kp.JOINED)})),this._dispatcher.dispatch(new $p({channels:[$],source:no.EVENT_CHANNEL_JOINED})),Es((function(){return Qe(zt,void 0,void 0,(function(){return Ke(this,(function(e){return this._groupChannelHandlers.forEach((function(e){var t,n;try{for(var r=We(re),i=r.next();!i.done;i=r.next()){var a=i.value;e.onUserJoined&&e.onUserJoined($,a)}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}$.isBroadcast&&ie&&e.onChannelMemberCountChanged&&e.onChannelMemberCountChanged([$])})),[2]}))}))})),[3,77];case 41:return(ze=this._leftChannels.get(X.channelUrl))?(se=ze.channel,[3,44]):[3,42];case 42:return[4,this.getChannel(X.channelUrl,!0)];case 43:se=Ht.sent(),Ht.label=44;case 44:return ae=se,oe=e.as(N_),Ie=oe.memberCount,Ne=oe.joinedMemberCount,ue=oe.member,le=!1,ce=eo.of(this._iid).appInfo,ae.isExclusive||ae.isSuper||ae.isBroadcast?le=ae._setLatestMemberCount(Ie,Ne,X.ts):((null==ce?void 0:ce.enabledChannelMemberShipHistory)?((de=ae.members.find((function(e){return e.userId===de.userId})))&&(de.state=kp.LEFT),ae.memberCount=Ie):ae.removeMember(ue),this._updateJoinedMemberCount(ae)),ue.userId===this._sdkState.userId?(ae.myMemberState=kp.NONE,ae.invitedAt=0,ae.joinedAt=0,ae._updateUnreadCount(0,0),ae.isPublic?this._dispatcher.dispatch(new $p({channels:[ae],source:no.EVENT_CHANNEL_LEFT})):(this._markAsLeave(ae),this._dispatcher.dispatch(new e_({channelUrls:[ae.url],source:no.EVENT_CHANNEL_LEFT})))):this._dispatcher.dispatch(new $p({channels:[ae],source:no.EVENT_CHANNEL_LEFT})),Es((function(){return Qe(zt,void 0,void 0,(function(){return Ke(this,(function(e){return this._groupChannelHandlers.forEach((function(e){e.onUserLeft&&e.onUserLeft(ae,ue),ae.isBroadcast&&le&&e.onChannelMemberCountChanged&&e.onChannelMemberCountChanged([ae])})),[2]}))}))})),[3,77];case 45:return[4,this.getChannel(X.channelUrl,!0)];case 46:he=Ht.sent(),fe=e.as(Jf).operators,pe=fe.map((function(e){return e.userId}));try{for(_e=We(he.members),ve=_e.next();!ve.done;ve=_e.next())(Fe=ve.value).role=pe.includes(Fe.userId)?Tt.OPERATOR:Tt.NONE}catch(e){Dt={error:e}}finally{try{ve&&!ve.done&&(Lt=_e.return)&&Lt.call(_e)}finally{if(Dt)throw Dt.error}}return he.myRole=pe.includes(this._sdkState.userId)?Tt.OPERATOR:Tt.NONE,this._dispatcher.dispatch(new $p({channels:[he],source:no.EVENT_CHANNEL_OPERATOR_UPDATED})),Es((function(){return Qe(zt,void 0,void 0,(function(){return Ke(this,(function(e){return this._groupChannelHandlers.forEach((function(e){e.onOperatorUpdated&&e.onOperatorUpdated(he,fe)})),[2]}))}))})),[3,77];case 47:return[4,this.getChannel(X.channelUrl,!0)];case 48:me=Ht.sent(),ge=e.as(M_),Ie=ge.memberCount,Ne=ge.joinedMemberCount,ye=ge.inviter,(Ee=ge.invitees).forEach((function(e){return e.state=kp.INVITED}));try{for(be=We(Ee),Ce=be.next();!Ce.done;Ce=be.next())we=Ce.value,me.isExclusive||me.isSuper||me.isBroadcast?me._setLatestMemberCount(Ie,Ne,X.ts):me.addMember(we,X.ts),this._sdkState.userId===we.userId&&(me.hiddenState=em.UNHIDDEN,me.myMemberState!==kp.JOINED&&(me.myMemberState=kp.INVITED),me.invitedAt=X.ts)}catch(e){Rt={error:e}}finally{try{Ce&&!Ce.done&&(xt=be.return)&&xt.call(be)}finally{if(Rt)throw Rt.error}}return this._dispatcher.dispatch(new $p({channels:[me],source:no.EVENT_CHANNEL_INVITED})),Es((function(){return Qe(zt,void 0,void 0,(function(){return Ke(this,(function(e){return this._groupChannelHandlers.forEach((function(e){e.onUserReceivedInvitation&&e.onUserReceivedInvitation(me,ye,Ee)})),[2]}))}))})),[3,77];case 49:return[4,this.getChannel(X.channelUrl,!0)];case 50:return Se=Ht.sent(),Te=e.as(O_),Ie=Te.memberCount,Ne=Te.joinedMemberCount,Ae=Te.inviter,ke=Te.invitee,Se.isExclusive||Se.isSuper||Se.isBroadcast?Se._setLatestMemberCount(Ie,Ne,X.ts):Se.removeMember(ke),this._sdkState.userId===ke.userId?(Se.invitedAt=0,Se.myMemberState=kp.NONE,Se.isPublic?this._dispatcher.dispatch(new $p({channels:[Se],source:no.EVENT_CHANNEL_DECLINED_INVITE})):this._dispatcher.dispatch(new e_({channelUrls:[Se.url],source:no.EVENT_CHANNEL_DECLINED_INVITE}))):this._dispatcher.dispatch(new $p({channels:[Se],source:no.EVENT_CHANNEL_DECLINED_INVITE})),Es((function(){return Qe(zt,void 0,void 0,(function(){return Ke(this,(function(e){return this._groupChannelHandlers.forEach((function(e){e.onUserDeclinedInvitation&&e.onUserDeclinedInvitation(Se,Ae,ke)})),[2]}))}))})),[3,77];case 51:return[4,this.getChannel(X.channelUrl,!0)];case 52:return Me=Ht.sent(),Ue=X.category===Pf.TYPING_START,Oe=e.as(Ue?F_:H_).user,Me._updateTypingStatus(Oe,Ue?X.ts:0),this._dispatcher.dispatch(new $p({channels:[Me],source:no.EVENT_CHANNEL_TYPING_STATUS_UPDATE})),Es((function(){return Qe(zt,void 0,void 0,(function(){return Ke(this,(function(e){return this._groupChannelHandlers.forEach((function(e){e.onTypingStatusUpdated&&e.onTypingStatusUpdated(Me)})),[2]}))}))})),[3,77];case 53:return[4,this.getChannel(X.channelUrl,!0)];case 54:De=Ht.sent(),Le=X.category===Pf.USER_CHANNEL_MUTE,(Re=e.as(Le?Ql:Wl).user).userId===this._sdkState.userId&&(De.myMutedState=Le?It.MUTED:It.UNMUTED,De._myMutedRemainingTime=Re.restrictionInfo.remainingDuration);try{for(xe=We(De.members),Pe=xe.next();!Pe.done;Pe=xe.next())if((Fe=Pe.value).userId===Re.userId){Fe.isMuted=Le;break}}catch(e){Pt={error:e}}finally{try{Pe&&!Pe.done&&(Ft=xe.return)&&Ft.call(xe)}finally{if(Pt)throw Pt.error}}return this._dispatcher.dispatch(new $p({channels:[De],source:Le?no.EVENT_CHANNEL_MUTED:no.EVENT_CHANNEL_UNMUTED,data:Re.userId})),Es((function(){return Qe(zt,void 0,void 0,(function(){return Ke(this,(function(e){return this._groupChannelHandlers.forEach((function(e){Le?e.onUserMuted&&e.onUserMuted(De,Re):e.onUserUnmuted&&e.onUserUnmuted(De,Re)})),[2]}))}))})),[3,77];case 55:return(ze=this._leftChannels.get(X.channelUrl))?(qe=ze.channel,[3,58]):[3,56];case 56:return[4,this.getChannel(X.channelUrl,!0)];case 57:qe=Ht.sent(),Ht.label=58;case 58:return He=qe,this._markAsLeave(He),(Ve=e.as(Zl).user).userId===this._sdkState.userId&&this._dispatcher.dispatch(new e_({channelUrls:[He.url],source:no.EVENT_CHANNEL_BANNED})),Es((function(){return Qe(zt,void 0,void 0,(function(){return Ke(this,(function(e){return this._groupChannelHandlers.forEach((function(e){e.onUserBanned&&e.onUserBanned(He,Ve)})),[2]}))}))})),[3,77];case 59:return[4,this.getChannel(X.channelUrl,!0)];case 60:return Ge=Ht.sent(),(Be=e.as(Xl).user).userId===this._sdkState.userId&&this._dispatcher.dispatch(new e_({channelUrls:[Ge.url],source:no.EVENT_CHANNEL_UNBANNED})),Es((function(){return Qe(zt,void 0,void 0,(function(){return Ke(this,(function(e){return this._groupChannelHandlers.forEach((function(e){e.onUserUnbanned&&e.onUserUnbanned(Ge,Be)})),[2]}))}))})),[3,77];case 61:return[4,this.getChannel(X.channelUrl,!0)];case 62:return je=Ht.sent(),Ye=e.as(ec).freeze,je.isFrozen=Ye,this._dispatcher.dispatch(new $p({channels:[je],source:Ye?no.EVENT_CHANNEL_FROZEN:no.EVENT_CHANNEL_UNFROZEN})),Es((function(){return Qe(zt,void 0,void 0,(function(){return Ke(this,(function(e){return this._groupChannelHandlers.forEach((function(e){Ye?e.onChannelFrozen&&e.onChannelFrozen(je):e.onChannelUnfrozen&&e.onChannelUnfrozen(je)})),[2]}))}))})),[3,77];case 63:return[4,this.getChannel(X.channelUrl,!0)];case 64:return Ze=Ht.sent(),Je=e.as(x_),Xe=Je.allowAutoUnhide,$e=Je.hidePreviousMessages,et=Je.messageOffsetTimestamp,null!==Xe&&(Ze.hiddenState=Xe?em.HIDDEN_ALLOW_AUTO_UNHIDE:em.HIDDEN_PREVENT_AUTO_UNHIDE),null!==$e&&$e&&Ze._updateUnreadCount(0,0),null!==et&&(Ze.messageOffsetTimestamp=et),this._dispatcher.dispatch(new $p({channels:[Ze],source:no.EVENT_CHANNEL_HIDDEN})),Es((function(){return Qe(zt,void 0,void 0,(function(){return Ke(this,(function(e){return this._groupChannelHandlers.forEach((function(e){e.onChannelHidden&&e.onChannelHidden(Ze)})),[2]}))}))})),[3,77];case 65:return[4,this.getChannel(X.channelUrl,!0)];case 66:return(tt=Ht.sent()).hiddenState=em.UNHIDDEN,this._dispatcher.dispatch(new $p({channels:[tt],source:no.EVENT_CHANNEL_UNHIDDEN})),Es((function(){return Qe(zt,void 0,void 0,(function(){return Ke(this,(function(e){return this._groupChannelHandlers.forEach((function(e){e.onChannelChanged&&e.onChannelChanged(tt)})),[2]}))}))})),[3,77];case 67:return[4,this.getChannel(X.channelUrl,!0)];case 68:return nt=Ht.sent(),this._dispatcher.dispatch(new e_({channelUrls:[X.channelUrl],source:no.EVENT_CHANNEL_DELETED})),Es((function(){return Qe(zt,void 0,void 0,(function(){return Ke(this,(function(e){return this._groupChannelHandlers.forEach((function(e){e.onChannelDeleted&&e.onChannelDeleted(nt.url,nt.channelType)})),[2]}))}))})),[3,77];case 69:return[4,this.getChannelWithoutCache(X.channelUrl,!0)];case 70:return rt=Ht.sent(),this._dispatcher.dispatch(new $p({channels:[rt],source:no.EVENT_CHANNEL_UPDATED})),Es((function(){return Qe(zt,void 0,void 0,(function(){return Ke(this,(function(e){return this._groupChannelHandlers.forEach((function(e){e.onChannelChanged&&e.onChannelChanged(rt)})),[2]}))}))})),[3,77];case 71:return[4,this.getChannel(X.channelUrl,!0)];case 72:return it=Ht.sent(),st=e.as(Ul),ot=st.created,ut=st.updated,lt=st.deleted,ot&&(it._upsertCachedMetaData(ot,X.ts),this._dispatcher.dispatch(new $p({channels:[it],source:no.EVENT_CHANNEL_METADATA_CREATED}))),ut&&(it._upsertCachedMetaData(ut,X.ts),this._dispatcher.dispatch(new $p({channels:[it],source:no.EVENT_CHANNEL_METADATA_UPDATED}))),lt&&(it._removeFromCachedMetaData(lt,X.ts),this._dispatcher.dispatch(new $p({channels:[it],source:no.EVENT_CHANNEL_METADATA_DELETED}))),Es((function(){return Qe(zt,void 0,void 0,(function(){return Ke(this,(function(e){return this._groupChannelHandlers.forEach((function(e){ot&&e.onMetaDataCreated&&e.onMetaDataCreated(it,ot),ut&&e.onMetaDataUpdated&&e.onMetaDataUpdated(it,ut),lt&&e.onMetaDataDeleted&&e.onMetaDataDeleted(it,lt)})),[2]}))}))})),[3,77];case 73:return[4,this.getChannel(X.channelUrl,!0)];case 74:return ct=Ht.sent(),dt=e.as(Vl),ht=dt.created,ft=dt.updated,pt=dt.deleted,ht&&this._dispatcher.dispatch(new $p({channels:[ct],source:no.EVENT_CHANNEL_METACOUNTER_CREATED})),ft&&this._dispatcher.dispatch(new $p({channels:[ct],source:no.EVENT_CHANNEL_METACOUNTER_UPDATED})),pt&&this._dispatcher.dispatch(new $p({channels:[ct],source:no.EVENT_CHANNEL_METACOUNTER_DELETED})),Es((function(){return Qe(zt,void 0,void 0,(function(){return Ke(this,(function(e){return this._groupChannelHandlers.forEach((function(e){ht&&e.onMetaCounterCreated&&e.onMetaCounterCreated(ct,ht),ft&&e.onMetaCounterUpdated&&e.onMetaCounterUpdated(ct,ft),pt&&e.onMetaCounterDeleted&&e.onMetaCounterDeleted(ct,pt)})),[2]}))}))})),[3,77];case 75:return[4,this.getChannel(X.channelUrl,!0)];case 76:return _t=Ht.sent(),vt=e.as(G_),mt=vt.pinnedMessageIds,gt=vt.latestPinnedMessage,(yt=vt.ts)>_t._pinnedMessagesUpdatedAt&&(_t.pinnedMessageIds=mt,_t.lastPinnedMessage=gt,_t._pinnedMessagesUpdatedAt=yt,this._dispatcher.dispatch(new $p({channels:[_t],source:no.EVENT_PINNED_MESSAGE_UPDATED})),Es((function(){return Qe(zt,void 0,void 0,(function(){var e,t,n,r,i;return Ke(this,(function(a){try{for(e=We(this._groupChannelHandlers.values()),t=e.next();!t.done;t=e.next())(n=t.value).onChannelChanged&&n.onChannelChanged(_t)}catch(e){r={error:e}}finally{try{t&&!t.done&&(i=e.return)&&i.call(e)}finally{if(r)throw r.error}}return[2]}))}))})),Es((function(){return Qe(zt,void 0,void 0,(function(){return Ke(this,(function(e){return this._groupChannelHandlers.forEach((function(e){e.onPinnedMessageUpdated&&e.onPinnedMessageUpdated(_t)})),[2]}))}))}))),[3,77];case 77:return[3,79];case 78:switch((Et=e.as(xh).event).category){case Ah.USER_BLOCK:bt=Dh.getDataAsUserBlockEvent(this._iid,Et),wt=bt.blocker,Nt=bt.blockee,this._groupChannelCache.block(wt.userId,Nt.userId);break;case Ah.USER_UNBLOCK:Ct=Dh.getDataAsUserBlockEvent(this._iid,Et),wt=Ct.blocker,Nt=Ct.blockee,this._groupChannelCache.unblock(wt.userId,Nt.userId)}return[3,79];case 79:return[3,81];case 80:if(At=Ht.sent(),at(At))throw At;return[3,81];case 81:return[2]}}))}))},t.prototype._markAsLeave=function(e){var t,n=this,r=null!==(t=this._leftChannels.get(e.url))&&void 0!==t?t:{channel:e,ref:0};r.ref++,this._leftChannels.set(e.url,r),setTimeout((function(){r.ref--,0===r.ref&&n._leftChannels.delete(e.url)}),1e4)},t.prototype.addHandler=function(e,t){this._groupChannelHandlers.set(e,t)},t.prototype.removeHandler=function(e){this._groupChannelHandlers.delete(e)},t.prototype.clearHandler=function(){this._groupChannelHandlers.clear()},t.prototype.subscribeChannelEvent=function(e,t){this._groupChannelBroadcast.subscribe(e,t)},t.prototype.unsubscribeChannelEvent=function(e){this._groupChannelBroadcast.unsubscribe(e)},t.prototype._updateJoinedMemberCount=function(e){e.joinedMemberCount=e.members.filter((function(e){return e.state===kp.JOINED})).length},t.prototype.getChannel=function(e,t){return void 0===t&&(t=!1),Qe(this,void 0,void 0,(function(){var n;return Ke(this,(function(r){switch(r.label){case 0:hs(ct("string",e)).throw(st.invalidParameters),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,this.getChannelFromCache(e)];case 2:return(n=r.sent())?[2,n]:[3,4];case 3:return r.sent(),[3,4];case 4:return[4,this.getChannelWithoutCache(e,t)];case 5:return[2,r.sent()]}}))}))},t.prototype.getChannelWithoutCache=function(e,t){return void 0===t&&(t=!1),Qe(this,void 0,void 0,(function(){var n,r,i,a,s;return Ke(this,(function(o){switch(o.label){case 0:return hs(ct("string",e)).throw(st.invalidParameters),n=new i_({channelUrl:e,isInternalCall:t}),[4,this._requestQueue.send(n)];case 1:switch(r=o.sent(),i=r.as(a_).channel,a=i.unreadMessageCount,s=i.unreadMentionCount,i.myCountPreference){case $v.UNREAD_MESSAGE_COUNT_ONLY:s=0;break;case $v.UNREAD_MENTION_COUNT_ONLY:a=0;break;case $v.OFF:a=0,s=0}return i._updateUnreadCount(a,s),[4,this.upsertChannelsToCache([i])];case 2:return[2,o.sent()[0]]}}))}))},t.prototype.refreshChannel=function(e,t,n){return void 0===t&&(t=!0),void 0===n&&(n=no.REFRESH_CHANNEL),Qe(this,void 0,void 0,(function(){var r,i,a,s,o;return Ke(this,(function(u){switch(u.label){case 0:return u.trys.push([0,5,,6]),r=new i_({channelUrl:e,isInternalCall:t}),[4,this._requestQueue.send(r)];case 1:return i=u.sent(),(a=i.as(a_).channel).myMemberState!==kp.NONE?[3,2]:(this._dispatcher.dispatch(new e_({channelUrls:[a.url],source:n})),[3,4]);case 2:return[4,this.upsertChannelsToCache([a])];case 3:s=u.sent(),this._dispatcher.dispatch(new $p({channels:s,source:n})),u.label=4;case 4:return[3,6];case 5:return(o=u.sent()).code!==Je.NON_AUTHORIZED&&o.code!==Je.NOT_FOUND_IN_DATABASE||this._dispatcher.dispatch(new e_({channelUrls:[e],source:n})),[3,6];case 6:return[2]}}))}))},t.prototype.getMyGroupChannels=function(e,t,n,r){return void 0===r&&(r=no.REQUEST_CHANNEL),Qe(this,void 0,void 0,(function(){var i,a,s,o,u;return Ke(this,(function(l){switch(l.label){case 0:return t.createdAfter&&(t.createdAfter=Math.floor(t.createdAfter/1e3)),t.createdBefore&&(t.createdBefore=Math.floor(t.createdBefore/1e3)),i=new o_(je(je({},t),{userId:this._sdkState.userId,token:e,limit:n})),[4,this._requestQueue.send(i)];case 1:return a=l.sent(),s=a.as(u_),o=s.channels,u=s.token,this._dispatcher.dispatch(new $p({channels:o,source:r})),[2,{channels:o,token:u}]}}))}))},t.prototype.getMyGroupChannelChangeLogs=function(e,t,n){return void 0===n&&(n=no.REQUEST_CHANNEL_CHANGELOGS),Qe(this,void 0,void 0,(function(){var r,i,a,s,o,u,l,c;return Ke(this,(function(d){switch(d.label){case 0:return r=je(je({},jp),t),hs((ct("string",e)||ct("number",e))&&Qp(r)).throw(st.invalidParameters),i=new n_(Vt({userId:this._sdkState.userId,ts:"number"==typeof e?e:null,token:"string"==typeof e?e:null,filter:r})),[4,this._requestQueue.send(i)];case 1:return a=d.sent(),s=a.as(r_),o=s.updatedChannels,u=s.deletedChannelUrls,l=s.hasMore,c=s.ts,o.length>0&&this._dispatcher.dispatch(new $p({channels:o,source:n,ts:c})),u.length>0&&this._dispatcher.dispatch(new e_({channelUrls:u,source:n})),[2,{updatedChannels:o,deletedChannelUrls:u,hasMore:l,token:s.token}]}}))}))},t.prototype.getGroupChannelCount=function(e){return Qe(this,void 0,void 0,(function(){var t,n;return Ke(this,(function(r){switch(r.label){case 0:return t=je(je({},Kp),e),hs(Wp(t)).throw(st.invalidParameters),n=new l_({userId:this._sdkState.userId,filter:t}),[4,this._requestQueue.send(n)];case 1:return[2,r.sent().as(c_).groupChannelCount]}}))}))},t.prototype.getUnreadItemCount=function(e){return Qe(this,void 0,void 0,(function(){var t,n,r,i,a,s,o,u,l,c,d,h,f,p,_,v;return Ke(this,(function(m){switch(m.label){case 0:return t=je(je({},Yp),e),hs(function(e){return ft(Hp,e.keys)}(t)).throw(st.invalidParameters),n=eo.of(this._iid),r=n.sdkState,i=n.requestQueue,a=new d_({userId:r.userId,filter:t}),[4,i.send(a)];case 1:return s=m.sent(),o=s.as(h_),u=o.groupChannelUnreadMentionCount,l=o.groupChannelUnreadMessageCount,c=o.groupChannelInvitationCount,d=o.superGroupChannelUnreadMentionCount,h=o.superGroupChannelUnreadMessageCount,f=o.superGroupChannelInvitationCount,p=o.nonSuperGroupChannelUnreadMentionCount,_=o.nonSuperGroupChannelUnreadMessageCount,v=o.nonSuperGroupChannelInvitationCount,[2,qt({groupChannelUnreadMentionCount:u,groupChannelUnreadMessageCount:l,groupChannelInvitationCount:c,superGroupChannelUnreadMentionCount:d,superGroupChannelUnreadMessageCount:h,superGroupChannelInvitationCount:f,nonSuperGroupChannelUnreadMentionCount:p,nonSuperGroupChannelUnreadMessageCount:_,nonSuperGroupChannelInvitationCount:v})]}}))}))},t.prototype.getTotalUnreadChannelCount=function(){return Qe(this,void 0,void 0,(function(){var e,t,n,r;return Ke(this,(function(i){switch(i.label){case 0:return e=eo.of(this._iid),t=e.sdkState,n=e.requestQueue,r=new f_({userId:t.userId}),[4,n.send(r)];case 1:return[2,i.sent().as(p_).unreadCount]}}))}))},t.prototype.getTotalUnreadMessageCount=function(e){return Qe(this,void 0,void 0,(function(){var t,n,r,i,a;return Ke(this,(function(s){switch(s.label){case 0:return t=je(je({},Zp),e),hs(function(e){return ft("string",e.channelCustomTypesFilter,!0)&&dt(Op,e.superChannelFilter)}(t)).throw(st.invalidParameters),n=eo.of(this._iid),r=n.sdkState,i=n.requestQueue,a=new __({userId:r.userId,filter:t}),[4,i.send(a)];case 1:return[2,s.sent().as(v_).unreadCount]}}))}))},t.prototype.getTotalScheduledMessageCount=function(e){return void 0===e&&(e={}),Qe(this,void 0,void 0,(function(){var t,n,r;return Ke(this,(function(i){switch(i.label){case 0:return t=je(je({},Jp),e),hs(function(e){return ct("string",e.channelUrl,!0)&&ft(jo,e.scheduledStatus,!0)&&dt(At,e.messageTypeFilter)}(t)).throw(st.invalidParameters),n=eo.of(this._iid).requestQueue,r=new m_(t),[4,n.send(r)];case 1:return[2,i.sent().as(g_).count]}}))}))},t.prototype.getSubscribedTotalUnreadMessageCount=function(){var e=eo.of(this._iid).subscribedUnreadMessageCount;return e.all>=0?e.all:0},t.prototype.getSubscribedCustomTypeTotalUnreadMessageCount=function(){var e=0,t=eo.of(this._iid).subscribedUnreadMessageCount;for(var n in t.customTypes)e+=t.customTypes[n];return e},t.prototype.getSubscribedCustomTypeUnreadMessageCount=function(e){var t;return null!==(t=eo.of(this._iid).subscribedUnreadMessageCount.customTypes[e])&&void 0!==t?t:0},t.prototype.createChannel=function(e){return Qe(this,void 0,void 0,(function(){var t,n,r,i;return Ke(this,(function(a){switch(a.label){case 0:return t=je(je({},Gp),e),hs(Bp(t)).throw(st.invalidParameters),t.isPublic||(t.accessCode=void 0),n=new E_(je({userId:this._sdkState.userId},t)),[4,this._requestQueue.send(n)];case 1:return r=a.sent(),i=r.as(b_).channel,[4,this.upsertChannelsToCache([i])];case 2:return a.sent(),[2,i]}}))}))},t.prototype.markAsReadAll=function(){return Qe(this,void 0,void 0,(function(){var e,t,n,r,i,a,s,o;return Ke(this,(function(u){switch(u.label){case 0:return e=Date.now(),hs(e-this._markAsReadAllLastSentAt>=1e3).throw(st.markAsReadAllRateLimitExceeded),this._markAsReadAllLastSentAt=e,t=new C_({userId:this._sdkState.userId}),[4,this._requestQueue.send(t)];case 1:u.sent(),n=this._groupChannelCache.channels;try{for(r=We(n),i=r.next();!i.done;i=r.next())(a=i.value)._updateUnreadMemberState(this._sdkState.userId,e),a._updateUnreadCount(0,0)}catch(e){s={error:e}}finally{try{i&&!i.done&&(o=r.return)&&o.call(r)}finally{if(s)throw s.error}}return n.length>0?[4,this.upsertChannelsToCache(n)]:[3,3];case 2:u.sent(),u.label=3;case 3:return[2]}}))}))},t.prototype.markAsReadWithChannelUrls=function(e){return Qe(this,void 0,void 0,(function(){var t,n,r,i,a,s,o,u,l;return Ke(this,(function(c){switch(c.label){case 0:return t=Date.now(),hs(ft("string",e)&&t-this._markAsReadAllLastSentAt>=1e3).throw(st.markAsReadAllRateLimitExceeded),this._markAsReadAllLastSentAt=t,n=new C_({userId:this._sdkState.userId,channelUrls:e}),[4,this._requestQueue.send(n)];case 1:c.sent(),r=this._groupChannelCache.channels,i=[];try{for(a=We(r),s=a.next();!s.done;s=a.next())o=s.value,e.includes(o.url)&&(o._updateUnreadMemberState(this._sdkState.userId,t),o._updateUnreadCount(0,0),i.push(o))}catch(e){u={error:e}}finally{try{s&&!s.done&&(l=a.return)&&l.call(a)}finally{if(u)throw u.error}}return i.length>0?[4,this.upsertChannelsToCache(i)]:[3,3];case 2:c.sent(),c.label=3;case 3:return[2]}}))}))},t.prototype.markAsDelivered=function(e){return Qe(this,void 0,void 0,(function(){return Ke(this,(function(t){switch(t.label){case 0:return[4,this.getChannel(e)];case 1:return[4,t.sent().markAsDelivered()];case 2:return t.sent(),[2]}}))}))},t.prototype.getMessageFromCache=function(e){var t;return Qe(this,void 0,void 0,(function(){return Ke(this,(function(n){switch(n.label){case 0:return[4,this._messageCache.get(e)];case 1:return[2,null!==(t=n.sent())&&void 0!==t?t:null]}}))}))},t.prototype.getExactlyMatchingMessagesForTokenFromCache=function(e,t,n){return Qe(this,void 0,void 0,(function(){return Ke(this,(function(r){switch(r.label){case 0:return[4,this._messageCache.fetch({channelUrl:e,token:t,filter:n,exactMatch:!0})];case 1:return[2,r.sent()]}}))}))},t.prototype.getMessagesFromCache=function(e,t,n,r,i,a){return void 0===i&&(i=100),void 0===a&&(a=!0),Qe(this,void 0,void 0,(function(){return Ke(this,(function(s){switch(s.label){case 0:return[4,this._messageCache.fetch({channelUrl:e,token:t,limit:i,filter:r,backward:"next"===n,inclusive:a})];case 1:return[2,s.sent()]}}))}))},t.prototype.getPollMessagesFromCache=function(e,t,n,r){return Qe(this,void 0,void 0,(function(){return Ke(this,(function(i){switch(i.label){case 0:return[4,this._messageCache.fetch({channelUrl:e,token:t,limit:r,filter:n,backward:!1,isPollOnly:!0})];case 1:return[2,i.sent()]}}))}))},t.prototype.getCachedMessageCountBetween=function(e,t,n,r){return Qe(this,void 0,void 0,(function(){return Ke(this,(function(i){switch(i.label){case 0:return[4,this._messageCache.countBetween(e,t,new Y_({top:n,bottom:r}))];case 1:return[2,i.sent()]}}))}))},t.prototype.getUnsentMessagesFromCache=function(e,t){return Qe(this,void 0,void 0,(function(){return Ke(this,(function(n){switch(n.label){case 0:return[4,this._unsentMessageCache.fetch({channelUrl:e,filter:t})];case 1:return[2,n.sent()]}}))}))},t.prototype.removeFailedMessageFromCache=function(e){return Qe(this,void 0,void 0,(function(){return Ke(this,(function(t){switch(t.label){case 0:return[4,this._unsentMessageCache.remove([e])];case 1:return t.sent(),[2]}}))}))},t}(Xf),X_=function(e,t){return t instanceof au?e.findIndex((function(e){return e instanceof au&&t.isIdentical(e)})):e.findIndex((function(e){return e.isIdentical(t)}))},$_=function(e,t){return e.findIndex((function(e){return e instanceof iu?e.messageId===t:e instanceof vu?e.notificationId===t:void 0}))},ev=function(e,t){if(e.length>0){for(var n=0,r=e.length-1,i=Math.floor((n+r)/2);n<r;){var a=e[i].createdAt-t.createdAt;if(a>0)r=i,i=Math.floor((n+r)/2);else{if(!(a<0))return i;n=i+1,i=Math.floor((n+r)/2)}}return e[i].createdAt>t.createdAt?i:i+1}return e.length};!function(e){e[e.IDLE=0]="IDLE",e[e.RUNNING=1]="RUNNING",e[e.END=2]="END"}(K_||(K_={}));var tv,nv=function(e){function t(t,n,r,i){var a=e.call(this)||this;return a._state=K_.IDLE,a._retryCount=0,a._retryLimit=3,a.priority=0,a._worker=n,a}return Be(t,e),Object.defineProperty(t.prototype,"isIdle",{get:function(){return this._state===K_.IDLE},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isRunning",{get:function(){return this._state===K_.RUNNING},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isDone",{get:function(){return this._state===K_.END},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"retryCount",{get:function(){return this._retryCount},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"retryLimit",{get:function(){return this._retryLimit},enumerable:!1,configurable:!0}),t.prototype._run=function(e){return Qe(this,void 0,void 0,(function(){var t,n;return Ke(this,(function(r){switch(r.label){case 0:if(!this.isRunning)return[3,4];r.label=1;case 1:return r.trys.push([1,3,,4]),[4,this._worker(e)];case 2:return t=r.sent(),this._retryCount=0,this.dispatch("progress",t),t.hasNext?this._run(t.nextToken):this.end(),[3,4];case 3:return n=r.sent(),this.dispatch("error",n),this._retryCount<this._retryLimit?(this._retryCount++,this._run(e)):this.stop(),[3,4];case 4:return[2]}}))}))},t.prototype.start=function(e){this.isIdle&&(this._state=K_.RUNNING,this._run(e))},t.prototype.stop=function(){this._state=K_.IDLE,this.dispatch("stop")},t.prototype.end=function(){this._state=K_.END,this.dispatch("end")},t}(Ft),rv={},iv=function(){function e(e){var t=e._iid,n=e.channel,r=e.limit,i=void 0===r?100:r,a=this;this.ref=0,this._iid=t,this._channel=n,this._limit=i,this._prevSyncLoopCount=0,this._nextSyncLoopCount=0;var s,o,u=eo.of(this._iid),l=u.sdkState,c=u.cacheContext,d=u.dispatcher,h=u.logger,f=u.statLogCollector;this._metadataKey=(s=l.userId,o=n.url,"sendbird:".concat(s,"@groupchannel/").concat(o,"/message/sync.meta"));var p=function(e,t){return"sendbird:".concat(e,"@groupchannel/").concat(t,"/message/sync")}(l.userId,n.url);this._prevSync=new nv(p,(function(e){return Qe(a,void 0,void 0,(function(){var t,r,i,a,s,o,u,l,d,p,_,v;return Ke(this,(function(m){switch(m.label){case 0:return t={hasNext:!0,nextToken:0},this._prevSyncLoopCount++,[4,this.loadMetadata(e)];case 1:if(m.sent(),h.debug("message background prev sync from",null===(o=this._metadata)||void 0===o?void 0:o.range.top),null===(u=this._metadata)||void 0===u?void 0:u.previousComplete)return[3,10];m.label=2;case 2:return m.trys.push([2,5,8,9]),[4,vh.of(this._iid).getMessagesByTimestamp(this._channel.url,this._channel.channelType,(null===(d=null===(l=this._metadata)||void 0===l?void 0:l.range)||void 0===d?void 0:d.top)?this._metadata.range.top:e,{prevResultSize:this._limit,nextResultSize:0,replyType:Ut.ALL,includeReactions:!0,includeMetaArray:!0,includeParentMessageInfo:!0,includeThreadInfo:!0},no.SYNC_MESSAGE_BACKGROUND)];case 3:return(r=m.sent()).length>0&&(i=r.map((function(e){return e.createdAt})),(null===(p=this._metadata)||void 0===p?void 0:(s=p.range).intersect.apply(s,Ze([],Ye(i),!1)))?this.extendRange(r):this._metadata={range:new Y_({top:Math.min.apply(Math,Ze([],Ye(i),!1)),bottom:Math.max.apply(Math,Ze([],Ye(i),!1))}),previousComplete:!1}),t.hasNext=r.length>=this._limit&&this._prevSyncLoopCount<1,this._metadata&&(t.nextToken=this._metadata.range.top,this._metadata.previousComplete=r.length<this._limit),h.debug("message background prev sync progress",t),[4,this.saveMetadata()];case 4:return m.sent(),[3,9];case 5:return a=m.sent(),h.debug("message background prev sync error",a),a instanceof st&&a.isInvalidTokenError?[4,this.clearMetadata()]:[3,7];case 6:m.sent(),m.label=7;case 7:throw a;case 8:return f.put(new Nn({type:dn.FEATURE_LOCALCACHE_EVENT,ts:Date.now(),data:{channel_url:n.url,measured_on:"back_sync",event:"cache_fetch",max_db_size:null!==(v=null===(_=c.localCacheConfig)||void 0===_?void 0:_.maxSize)&&void 0!==v?v:0,use_local_cache:c.localCacheEnabled,starting_point:0,message_init_policy:""}})),[7];case 9:return[3,11];case 10:t.hasNext=!1,m.label=11;case 11:return[2,t]}}))}))})),this._nextSync=new nv(p,(function(e){return Qe(a,void 0,void 0,(function(){var t,r,i,a,s,o,u,l,d,p,_;return Ke(this,(function(v){switch(v.label){case 0:return t={hasNext:!0,nextToken:0},this._nextSyncLoopCount++,[4,this.loadMetadata(e)];case 1:v.sent(),h.debug("message background next sync from",null===(o=this._metadata)||void 0===o?void 0:o.range.bottom),v.label=2;case 2:return v.trys.push([2,5,6,7]),[4,vh.of(this._iid).getMessagesByTimestamp(this._channel.url,this._channel.channelType,(null===(l=null===(u=this._metadata)||void 0===u?void 0:u.range)||void 0===l?void 0:l.bottom)?this._metadata.range.bottom:e,{prevResultSize:0,nextResultSize:this._limit,replyType:Ut.ALL,includeReactions:!0,includeMetaArray:!0,includeParentMessageInfo:!0,includeThreadInfo:!0},no.SYNC_MESSAGE_BACKGROUND)];case 3:return(r=v.sent()).length>0&&(i=r.map((function(e){return e.createdAt})),(null===(d=this._metadata)||void 0===d?void 0:(s=d.range).intersect.apply(s,Ze([],Ye(i),!1)))?this.extendRange(r):this._metadata={range:new Y_({top:Math.min.apply(Math,Ze([],Ye(i),!1)),bottom:Math.max.apply(Math,Ze([],Ye(i),!1))}),previousComplete:!1}),t.hasNext=r.length>=this._limit&&this._nextSyncLoopCount<1,this._metadata&&(t.nextToken=this._metadata.range.bottom),h.debug("message background next sync progress",t),[4,this.saveMetadata()];case 4:return v.sent(),[3,7];case 5:throw a=v.sent(),h.debug("message background next sync error",a),a;case 6:return f.put(new Nn({type:dn.FEATURE_LOCALCACHE_EVENT,ts:Date.now(),data:{channel_url:n.url,measured_on:"back_sync",event:"cache_fetch",max_db_size:null!==(_=null===(p=c.localCacheConfig)||void 0===p?void 0:p.maxSize)&&void 0!==_?_:0,use_local_cache:c.localCacheEnabled,starting_point:0,message_init_policy:""}})),[7];case 7:return[2,t]}}))}))})),this._connectionEventContext=d.on((function(e){e instanceof Ka&&(e.stateType===Ga.CONNECTED?a.resume():a.pause())}))}return e.of=function(t,n){return rv[t]||(rv[t]={}),rv[t][n.url]||(rv[t][n.url]=new e({_iid:t,channel:n})),rv[t][n.url].ref++,rv[t][n.url]},e.clear=function(e,t){rv[e]&&rv[e][t]&&(rv[e][t].close(),delete rv[e])},Object.defineProperty(e.prototype,"range",{get:function(){var e,t;return null!==(t=null===(e=this._metadata)||void 0===e?void 0:e.range)&&void 0!==t?t:new Y_({})},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"previousComplete",{get:function(){var e;return!!(null===(e=this._metadata)||void 0===e?void 0:e.previousComplete)},enumerable:!1,configurable:!0}),e.prototype.isWrappingMessages=function(e){var t;return null===(t=this.range)||void 0===t?void 0:t.includes.apply(t,Ze([],Ye(e.map((function(e){return e.createdAt}))),!1))},e.prototype.extendRange=function(e){var t;this._metadata&&(t=this._metadata.range).extends.apply(t,Ze([],Ye(e.map((function(e){return e.createdAt}))),!1))},e.prototype.loadMetadata=function(e){return Qe(this,void 0,void 0,(function(){var t;return Ke(this,(function(n){switch(n.label){case 0:return this._metadata?[3,2]:[4,eo.of(this._iid).cacheContext.preference.get(this._metadataKey)];case 1:(t=n.sent())?t.range.bottom<e?this._metadata={range:new Y_({}),previousComplete:!1}:this._metadata={range:new Y_(t.range),previousComplete:t.previousComplete}:this._metadata={range:new Y_({}),previousComplete:!1},n.label=2;case 2:return[2,this._metadata]}}))}))},e.prototype.saveMetadata=function(){return Qe(this,void 0,void 0,(function(){return Ke(this,(function(e){switch(e.label){case 0:return this._metadata?[4,eo.of(this._iid).cacheContext.preference.set(this._metadataKey,this._metadata)]:[3,2];case 1:return e.sent(),[2,!0];case 2:return[2,!1]}}))}))},e.prototype.clearMetadata=function(){return Qe(this,void 0,void 0,(function(){return Ke(this,(function(e){switch(e.label){case 0:return[4,eo.of(this._iid).cacheContext.preference.remove(this._metadataKey)];case 1:return e.sent(),this._metadata=void 0,[2]}}))}))},e.prototype.resume=function(e){var t,n,r,i;void 0===e&&(e=Date.now());var a=eo.of(this._iid),s=a.logger;a.sessionManager.session.hasSession&&(s.debug("message background sync resume()"),this._prevSyncLoopCount=this._nextSyncLoopCount=0,this._metadata&&this._metadata.previousComplete||this._prevSync.start(null!==(n=null===(t=this._metadata)||void 0===t?void 0:t.range.top)&&void 0!==n?n:e),this._nextSync.start(null!==(i=null===(r=this._metadata)||void 0===r?void 0:r.range.bottom)&&void 0!==i?i:e))},e.prototype.pause=function(){eo.of(this._iid).logger.debug("message background sync stop()"),this._prevSync.stop(),this._nextSync.stop()},e.prototype.close=function(){this.ref--,this.ref<=0&&(this.ref=0,this.pause(),this._connectionEventContext.close(),delete rv[this._iid][this._channel.url])},e}(),av={},sv=function(){function e(e){var t=e._iid,n=e.channel,r=this;this.ref=0,this._iid=t,this._channel=n;var i,a,s=eo.of(this._iid),o=s.logger,u=s.sdkState,l=s.dispatcher;this._metadataKey=(i=u.userId,a=n.url,"sendbird:".concat(i,"@groupchannel/").concat(a,"/message/changelogs.meta"));var c=function(e,t){return"sendbird:".concat(e,"@groupchannel/").concat(t,"/message/changelogs")}(u.userId,this._channel.url);this._sync=new nv(c,(function(){return Qe(r,void 0,void 0,(function(){var e,t,n,r,i,a,s,u;return Ke(this,(function(l){switch(l.label){case 0:return e={hasNext:!0,nextToken:0},[4,this.loadMetadata()];case 1:l.sent(),o.debug("message changelog sync from",null===(u=this._metadata)||void 0===u?void 0:u.token),l.label=2;case 2:return l.trys.push([2,5,,8]),[4,vh.of(this._iid).getMessageChangelogs(this._channel.url,this._channel.channelType,this._metadata.token,{replyType:Ut.ALL,includeReactions:!0,includeThreadInfo:!0,includeMetaArray:!0,includeParentMessageInfo:!0},no.SYNC_MESSAGE_CHANGELOGS)];case 3:return t=l.sent(),n=t.updatedMessages,r=t.deletedMessageIds,i=t.hasMore,a=t.token,e.hasNext=i,e.nextToken=a,(n.length>0||r.length>0)&&this._metadata&&(this._metadata.token=a),o.debug("message changelog sync progress",e),[4,this.saveMetadata()];case 4:return l.sent(),[3,8];case 5:return s=l.sent(),o.debug("message changelog sync error",s),s instanceof st&&s.isInvalidTokenError?[4,this.clearMetadata()]:[3,7];case 6:l.sent(),l.label=7;case 7:throw s;case 8:return[2,e]}}))}))})),this._connectionEventContext=l.on((function(e){e instanceof Ka&&(e.stateType===Ga.CONNECTED?r.resume():r.pause())}))}return e.of=function(t,n){return av[t]||(av[t]={}),av[t][n.url]||(av[t][n.url]=new e({_iid:t,channel:n})),av[t][n.url].ref++,av[t][n.url]},e.clear=function(e,t){av[e]&&av[e][t]&&(av[e][t].close(),delete av[e])},e.prototype.loadMetadata=function(){return Qe(this,void 0,void 0,(function(){var e,t,n,r;return Ke(this,(function(i){switch(i.label){case 0:return this._metadata?[3,2]:(e=eo.of(this._iid),t=e.cacheContext,n=e.firstConnectedAt,[4,t.preference.get(this._metadataKey)]);case 1:r=i.sent(),this._metadata={token:r?r.token:n},i.label=2;case 2:return[2,this._metadata]}}))}))},e.prototype.saveMetadata=function(){return Qe(this,void 0,void 0,(function(){return Ke(this,(function(e){switch(e.label){case 0:return this._metadata?[4,eo.of(this._iid).cacheContext.preference.set(this._metadataKey,this._metadata)]:[3,2];case 1:return e.sent(),[2,!0];case 2:return[2,!1]}}))}))},e.prototype.clearMetadata=function(){return Qe(this,void 0,void 0,(function(){return Ke(this,(function(e){switch(e.label){case 0:return[4,eo.of(this._iid).cacheContext.preference.remove(this._metadataKey)];case 1:return e.sent(),this._metadata=void 0,[2]}}))}))},e.prototype.resume=function(){var e=eo.of(this._iid),t=e.logger;e.sessionManager.session.hasSession&&(t.debug("message changelog sync resume()"),this._sync.start(0))},e.prototype.pause=function(){eo.of(this._iid).logger.debug("message changelog sync pause()"),this._sync.stop()},e.prototype.close=function(){this.ref--,this.ref<=0&&(this.ref=0,this.pause(),this._connectionEventContext.close(),delete av[this._iid][this._channel.url])},e}(),ov={},uv=function(){function e(e){var t=e._iid,n=e.channel,r=e.hasPollMessage,i=this;this.ref=0,this._iid=t,this._channel=n;var a,s,o=eo.of(this._iid),u=o.logger,l=o.sdkState,c=o.dispatcher;this._metadataKey=(a=l.userId,s=n.url,"sendbird:".concat(a,"@groupchannel/").concat(s,"/poll/changelogs.meta"));var d=function(e,t){return"sendbird:".concat(e,"@groupchannel/").concat(t,"/poll/changelogs")}(l.userId,this._channel.url);this._sync=new nv(d,(function(){return Qe(i,void 0,void 0,(function(){var e,t,n,i,a,s,o,l;return Ke(this,(function(c){switch(c.label){case 0:return e={hasNext:!0,nextToken:0},[4,this.loadMetadata()];case 1:return c.sent(),u.debug("poll changelog sync from",null===(l=this._metadata)||void 0===l?void 0:l.token),(t=!this._metadata||!this._metadata.token)?[4,r()]:[3,3];case 2:t=!c.sent(),c.label=3;case 3:if(t)return[2,{hasNext:!1,nextToken:0}];this._metadata||(n=eo.of(this._iid).firstConnectedAt,this._metadata={token:n}),c.label=4;case 4:return c.trys.push([4,7,,10]),[4,Ro.of(this._iid).getPollChangeLogs(this._channel.url,this._channel.channelType,this._metadata.token)];case 5:return i=c.sent(),a=i.hasMore,s=i.token,e.hasNext=a,e.nextToken=s,this._metadata.token=s,u.debug("poll changelog sync progress",e),[4,this.saveMetadata()];case 6:return c.sent(),[3,10];case 7:return o=c.sent(),u.debug("poll changelog sync error",o),o instanceof st&&o.isInvalidTokenError?[4,this.clearMetadata()]:[3,9];case 8:c.sent(),c.label=9;case 9:throw o;case 10:return[2,e]}}))}))})),this._connectionEventContext=c.on((function(e){e instanceof Ka&&(e.stateType===Ga.CONNECTED?i.resume():i.pause())}))}return e.of=function(t,n,r){return ov[t]||(ov[t]={}),ov[t][n.url]||(ov[t][n.url]=new e({_iid:t,channel:n,hasPollMessage:r})),ov[t][n.url].ref++,ov[t][n.url]},e.prototype.loadMetadata=function(){return Qe(this,void 0,void 0,(function(){var e;return Ke(this,(function(t){switch(t.label){case 0:return this._metadata?[3,2]:[4,eo.of(this._iid).cacheContext.preference.get(this._metadataKey)];case 1:e=t.sent(),this._metadata=e?{token:e.token}:void 0,t.label=2;case 2:return[2]}}))}))},e.prototype.saveMetadata=function(){return Qe(this,void 0,void 0,(function(){return Ke(this,(function(e){switch(e.label){case 0:return this._metadata?[4,eo.of(this._iid).cacheContext.preference.set(this._metadataKey,this._metadata)]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))}))},e.prototype.clearMetadata=function(){return Qe(this,void 0,void 0,(function(){return Ke(this,(function(e){switch(e.label){case 0:return[4,eo.of(this._iid).cacheContext.preference.remove(this._metadataKey)];case 1:return e.sent(),this._metadata=void 0,[2]}}))}))},e.prototype.resume=function(){eo.of(this._iid).logger.debug("poll changelog sync resume()"),this._sync.start(0)},e.prototype.pause=function(){eo.of(this._iid).logger.debug("poll changelog sync pause()"),this._sync.stop()},e.prototype.close=function(){this.ref--,this.ref<=0&&(this.ref=0,this.pause(),this._connectionEventContext.close(),delete ov[this._iid][this._channel.url])},e}(),lv=function(e){function t(t){var n=t.channels,r=t.source,i=t.isWebSocketEventComing,a=void 0!==i&&i,s=t.data,o=void 0===s?null:s,u=e.call(this)||this;return u.channels=n,u.source=r,u.isWebSocketEventComing=a,u.data=o,u}return Be(t,e),t}(Ht),cv=(function(e){function t(t){var n=t.channelUrls,r=t.source,i=t.isWebSocketEventComing,a=void 0!==i&&i,s=e.call(this)||this;return s.channelUrls=n,s.source=r,s.isWebSocketEventComing=a,s}Be(t,e)}(Ht),function(e){function t(t){var n,r,i,a,s,o,u,l,c,d,h=this;return(h=e.call(this)||this).method=Gt.GET,h.path="".concat(sn(t.channelType),"/").concat(t.channelUrl,"/messages_gap"),h.params=qt({prev_start_ts:t.prevStart,prev_end_ts:t.prevEnd,prev_cache_count:t.prevCount,next_start_ts:t.nextStart,next_end_ts:t.nextEnd,next_cache_count:t.nextCount,huge_gap_threshold:null!==(n=t.threshold)&&void 0!==n?n:null,reverse:!0,custom_types:null!==(r=t.customTypes)&&void 0!==r?r:["*"],message_type:null!==(i=t.messageType)&&void 0!==i?i:null,include_reply_type:null!==(a=t.replyType)&&void 0!==a?a:Ut.NONE,include_reactions:null===(s=t.includeReactions)||void 0===s||s,include_meta_array:null===(o=t.includeMetaArray)||void 0===o||o,include_thread_info:null===(u=t.includeThreadInfo)||void 0===u||u,include_parent_message_info:null===(l=t.includeParentMessageInfo)||void 0===l||l,with_sorted_meta_array:null===(c=t.includeMetaArray)||void 0===c||c,show_subchannel_messages_only:null!==(d=t.showSubchannelMessagesOnly)&&void 0!==d&&d,include_poll_details:!0,checking_continuous_messages:t.checkingContinuousMessages}),h}return Be(t,e),t}(hn)),dv=function(e){function t(t,n){var r,i,a,s,o,u,l=this;return(l=e.call(this,t,n)||this).isHugeGap=n.is_huge_gap,l.prevMessages=(null!==(r=n.prev_messages)&&void 0!==r?r:[]).map((function(e){return gu(t,e)})),l.prevHasMore=null!==(i=n.prev_hasmore)&&void 0!==i&&i,l.isContinuousPrevMessages=null!==(a=n.is_continuous_prev_messages)&&void 0!==a&&a,l.nextMessages=(null!==(s=n.next_messages)&&void 0!==s?s:[]).map((function(e){return gu(t,e)})),l.nextHasmore=null!==(o=n.next_hasmore)&&void 0!==o&&o,l.isContinuousNextMessages=null!==(u=n.is_continuous_next_messages)&&void 0!==u&&u,l}return Be(t,e),t}(fn),hv=function(e){this.source=e},fv=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Be(t,e),t}(hv),pv=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Be(t,e),t}(hv),_v=function(e){this.source=e},vv=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Be(t,e),t}(_v),mv=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Be(t,e),t}(_v),gv=6e5,yv={includeMetaArray:!0,includeReactions:!0,includeThreadInfo:!0,includeParentMessageInfo:!0};!function(e){e.CACHE_AND_REPLACE_BY_API="cache_and_replace_by_api"}(tv||(tv={}));var Ev,bv,Cv,wv=function(){function e(){this._onCacheResult=Dn,this._onApiResult=Dn}return e.prototype._invokeResponse=function(e,t,n){var r=this;Es((function(){return Qe(r,void 0,void 0,(function(){return Ke(this,(function(r){switch(e){case"local":this._onCacheResult(t,n);break;case"remote":this._onApiResult(t,n)}return[2]}))}))}))},e.prototype.onCacheResult=function(e){return this._onCacheResult=e,this},e.prototype.onApiResult=function(e){return this._onApiResult=e,this},e}(),Sv=function(){function e(e,t){var n=t.filter,r=t.startingPoint,i=t.limit,a=t.channel,s=t.channelManager,o=t.disableBackgroundSync,u=void 0!==o&&o,l=this;this._messages=[],this._unsentMessages=[],this._isLoadingPrevious=!1,this._isLoadingNext=!1,this._iid=e,this._key="mc-".concat(xt()),this._isDisposed=!1,this.filter=null!=n?n:new th,this._channel=a,this._syncRange=new Y_({}),this._hasPrevious=!0,this._hasNext=!0,this._startingPoint="number"==typeof r?r:Date.now()+gv,this._limit=i||100,this._channelManager=s,this._channelManager.subscribeChannelEvent(this._key,{onUpdate:function(e,t,n){var r=e.findIndex((function(e){return e.isIdentical(l.channel)}));r>=0&&(l._replaceChannelOfCollection(e[r]),l.channel._runIfHandleableWithGroupChannel((function(e){switch(t){case no.EVENT_CHANNEL_UPDATED:var r=!1;for(var i in l._messages)if(l._messages[i].createdAt>=e.messageOffsetTimestamp){r=!0;var a=parseInt(i);if(a>0){var s=l._messages.splice(0,a);l._removeMessagesFromView(s.map((function(e){return l.keyOf(e)})),no.EVENT_MESSAGE_OFFSET_UPDATED)}break}!r&&l._messages.length>0&&l._removeMessagesFromView(l._messages.map((function(e){return l.keyOf(e)})),no.EVENT_MESSAGE_OFFSET_UPDATED);break;case no.EVENT_CHANNEL_UNMUTED:var o=eo.of(l._iid).sdkState,u=n;o.userId===u&&l._clearCheckMyMutedTimer();break;case no.EVENT_CHANNEL_MUTED:o=eo.of(l._iid).sdkState;var c=n;o.userId===c&&-1!==e._myMutedRemainingTime&&l._startCheckMyMutedTimer(e._myMutedRemainingTime);break;case no.EVENT_CHANNEL_LEFT:e.isPublic&&l._clearCheckMyMutedTimer()}Es((function(){return Qe(l,void 0,void 0,(function(){var e,n;return Ke(this,(function(r){return e=this._createChannelEventContext(t),Xp(t)&&(null===(n=this._handler)||void 0===n?void 0:n.onChannelUpdated)&&this._handler.onChannelUpdated(e,this.channel),[2]}))}))}))})),l._postprocessChannelUpdateEvent(e[r],t))},onRemove:function(e,t){var n=e.indexOf(l.channel.url);n>=0&&(l._clearCheckMyMutedTimer(),Es((function(){return Qe(l,void 0,void 0,(function(){var e,n;return Ke(this,(function(r){return e=this._createChannelEventContext(t),(null===(n=this._handler)||void 0===n?void 0:n.onChannelDeleted)&&this._handler.onChannelDeleted(e,this.channel.url),[2]}))}))})),l._postprocessChannelRemoveEvent(e[n]))}}),this._channelManager.subscribeMessageEvent(this._key,{onUpdate:function(e,t){var n,r,i=[],a=[];try{for(var s=We(e),o=s.next();!o.done;o=s.next()){var u=o.value;u.channelUrl===l._channel.url&&(l.filter.match(u)?i.push(u):a.push(l.keyOf(u)))}}catch(e){n={error:e}}finally{try{o&&!o.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}if(lo(t)){if(i.length>0)switch(t){case no.LOCAL_MESSAGE_CANCELED:case no.LOCAL_MESSAGE_RESEND_STARTED:case no.EVENT_MESSAGE_SENT_FAILED:case no.EVENT_MESSAGE_SENT_SUCCESS:case no.EVENT_MESSAGE_UPDATED:case no.EVENT_MESSAGE_THREADINFO_UPDATED:case no.EVENT_MESSAGE_REACTION_UPDATED:case no.SYNC_MESSAGE_CHANGELOGS:l._updateMessagesToView(i,t);break;case no.EVENT_MESSAGE_SENT_PENDING:l._addMessagesToView(i,t);break;case no.EVENT_MESSAGE_RECEIVED:l.hasNext||l._addMessagesToView(i,t);break;case no.SYNC_MESSAGE_FILL:l._addMessagesToView(i,t)}a.length>0&&l._removeMessagesFromView(a,t)}l._postprocessMessageUpdateEvent(e,t)},onRemove:function(e,t){l._removeMessagesFromView(e,t),l._postprocessMessageRemoveEvent(e)},onRemoveUnsent:function(e,t){l._removeUnsentMessageFromView(e,t)},onPollChangeLogUpdate:function(e,t){l._updatePollsToView(e,t)},onPollUpdate:function(e,t){l._applyPollUpdateEventToView(e,t)},onPollVote:function(e,t){l._applyPollVoteEventToView(e,t)}});var c=eo.of(this._iid),d=c.cacheContext,h=c.dispatcher;this._channel._updateMessageCollectionLastAccessedAt();var f=this._createChannelUpdateEventCommand(no.CHANNEL_LASTACCESSEDAT_UPDATED);f&&h.dispatch(f),!u&&this._shouldStartBackgroundSync()&&(this._backgroundSync=iv.of(this._iid,this._channel),this._backgroundSync.resume(this._startingPoint)),this._changelogSync=sv.of(this._iid,this._channel),this._changelogSync.resume(),this._pollChangelogSync=uv.of(this._iid,this._channel,this._hasPollMessage.bind(this)),this._pollChangelogSync.resume(),this._prevFill=new nv(this._key,(function(e){return Qe(l,void 0,void 0,(function(){var t,n,r,i,a,s,o;return Ke(this,(function(u){switch(u.label){case 0:return[4,this._getRemoteMessages(e,{prevLimit:this._limit,source:no.SYNC_MESSAGE_FILL,checkingContinuousMessages:d.localCacheEnabled})];case 1:return t=u.sent(),n=t.messages,r=t.isContinuousMessages,n.length>0?(i=Math.min.apply(Math,Ze([],Ye(n.map((function(e){return e.createdAt}))),!1)),this._syncRange.extends(i),r&&(null===(a=this._backgroundSync)||void 0===a||a.range.extends(i)),[2,{hasNext:n.length>=this._limit&&this.viewTop<i,nextToken:this._syncRange.top}]):(p.put(new Nn({type:dn.FEATURE_LOCALCACHE_EVENT,ts:Date.now(),data:{channel_url:this.channel.url,measured_on:"gap_check",event:"cache_fetch",max_db_size:null!==(o=null===(s=d.localCacheConfig)||void 0===s?void 0:s.maxSize)&&void 0!==o?o:0,use_local_cache:d.localCacheEnabled,starting_point:0,message_init_policy:""}})),[2,{hasNext:!1,nextToken:0}])}}))}))})),this._nextFill=new nv(this._key,(function(e){return Qe(l,void 0,void 0,(function(){var t,n,r,i,a,s,o;return Ke(this,(function(u){switch(u.label){case 0:return[4,this._getRemoteMessages(e,{nextLimit:this._limit,source:no.SYNC_MESSAGE_FILL,checkingContinuousMessages:d.localCacheEnabled})];case 1:return t=u.sent(),n=t.messages,r=t.isContinuousMessages,n.length>0?(i=Math.max.apply(Math,Ze([],Ye(n.map((function(e){return e.createdAt}))),!1)),this._syncRange.extends(i),r&&(null===(a=this._backgroundSync)||void 0===a||a.range.extends(i)),[2,{hasNext:!(n.length>=this._limit&&this._hasNext)||this.viewBottom>i,nextToken:this._syncRange.bottom}]):(p.put(new Nn({type:dn.FEATURE_LOCALCACHE_EVENT,ts:Date.now(),data:{channel_url:this.channel.url,measured_on:"gap_check",event:"cache_fetch",max_db_size:null!==(o=null===(s=d.localCacheConfig)||void 0===s?void 0:s.maxSize)&&void 0!==o?o:0,use_local_cache:d.localCacheEnabled,starting_point:0,message_init_policy:""}})),[2,{hasNext:!1,nextToken:0}])}}))}))})),this._connectionEventContext=h.on((function(e){if(e instanceof Ka)switch(e.stateType){case Ga.CONNECTED:bs((function(){return Qe(l,void 0,void 0,(function(){return Ke(this,(function(e){return this._activate(),[2]}))}))}));break;case Ga.LOGOUT:l.dispose();break;default:l._clearCheckMyMutedTimer(),l._prevFill.stop(),l._nextFill.stop()}}));var p=eo.of(this._iid).statLogCollector;p.put(new Qs({type:dn.FEATURE_LOCALCACHE,data:{use_local_cache:d.localCacheEnabled,collection_interface:{message:!0}}}))}return e.prototype.keyOf=function(e){return 0},e.prototype._postprocessChannelUpdateEvent=function(e,t){},e.prototype._postprocessChannelRemoveEvent=function(e){},e.prototype._postprocessMessageUpdateEvent=function(e,t){},e.prototype._postprocessMessageRemoveEvent=function(e){},Object.defineProperty(e.prototype,"channel",{get:function(){return this._channel},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"succeededMessages",{get:function(){return Ze([],Ye(this._messages),!1)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"failedMessages",{get:function(){return this._unsentMessages.filter((function(e){return e.sendingStatus===Dt.FAILED}))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pendingMessages",{get:function(){return this._unsentMessages.filter((function(e){return e.sendingStatus===Dt.PENDING}))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hasPrevious",{get:function(){return this._hasPrevious},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hasNext",{get:function(){return this._hasNext},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"viewTop",{get:function(){return Math.min.apply(Math,Ze(Ze([],Ye(this._messages.map((function(e){return e.createdAt}))),!1),[Number.MAX_SAFE_INTEGER],!1))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"viewBottom",{get:function(){return Math.max.apply(Math,Ze(Ze([],Ye(this._messages.map((function(e){return e.createdAt}))),!1),[0],!1))},enumerable:!1,configurable:!0}),e.prototype._activate=function(){return Qe(this,void 0,void 0,(function(){return Ke(this,(function(e){switch(e.label){case 0:return eo.of(this._iid).logger.debug("check huge gap"),this._checkHugeGap(),[4,this._refreshChannel(no.SYNC_CHANNEL_CHANGELOGS)];case 1:return e.sent(),[2]}}))}))},e.prototype._replaceChannelOfCollection=function(e){this._channel.isGroupChannel()?this._channel=e:this._channel.isFeedChannel()&&(this._channel._groupChannel=e._groupChannel)},e.prototype._shouldStartBackgroundSync=function(){var e=eo.of(this._iid).cacheContext;return this.channel.isGroupChannel()?e.localCacheEnabled&&!this.channel.isSuper:e.localCacheEnabled},e.prototype._createChannelEventContext=function(e){switch(!0){case this.channel.isGroupChannel():return new fv(e);case this.channel.isFeedChannel():return new pv(e);default:throw new st({code:Je.WRONG_CHANNEL_TYPE,message:"Wrong channel type"})}},e.prototype._createMessageEventContext=function(e){switch(!0){case this.channel.isGroupChannel():return new vv(e);case this.channel.isFeedChannel():return new mv(e);default:throw new st({code:Je.WRONG_CHANNEL_TYPE,message:"Wrong channel type"})}},e.prototype._createChannelUpdateEventCommand=function(e){switch(!0){case this.channel.isGroupChannel():return new $p({channels:[this._channel],source:e});case this.channel.isFeedChannel():return new lv({channels:[this._channel],source:e});default:return null}},e.prototype._setBaseMessageCollectionHandler=function(e){this._handler=e},e.prototype._filterUnderOffsetMessage=function(e){return e},e.prototype._updateChildMessagesInView=function(e){var t=[];return this._messages.forEach((function(n){n instanceof iu&&n.parentMessageId===e.messageId&&n.applyParentMessage(e)&&t.push(n)})),t},e.prototype._updatePollsToView=function(e,t){var n,r,i=this,a=[];try{for(var s=We(e),o=s.next();!o.done;o=s.next()){var u=o.value,l=$_(this._messages,u.messageId);if(l>=0){var c=this._messages[l];c.isUserMessage()&&c.applyPoll(u),a.push(c)}}}catch(e){n={error:e}}finally{try{o&&!o.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}return a.length>0&&lo(t)&&Es((function(){return Qe(i,void 0,void 0,(function(){var e,n,r;return Ke(this,(function(i){return e=this._createMessageEventContext(t),a.length>0&&(null===(r=(n=this._handler).onMessagesUpdated)||void 0===r||r.call(n,e,this.channel,a)),[2]}))}))})),a},e.prototype._applyPollUpdateEventToView=function(e,t){var n=this,r=$_(this._messages,e.messageId);if(r>=0){var i=this._messages[r];i&&i.isUserMessage()&&i.poll&&i.poll.applyPollUpdateEvent(e)&&lo(t)&&Es((function(){return Qe(n,void 0,void 0,(function(){var e,n,r;return Ke(this,(function(a){return e=this._createMessageEventContext(t),null===(r=null===(n=this._handler)||void 0===n?void 0:n.onMessagesUpdated)||void 0===r||r.call(n,e,this.channel,[i]),[2]}))}))}))}},e.prototype._applyPollVoteEventToView=function(e,t){var n=this,r=$_(this._messages,e.messageId);if(r>=0){var i=this._messages[r];i&&i.isUserMessage()&&i.poll&&i.poll.applyPollVoteEvent(e)&&lo(t)&&Es((function(){return Qe(n,void 0,void 0,(function(){var e,n,r;return Ke(this,(function(a){return e=this._createMessageEventContext(t),null===(r=null===(n=this._handler)||void 0===n?void 0:n.onMessagesUpdated)||void 0===r||r.call(n,e,this.channel,[i]),[2]}))}))}))}},e.prototype._removeMessagesFromView=function(e,t){var n,r,i=this,a=[],s=[],o=function(e){var t=u._messages.findIndex((function(t){return i.keyOf(t)===e}));if(t>=0){var n=u._messages[t];a.push(u.keyOf(n)),s.push(n),u._messages.splice(t,1)}},u=this;try{for(var l=We(e),c=l.next();!c.done;c=l.next())o(c.value)}catch(e){n={error:e}}finally{try{c&&!c.done&&(r=l.return)&&r.call(l)}finally{if(n)throw n.error}}return lo(t)&&s.length>0&&Es((function(){return Qe(i,void 0,void 0,(function(){var e,n,r;return Ke(this,(function(i){return e=this._createMessageEventContext(t),null===(r=null===(n=this._handler)||void 0===n?void 0:n.onMessagesDeleted)||void 0===r||r.call(n,e,this.channel,a,s),[2]}))}))})),a},e.prototype._removeUnsentMessageFromView=function(e,t){var n=this._unsentMessages.findIndex((function(t){return t.reqId===e}));n>=0&&this._unsentMessages.splice(n,1)},e.prototype._getLocalMessages=function(e,t){var n=t.prevLimit,r=void 0===n?0:n,i=t.nextLimit,a=void 0===i?0:i,s=t.inclusive,o=void 0===s||s;return Qe(this,void 0,void 0,(function(){var t,n,i,s,u;return Ke(this,(function(l){switch(l.label){case 0:return t=[],o?[4,this._channelManager.getExactlyMatchingMessagesForTokenFromCache(this._channel.url,e,this.filter)]:[3,2];case 1:t=l.sent(),l.label=2;case 2:return r>0?[4,this._channelManager.getMessagesFromCache(this._channel.url,e,"prev",this.filter,r,!1)]:[3,4];case 3:return i=l.sent(),[3,5];case 4:i=[],l.label=5;case 5:return n=i,a>0?[4,this._channelManager.getMessagesFromCache(this._channel.url,e,"next",this.filter,a,!1)]:[3,7];case 6:return u=l.sent(),[3,8];case 7:u=[],l.label=8;case 8:return s=u,[2,Ze(Ze(Ze([],Ye(t),!1),Ye(n),!1),Ye(s),!1).sort((function(e,t){return t.createdAt-e.createdAt}))]}}))}))},e.prototype._getRemoteMessages=function(e,t){var n=t.prevLimit,r=void 0===n?0:n,i=t.nextLimit,a=void 0===i?0:i,s=t.source,o=void 0===s?no.REQUEST_MESSAGE:s,u=t.reverse,l=void 0!==u&&u,c=t.checkingHasNext,d=void 0!==c&&c,h=t.checkingContinuousMessages,f=void 0!==h&&h;return Qe(this,void 0,void 0,(function(){var t,n;return Ke(this,(function(i){switch(i.label){case 0:return t=vh.of(this._iid),r>0||a>0?[4,t._getMessagesByTimestampForCollection(this._channel.url,this._channel.channelType,e,Vt(je(je(je({},this.filter),yv),{isInclusive:!0,reverse:l,prevResultSize:r,nextResultSize:a})),o,d,f)]:[3,2];case 1:return n=i.sent(),[3,3];case 2:n={messages:[],isContinuousMessages:!1},i.label=3;case 3:return[2,n]}}))}))},e.prototype._checkHugeGap=function(){var e,t,n,r,i;return Qe(this,void 0,void 0,(function(){var a,s,o,u,l,c,d,h,f,p,_,v,m,g,y,E,b,C,w,S,T,I,N,A,k,M,U=this;return Ke(this,(function(O){switch(O.label){case 0:return a=eo.of(this._iid),s=a.dispatcher,o=a.requestQueue,u=a.cacheContext,l=a.statLogCollector,c=a.logger,this._messages.length>0?(d=this._syncRange.top,h=this.viewTop,f=this._syncRange.bottom,p=this.hasNext?this.viewBottom:Number.MAX_SAFE_INTEGER,[4,this._channelManager.getCachedMessageCountBetween(this._channel.url,this.filter,h,d)]):[3,8];case 1:return _=O.sent(),[4,this._channelManager.getCachedMessageCountBetween(this._channel.url,this.filter,f,p)];case 2:v=O.sent(),O.label=3;case 3:return O.trys.push([3,5,6,7]),[4,Ns((function(){return Qe(U,void 0,void 0,(function(){var e,t,n,r,i,a,l,c,m,g,y,E,b,C,w,S,T,I=this;return Ke(this,(function(N){switch(N.label){case 0:return e=new cv(je(je({channelUrl:this._channel.url,channelType:this._channel.channelType,prevStart:h,prevEnd:d,prevCount:_,nextStart:f,nextEnd:p,nextCount:v,checkingContinuousMessages:u.localCacheEnabled},this.filter),yv)),[4,o.send(e)];case 1:return t=N.sent(),n=t.as(dv),r=n.isHugeGap,i=n.prevMessages,a=void 0===i?[]:i,l=n.prevHasMore,c=n.isContinuousPrevMessages,m=n.nextMessages,g=void 0===m?[]:m,y=n.nextHasmore,E=n.isContinuousNextMessages,r?Es((function(){return Qe(I,void 0,void 0,(function(){var e;return Ke(this,(function(t){return(null===(e=this._handler)||void 0===e?void 0:e.onHugeGapDetected)&&this._handler.onHugeGapDetected(),[2]}))}))})):(b=this.viewTop,C=this.viewBottom,w=Math.min.apply(Math,Ze([Number.MAX_SAFE_INTEGER,b],Ye(a.map((function(e){return e.createdAt}))),!1)),S=Math.max.apply(Math,Ze([0,C],Ye(g.map((function(e){return e.createdAt}))),!1)),s.dispatch(new co({messages:a,source:no.SYNC_MESSAGE_FILL})),s.dispatch(new co({messages:g,source:no.SYNC_MESSAGE_FILL})),this._syncRange.extends(w,S),(c||E)&&(null===(T=this._backgroundSync)||void 0===T||T.range.extends(w,S)),l&&this._prevFill.start(w),y&&this._nextFill.start(S)),[2]}}))}))}),1)];case 4:return O.sent(),[3,7];case 5:return m=O.sent(),c.debug("Failed HugeGap Check ",m),[3,7];case 6:return l.put(new Nn({type:dn.FEATURE_LOCALCACHE_EVENT,ts:Date.now(),data:{channel_url:this.channel.url,measured_on:"gap_check",event:"cache_fetch",max_db_size:null!==(t=null===(e=u.localCacheConfig)||void 0===e?void 0:e.maxSize)&&void 0!==t?t:0,use_local_cache:u.localCacheEnabled,starting_point:0,message_init_policy:""}})),[7];case 7:return[3,13];case 8:g=Math.floor(this._limit/2),y=Date.now(),O.label=9;case 9:return O.trys.push([9,11,12,13]),[4,this._getRemoteMessages(y,{prevLimit:g,nextLimit:g,source:no.SYNC_MESSAGE_FILL,checkingHasNext:!0,checkingContinuousMessages:u.localCacheEnabled})];case 10:if(E=O.sent(),b=E.messages,C=E.isContinuousMessages,w=E.hasNext,b.length>0){for(S=b.map((function(e){return e.createdAt})),T=0,I=0,N=0;N<S.length;N++)(A=S[N])<=y?T++:A>=y&&I++;this._hasPrevious=T>=g,this._hasNext=null!=w?w:I>=g,(M=this._syncRange).extends.apply(M,Ze([],Ye(S),!1)),C&&(null===(n=this._backgroundSync)||void 0===n||n.range.extends(this._syncRange.top,this._syncRange.bottom)),this._addMessagesToView(b,no.SYNC_MESSAGE_FILL)}else this._hasPrevious=!1,this._hasNext=!1;return[3,13];case 11:return(k=O.sent())instanceof st&&k.code===Je.NOT_FOUND_IN_DATABASE&&(this._hasPrevious=!1,this._hasNext=!1),[3,13];case 12:return l.put(new Nn({type:dn.FEATURE_LOCALCACHE_EVENT,ts:Date.now(),data:{channel_url:this.channel.url,measured_on:"gap_check",event:"cache_fetch",max_db_size:null!==(i=null===(r=u.localCacheConfig)||void 0===r?void 0:r.maxSize)&&void 0!==i?i:0,use_local_cache:u.localCacheEnabled,starting_point:0,message_init_policy:""}})),[7];case 13:return[2]}}))}))},e.prototype._loadUnsentMessages=function(){return Qe(this,void 0,void 0,(function(){var e;return Ke(this,(function(t){switch(t.label){case 0:return e=this,[4,this._channelManager.getUnsentMessagesFromCache(this._channel.url,this.filter)];case 1:return e._unsentMessages=t.sent(),[2]}}))}))},e.prototype._hasPollMessage=function(){return Qe(this,void 0,void 0,(function(){return Ke(this,(function(e){switch(e.label){case 0:return[4,this._channelManager.getPollMessagesFromCache(this._channel.url,Date.now()+gv,this.filter,1)];case 1:return e.sent().length>0?[2,!0]:[2,!1]}}))}))},e.prototype._refreshChannel=function(e){var t=this;bs((function(){return Qe(t,void 0,void 0,(function(){return Ke(this,(function(t){switch(t.label){case 0:return[4,this._channelManager.refreshChannel(this.channel.url,!0,e)];case 1:return t.sent(),[2]}}))}))}))},e.prototype._startCheckMyMutedTimer=function(e){var t=this;this._clearCheckMyMutedTimer(),this._checkMyMutedStateTimer=setTimeout((function(){return Qe(t,void 0,void 0,(function(){var e,t,n=this;return Ke(this,(function(r){switch(r.label){case 0:this._checkMyMutedStateTimer=void 0,e=!0,r.label=1;case 1:return r.trys.push([1,3,4,5]),[4,this._channel.getMyMutedInfo()];case 2:return t=r.sent(),e=!t.isMuted,[3,5];case 3:return r.sent(),e=!0,[3,5];case 4:return e&&this.channel._runIfHandleableWithGroupChannel((function(e){var t,r;e.myMutedState=It.UNMUTED;var i=n._createChannelEventContext(no.EVENT_CHANNEL_UNMUTED);null===(r=null===(t=n._handler)||void 0===t?void 0:t.onChannelUpdated)||void 0===r||r.call(t,i,n.channel)})),[7];case 5:return[2]}}))}))}),e+1e3)},e.prototype._clearCheckMyMutedTimer=function(){this._checkMyMutedStateTimer&&(clearTimeout(this._checkMyMutedStateTimer),this._checkMyMutedStateTimer=void 0)},e.prototype.initialize=function(e){var t=this,n=new wv;this._messages=[],this._unsentMessages=[],this._syncRange=new Y_({}),this._hasNext=!0,this._hasPrevious=!0,this._refreshChannel(no.REFRESH_CHANNEL);var r=eo.of(this._iid),i=r.cacheContext,a=r.statLogCollector,s=Math.floor(this._limit/2);return e===tv.CACHE_AND_REPLACE_BY_API&&this._getLocalMessages(this._startingPoint,{prevLimit:s,nextLimit:s}).then((function(e){return Qe(t,void 0,void 0,(function(){var t;return Ke(this,(function(r){switch(r.label){case 0:return t=this._filterUnderOffsetMessage(e),this._addMessagesToView(t,no.REQUEST_MESSAGE),[4,this._loadUnsentMessages()];case 1:return r.sent(),n._invokeResponse("local",null,t),[2]}}))}))})).catch((function(e){if(at(e))throw e;n._invokeResponse("local",e,null)})).finally((function(){var r=eo.of(t._iid).cacheContext;t._getRemoteMessages(t._startingPoint,{prevLimit:s,nextLimit:s,reverse:!0,checkingHasNext:!0,checkingContinuousMessages:r.localCacheEnabled}).then((function(i){var o,u,l,c,d,h,f=i.messages,p=i.isContinuousMessages,_=i.hasNext,v=t._filterUnderOffsetMessage(f),m=!0;if(t._messages.length===v.length){var g=t._messages.map((function(e){return t.keyOf(e)}));for(var y in v)if(!g.includes(t.keyOf(v[y]))){m=!1;break}}else m=!1;if(t._messages=[],v.length>0){var E=v.map((function(e){return e.createdAt})),b=0,C=0;for(y=0;y<E.length;y++){var w=E[y];w<t._startingPoint?b++:w>t._startingPoint&&C++}t._hasPrevious=b>=s,t._hasNext=null!=_?_:C>=s,(o=t._syncRange).extends.apply(o,Ze([],Ye(v.map((function(e){return e.createdAt}))),!1)),p&&(null===(u=t._backgroundSync)||void 0===u||u.range.extends(t._syncRange.top,t._syncRange.bottom)),t._addMessagesToView(v,no.REQUEST_MESSAGE)}else t._hasPrevious=!1,t._hasNext=!1;a.put(new Nn({type:dn.FEATURE_LOCALCACHE_EVENT,ts:Date.now(),data:{channel_url:t.channel.url,starting_point:t._startingPoint,measured_on:"initial_load",event:m?"cache_hit":"cache_miss",max_db_size:null!==(c=null===(l=r.localCacheConfig)||void 0===l?void 0:l.maxSize)&&void 0!==c?c:0,message_init_policy:e,use_local_cache:r.localCacheEnabled,collection_id:t._key}})),a.put(new Nn({type:dn.FEATURE_LOCALCACHE_EVENT,ts:Date.now(),data:{channel_url:t.channel.url,starting_point:t._startingPoint,measured_on:"initial_load",event:"cache_fetch",max_db_size:null!==(h=null===(d=r.localCacheConfig)||void 0===d?void 0:d.maxSize)&&void 0!==h?h:0,message_init_policy:e,use_local_cache:r.localCacheEnabled,collection_id:t._key}})),n._invokeResponse("remote",null,v)})).catch((function(e){if(at(e))throw e;n._invokeResponse("remote",e,null)}))})),a.put(new Qs({type:dn.FEATURE_LOCALCACHE,data:{use_local_cache:i.localCacheEnabled,collection_interface:{message_init_policy:e}}})),n},e.prototype.loadPrevious=function(){var e,t,n;return Qe(this,void 0,void 0,(function(){var r,i,a,s,o,u,l,c,d=this;return Ke(this,(function(h){switch(h.label){case 0:if(this._isDisposed)throw new st({code:Je.COLLECTION_DISPOSED,message:"Collection has been disposed."});return r=eo.of(this._iid),i=r.cacheContext,a=r.statLogCollector,s=r.logger,this._hasPrevious?this._isLoadingPrevious?(s.warn("Messages are already fetching."),[2,[]]):(this._isLoadingPrevious=!0,o=Math.floor(this._limit/2),u=this.viewTop,l=[],[4,bs((function(){return Qe(d,void 0,void 0,(function(){var e;return Ke(this,(function(t){switch(t.label){case 0:return e=this._filterUnderOffsetMessage,[4,this._getLocalMessages(u,{prevLimit:o,inclusive:!1})];case 1:return l=e.apply(this,[t.sent()]),[2]}}))}))}))]):[2,[]];case 1:return h.sent(),c=l.length>=o,a.put(new Nn({type:dn.FEATURE_LOCALCACHE_EVENT,ts:Date.now(),data:{channel_url:this.channel.url,starting_point:this._startingPoint,measured_on:"load_prev",event:c?"cache_hit":"cache_miss",max_db_size:null!==(t=null===(e=i.localCacheConfig)||void 0===e?void 0:e.maxSize)&&void 0!==t?t:0,use_local_cache:i.localCacheEnabled,collection_id:this._key,message_init_policy:""}})),c&&(null===(n=this._backgroundSync)||void 0===n?void 0:n.isWrappingMessages(l))?[3,3]:[4,bs((function(){return Qe(d,void 0,void 0,(function(){var e,t,n,r,i,s,c,d=this;return Ke(this,(function(h){switch(h.label){case 0:return e=eo.of(this._iid).cacheContext,[4,this._getRemoteMessages(u,{prevLimit:o,reverse:!0,checkingContinuousMessages:e.localCacheEnabled})];case 1:return t=h.sent(),(l=this._filterUnderOffsetMessage(t.messages)).length>0&&((n=this._syncRange).extends.apply(n,Ze([],Ye(l.map((function(e){return e.createdAt}))),!1)),(null===(r=this._backgroundSync)||void 0===r?void 0:r.range.overlap(this._syncRange))&&t.isContinuousMessages&&(null===(i=this._backgroundSync)||void 0===i||i.range.extends(this._syncRange.top))),l=l.filter((function(e){return X_(d._messages,e)<0})),this._hasPrevious=l.length>=o,a.put(new Nn({type:dn.FEATURE_LOCALCACHE_EVENT,ts:Date.now(),data:{channel_url:this.channel.url,starting_point:this._startingPoint,measured_on:"load_prev",event:"cache_fetch",max_db_size:null!==(c=null===(s=e.localCacheConfig)||void 0===s?void 0:s.maxSize)&&void 0!==c?c:0,use_local_cache:e.localCacheEnabled,collection_id:this._key,message_init_policy:""}})),[2]}}))}))}))];case 2:return h.sent(),this._addMessagesToView(l,no.REQUEST_MESSAGE),[3,4];case 3:this._hasPrevious=l.length>=o,l.length>0&&this._addMessagesToView(l,no.REQUEST_MESSAGE),h.label=4;case 4:return this._isLoadingPrevious=!1,[2,l]}}))}))},e.prototype.loadNext=function(){var e,t,n;return Qe(this,void 0,void 0,(function(){var r,i,a,s,o,u,l,c,d=this;return Ke(this,(function(h){switch(h.label){case 0:if(this._isDisposed)throw new st({code:Je.COLLECTION_DISPOSED,message:"Collection has been disposed."});return r=eo.of(this._iid),i=r.cacheContext,a=r.statLogCollector,s=r.logger,this._hasNext?this._isLoadingNext?(s.warn("Messages are already fetching."),[2,[]]):(this._isLoadingNext=!0,o=Math.floor(this._limit/2),u=this.viewBottom,l=[],[4,bs((function(){return Qe(d,void 0,void 0,(function(){var e;return Ke(this,(function(t){switch(t.label){case 0:return e=this._filterUnderOffsetMessage,[4,this._getLocalMessages(u,{nextLimit:o,inclusive:!1})];case 1:return l=e.apply(this,[t.sent()]),[2]}}))}))}))]):[2,[]];case 1:return h.sent(),c=l.length>=o,a.put(new Nn({type:dn.FEATURE_LOCALCACHE_EVENT,ts:Date.now(),data:{channel_url:this.channel.url,starting_point:this._startingPoint,measured_on:"load_next",event:c?"cache_hit":"cache_miss",max_db_size:null!==(t=null===(e=i.localCacheConfig)||void 0===e?void 0:e.maxSize)&&void 0!==t?t:0,use_local_cache:i.localCacheEnabled,collection_id:this._key,message_init_policy:""}})),c&&(null===(n=this._backgroundSync)||void 0===n?void 0:n.isWrappingMessages(l))?[3,3]:[4,bs((function(){return Qe(d,void 0,void 0,(function(){var e,t,n,r,i,s,c,d,h=this;return Ke(this,(function(f){switch(f.label){case 0:return e=eo.of(this._iid).cacheContext,[4,this._getRemoteMessages(u,{nextLimit:o,reverse:!0,checkingHasNext:!0,checkingContinuousMessages:e.localCacheEnabled})];case 1:return t=f.sent(),(l=this._filterUnderOffsetMessage(t.messages)).length>0&&((n=this._syncRange).extends.apply(n,Ze([],Ye(l.map((function(e){return e.createdAt}))),!1)),(null===(r=this._backgroundSync)||void 0===r?void 0:r.range.overlap(this._syncRange))&&t.isContinuousMessages&&(null===(i=this._backgroundSync)||void 0===i||i.range.extends(this._syncRange.bottom))),l=l.filter((function(e){return X_(h._messages,e)<0})),this._hasNext=null!==(s=t.hasNext)&&void 0!==s?s:l.length>=o,a.put(new Nn({type:dn.FEATURE_LOCALCACHE_EVENT,ts:Date.now(),data:{channel_url:this.channel.url,starting_point:this._startingPoint,measured_on:"load_next",event:"cache_fetch",max_db_size:null!==(d=null===(c=e.localCacheConfig)||void 0===c?void 0:c.maxSize)&&void 0!==d?d:0,use_local_cache:e.localCacheEnabled,collection_id:this._key,message_init_policy:""}})),[2]}}))}))}))];case 2:return h.sent(),this._addMessagesToView(l,no.REQUEST_MESSAGE),[3,4];case 3:this._hasNext=l.length>=o,l.length>0&&this._addMessagesToView(l,no.REQUEST_MESSAGE),h.label=4;case 4:return this._isLoadingNext=!1,[2,l]}}))}))},e.prototype.removeFailedMessage=function(e){return Qe(this,void 0,void 0,(function(){var t;return Ke(this,(function(n){switch(n.label){case 0:if(this._isDisposed)throw new st({code:Je.COLLECTION_DISPOSED,message:"Collection has been disposed."});return[4,this._channelManager.removeFailedMessageFromCache(e)];case 1:return n.sent(),(t=this._unsentMessages.findIndex((function(t){return t.reqId===e})))>-1&&this._unsentMessages.splice(t,1),[2]}}))}))},e.prototype.dispose=function(){var e,t,n,r=this;if(!this._isDisposed){this._isDisposed=!0;var i=eo.of(this._iid),a=i.cacheContext,s=i.dispatcher;this._messages=[],this._clearCheckMyMutedTimer(),this._channel._runIfHandleableWithGroupChannel((function(e){if(e.myMemberState!==kp.NONE){r._channel._updateMessageCollectionLastAccessedAt();var t=r._createChannelUpdateEventCommand(no.CHANNEL_LASTACCESSEDAT_UPDATED);t&&s.dispatch(t)}})),a.localCacheEnabled&&(this._prevFill.stop(),this._nextFill.stop()),null===(e=this._backgroundSync)||void 0===e||e.close(),null===(t=this._changelogSync)||void 0===t||t.close(),null===(n=this._pollChangelogSync)||void 0===n||n.close(),this._channelManager.unsubscribeChannelEvent(this._key),this._channelManager.unsubscribeMessageEvent(this._key),this._connectionEventContext&&this._connectionEventContext.close()}},e}(),Tv=function(e){function t(t,n){return e.call(this,t,je(je({},n),{channelManager:J_.of(t)}))||this}return Be(t,e),t.prototype.keyOf=function(e){return e.messageId},t.prototype.initialize=function(t){var n=this;return bs((function(){return Qe(n,void 0,void 0,(function(){var e;return Ke(this,(function(t){switch(t.label){case 0:return[4,this.channel.getMyMutedInfo()];case 1:return(e=t.sent()).isMuted&&-1!==e.remainingDuration&&this._startCheckMyMutedTimer(e.remainingDuration),[2]}}))}))})),e.prototype.initialize.call(this,t)},t.prototype.setMessageCollectionHandler=function(e){this._setBaseMessageCollectionHandler(e)},t.prototype._activate=function(){return Qe(this,void 0,void 0,(function(){var t=this;return Ke(this,(function(n){switch(n.label){case 0:return[4,e.prototype._activate.call(this)];case 1:return n.sent(),[4,bs((function(){return Qe(t,void 0,void 0,(function(){var e;return Ke(this,(function(t){switch(t.label){case 0:return[4,this.channel.getMyMutedInfo()];case 1:return(e=t.sent()).isMuted&&-1!==e.remainingDuration&&this._startCheckMyMutedTimer(e.remainingDuration),[2]}}))}))}))];case 2:return n.sent(),[2]}}))}))},t.prototype._addMessagesToView=function(e,t){var n,r,i=this,a=this._filterUnderOffsetMessage(e),s=[],o=[];try{for(var u=We(a),l=u.next();!l.done;l=u.next()){var c=l.value;if(t===no.SYNC_MESSAGE_FILL)if(c.messageId>0){if((p=X_(this._messages,c))<0){X_(this._unsentMessages,c)<0&&s.push(c);var d=ev(this._messages,c);this._messages.splice(d,0,c)}}else c instanceof au&&(p=X_(this._unsentMessages,c))<0&&X_(this._messages,c)<0&&(this._unsentMessages.push(c),s.push(c));else if(c.messageId>0){if((p=X_(this._messages,c))<0){var h=X_(this._unsentMessages,c);h<0?s.push(c):(this._unsentMessages.splice(h,1),o.push(c)),d=ev(this._messages,c),this._messages.splice(d,0,c)}else o.push(c),this._messages[p]=c;if(c.updatedAt>0){var f=this._updateChildMessagesInView(c);o.push.apply(o,Ze([],Ye(f),!1))}}else if(c instanceof au){var p;(p=X_(this._unsentMessages,c))<0?X_(this._messages,c)<0&&(this._unsentMessages.push(c),s.push(c)):(o.push(c),this._unsentMessages[p]=c)}}}catch(e){n={error:e}}finally{try{l&&!l.done&&(r=u.return)&&r.call(u)}finally{if(n)throw n.error}}lo(t)&&Es((function(){return Qe(i,void 0,void 0,(function(){var e,n,r,i,a;return Ke(this,(function(u){return e=this._createMessageEventContext(t),s.length>0&&(null===(r=null===(n=this._handler)||void 0===n?void 0:n.onMessagesAdded)||void 0===r||r.call(n,e,this.channel,s)),o.length>0&&(null===(a=null===(i=this._handler)||void 0===i?void 0:i.onMessagesUpdated)||void 0===a||a.call(i,e,this.channel,o)),[2]}))}))}))},t.prototype._updateMessagesToView=function(e,t){var n,r,i=this,a=[],s=[],o=[];try{for(var u=We(e),l=u.next();!l.done;l=u.next()){var c,d=l.value;if(d.messageId>0)if((c=X_(this._messages,d))>=0)s.push(d),this._messages[c]=d;else{var h=X_(this._unsentMessages,d);if(h>=0){var f=Ye(this._unsentMessages.splice(h,1),1)[0];if(this.hasNext&&f)o.push(f);else{s.push(d);var p=ev(this._messages,d);this._messages.splice(p,0,d)}}else{var _=this._messages.map((function(e){return e.createdAt}));(d.createdAt<Math.min.apply(Math,Ze([],Ye(_),!1))&&!this._hasPrevious||d.createdAt>Math.max.apply(Math,Ze([],Ye(_),!1))&&!this._hasNext)&&a.push(d)}}else d instanceof au&&(c=X_(this._unsentMessages,d))>=0&&(s.push(d),this._unsentMessages[c]=d)}}catch(e){n={error:e}}finally{try{l&&!l.done&&(r=u.return)&&r.call(u)}finally{if(n)throw n.error}}return lo(t)&&Es((function(){return Qe(i,void 0,void 0,(function(){var e,n,r,i,u;return Ke(this,(function(l){return e=this._createMessageEventContext(t),s.length>0?null===(r=null===(n=this._handler)||void 0===n?void 0:n.onMessagesUpdated)||void 0===r||r.call(n,e,this.channel,s):o.length>0?null===(u=null===(i=this._handler)||void 0===i?void 0:i.onMessagesDeleted)||void 0===u||u.call(i,e,this.channel,[],o):a.length>0&&this._addMessagesToView(a,t),[2]}))}))})),s},t}(Sv),Iv={coverUrl:void 0,coverImage:void 0,isDistinct:void 0,isPublic:void 0,isDiscoverable:void 0,accessCode:void 0,name:void 0,data:void 0,customType:void 0,operatorUserIds:void 0,messageSurvivalSeconds:void 0},Nv=function(e){function t(t){var n=this,r=t.channelUrl,i=t.token,a=t.limit,s=t.order,o=t.mutedMemberFilter,u=t.memberStateFilter,l=t.nicknameStartsWithFilter,c=t.operatorFilter;return(n=e.call(this)||this).method=Gt.GET,n.path="".concat(Kt,"/").concat(encodeURIComponent(r),"/members"),n.params={token:i,limit:a,order:s,muted_member_filter:o,member_state_filter:u,nickname_startswith:l,operator_filter:c,show_member_is_muted:!0,show_read_receipt:!0,show_delivery_receipt:!0},n}return Be(t,e),t}(hn),Av=function(e){function t(t,n){var r=e.call(this,t,n)||this;r.members=[];var i=n.next,a=n.members;return r.token=i,a&&a.length>0&&(r.members=a.map((function(e){return new Fp(t,e)}))),r}return Be(t,e),t}(fn);!function(e){e.ALL="all",e.MUTED="muted",e.UNMUTED="unmuted"}(Ev||(Ev={})),function(e){e.MEMBER_NICKNAME_ALPHABETICAL="member_nickname_alphabetical",e.OPERATOR_THEN_MEMBER_ALPHABETICAL="operator_then_member_alphabetical"}(bv||(bv={})),function(e){e.ALL="all",e.JOINED="joined_only",e.INVITED="invited_only",e.INVITED_BY_FRIEND="invited_by_friend",e.INVITED_BY_NON_FRIEND="invited_by_non_friend"}(Cv||(Cv={}));var kv=function(e){function t(t,n,r){var i,a,s,o,u=this;return(u=e.call(this,t,n,St.GROUP,r)||this).mutedMemberFilter=Ev.ALL,u.memberStateFilter=Cv.ALL,u.nicknameStartsWithFilter=null,u.operatorFilter=Rp.ALL,u.order=bv.MEMBER_NICKNAME_ALPHABETICAL,u.mutedMemberFilter=null!==(i=r.mutedMemberFilter)&&void 0!==i?i:Ev.ALL,u.memberStateFilter=null!==(a=r.memberStateFilter)&&void 0!==a?a:Cv.ALL,u.nicknameStartsWithFilter=null!==(s=r.nicknameStartsWithFilter)&&void 0!==s?s:null,u.order=null!==(o=r.order)&&void 0!==o?o:bv.MEMBER_NICKNAME_ALPHABETICAL,u}return Be(t,e),t.prototype._validate=function(){return e.prototype._validate.call(this)&&dt(Ev,this.mutedMemberFilter)&&dt(Cv,this.memberStateFilter)&&(ct("string",this.nicknameStartsWithFilter)||null===this.nicknameStartsWithFilter)&&dt(Rp,this.operatorFilter)&&dt(bv,this.order)},t.prototype.next=function(){return Qe(this,void 0,void 0,(function(){var e,t,n,r,i,a;return Ke(this,(function(s){switch(s.label){case 0:return this._validate()?this._isLoading?[3,3]:this._hasNext?(this._isLoading=!0,e=eo.of(this._iid).requestQueue,t=new Nv(Vt(je(je({},this),{token:this._token}))),[4,e.send(t)]):[3,2]:[3,5];case 1:return n=s.sent(),r=n.as(Av),i=r.members,a=r.token,this._token=a,this._hasNext=!!a,this._isLoading=!1,[2,i];case 2:return[2,[]];case 3:throw st.queryInProgress;case 4:return[3,6];case 5:throw st.invalidParameters;case 6:return[2]}}))}))},t}(go),Mv=function(e){function t(t){var n=this,r=t.channelUrl,i=t.userId,a=t.accessCode;return(n=e.call(this)||this).method=Gt.PUT,n.path="".concat(Kt,"/").concat(encodeURIComponent(r),"/accept"),n.params={user_id:i,access_code:a},n}return Be(t,e),t}(hn),Uv=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.channel=new om(t,n),r.channel.myMemberState=kp.JOINED,r}return Be(t,e),t}(fn),Ov=function(e){function t(t){var n=this,r=t.channelUrl,i=t.isDistinct,a=t.isPublic,s=t.isDiscoverable,o=t.coverUrl,u=t.coverImage,l=t.accessCode,c=t.name,d=t.data,h=t.customType,f=t.operatorUserIds,p=t.messageSurvivalSeconds;return(n=e.call(this)||this).method=Gt.PUT,n.path="".concat(Kt,"/").concat(encodeURIComponent(r)),n.params=qt({is_distinct:i,is_public:a,is_discoverable:s,name:c,data:d,custom_type:h,cover_url:o,cover_file:u,access_code:l,operator_ids:f,message_survival_seconds:p}),n}return Be(t,e),t}(hn),Dv=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.channel=new om(t,n),r}return Be(t,e),t}(fn),Lv=function(e){function t(t){var n=this,r=t.channelUrl;return(n=e.call(this)||this).method=Gt.DELETE,n.path="".concat(Kt,"/").concat(encodeURIComponent(r)),n}return Be(t,e),t}(hn);!function(e){Be((function(t,n){return e.call(this,t,n)||this}),e)}(fn);var Rv=function(e){function t(t){var n=this,r=t.channelUrl;return(n=e.call(this)||this).method=Gt.DELETE,n.path="".concat(Kt,"/").concat(encodeURIComponent(r),"/hide"),n}return Be(t,e),t}(hn);!function(e){Be((function(){return null!==e&&e.apply(this,arguments)||this}),e)}(fn);var xv=function(e){function t(t){var n=t.userId,r=t.channelUrl,i=t.countPreference,a=e.call(this)||this;return a.method=Gt.PUT,a.path="".concat(jt,"/").concat(encodeURIComponent(n),"/count_preference/").concat(encodeURIComponent(r)),a.params={count_preference:i},a}return Be(t,e),t}(hn),Pv=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.countPreference=n.count_preference,r}return Be(t,e),t}(fn),Fv=function(e){function t(t){var n=this,r=t.channelUrl;return(n=e.call(this)||this).method=Gt.PUT,n.path="".concat(Kt,"/").concat(encodeURIComponent(r),"/reset_user_history"),n}return Be(t,e),t}(hn),zv=function(e){function t(t,n){var r=e.call(this,t,n)||this,i=n.ts_message_offset;return r.messageOffsetTimestamp=i,r}return Be(t,e),t}(fn),Hv=je(je({},sl),{scheduledAt:void 0,file:void 0,fileUrl:void 0,fileName:void 0,mimeType:void 0,fileSize:void 0,thumbnailSizes:void 0,requireAuth:!1}),qv=je(je({},ul),{scheduledAt:void 0}),Vv=function(e){function t(t){var n,r=this;r=e.call(this)||this;var i=[];t.mentionType===Mt.USERS&&(t.mentionedUserIds?i=t.mentionedUserIds:t.mentionedUsers&&(i=t.mentionedUsers.map((function(e){return e.userId}))));var a=t.channelType,s=t.channelUrl,o=t.scheduledMessageId;return r.method=Gt.PUT,r.path="".concat(sn(a),"/").concat(encodeURIComponent(s),"/scheduled_messages/").concat(encodeURIComponent(o)),r.params=qt(Vt({req_id:t.reqId,scheduled_at:t.scheduledAt,message_type:kt.FILE,url:t.fileUrl,file_name:t.fileName,file_size:t.fileSize,file_type:t.mimeType,thumbnails:t.thumbnailSizes?t.thumbnailSizes.map((function(e){return su.payloadify(e)})):[],custom_type:t.customType,data:t.data,require_auth:t.requireAuth,mention_type:t.mentionType,mentioned_user_ids:i,sorted_metaarray:null===(n=t.metaArrays)||void 0===n?void 0:n.map((function(e){return $o.payloadify(e)})),apple_critical_alert_options:t.appleCriticalAlertOptions?Jo.payloadify(t.appleCriticalAlertOptions):null,push_option:t.pushNotificationDeliveryOption})),r}return Be(t,e),t}(hn),Gv=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.message=new yu(t,n),r}return Be(t,e),t}(fn),Bv=function(e){function t(t){var n,r=this;r=e.call(this)||this;var i=[];t.mentionType===Mt.USERS&&(t.mentionedUserIds?i=t.mentionedUserIds:t.mentionedUsers&&(i=t.mentionedUsers.map((function(e){return e.userId}))));var a=t.channelType,s=t.channelUrl,o=t.scheduledMessageId;return r.method=Gt.PUT,r.path="".concat(sn(a),"/").concat(encodeURIComponent(s),"/scheduled_messages/").concat(encodeURIComponent(o)),r.params=qt(Vt({req_id:t.reqId,scheduled_at:t.scheduledAt,message_type:kt.USER,message:t.message,custom_type:t.customType,data:t.data,mention_type:t.mentionType,mentioned_user_ids:i,sorted_metaarray:null===(n=t.metaArrays)||void 0===n?void 0:n.map((function(e){return $o.payloadify(e)})),apple_critical_alert_options:t.appleCriticalAlertOptions?Jo.payloadify(t.appleCriticalAlertOptions):null,target_langs:t.translationTargetLanguages,push_option:t.pushNotificationDeliveryOption})),r}return Be(t,e),t}(hn);!function(e){Be((function(t,n){var r=e.call(this,t,n)||this;return r.message=new hu(t,n),r}),e)}(fn);var jv=function(e){function t(t){var n=e.call(this)||this,r=t.channelType,i=t.channelUrl,a=t.scheduledMessageId;return n.method=Gt.DELETE,n.path="".concat(sn(r),"/").concat(encodeURIComponent(i),"/scheduled_messages/").concat(encodeURIComponent(a)),n}return Be(t,e),t}(hn),Qv=function(e){function t(t){var n=e.call(this)||this,r=t.channelType,i=t.channelUrl,a=t.scheduledMessageId;return n.method=Gt.POST,n.path="".concat(sn(r),"/").concat(encodeURIComponent(i),"/scheduled_messages/").concat(encodeURIComponent(a),"/send_now"),n}return Be(t,e),t}(hn),Kv=function(e){function t(t){var n=t.userId,r=t.channelUrl,i=t.pushTriggerOption,a=e.call(this)||this;return a.method=Gt.PUT,a.path="".concat(jt,"/").concat(encodeURIComponent(n),"/push_preference/").concat(encodeURIComponent(r)),a.params={push_trigger_option:i},a}return Be(t,e),t}(hn),Wv=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.pushTriggerOption=n.push_trigger_option,r.enabled=n.enable,r}return Be(t,e),t}(fn),Yv=function(e){function t(t){var n=t.userId,r=t.channelUrl,i=e.call(this)||this;return i.method=Gt.GET,i.path="".concat(jt,"/").concat(encodeURIComponent(n),"/push_preference/").concat(encodeURIComponent(r)),i}return Be(t,e),t}(hn),Zv=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.pushTriggerOption=n.push_trigger_option,r.enabled=n.enable,r}return Be(t,e),t}(fn),Jv=function(e){function t(t){var n=t.channelType,r=t.channelUrl,i=t.messageId,a=e.call(this)||this;return a.method=Gt.POST,a.path="".concat(sn(n),"/").concat(encodeURIComponent(r),"/messages/").concat(i,"/pin"),a}return Be(t,e),t}(hn);!function(e){Be((function(t,n){return e.call(this,t,n)||this}),e)}(fn);var Xv=function(e){function t(t){var n=t.channelType,r=t.channelUrl,i=t.messageId,a=e.call(this)||this;return a.method=Gt.DELETE,a.path="".concat(sn(n),"/").concat(encodeURIComponent(r),"/messages/").concat(i,"/pin"),a}return Be(t,e),t}(hn);!function(e){Be((function(t,n){return e.call(this,t,n)||this}),e)}(fn);var $v,em,tm=function(e){function t(t,n){var r=e.call(this,t)||this;return r.message=null,r.message=gu(t,n.message),r}return Be(t,e),t}(ns),nm=function(e){function t(t){var n=this,r=t.channelType,i=t.channelUrl,a=t.limit,s=t.token,o=t.includeReactions,u=t.includeMetaArray,l=t.includeParentMessageInfo,c=t.includeThreadInfo,d=t.includePollDetails;return(n=e.call(this)||this).method=Gt.GET,n.path="".concat(sn(r),"/").concat(encodeURIComponent(i),"/pinned_messages"),n.params=qt({limit:a,token:s,include_reactions:o,with_sorted_meta_array:u,include_thread_info:c,include_parent_message_info:l,include_poll_details:d}),n}return Be(t,e),t}(hn),rm=function(e){function t(t,n){var r=e.call(this,t,n)||this,i=n.pinned_messages,a=n.has_more,s=n.next;return r.pinnedMessages=i.map((function(e){return new tm(t,e)})),r.hasMore=a,r.token=s,r}return Be(t,e),t}(fn),im=function(e){function t(t,n,r,i){var a=e.call(this,t,n,r,i)||this;return a.includeMetaArray=i.includeMetaArray,a.includeReactions=i.includeReactions,a.includeParentMessageInfo=i.includeParentMessageInfo,a.includeThreadInfo=i.includeThreadInfo,a.includePollDetails=i.includePollDetails,a}return Be(t,e),t.prototype._validate=function(){return e.prototype._validate.call(this)&&ct("boolean",this.includeMetaArray,!0)&&ct("boolean",this.includeReactions,!0)&&ct("boolean",this.includeParentMessageInfo,!0)&&ct("boolean",this.includeThreadInfo,!0)&&ct("boolean",this.includePollDetails,!0)},t.prototype.next=function(){return Qe(this,void 0,void 0,(function(){var e,t,n,r,i,a,s;return Ke(this,(function(o){switch(o.label){case 0:return this._validate()?this._isLoading?[3,3]:this._hasNext?(this._isLoading=!0,e=eo.of(this._iid).requestQueue,t=new nm(je(je({},this),{token:this._token})),[4,e.send(t)]):[3,2]:[3,5];case 1:return n=o.sent(),r=n.as(rm),i=r.pinnedMessages,a=r.hasMore,s=r.token,this._token=s,this._hasNext=!!a,this._isLoading=!1,[2,i];case 2:return[2,[]];case 3:throw st.queryInProgress;case 4:return[3,6];case 5:throw st.invalidParameters;case 6:return[2]}}))}))},t}(go),am=function(e){function t(t,n){var r,i,a=this;return(a=e.call(this,t)||this).channelUrl=null!==(r=n.channel_url)&&void 0!==r?r:"",a.channelType=null!==(i=n.channel_type)&&void 0!==i?i:St.GROUP,a.member=new ps(a._iid,n.user),a.deliveryAt=n.ts,a}return Be(t,e),t}(ns);!function(e){e.ALL="all",e.UNREAD_MESSAGE_COUNT_ONLY="unread_message_count_only",e.UNREAD_MENTION_COUNT_ONLY="unread_mention_count_only",e.OFF="off"}($v||($v={})),function(e){e.UNHIDDEN="unhidden",e.HIDDEN_ALLOW_AUTO_UNHIDE="hidden_allow_auto_unhide",e.HIDDEN_PREVENT_AUTO_UNHIDE="hidden_prevent_auto_unhide"}(em||(em={}));var sm,om=function(e){function t(t,n){var r,i,a,s,o,u,l,c,d,h,f,p,_,v,m,g,y,E,b,C,w=this;return(w=e.call(this,t,n)||this)._unreadMemberStateMap=new Map,w._undeliveredMemberStateMap=new Map,w._typingStatus=new Map,w._lastMemberCountUpdated=0,w._typingStarted=0,w._typingEnded=0,w.isDistinct=!1,w.isSuper=!1,w.isBroadcast=!1,w.isExclusive=!1,w.isPublic=!1,w.isDiscoverable=!0,w.isChatNotification=!1,w.isAccessCodeRequired=!1,w.isPushEnabled=!1,w.unreadMessageCount=0,w.unreadMentionCount=0,w.members=[],w.memberCount=0,w.joinedMemberCount=0,w.hiddenState=em.UNHIDDEN,w.lastMessage=null,w.messageOffsetTimestamp=0,w.messageSurvivalSeconds=-1,w.myMemberState=kp.NONE,w.myRole=Tt.NONE,w.myMutedState=It.UNMUTED,w.myLastRead=0,w.myCountPreference=$v.ALL,w.myPushTriggerOption=tt.DEFAULT,w.inviter=null,w.invitedAt=0,w.joinedAt=0,w.pinnedMessageIds=[],w.lastPinnedMessage=null,w._pinnedMessagesUpdatedAt=0,w._myMutedRemainingTime=-1,w.channelType=St.GROUP,w.isDistinct=null!==(i=n.is_distinct)&&void 0!==i&&i,w.isSuper=null!==(a=n.is_super)&&void 0!==a&&a,w.isBroadcast=null!==(s=n.is_broadcast)&&void 0!==s&&s,w.isExclusive=null!==(o=n.is_exclusive)&&void 0!==o&&o,w.isPublic=null!==(u=n.is_public)&&void 0!==u&&u,w.isDiscoverable=null!==(l=n.is_discoverable)&&void 0!==l?l:w.isPublic,w.isChatNotification=null!==(c=n.is_chat_notification)&&void 0!==c&&c,w.isAccessCodeRequired=null!==(d=n.is_access_code_required)&&void 0!==d&&d,w.isPushEnabled=null!==(h=n.is_push_enabled)&&void 0!==h&&h,Array.isArray(n.members)&&(r=w.members).push.apply(r,Ze([],Ye(n.members.map((function(e){return new Fp(w._iid,e)}))),!1)),w.memberCount=null!==(f=n.member_count)&&void 0!==f?f:0,w.joinedMemberCount=null!==(p=n.joined_member_count)&&void 0!==p?p:0,w.hiddenState=dt(em,n.hidden_state)?n.hidden_state:em.UNHIDDEN,w.messageOffsetTimestamp=null!==(_=n.ts_message_offset)&&void 0!==_?_:0,w.messageSurvivalSeconds=null!==(v=n.message_survival_seconds)&&void 0!==v?v:-1,w.lastMessage=n.last_message?gu(w._iid,je({channel_type:w.channelType},n.last_message)):null,n.read_receipt&&Object.keys(n.read_receipt).forEach((function(e){ct("number",n.read_receipt[e])&&w._updateUnreadMemberState(e,n.read_receipt[e])})),n.delivery_receipt&&Object.keys(n.delivery_receipt).forEach((function(e){ct("number",n.delivery_receipt[e])&&w._updateUndeliveredMemberState(e,n.delivery_receipt[e])})),w.myMemberState=dt(kp,n.member_state)?n.member_state:kp.NONE,w.myRole=dt(Tt,n.my_role)?n.my_role:Tt.NONE,dt(It,n.is_muted)?w.myMutedState=n.is_muted:ct("boolean",n.is_muted)?w.myMutedState=n.is_muted?It.MUTED:It.UNMUTED:w.myMutedState=It.UNMUTED,w.myCountPreference=dt($v,n.count_preference)?n.count_preference:$v.ALL,w.myPushTriggerOption=dt(tt,n.push_trigger_option)?n.push_trigger_option:tt.ALL,w.myLastRead=null!==(m=n.user_last_read)&&void 0!==m?m:0,w.inviter=n.inviter?new ps(w._iid,n.inviter):null,w.invitedAt=null!==(g=n.invited_at)&&void 0!==g?g:0,w.joinedAt=null!==(y=n.joined_ts)&&void 0!==y?y:0,w._updateUnreadCount(null!==(E=n.unread_message_count)&&void 0!==E?E:0,null!==(b=n.unread_mention_count)&&void 0!==b?b:0),w.pinnedMessageIds=null!==(C=n.pinned_message_ids)&&void 0!==C?C:[],w.lastPinnedMessage=n.latest_pinned_message?gu(w._iid,je({channel_type:w.channelType},n.latest_pinned_message)):null,w}return Be(t,e),Object.defineProperty(t.prototype,"isHidden",{get:function(){return this.hiddenState!==em.UNHIDDEN},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isTyping",{get:function(){return this._typingStatus.size>0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cachedUnreadMemberState",{get:function(){var e,t,n={};try{for(var r=We(this._unreadMemberStateMap),i=r.next();!i.done;i=r.next()){var a=Ye(i.value,2),s=a[0],o=a[1];n[s]=o}}catch(t){e={error:t}}finally{try{i&&!i.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}return n},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cachedUndeliveredMemberState",{get:function(){var e,t,n={};try{for(var r=We(this._undeliveredMemberStateMap),i=r.next();!i.done;i=r.next()){var a=Ye(i.value,2),s=a[0],o=a[1];n[s]=o}}catch(t){e={error:t}}finally{try{i&&!i.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}return n},enumerable:!1,configurable:!0}),t.payloadify=function(t){return qt(Vt(je(je({},e.payloadify.call(this,t)),{is_access_code_required:t.isAccessCodeRequired,is_distinct:t.isDistinct,is_super:t.isSuper,is_broadcast:t.isBroadcast,is_exclusive:t.isExclusive,is_public:t.isPublic,is_discoverable:t.isDiscoverable,is_muted:t.myMutedState,is_push_enabled:t.isPushEnabled,unread_message_count:t.unreadMessageCount,unread_mention_count:t.unreadMentionCount,push_trigger_option:t.myPushTriggerOption,count_preference:t.myCountPreference,hidden_state:t.hiddenState,member_count:t.memberCount,joined_member_count:t.joinedMemberCount,member_state:t.myMemberState,my_role:t.myRole,user_last_read:t.myLastRead,ts_message_offset:t.messageOffsetTimestamp,message_survival_seconds:t.messageSurvivalSeconds,read_receipt:t.cachedUnreadMemberState,delivery_receipt:t.cachedUndeliveredMemberState,members:t.members.map((function(e){return Fp.payloadify(e)})),last_message:t.lastMessage?mu(t.lastMessage):null,inviter:t.inviter?ps.payloadify(t.inviter):null,invited_at:t.invitedAt,joined_ts:t.joinedAt,pinned_message_ids:t.pinnedMessageIds,latest_pinned_message:t.lastPinnedMessage?mu(t.lastPinnedMessage):null})))},t.prototype._shouldUpdateLastMessageWith=function(e){return!(e instanceof au&&e.parentMessageId>0&&!e.replyToChannel)&&(!this.lastMessage||this.lastMessage.createdAt<e.createdAt||this.lastMessage.createdAt===e.createdAt&&this.lastMessage.messageId===e.messageId&&this.lastMessage.updatedAt<e.updatedAt)},t.prototype._tryUpdateLastMessageAndCallEvents=function(e,t){var n=eo.of(this._iid).dispatcher,r=J_.of(this._iid);e._shouldUpdateLastMessageWith(t)&&(e.lastMessage=t),r.handlers.map((function(t){t.onChannelChanged&&t.onChannelChanged(e)})),n.dispatch(new $p({channels:[e],source:no.EVENT_MESSAGE_SENT}))},t.prototype._updateUnreadCount=function(e,t){if("number"==typeof e&&e>=0)if(this.myCountPreference===$v.ALL||this.myCountPreference===$v.UNREAD_MESSAGE_COUNT_ONLY)if(this.isExclusive||this.isSuper||this.isBroadcast){var n=eo.of(this._iid).maxSuperGroupChannelUnreadCount;this.unreadMessageCount=n&&e>=n?n:e}else this.unreadMessageCount=e;else this.unreadMessageCount=0;else this.unreadMessageCount=0;"number"==typeof t&&t>=0&&(this.myCountPreference===$v.ALL||this.myCountPreference===$v.UNREAD_MENTION_COUNT_ONLY)?this.unreadMentionCount=t:this.unreadMentionCount=0},t.prototype._updateUnreadMemberState=function(e,t){var n=this._unreadMemberStateMap.get(e);return(!n||n<t)&&(this._unreadMemberStateMap.set(e,t),eo.of(this._iid).sdkState.userId===e&&(this.myLastRead=t),!0)},t.prototype._updateUndeliveredMemberState=function(e,t){var n=this._undeliveredMemberStateMap.get(e);return(!n||n<t)&&(this._undeliveredMemberStateMap.set(e,t),!0)},t.prototype._updateTypingStatus=function(e,t){void 0===t&&(t=(new Date).getTime()),t>0?this._typingStatus.set(e.userId,{user:e,ts:t}):this._typingStatus.delete(e.userId)},t.prototype._clearTypingStatus=function(){this._typingStatus.clear(),this._typingStarted=0,this._typingEnded=0},t.prototype._setLatestMemberCount=function(e,t,n){var r=!1;return n>=this._lastMemberCountUpdated&&(this._lastMemberCountUpdated=n,r=e!==this.memberCount||t!==this.joinedMemberCount,this.memberCount=e,this.joinedMemberCount=t),r},t.prototype.isReadMessage=function(e){var t=eo.of(this._iid).sdkState,n=this._unreadMemberStateMap.get(t.userId);return!!n&&n>=e.createdAt},t.prototype.serialize=function(){var e=this;return cs(this,(function(t){t.cachedUnreadMemberState=e.cachedUnreadMemberState,t.cachedUndeliveredMemberState=e.cachedUndeliveredMemberState}))},t.prototype.createMessageCollection=function(e){return void 0===e&&(e={}),new Tv(this._iid,je(je({},e),{channel:this}))},t.prototype.createMemberListQuery=function(e){return void 0===e&&(e={}),new kv(this._iid,this.url,e)},t.prototype.createPinnedMessageListQuery=function(e){return void 0===e&&(e={}),new im(this._iid,this.url,this.channelType,e)},t.prototype.addMember=function(e,t){if(void 0===t&&(t=0),!this.isExclusive&&!this.isSuper&&!this.isBroadcast){var n=this.members.findIndex((function(t){return t.userId===e.userId}));if(n>-1){var r=this.members[n];r.state===kp.JOINED&&(e.state=r.state),this.members.splice(n,1),this.memberCount--}this.members.push(e),this.memberCount++,this._updateUnreadMemberState(e.userId,t),this._updateUndeliveredMemberState(e.userId,t)}},t.prototype.removeMember=function(e){if(!this.isExclusive&&!this.isSuper&&!this.isBroadcast){var t=e instanceof Fp?e.userId:e,n=this.members.findIndex((function(e){return e.userId===t}));if(n>-1)return this.members.splice(n,1),this.memberCount--,!0}return!1},t.prototype.getUnreadMemberCount=function(e){var t,n;if(e instanceof au&&!this.isExclusive&&!this.isSuper&&!this.isBroadcast){var r=eo.of(this._iid).sdkState,i=e.createdAt,a=0;try{for(var s=We(this.members),o=s.next();!o.done;o=s.next()){var u=o.value;r.userId!==u.userId&&u.state===kp.JOINED&&e.sender.userId!==u.userId&&(this.cachedUnreadMemberState[u.userId]||0)<i&&a++}}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=s.return)&&n.call(s)}finally{if(t)throw t.error}}return a}return 0},t.prototype.getUndeliveredMemberCount=function(e){var t,n;if(e instanceof au&&!this.isExclusive&&!this.isSuper&&!this.isBroadcast){var r=eo.of(this._iid).sdkState,i=e.createdAt,a=0;try{for(var s=We(this.members),o=s.next();!o.done;o=s.next()){var u=o.value;r.userId!==u.userId&&u.state===kp.JOINED&&e.sender.userId!==u.userId&&(this.cachedUndeliveredMemberState[u.userId]||0)<i&&a++}}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=s.return)&&n.call(s)}finally{if(t)throw t.error}}return a}return 0},t.prototype.getReadMembers=function(e,t){var n=this;void 0===t&&(t=!1);var r=eo.of(this._iid).sdkState;if(!r.userId||this.isExclusive||this.isSuper||this.isBroadcast)return[];var i=e instanceof au?e.sender:null,a=[];return this.members.forEach((function(s){if(t||s.userId!==r.userId&&s.userId!==(null==i?void 0:i.userId)){var o=n._unreadMemberStateMap.get(s.userId);o&&o>=e.createdAt&&a.push(s)}})),a},t.prototype.getUnreadMembers=function(e,t){var n=this;void 0===t&&(t=!1);var r=eo.of(this._iid).sdkState;if(!r.userId||this.isExclusive||this.isSuper||this.isBroadcast)return[];var i=e instanceof au?e.sender:null,a=[];return this.members.forEach((function(s){if(t||s.userId!==r.userId&&s.userId!==(null==i?void 0:i.userId)){var o=n._unreadMemberStateMap.get(s.userId);o&&o<e.createdAt&&a.push(s)}})),a},t.prototype.getReadStatus=function(e){var t=this;void 0===e&&(e=!1);var n=eo.of(this._iid).sdkState;if(!n.userId||this.isExclusive||this.isSuper||this.isBroadcast)return null;var r={};return this.members.forEach((function(i){if(e||i.userId!==n.userId){var a=t._unreadMemberStateMap.get(i.userId);r[i.userId]=new zp(t._iid,{channel_url:t.url,channel_type:t.channelType,user:Fp.payloadify(i),ts:null!=a?a:0})}})),r},t.prototype.getDeliveryStatus=function(e){var t=this;void 0===e&&(e=!0);var n=eo.of(this._iid).sdkState;if(!n.userId||this.isExclusive||this.isSuper||this.isBroadcast)return null;var r={};return this.members.forEach((function(i){if(e||i.userId!==n.userId){var a=t._undeliveredMemberStateMap.get(i.userId);r[i.userId]=new am(t._iid,{channel_url:t.url,channel_type:t.channelType,user:Fp.payloadify(i),ts:null!=a?a:0})}})),r},t.prototype.getTypingUsers=function(){var e=[];return this._typingStatus.forEach((function(t){var n=t.user;e.push(n)})),e},t.prototype.invalidateTypingStatus=function(){var e=this,t=eo.of(this._iid).typingIndicatorInvalidateTime,n=Date.now(),r=!1;return this._typingStatus.forEach((function(i,a){var s=i.ts;n-s>=t&&(e._typingStatus.delete(a),r=!0)})),r},t.prototype.refresh=function(){return Qe(this,void 0,void 0,(function(){return Ke(this,(function(e){return[2,this._refresh()]}))}))},t.prototype._refresh=function(e){return void 0===e&&(e=!1),Qe(this,void 0,void 0,(function(){var t,n,r,i,a,s;return Ke(this,(function(o){switch(o.label){case 0:return t=eo.of(this._iid),n=t.requestQueue,r=t.dispatcher,i=new i_({channelUrl:this.url}),[4,n.send(i)];case 1:return a=o.sent(),s=a.as(a_).channel,this._update(s),e||r.dispatch(new $p({channels:[s],source:no.REFRESH_CHANNEL})),[2,this]}}))}))},t.prototype.freeze=function(){return Qe(this,void 0,void 0,(function(){return Ke(this,(function(t){switch(t.label){case 0:return[4,e.prototype.freeze.call(this)];case 1:return t.sent(),eo.of(this._iid).dispatcher.dispatch(new $p({channels:[this],source:no.EVENT_CHANNEL_FROZEN,isWebSocketEventComing:!0})),[2]}}))}))},t.prototype.unfreeze=function(){return Qe(this,void 0,void 0,(function(){return Ke(this,(function(t){switch(t.label){case 0:return[4,e.prototype.unfreeze.call(this)];case 1:return t.sent(),eo.of(this._iid).dispatcher.dispatch(new $p({channels:[this],source:no.EVENT_CHANNEL_UNFROZEN,isWebSocketEventComing:!0})),[2]}}))}))},t.prototype.updateChannel=function(e){return Qe(this,void 0,void 0,(function(){var t,n,r,i,a,s,o;return Ke(this,(function(u){switch(u.label){case 0:return t=je(je({},Iv),e),hs(function(e){return ct("string",e.coverUrl,!0)&&(vt(e.coverImage)||ct("string",e.coverImage,!0))&&ct("boolean",e.isDistinct,!0)&&ct("boolean",e.isPublic,!0)&&ct("boolean",e.isDiscoverable,!0)&&ct("string",e.accessCode,!0)&&ct("string",e.name,!0)&&ct("string",e.data,!0)&&ct("string",e.customType,!0)&&ft("string",e.operatorUserIds,!0)&&ct("number",e.messageSurvivalSeconds,!0)}(t)).throw(st.invalidParameters),n=eo.of(this._iid),r=n.dispatcher,i=n.requestQueue,a=new Ov(je({channelUrl:this.url},t)),[4,i.send(a)];case 1:return s=u.sent(),o=s.as(Dv).channel,this._update(o),r.dispatch(new $p({channels:[o],source:no.EVENT_CHANNEL_UPDATED,isWebSocketEventComing:!0})),[2,this]}}))}))},t.prototype.invite=function(e){return Qe(this,void 0,void 0,(function(){return Ke(this,(function(t){return hs(e.every((function(e){return e instanceof ps}))).throw(st.invalidParameters),[2,this.inviteWithUserIds(e.map((function(e){return e.userId})))]}))}))},t.prototype.inviteWithUserIds=function(e){return Qe(this,void 0,void 0,(function(){var t,n,r,i,a,s;return Ke(this,(function(o){switch(o.label){case 0:return hs(ft("string",e)).throw(st.invalidParameters),t=eo.of(this._iid),n=t.dispatcher,r=t.requestQueue,i=new A_({channelUrl:this.url,userIds:e}),[4,r.send(i)];case 1:return a=o.sent(),s=a.as(k_).channel,this._update(s),n.dispatch(new $p({channels:[s],source:no.EVENT_CHANNEL_INVITED,isWebSocketEventComing:!0})),[2,this]}}))}))},t.prototype.join=function(e){return Qe(this,void 0,void 0,(function(){var t,n,r,i,a,s,o;return Ke(this,(function(u){switch(u.label){case 0:return hs(ct("string",e,!0)).throw(st.invalidParameters),t=eo.of(this._iid),n=t.dispatcher,r=t.sdkState,i=t.requestQueue,a=new w_({channelUrl:this.url,userId:r.userId,accessCode:e}),[4,i.send(a)];case 1:return s=u.sent(),(o=s.as(S_).channel).myMemberState=this.myMemberState=kp.JOINED,this._update(o),n.dispatch(new $p({channels:[o],source:no.EVENT_CHANNEL_JOINED,isWebSocketEventComing:!0})),[2,this]}}))}))},t.prototype.leave=function(e){return void 0===e&&(e=!1),Qe(this,void 0,void 0,(function(){var t,n,r,i;return Ke(this,(function(a){switch(a.label){case 0:return t=eo.of(this._iid),n=t.sdkState,r=t.requestQueue,i=new I_({channelUrl:this.url,userId:n.userId,shouldRemoveOperatorStatus:e}),[4,r.send(i)];case 1:return a.sent(),this.myMemberState=kp.NONE,[2]}}))}))},t.prototype.acceptInvitation=function(e){return Qe(this,void 0,void 0,(function(){var t,n,r,i,a,s,o;return Ke(this,(function(u){switch(u.label){case 0:return hs(ct("string",e,!0)).throw(st.invalidParameters),t=eo.of(this._iid),n=t.dispatcher,r=t.sdkState,i=t.requestQueue,a=new Mv({channelUrl:this.url,userId:r.userId,accessCode:e}),[4,i.send(a)];case 1:return s=u.sent(),(o=s.as(Uv).channel).myMemberState=this.myMemberState=kp.JOINED,this._update(o),n.dispatch(new $p({channels:[o],source:no.EVENT_CHANNEL_ACCEPTED_INVITE,isWebSocketEventComing:!0})),[2,this]}}))}))},t.prototype.declineInvitation=function(){return Qe(this,void 0,void 0,(function(){var e,t,n,r;return Ke(this,(function(i){switch(i.label){case 0:return e=eo.of(this._iid),t=e.sdkState,n=e.requestQueue,r=new U_({channelUrl:this.url,userId:t.userId}),[4,n.send(r)];case 1:return i.sent(),this.myMemberState=kp.NONE,[2,this]}}))}))},t.prototype.sendUserMessage=function(t){var n=this,r=new Gu,i=eo.of(this._iid).dispatcher,a=Oh.of(this._iid);return e.prototype.sendUserMessage.call(this,t).onPending((function(e){a.completeCurrentAndProcessNextAutoResend(e),r._trigger(e)})).onFailed((function(e,t){t&&a.completeCurrentAndProcessNextAutoResend(t),r._triggerFailed(e,t)})).onSucceeded((function(e){n.hiddenState===em.HIDDEN_ALLOW_AUTO_UNHIDE&&(n.hiddenState=em.UNHIDDEN),a.completeCurrentAndProcessNextAutoResend(e),n._shouldUpdateLastMessageWith(e)&&(n.lastMessage=e),J_.of(n._iid).handlers.map((function(e){e.onChannelChanged&&e.onChannelChanged(n)})),i.dispatch(new $p({channels:[n],source:no.EVENT_MESSAGE_SENT})),r._trigger(e)})),r},t.prototype.updateUserMessage=function(t,n){return Qe(this,void 0,void 0,(function(){var r,i,a,s,o=this;return Ke(this,(function(u){switch(u.label){case 0:return r=eo.of(this._iid).dispatcher,[4,e.prototype.updateUserMessage.call(this,t,n)];case 1:return i=u.sent(),a=!1,!i.silent&&this._shouldUpdateLastMessageWith(i)&&(this.lastMessage=i,a=!0),s=!1,this.lastPinnedMessage&&this.lastPinnedMessage.messageId===i.messageId&&(this.lastPinnedMessage=i,a=!0,s=!0),a&&(J_.of(this._iid).handlers.map((function(e){e.onChannelChanged&&e.onChannelChanged(o)})),r.dispatch(new $p({channels:[this],source:s?no.EVENT_PINNED_MESSAGE_UPDATED:no.EVENT_MESSAGE_UPDATED}))),s&&J_.of(this._iid).handlers.map((function(e){e.onPinnedMessageUpdated&&e.onPinnedMessageUpdated(o)})),r.dispatch(new co({messages:[i],source:no.EVENT_MESSAGE_UPDATED})),[2,i]}}))}))},t.prototype._autoResendUserMessage=function(t){var n=this,r=new Gu,i=eo.of(this._iid).dispatcher,a=Oh.of(this._iid);return e.prototype._autoResendUserMessage.call(this,t).onPending((function(e){a.completeCurrentAndProcessNextAutoResend(e),r._trigger(e)})).onFailed((function(e,t){a.completeCurrentAndProcessNextAutoResend(t),r._triggerFailed(e,t)})).onSucceeded((function(e){var t=J_.of(n._iid);a.completeCurrentAndProcessNextAutoResend(e),n._shouldUpdateLastMessageWith(e)&&(n.lastMessage=e),t.handlers.map((function(e){e.onChannelChanged&&e.onChannelChanged(n)})),i.dispatch(new $p({channels:[n],source:no.EVENT_MESSAGE_SENT})),r._trigger(e)})),r},t.prototype.sendFileMessage=function(t){var n=this,r=new Gu,i=eo.of(this._iid).dispatcher,a=Oh.of(this._iid);return e.prototype.sendFileMessage.call(this,t).onPending((function(e){a.completeCurrentAndProcessNextAutoResend(e),r._trigger(e)})).onFailed((function(e,t){t&&a.completeCurrentAndProcessNextAutoResend(t),r._triggerFailed(e,t)})).onSucceeded((function(e){var t=J_.of(n._iid);a.completeCurrentAndProcessNextAutoResend(e),n._shouldUpdateLastMessageWith(e)&&(n.lastMessage=e),t.handlers.map((function(e){e.onChannelChanged&&e.onChannelChanged(n)})),i.dispatch(new $p({channels:[n],source:no.EVENT_MESSAGE_SENT})),r._trigger(e)})),r},t.prototype.sendMultipleFilesMessage=function(t){var n=this,r=new zc,i=eo.of(this._iid).dispatcher;return e.prototype.sendMultipleFilesMessage.call(this,t).onPending((function(e){r._trigger(e)})).onFailed((function(e,t){r._triggerFailed(e,t)})).onSucceeded((function(e){var t=J_.of(n._iid);n._shouldUpdateLastMessageWith(e)&&(n.lastMessage=e),t.handlers.map((function(e){e.onChannelChanged&&e.onChannelChanged(n)})),i.dispatch(new $p({channels:[n],source:no.EVENT_MESSAGE_SENT})),r._trigger(e)})).onFileUploaded((function(e,t,n,i){r._triggerOnFileUploaded(e,t,n,i)})),r},t.prototype.updateFileMessage=function(t,n){return Qe(this,void 0,void 0,(function(){var r,i,a,s,o=this;return Ke(this,(function(u){switch(u.label){case 0:return r=eo.of(this._iid).dispatcher,[4,e.prototype.updateFileMessage.call(this,t,n)];case 1:return i=u.sent(),a=!1,!i.silent&&this._shouldUpdateLastMessageWith(i)&&(this.lastMessage=i,a=!0),s=!1,this.lastPinnedMessage&&this.lastPinnedMessage.messageId===i.messageId&&(this.lastPinnedMessage=i,a=!0,s=!0),a&&(J_.of(this._iid).handlers.map((function(e){e.onChannelChanged&&e.onChannelChanged(o)})),r.dispatch(new $p({channels:[this],source:s?no.EVENT_PINNED_MESSAGE_UPDATED:no.EVENT_MESSAGE_UPDATED}))),s&&J_.of(this._iid).handlers.map((function(e){e.onPinnedMessageUpdated&&e.onPinnedMessageUpdated(o)})),r.dispatch(new co({messages:[i],source:no.EVENT_MESSAGE_UPDATED})),[2,i]}}))}))},t.prototype._autoResendFileMessage=function(t){var n=this,r=new Gu,i=eo.of(this._iid).dispatcher,a=Oh.of(this._iid);return e.prototype._autoResendFileMessage.call(this,t).onPending((function(e){a.completeCurrentAndProcessNextAutoResend(e),r._trigger(e)})).onFailed((function(e,t){a.completeCurrentAndProcessNextAutoResend(t),r._triggerFailed(e,t)})).onSucceeded((function(e){var t=J_.of(n._iid);a.completeCurrentAndProcessNextAutoResend(e),n._shouldUpdateLastMessageWith(e)&&(n.lastMessage=e),t.handlers.map((function(e){e.onChannelChanged&&e.onChannelChanged(n)})),i.dispatch(new $p({channels:[n],source:no.EVENT_MESSAGE_SENT})),r._trigger(e)})),r},t.prototype.deleteMessage=function(t){return Qe(this,void 0,void 0,(function(){return Ke(this,(function(n){switch(n.label){case 0:return[4,e.prototype.deleteMessage.call(this,t)];case 1:return n.sent(),0===t.messageId&&t instanceof au&&eo.of(this._iid).dispatcher.dispatch(new fo({reqId:t.reqId,source:no.EVENT_MESSAGE_DELETED})),[2]}}))}))},t.prototype.hide=function(e){return Qe(this,void 0,void 0,(function(){var t,n,r,i,a,s,o,u;return Ke(this,(function(l){switch(l.label){case 0:return t=je(je({},D_),e),hs(function(e){return ct("boolean",e.hidePreviousMessages,!0)&&ct("boolean",e.allowAutoUnhide,!0)}(t)).throw(st.invalidParameters),n=eo.of(this._iid),r=n.dispatcher,i=n.sdkState,a=n.requestQueue,s=new L_(je({channelUrl:this.url,userId:i.userId},t)),[4,a.send(s)];case 1:return o=l.sent(),u=o.as(R_).messageOffsetTimestamp,this.hiddenState=t.allowAutoUnhide?em.HIDDEN_ALLOW_AUTO_UNHIDE:em.HIDDEN_PREVENT_AUTO_UNHIDE,t.hidePreviousMessages&&this._updateUnreadCount(0,0),u&&(this.messageOffsetTimestamp=u),r.dispatch(new $p({channels:[this],source:no.EVENT_CHANNEL_HIDDEN,isWebSocketEventComing:!0})),[2,this]}}))}))},t.prototype.unhide=function(){return Qe(this,void 0,void 0,(function(){var e,t,n,r;return Ke(this,(function(i){switch(i.label){case 0:return e=eo.of(this._iid),t=e.dispatcher,n=e.requestQueue,r=new Rv({channelUrl:this.url}),[4,n.send(r)];case 1:return i.sent(),this.hiddenState=em.UNHIDDEN,t.dispatch(new $p({channels:[this],source:no.EVENT_CHANNEL_UNHIDDEN,isWebSocketEventComing:!0})),[2,this]}}))}))},t.prototype.delete=function(){return Qe(this,void 0,void 0,(function(){var e,t;return Ke(this,(function(n){switch(n.label){case 0:return e=eo.of(this._iid).requestQueue,t=new Lv({channelUrl:this.url}),[4,e.send(t)];case 1:return n.sent(),[2]}}))}))},t.prototype.markAsRead=function(){return Qe(this,void 0,void 0,(function(){var e,t,n,r,i,a,s,o=this;return Ke(this,(function(u){switch(u.label){case 0:return e=eo.of(this._iid),t=e.sdkState,n=e.dispatcher,r=e.requestQueue,i=new B_({channelUrl:this.url}),[4,r.send(i)];case 1:return a=u.sent(),s=a.as(j_).readStatus,this._updateUnreadMemberState(t.userId,s.readAt),(this.unreadMessageCount>0||this.unreadMentionCount>0)&&(this._updateUnreadCount(0,0),J_.of(this._iid).handlers.map((function(e){e.onChannelChanged&&e.onChannelChanged(o)}))),n.dispatch(new $p({channels:[this],source:no.EVENT_CHANNEL_READ})),[2]}}))}))},t.prototype.markAsDelivered=function(){return Qe(this,void 0,void 0,(function(){var e,t,n,r;return Ke(this,(function(i){switch(i.label){case 0:return e=eo.of(this._iid),t=e.sdkState,n=e.requestQueue,r=new Q_({channelUrl:this.url,userId:t.userId}),[4,n.send(r)];case 1:return i.sent(),[2]}}))}))},t.prototype.startTyping=function(){return Qe(this,void 0,void 0,(function(){var e,t,n,r,i;return Ke(this,(function(a){switch(a.label){case 0:return e=eo.of(this._iid),t=e.requestQueue,n=e.typingIndicatorThrottle,(r=(new Date).getTime())-this._typingStarted>=n?(this._typingStarted=r,this._typingEnded=0,i=new P_({channelUrl:this.url,time:this._typingStarted}),[4,t.send(i)]):[3,2];case 1:a.sent(),a.label=2;case 2:return[2]}}))}))},t.prototype.endTyping=function(){return Qe(this,void 0,void 0,(function(){var e,t,n,r,i;return Ke(this,(function(a){switch(a.label){case 0:return e=eo.of(this._iid),t=e.requestQueue,n=e.typingIndicatorThrottle,(r=(new Date).getTime())-this._typingEnded>=n?(this._typingStarted=0,this._typingEnded=r,i=new z_({channelUrl:this.url,time:this._typingStarted}),[4,t.send(i)]):[3,2];case 1:a.sent(),a.label=2;case 2:return[2]}}))}))},t.prototype.createScheduledUserMessage=function(e){e=je(je({},ih),e),hs(function(e){return Ju(e)&&ct("number",e.scheduledAt,!0)}(e)).throw(st.invalidParameters);var t=new Gu;return this._createScheduledUserMessage(e,t),t},t.prototype.updateScheduledUserMessage=function(e,t){return Qe(this,void 0,void 0,(function(){var n,r,i;return Ke(this,(function(a){switch(a.label){case 0:return n=je(je({},qv),t),hs(function(e){return ll(e)&&ct("number",e.scheduledAt,!0)}(n)).throw(st.invalidParameters),r=eo.of(this._iid).requestQueue,i=new Bv(je({reqId:this._generateRequestId(),scheduledMessageId:e,channelType:this.channelType,channelUrl:this.url},n)),[4,r.send(i)];case 1:return[2,a.sent().as(yc).message]}}))}))},t.prototype.createScheduledFileMessage=function(e){var t=this;e=je(je({},ah),e),hs(function(e){return ju(e)&&ct("number",e.scheduledAt)&&(vt(e.file)||ct("string",e.fileUrl))&&ct("string",e.fileName,!0)&&ct("string",e.mimeType,!0)&&ct("number",e.fileSize,!0)&&(null===e.thumbnailSizes||void 0===e.thumbnailSizes||e.thumbnailSizes.every((function(e){return ct("object",e)&&e.maxWidth>0&&e.maxHeight>0})))}(e)).throw(st.invalidParameters);var n=Date.now(),r=this._generateRequestId(),i=new Gu;return Ts(2).then((function(){var a=t._createPendingScheduledFileMessage(e,r,n);Es((function(){return Qe(t,void 0,void 0,(function(){return Ke(this,(function(e){return[2,i._trigger(a)]}))}))}))})),vt(e.file)?this._uploadFileAndUpdateParams(e).then((function(){return t._createScheduledFileMessage(e,i,r,n)})):this._createScheduledFileMessage(e,i,r,n),i},t.prototype.updateScheduledFileMessage=function(e,t){return Qe(this,void 0,void 0,(function(){var n,r;return Ke(this,(function(i){switch(i.label){case 0:return n=je(je({},Hv),t),hs(function(e){return ol(e)&&ct("number",e.scheduledAt,!0)&&(vt(e.file)||ct("string",e.fileUrl))&&ct("string",e.fileName,!0)&&ct("string",e.mimeType,!0)&&ct("number",e.fileSize,!0)&&(null===e.thumbnailSizes||void 0===e.thumbnailSizes||e.thumbnailSizes.every((function(e){return ct("object",e)&&e.maxWidth>0&&e.maxHeight>0})))}(n)).throw(st.invalidParameters),vt(n.file)?[4,this._uploadFileAndUpdateParams(n)]:[3,2];case 1:i.sent(),i.label=2;case 2:return r=new Vv(je({reqId:this._generateRequestId(),scheduledMessageId:e,channelType:this.channelType,channelUrl:this.url},n)),[4,eo.of(this._iid).requestQueue.send(r)];case 3:return[2,i.sent().as(Gv).message]}}))}))},t.prototype.cancelScheduledMessage=function(e){return Qe(this,void 0,void 0,(function(){var t;return Ke(this,(function(n){switch(n.label){case 0:return t=new jv({scheduledMessageId:e,channelType:this.channelType,channelUrl:this.url}),[4,eo.of(this._iid).requestQueue.send(t)];case 1:return n.sent(),[2]}}))}))},t.prototype.sendScheduledMessageNow=function(e){return Qe(this,void 0,void 0,(function(){var t;return Ke(this,(function(n){switch(n.label){case 0:return t=new Qv({scheduledMessageId:e,channelType:this.channelType,channelUrl:this.url}),[4,eo.of(this._iid).requestQueue.send(t)];case 1:return n.sent(),[2]}}))}))},t.prototype.getMyPushTriggerOption=function(){return Qe(this,void 0,void 0,(function(){var e,t,n,r,i,a;return Ke(this,(function(s){switch(s.label){case 0:return e=eo.of(this._iid),t=e.sdkState,n=e.requestQueue,r=new Yv({userId:t.userId,channelUrl:this.url}),[4,n.send(r)];case 1:return i=s.sent(),a=i.as(Zv).pushTriggerOption,this.myPushTriggerOption=a,[2,a]}}))}))},t.prototype.setMyPushTriggerOption=function(e){return Qe(this,void 0,void 0,(function(){var t,n,r,i,a,s,o;return Ke(this,(function(u){switch(u.label){case 0:return hs(dt(tt,e)).throw(st.invalidParameters),t=eo.of(this._iid),n=t.dispatcher,r=t.sdkState,i=t.requestQueue,a=new Kv({userId:r.userId,channelUrl:this.url,pushTriggerOption:e}),[4,i.send(a)];case 1:return s=u.sent(),o=s.as(Wv).pushTriggerOption,this.myPushTriggerOption=o,n.dispatch(new $p({channels:[this],source:no.EVENT_CHANNEL_UPDATED,isWebSocketEventComing:!0})),[2,o]}}))}))},t.prototype.setMyCountPreference=function(e){return Qe(this,void 0,void 0,(function(){var t,n,r,i,a,s,o;return Ke(this,(function(u){switch(u.label){case 0:return hs(dt($v,e)).throw(st.invalidParameters),t=eo.of(this._iid),n=t.dispatcher,r=t.sdkState,i=t.requestQueue,a=new xv({channelUrl:this.url,userId:r.userId,countPreference:e}),[4,i.send(a)];case 1:return s=u.sent(),o=s.as(Pv).countPreference,this.myCountPreference=o,this._updateUnreadCount(this.unreadMessageCount,this.unreadMentionCount),n.dispatch(new $p({channels:[this],source:no.EVENT_CHANNEL_UPDATED,isWebSocketEventComing:!0})),[2,o]}}))}))},t.prototype.resetMyHistory=function(){return Qe(this,void 0,void 0,(function(){var e,t,n,r,i,a;return Ke(this,(function(s){switch(s.label){case 0:return e=eo.of(this._iid),t=e.dispatcher,n=e.requestQueue,r=new Fv({channelUrl:this.url}),[4,n.send(r)];case 1:return i=s.sent(),a=i.as(zv).messageOffsetTimestamp,this.messageOffsetTimestamp=a,this.lastMessage&&this.lastMessage.createdAt<a&&(this.lastMessage=null),t.dispatch(new $p({channels:[this],source:no.EVENT_CHANNEL_RESET_HISTORY,isWebSocketEventComing:!0})),[2,this]}}))}))},t.prototype.pinMessage=function(e){return Qe(this,void 0,void 0,(function(){var t,n;return Ke(this,(function(r){switch(r.label){case 0:return hs(ct("number",e)&&e>0).throw(st.invalidParameters),t=eo.of(this._iid).requestQueue,n=new Jv({channelType:this.channelType,channelUrl:this.url,messageId:e}),[4,t.send(n)];case 1:return r.sent(),[2]}}))}))},t.prototype.unpinMessage=function(e){return Qe(this,void 0,void 0,(function(){var t,n;return Ke(this,(function(r){switch(r.label){case 0:return hs(ct("number",e)&&e>0).throw(st.invalidParameters),t=eo.of(this._iid).requestQueue,n=new Xv({channelType:this.channelType,channelUrl:this.url,messageId:e}),[4,t.send(n)];case 1:return r.sent(),[2]}}))}))},t.prototype._uploadFileAndUpdateParams=function(e){return Qe(this,void 0,void 0,(function(){var t,n,r,i,a,s,o,u,l,c,d;return Ke(this,(function(h){switch(h.label){case 0:return vt(e.file)?(t=eo.of(this._iid).requestQueue,n=new Vo({file:e.file,channelUrl:this.url,thumbnailSizes:e.thumbnailSizes,requestId:this._generateRequestId()}),[4,t.send(n)]):[3,2];case 1:r=h.sent(),i=r.as(Go),a=i.url,s=i.fileSize,o=void 0===s?e.fileSize:s,u=i.thumbnailSizes,l=void 0===u?e.thumbnailSizes:u,c=i.requireAuth,d=void 0!==c&&c,e.fileUrl=a,e.fileSize=o,e.thumbnailSizes=l,e.requireAuth=d,h.label=2;case 2:return[2]}}))}))},t.prototype.resendMessage=function(e,t){var n,r=this;if(hs(e instanceof au&&!e.scheduledInfo&&e.isResendable).throw(st.invalidParameters),e.isUserMessage()){var i=null!==(n=e.messageParams)&&void 0!==n?n:Zu(e),a=new Gu;return this._sendUserMessage(i,Pc.RESEND,e.reqId).onPending((function(e){a._trigger(e)})).onFailed((function(e,t){a._triggerFailed(e,t)})).onSucceeded((function(e){r._tryUpdateLastMessageAndCallEvents(r,e),a._trigger(e)})),a}if(e.isFileMessage()){var s=this._validateFailedFileMessageHasFile(e,t);hs(s).throw(st.invalidParameters),i=il(e,t);var o=new Gu;return this._sendFileMessage(i,Pc.RESEND,e.reqId).onPending((function(e){o._trigger(e)})).onFailed((function(e,t){o._triggerFailed(e,t)})).onSucceeded((function(e){r._tryUpdateLastMessageAndCallEvents(r,e),o._trigger(e)})),o}if(e.isMultipleFilesMessage()){i=e.messageParams;var u=new zc;return this._sendMultipleFilesMessage(i,Pc.RESEND,e.reqId).onPending((function(e){u._trigger(e)})).onFailed((function(e,t){u._triggerFailed(e,t)})).onSucceeded((function(e){r._tryUpdateLastMessageAndCallEvents(r,e),u._trigger(e)})).onFileUploaded((function(e,t,n,r){u._triggerOnFileUploaded(e,t,n,r)})),u}},t.prototype.copyMessage=function(e,t){var n=this;if(hs(e instanceof qc&&t instanceof au&&t.sendingStatus===Dt.SUCCEEDED&&this.url===t.channelUrl&&!t.scheduledInfo).throw(st.invalidParameters),t.isUserMessage()){hs(!t.poll).throw(st.notSupportedError);var r=Wu(t),i=new Gu;return e._sendUserMessage(r).onPending((function(e){i._trigger(e)})).onFailed((function(e,t){i._triggerFailed(e,t)})).onSucceeded((function(t){e.isGroupChannel()&&n._tryUpdateLastMessageAndCallEvents(e,t),i._trigger(t)})),i}if(t.isFileMessage()){r=nl(t);var a=new Gu;return e._sendFileMessage(r).onPending((function(e){a._trigger(e)})).onFailed((function(e,t){a._triggerFailed(e,t)})).onSucceeded((function(t){e.isGroupChannel()&&n._tryUpdateLastMessageAndCallEvents(e,t),a._trigger(t)})),a}if(t.isMultipleFilesMessage()){if(e.isGroupChannel()){r=function(e){var t,n,r;return null!==(t=e.messageParams)&&void 0!==t?t:Vt(je(je({},e),{isReplyToChannel:!1,mentionedUserIds:null!==(n=e.mentionedUserIds)&&void 0!==n?n:null===(r=e.mentionedUsers)||void 0===r?void 0:r.map((function(e){return e.userId})),pushNotificationDeliveryOption:Ot.DEFAULT,isPinnedMessage:!1,fileInfoList:e.fileInfoList.map((function(e){var t;return{fileUrl:e.plainUrl,fileName:e.fileName,fileSize:e.fileSize,mimeType:e.mimeType,thumbnailSizes:null===(t=e.thumbnails)||void 0===t?void 0:t.map((function(e){return{maxWidth:e.width,maxHeight:e.height}})),_uploadedMetaData:{requireAuth:e._requireAuth,isUploaded:!0}}}))}))}(t);var s=new zc;return e._sendMultipleFilesMessage(r,Pc.COPY).onPending((function(e){s._trigger(e)})).onFailed((function(e,t){s._triggerFailed(e,t)})).onSucceeded((function(t){n._tryUpdateLastMessageAndCallEvents(e,t),s._trigger(t)})).onFileUploaded((function(e,t,n,r){s._triggerOnFileUploaded(e,t,n,r)})),s}throw st.channelTypeNotSupportedError}},t}(qc),um={},lm=function(){function e(e){var t=e._iid,n=e.limit,r=void 0===n?100:n,i=this;this.ref=0,this._iid=t,this._limit=r;var a,s=eo.of(this._iid),o=s.sdkState,u=s.dispatcher,l=s.logger,c=s.cacheContext;this._metadataKey=(a=o.userId,"sendbird:".concat(a,"@groupchannel/sync.meta"));var d=function(e){return"sendbird:".concat(e,"@groupchannel/sync")}(o.userId);this._sync=new nv(d,(function(){return Qe(i,void 0,void 0,(function(){var e,t,n,r,i,a,s,u,d,h,f,p;return Ke(this,(function(_){switch(_.label){case 0:return e={hasNext:!0,nextToken:""},[4,this.loadMetadata()];case 1:if(_.sent(),l.debug("channel background sync from",null===(d=this._metadata)||void 0===d?void 0:d.token),null===(h=this._metadata)||void 0===h?void 0:h.completed)return[3,13];_.label=2;case 2:if(_.trys.push([2,9,,12]),(t={includeEmpty:!0,order:bh.CHRONOLOGICAL}).order!==bh.LATEST_LAST_MESSAGE)return[3,6];_.label=3;case 3:return _.trys.push([3,5,,6]),[4,c.preference.get(Xa(o.appId))];case 4:return n=_.sent(),t.includeChatNotification=Boolean(n),[3,6];case 5:return _.sent(),t.includeChatNotification=!1,[3,6];case 6:return[4,J_.of(this._iid).getMyGroupChannels(null!==(p=null===(f=this._metadata)||void 0===f?void 0:f.token)&&void 0!==p?p:"",t,this._limit,no.SYNC_CHANNEL_BACKGROUND)];case 7:return r=_.sent(),i=r.channels,a=r.token,e.hasNext=i.length>=this._limit&&!!a,e.nextToken=a,this._metadata&&(this._metadata.token=a,(u=this._metadata.range).extends.apply(u,Ze([],Ye(i.map((function(e){return e.createdAt}))),!1)),this._metadata.completed=!e.hasNext),l.debug("channel background sync progress",e),[4,this.saveMetadata()];case 8:return _.sent(),[3,12];case 9:return s=_.sent(),l.debug("channel background sync error",s),s instanceof st&&s.isInvalidTokenError?[4,this.clearMetaData()]:[3,11];case 10:_.sent(),_.label=11;case 11:throw s;case 12:return[3,14];case 13:e.hasNext=!1,e.nextToken="",_.label=14;case 14:return[2,e]}}))}))})),this._connectionEventContext=u.on((function(e){e instanceof Ka&&(e.stateType===Ga.CONNECTED?i.resume():i.pause())}))}return e.of=function(t){return um[t]||(um[t]=new e({_iid:t})),um[t].ref++,um[t]},e.clear=function(e){um[e]&&(um[e].close(),delete um[e])},Object.defineProperty(e.prototype,"range",{get:function(){var e,t;return null!==(t=null===(e=this._metadata)||void 0===e?void 0:e.range)&&void 0!==t?t:new Y_({})},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"completed",{get:function(){var e;return!!(null===(e=this._metadata)||void 0===e?void 0:e.completed)},enumerable:!1,configurable:!0}),e.prototype.loadMetadata=function(){return Qe(this,void 0,void 0,(function(){var e;return Ke(this,(function(t){switch(t.label){case 0:return this._metadata?[3,2]:[4,eo.of(this._iid).cacheContext.preference.get(this._metadataKey)];case 1:e=t.sent(),this._metadata={token:e?e.token:"",range:new Y_(e?e.range:{top:Number.MAX_SAFE_INTEGER,bottom:0}),completed:!!e&&e.completed},t.label=2;case 2:return[2,this._metadata]}}))}))},e.prototype.saveMetadata=function(){return Qe(this,void 0,void 0,(function(){return Ke(this,(function(e){switch(e.label){case 0:return this._metadata?[4,eo.of(this._iid).cacheContext.preference.set(this._metadataKey,this._metadata)]:[3,2];case 1:return e.sent(),[2,!0];case 2:return[2,!1]}}))}))},e.prototype.clearMetaData=function(){return Qe(this,void 0,void 0,(function(){return Ke(this,(function(e){switch(e.label){case 0:return[4,eo.of(this._iid).cacheContext.preference.remove(this._metadataKey)];case 1:return e.sent(),this._metadata=void 0,[2]}}))}))},e.prototype.resume=function(){var e,t,n=eo.of(this._iid),r=n.logger;n.sessionManager.session.hasSession&&(r.debug("channel background sync resume()"),this._sync.start(null!==(t=null===(e=this._metadata)||void 0===e?void 0:e.token)&&void 0!==t?t:""))},e.prototype.pause=function(){eo.of(this._iid).logger.debug("channel background sync stop()"),this._sync.stop()},e.prototype.close=function(){this.ref--,this.ref<=0&&(this.ref=0,this.pause(),this._connectionEventContext.close(),delete um[this._iid])},e}(),cm={},dm=function(){function e(e){var t=e._iid,n=this;this.ref=0,this._iid=t;var r,i=eo.of(this._iid),a=i.logger,s=i.sdkState,o=i.dispatcher,u=i.cacheContext;this._metadataKey=(r=s.userId,"sendbird:".concat(r,"@groupchannel/changelogs.meta"));var l=function(e){return"sendbird:".concat(e,"@groupchannel/changelogs")}(s.userId);this._sync=new nv(l,(function(){return Qe(n,void 0,void 0,(function(){var e,t,n,r,i,o,l,c,d,h;return Ke(this,(function(f){switch(f.label){case 0:return e={hasNext:!0,nextToken:0},[4,this.loadMetadata()];case 1:f.sent(),a.debug("channel changelog sync from",null===(c=this._metadata)||void 0===c?void 0:c.token),f.label=2;case 2:f.trys.push([2,9,,12]),t={includeEmpty:!0},f.label=3;case 3:return f.trys.push([3,5,,6]),[4,u.preference.get(Xa(s.appId))];case 4:return n=f.sent(),t.includeChatNotification=Boolean(n),[3,6];case 5:return f.sent(),t.includeChatNotification=!1,[3,6];case 6:return[4,J_.of(this._iid).getMyGroupChannelChangeLogs(null!==(h=null===(d=this._metadata)||void 0===d?void 0:d.token)&&void 0!==h?h:"",t,no.SYNC_CHANNEL_CHANGELOGS)];case 7:return r=f.sent(),i=r.hasMore,o=r.token,e.hasNext=i,e.nextToken=o,this._metadata&&(this._metadata.token=o),a.debug("channel changelog sync progress",e),[4,this.saveMetadata()];case 8:return f.sent(),[3,12];case 9:return l=f.sent(),a.debug("channel changelog sync error",l),l instanceof st&&l.isInvalidTokenError?[4,this.clearMetadata()]:[3,11];case 10:f.sent(),f.label=11;case 11:throw l;case 12:return[2,e]}}))}))})),this._connectionEventContext=o.on((function(e){e instanceof Ka&&(e.stateType===Ga.CONNECTED?n.resume():n.pause())}))}return e.of=function(t){return cm[t]||(cm[t]=new e({_iid:t})),cm[t].ref++,cm[t]},e.clear=function(e){cm[e]&&(cm[e].close(),delete cm[e])},e.prototype.loadMetadata=function(){return Qe(this,void 0,void 0,(function(){var e,t,n,r;return Ke(this,(function(i){switch(i.label){case 0:return this._metadata?[3,2]:(e=eo.of(this._iid),t=e.cacheContext,n=e.firstConnectedAt,[4,t.preference.get(this._metadataKey)]);case 1:r=i.sent(),this._metadata={token:r?r.token:n},i.label=2;case 2:return[2,this._metadata]}}))}))},e.prototype.saveMetadata=function(){return Qe(this,void 0,void 0,(function(){return Ke(this,(function(e){switch(e.label){case 0:return this._metadata?[4,eo.of(this._iid).cacheContext.preference.set(this._metadataKey,this._metadata)]:[3,2];case 1:return e.sent(),[2,!0];case 2:return[2,!1]}}))}))},e.prototype.clearMetadata=function(){return Qe(this,void 0,void 0,(function(){return Ke(this,(function(e){switch(e.label){case 0:return[4,eo.of(this._iid).cacheContext.preference.remove(this._metadataKey)];case 1:return e.sent(),this._metadata=void 0,[2]}}))}))},e.prototype.resume=function(){eo.of(this._iid).sessionManager.session.hasSession&&this._sync.start(0)},e.prototype.pause=function(){this._sync.stop()},e.prototype.close=function(){this.ref--,this.ref<=0&&(this.ref=0,this.pause(),this._connectionEventContext.close(),delete cm[this._iid])},e}(),hm=function(e,t){return e.findIndex((function(e){return e.isIdentical(t)}))},fm=function(e,t,n){if(e.length>0){for(var r=hm(e,t),i=0,a=e.length-1,s=Math.floor((i+a)/2);i<a;){var o=pm(e[s],t,n);if(o>0)a=s,s=Math.floor((i+a)/2);else{if(!(o<0))return{place:s,oldPosition:r};i=s+1,s=Math.floor((i+a)/2)}}return{place:pm(e[s],t,n)>=0?s:s+1,oldPosition:r}}return{place:e.length,oldPosition:-1}},pm=function(e,t,n){switch(n){case bh.LATEST_LAST_MESSAGE:return e.lastMessage&&t.lastMessage?t.lastMessage.createdAt-e.lastMessage.createdAt:e.lastMessage?-1:t.lastMessage?1:t.createdAt-e.createdAt;case bh.CHRONOLOGICAL:return t.createdAt-e.createdAt;case bh.CHANNEL_NAME_ALPHABETICAL:var r=e.name.localeCompare(t.name);return 0===r?e.createdAt-t.createdAt:r;default:return 0}},_m=function(){function e(e,t){var n=t.filter,r=t.order,i=t.limit,a=this;this.channels=[],this._iid=e,this._key="gcc-".concat(xt()),this._isDisposed=!1,this._isGetRemoteChannelsSucceeded=!0,this.filter=null!=n?n:new qp,this.order=null!=r?r:bh.LATEST_LAST_MESSAGE,this._hasMore=!0,this._token="",this._limit=null!=i?i:100;var s=eo.of(this._iid),o=s.sdkState,u=s.cacheContext,l=s.dispatcher;u.localCacheEnabled&&(this._backgroundSync=lm.of(e),this._backgroundSync.resume()),this._changelogSync=dm.of(e),this._changelogSync.resume(),J_.of(this._iid).subscribeChannelEvent(this._key,{onUpdate:function(e,t){if(Xp(t)){var n=e.filter((function(e){return a.filter.match(e,o.userId)})),r=e.filter((function(e){return!a.filter.match(e,o.userId)})).map((function(e){return e.url}));n.length>0&&a._addChannelsToView(n,t),r.length>0&&a._removeChannelsFromView(r,t)}},onRemove:function(e,t){a._removeChannelsFromView(e,t)}}),eo.of(this._iid).statLogCollector.put(new Qs({type:dn.FEATURE_LOCALCACHE,data:{use_local_cache:u.localCacheEnabled,collection_interface:{group_channel:!0}}})),l.on((function(e){e instanceof Ka&&(e.stateType===Ga.CONNECTED?a._isGetRemoteChannelsSucceeded||Qe(a,void 0,void 0,(function(){return Ke(this,(function(e){switch(e.label){case 0:return[4,this._revokeLoadMore()];case 1:return e.sent(),[2]}}))})):e.stateType===Ga.LOGOUT&&a.dispose())}))}return Object.defineProperty(e.prototype,"hasMore",{get:function(){return!this._isDisposed&&this._hasMore},enumerable:!1,configurable:!0}),e.prototype.setGroupChannelCollectionHandler=function(e){this._handler=e},e.prototype._addChannelsToView=function(e,t,n){var r,i,a,s,o=this;void 0===n&&(n=!1);var u=[],l=[],c=[];try{for(var d=We(e),h=d.next();!h.done;h=d.next()){var f=h.value,p=hm(this.channels,f);p>=0&&this.channels.splice(p,1);var _=fm(this.channels,f,this.order).place;if(p<0)_===this.channels.length?!n&&this._hasMore||(u.push(f),this.channels.push(f)):(u.push(f),this.channels.splice(_,0,f));else switch(t){case no.EVENT_CHANNEL_UPDATED:case no.EVENT_MESSAGE_RECEIVED:case no.SYNC_CHANNEL_CHANGELOGS:case no.EVENT_MESSAGE_SENT:_!==p&&this._hasMore&&_===this.channels.length?c.push(f):(this.channels.splice(_,0,f),l.push(f));break;default:this.channels.splice(_,0,f),l.push(f)}}}catch(e){r={error:e}}finally{try{h&&!h.done&&(i=d.return)&&i.call(d)}finally{if(r)throw r.error}}if(c.length>0)try{for(var v=We(c),m=v.next();!m.done;m=v.next()){f=m.value;var g=hm(this.channels,f);-1!==g&&this.channels.splice(g,1)}}catch(e){a={error:e}}finally{try{m&&!m.done&&(s=v.return)&&s.call(v)}finally{if(a)throw a.error}}Xp(t)&&Es((function(){return Qe(o,void 0,void 0,(function(){var e,n,r,i;return Ke(this,(function(a){return e=new fv(t),u.length>0&&(null===(n=this._handler)||void 0===n?void 0:n.onChannelsAdded)&&this._handler.onChannelsAdded(e,u),l.length>0&&(null===(r=this._handler)||void 0===r?void 0:r.onChannelsUpdated)&&this._handler.onChannelsUpdated(e,l),c.length>0&&(null===(i=this._handler)||void 0===i?void 0:i.onChannelsDeleted)&&this._handler.onChannelsDeleted(e,c.map((function(e){return e.url}))),[2]}))}))}))},e.prototype._removeChannelsFromView=function(e,t){var n,r,i=this,a=[],s=function(e){var t=o.channels.findIndex((function(t){return t.url===e}));t>=0&&(a.push(o.channels[t].url),o.channels.splice(t,1))},o=this;try{for(var u=We(e),l=u.next();!l.done;l=u.next())s(l.value)}catch(e){n={error:e}}finally{try{l&&!l.done&&(r=u.return)&&r.call(u)}finally{if(n)throw n.error}}return Xp(t)&&a.length>0&&Es((function(){return Qe(i,void 0,void 0,(function(){var e,n;return Ke(this,(function(r){return e=new fv(t),(null===(n=this._handler)||void 0===n?void 0:n.onChannelsDeleted)&&this._handler.onChannelsDeleted(e,a),[2]}))}))})),a},e.prototype._getLocalChannels=function(){return Qe(this,void 0,void 0,(function(){var e,t;return Ke(this,(function(n){switch(n.label){case 0:return e=J_.of(this._iid),t=this.channels.length>0?function(e,t){var n,r,i,a;switch(t){case bh.LATEST_LAST_MESSAGE:return null!==(r=null===(n=e.lastMessage)||void 0===n?void 0:n.createdAt)&&void 0!==r?r:e.createdAt;case bh.CHRONOLOGICAL:return e.createdAt;case bh.CHANNEL_NAME_ALPHABETICAL:return e.name;default:return null!==(a=null===(i=e.lastMessage)||void 0===i?void 0:i.createdAt)&&void 0!==a?a:e.createdAt}}(this.channels[this.channels.length-1],this.order):null,[4,e.getChannelsFromCache(t,this.filter,this.order,this._limit,t?this.channels[this.channels.length-1].url:void 0)];case 1:return[2,n.sent()]}}))}))},e.prototype._getRemoteChannels=function(){return Qe(this,void 0,void 0,(function(){var e,t,n;return Ke(this,(function(r){switch(r.label){case 0:return[4,J_.of(this._iid).getMyGroupChannels(this._token,Vt(je(je({},this.filter),{order:this.order})),this._limit)];case 1:return e=r.sent(),t=e.channels,n=e.token,this._token=n,this._hasMore=!!n,[2,t]}}))}))},e.prototype._revokeLoadMore=function(){return Qe(this,void 0,void 0,(function(){var e;return Ke(this,(function(t){switch(t.label){case 0:if(this._isDisposed)return[2];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this._getRemoteChannels()];case 2:return e=t.sent(),this._isGetRemoteChannelsSucceeded=!0,this._addChannelsToView(e,no.REQUEST_CHANNEL,!0),[3,4];case 3:return t.sent(),this._isGetRemoteChannelsSucceeded=!1,[3,4];case 4:return[2]}}))}))},e.prototype.loadMore=function(){return Qe(this,void 0,void 0,(function(){var e,t,n,r,i=this;return Ke(this,(function(a){switch(a.label){case 0:if(this._isDisposed)throw new st({code:Je.COLLECTION_DISPOSED,message:"Collection has been disposed."});return this._hasMore?(e=eo.of(this._iid),t=e.cacheContext,n=e.connectionManager,r=[],!t.localCacheEnabled||n.isConnected&&!this._backgroundSync.completed?[3,2]:[4,bs((function(){return Qe(i,void 0,void 0,(function(){return Ke(this,(function(e){switch(e.label){case 0:return[4,this._getLocalChannels()];case 1:return r=e.sent(),[2]}}))}))}))]):[3,6];case 1:return a.sent(),this._hasMore=r.length>=this._limit,[3,5];case 2:return a.trys.push([2,4,,5]),[4,this._getRemoteChannels()];case 3:return r=a.sent(),this._isGetRemoteChannelsSucceeded=!0,[3,5];case 4:return a.sent(),this._isGetRemoteChannelsSucceeded=!1,[3,5];case 5:return this._addChannelsToView(r,no.REQUEST_CHANNEL,!0),[2,r];case 6:return[2,[]]}}))}))},e.prototype.dispose=function(){var e,t;this._isDisposed||(this._isDisposed=!0,this.channels.length>0&&this.channels.splice(0,this.channels.length),null===(e=this._backgroundSync)||void 0===e||e.close(),null===(t=this._changelogSync)||void 0===t||t.close(),J_.of(this._iid).unsubscribeChannelEvent(this._key))},e}(),vm=function(e){function t(t){var n=this,r=t.token,i=t.limit,a=t.order,s=t.includeEmpty,o=t.membershipFilter,u=t.channelNameContainsFilter,l=t.channelUrlsFilter,c=t.customTypesFilter,d=t.customTypeStartsWithFilter,h=t.superChannelFilter,f=t.metadataOrderKeyFilter,p=t.metadataKey,_=t.metadataValues,v=t.metadataValueStartsWith,m=t.includeFrozen,g=t.includeMetaData;return(n=e.call(this)||this).method=Gt.GET,n.path=Kt,n.params=qt(Vt({token:r,limit:i,order:a,show_member:!0,show_read_receipt:!0,show_delivery_receipt:!0,show_empty:s,public_mode:Mp.PUBLIC,public_membership_mode:o,name_contains:u,channel_urls:l,custom_types:c,custom_type_startswith:d,super_mode:h,metadata_order_key:f,metadata_key:p,metadata_values:_,metadata_value_startswith:v,show_frozen:m,show_metadata:g})),n}return Be(t,e),t}(hn),mm=function(e){function t(t,n){var r=e.call(this,t,n)||this;r.channels=[];var i=n.next,a=n.channels,s=n.ts;return r.token=i,a&&a.length>0&&(r.channels=a.map((function(e){return e.ts=s,new om(t,e)}))),r.ts="number"==typeof s?s:0,r}return Be(t,e),t}(fn);!function(e){e.ALL="all",e.JOINED="joined"}(sm||(sm={}));var gm=function(e){function t(t,n){var r,i,a,s,o,u,l,c,d,h,f,p,_,v,m=this;return(m=e.call(this,t,n)||this).includeEmpty=!1,m.includeFrozen=!0,m.includeMetaData=!0,m.channelUrlsFilter=null,m.customTypesFilter=null,m.customTypeStartsWithFilter=null,m.channelNameContainsFilter=null,m.membershipFilter=sm.ALL,m.superChannelFilter=Op.ALL,m.metadataKey=null,m.metadataValues=null,m.metadataOrderKeyFilter=null,m.metadataValueStartsWith=null,m.order=Ch.CHRONOLOGICAL,m.includeEmpty=null!==(r=n.includeEmpty)&&void 0!==r&&r,m.includeFrozen=null===(i=n.includeFrozen)||void 0===i||i,m.includeMetaData=null===(a=n.includeMetaData)||void 0===a||a,m.channelUrlsFilter=null!==(s=n.channelUrlsFilter)&&void 0!==s?s:null,m.customTypesFilter=null!==(o=n.customTypesFilter)&&void 0!==o?o:null,m.customTypeStartsWithFilter=null!==(u=n.customTypeStartsWithFilter)&&void 0!==u?u:null,m.channelNameContainsFilter=null!==(l=n.channelNameContainsFilter)&&void 0!==l?l:null,m.membershipFilter=null!==(c=n.membershipFilter)&&void 0!==c?c:sm.ALL,m.superChannelFilter=null!==(d=n.superChannelFilter)&&void 0!==d?d:Op.ALL,m.metadataKey=null!==(h=n.metadataKey)&&void 0!==h?h:null,m.metadataValues=null!==(f=n.metadataValues)&&void 0!==f?f:null,m.metadataOrderKeyFilter=null!==(p=n.metadataOrderKeyFilter)&&void 0!==p?p:null,m.metadataValueStartsWith=null!==(_=n.metadataValueStartsWith)&&void 0!==_?_:null,m.order=null!==(v=n.order)&&void 0!==v?v:Ch.CHRONOLOGICAL,m}return Be(t,e),t.prototype._validate=function(){return e.prototype._validate.call(this)&&ct("boolean",this.includeEmpty)&&ct("boolean",this.includeFrozen)&&ct("boolean",this.includeMetaData)&&ct("string",this.channelNameContainsFilter,!0)&&ft("string",this.channelUrlsFilter,!0)&&ft("string",this.customTypesFilter,!0)&&ct("string",this.customTypeStartsWithFilter,!0)&&dt(sm,this.membershipFilter)&&dt(Op,this.superChannelFilter)&&dt(Ch,this.order)&&ct("string",this.metadataOrderKeyFilter,!0)&&ct("string",this.metadataKey,!0)&&ft("string",this.metadataValues,!0)&&ct("string",this.metadataValueStartsWith,!0)},t.prototype.next=function(){return Qe(this,void 0,void 0,(function(){var e,t,n,r,i,a,s,o;return Ke(this,(function(u){switch(u.label){case 0:return this._validate()?this._isLoading?[3,3]:(e=[],this._hasNext?(this._isLoading=!0,t=eo.of(this._iid),n=t.requestQueue,t.dispatcher,r=new vm(Vt(je(je({},this),{token:this._token}))),[4,n.send(r)]):[3,2]):[3,5];case 1:return i=u.sent(),a=i.as(mm),s=a.channels,o=a.token,this._token=o,this._hasNext=!!o,this._isLoading=!1,[2,s];case 2:return[2,e];case 3:throw st.queryInProgress;case 4:return[3,6];case 5:throw st.invalidParameters;case 6:return[2]}}))}))},t}(mo),ym=function(e){function t(t){void 0===t&&(t={});var n=e.call(this)||this;return Object.keys(t).forEach((function(e){n.hasOwnProperty(e)&&(n[e]=t[e])})),n}return Be(t,e),t}(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onUserJoined=Dn,t.onUserLeft=Dn,t.onUserReceivedInvitation=Dn,t.onUserDeclinedInvitation=Dn,t.onChannelHidden=Dn,t.onUnreadMemberStatusUpdated=Dn,t.onUndeliveredMemberStatusUpdated=Dn,t.onTypingStatusUpdated=Dn,t.onPollUpdated=Dn,t.onPollVoted=Dn,t.onPollDeleted=Dn,t.onPinnedMessageUpdated=Dn,t}return Be(t,e),t}(ap)),Em=function(e){function t(t){var n=this,r=t.token,i=t.limit,a=t.order,s=t.reverse,o=t.channelUrl,u=t.messageTypeFilter,l=t.scheduledStatus;return(n=e.call(this)||this).method=Gt.GET,n.path="".concat(nn),n.params=qt(Vt({token:r,limit:i,reverse:s,channel_url:o,order:a,message_type:u,status:l})),n}return Be(t,e),t}(hn),bm=function(e){function t(t,n){var r=e.call(this,t,n)||this;r.scheduledMessages=[];var i=n.next,a=n.scheduled_messages;return r.token=i,r.scheduledMessages=a.map((function(e){return gu(t,e)})),r}return Be(t,e),t}(fn),Cm=function(e){function t(t,n){var r,i,a,s,o,u=this;return(u=e.call(this,t,n)||this).channelUrl=null,u.order=null,u.reverse=!1,u.scheduledStatus=null,u.messageTypeFilter=At.ALL,u.channelUrl=null!==(r=n.channelUrl)&&void 0!==r?r:null,u.order=null!==(i=n.order)&&void 0!==i?i:null,u.reverse=null!==(a=n.reverse)&&void 0!==a&&a,u.scheduledStatus=null!==(s=n.scheduledStatus)&&void 0!==s?s:null,u.messageTypeFilter=null!==(o=n.messageTypeFilter)&&void 0!==o?o:At.ALL,u}return Be(t,e),t.prototype._validate=function(){return e.prototype._validate.call(this)&&ct("string",this.channelUrl,!0)&&(dt(wh,this.order)||null===this.order)&&ct("boolean",this.reverse)&&(ft(jo,this.scheduledStatus)||null===this.scheduledStatus)&&dt(At,this.messageTypeFilter)},t.prototype.next=function(){return Qe(this,void 0,void 0,(function(){var e,t,n,r,i,a;return Ke(this,(function(s){switch(s.label){case 0:return this._validate()?this._isLoading?[3,3]:this._hasNext?(this._isLoading=!0,e=eo.of(this._iid).requestQueue,t=new Em(Vt(je(je({},this),{token:this._token}))),[4,e.send(t)]):[3,2]:[3,5];case 1:return n=s.sent(),r=n.as(bm),i=r.scheduledMessages,a=r.token,this._token=a,this._hasNext=!!a,this._isLoading=!1,[2,i];case 2:return[2,[]];case 3:throw st.queryInProgress;case 4:return[3,6];case 5:throw st.invalidParameters;case 6:return[2]}}))}))},t}(mo),wm=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.name="groupChannel",t}return Be(t,e),t.prototype.init=function(t,n){var r=n.sdkState,i=n.dispatcher,a=n.sessionManager,s=n.requestQueue,o=n.logger,u=n.onlineDetector,l=n.cacheContext;e.prototype.init.call(this,t,{sdkState:r,dispatcher:i,sessionManager:a,requestQueue:s,logger:o,onlineDetector:u,cacheContext:l}),this._manager=new J_(t,{sdkState:r,cacheContext:l,dispatcher:i,sessionManager:a,requestQueue:s,logger:o})},t.prototype.createGroupChannelCollection=function(e){return void 0===e&&(e={}),new _m(this._iid,e)},t.prototype.createMyGroupChannelListQuery=function(e){return void 0===e&&(e={}),new V_(this._iid,e)},t.prototype.createPublicGroupChannelListQuery=function(e){return void 0===e&&(e={}),new gm(this._iid,e)},t.prototype.createScheduledMessageListQuery=function(e){return void 0===e&&(e={}),new Cm(this._iid,e)},t.prototype.addGroupChannelHandler=function(e,t){hs(ct("string",e)&&t instanceof ym).throw(st.invalidParameters),this._manager.addHandler(e,t)},t.prototype.removeGroupChannelHandler=function(e){hs(ct("string",e)).throw(st.invalidParameters),this._manager.removeHandler(e)},t.prototype.removeAllGroupChannelHandlers=function(){this._manager.clearHandler()},t.prototype.buildGroupChannelFromSerializedData=function(e){return this._manager.buildGroupChannelFromSerializedData(e)},t.prototype.buildGroupChannelListQueryFromSerializedData=function(e){return this._manager.buildGroupChannelListQueryFromSerializedData(e)},t.prototype.buildMemberFromSerializedData=function(e){return this._manager.buildMemberFromSerializedData(e)},t.prototype.getChannel=function(e){return Qe(this,void 0,void 0,(function(){return Ke(this,(function(t){return hs(ct("string",e)).throw(st.invalidParameters),[2,this._manager.getChannel(e)]}))}))},t.prototype.getChannelWithoutCache=function(e){return Qe(this,void 0,void 0,(function(){return Ke(this,(function(t){return hs(ct("string",e)).throw(st.invalidParameters),[2,this._manager.getChannelWithoutCache(e)]}))}))},t.prototype.getMyGroupChannelChangeLogsByToken=function(e,t){return void 0===t&&(t={}),Qe(this,void 0,void 0,(function(){var n;return Ke(this,(function(r){switch(r.label){case 0:return n=je(je({},jp),t),hs(ct("string",e)&&Qp(n)).throw(st.invalidParameters),[4,this._manager.getMyGroupChannelChangeLogs(e,n)];case 1:return[2,r.sent()]}}))}))},t.prototype.getMyGroupChannelChangeLogsByTimestamp=function(e,t){return void 0===t&&(t={}),Qe(this,void 0,void 0,(function(){var n;return Ke(this,(function(r){switch(r.label){case 0:return n=je(je({},jp),t),hs(ct("number",e)&&Qp(n)).throw(st.invalidParameters),[4,this._manager.getMyGroupChannelChangeLogs(e,n)];case 1:return[2,r.sent()]}}))}))},t.prototype.getGroupChannelCount=function(e){return Qe(this,void 0,void 0,(function(){var t;return Ke(this,(function(n){return t=je(je({},Kp),e),hs(Wp(t)).throw(st.invalidParameters),[2,this._manager.getGroupChannelCount(t)]}))}))},t.prototype.getUnreadItemCount=function(e){return void 0===e&&(e={}),Qe(this,void 0,void 0,(function(){return Ke(this,(function(t){switch(t.label){case 0:return[4,this._manager.getUnreadItemCount(e)];case 1:return[2,t.sent()]}}))}))},t.prototype.getTotalUnreadChannelCount=function(){return Qe(this,void 0,void 0,(function(){return Ke(this,(function(e){switch(e.label){case 0:return[4,this._manager.getTotalUnreadChannelCount()];case 1:return[2,e.sent()]}}))}))},t.prototype.getTotalUnreadMessageCount=function(e){return void 0===e&&(e={}),Qe(this,void 0,void 0,(function(){return Ke(this,(function(t){switch(t.label){case 0:return[4,this._manager.getTotalUnreadMessageCount(e)];case 1:return[2,t.sent()]}}))}))},t.prototype.getTotalScheduledMessageCount=function(e){return void 0===e&&(e={}),Qe(this,void 0,void 0,(function(){return Ke(this,(function(t){switch(t.label){case 0:return[4,this._manager.getTotalScheduledMessageCount(e)];case 1:return[2,t.sent()]}}))}))},t.prototype.getSubscribedTotalUnreadMessageCount=function(){return this._manager.getSubscribedTotalUnreadMessageCount()},t.prototype.getSubscribedCustomTypeTotalUnreadMessageCount=function(){return this._manager.getSubscribedCustomTypeTotalUnreadMessageCount()},t.prototype.getSubscribedCustomTypeUnreadMessageCount=function(e){return this._manager.getSubscribedCustomTypeUnreadMessageCount(e)},t.prototype.createChannel=function(e){return void 0===e&&(e={}),Qe(this,void 0,void 0,(function(){var t;return Ke(this,(function(n){return t=je(je({},Gp),e),hs(Bp(t)).throw(st.invalidParameters),[2,this._manager.createChannel(t)]}))}))},t.prototype.createDistinctChannelIfNotExist=function(e){return void 0===e&&(e={}),Qe(this,void 0,void 0,(function(){var t;return Ke(this,(function(n){return t=je(je({},Gp),e),hs(Bp(t)).throw(st.invalidParameters),t&&(t.isDistinct=!0),[2,this.createChannel(t)]}))}))},t.prototype.createChannelWithUserIds=function(e,t,n,r,i,a){return void 0===t&&(t=!1),void 0===i&&(i=""),void 0===a&&(a=""),Qe(this,void 0,void 0,(function(){var s;return Ke(this,(function(o){return s=je(je({},Gp),{invitedUserIds:e,isDistinct:t,name:n,data:i,customType:a}),"string"==typeof r?s.coverUrl=r:s.coverImage=r,[2,this.createChannel(s)]}))}))},t.prototype.markAsReadAll=function(){return Qe(this,void 0,void 0,(function(){return Ke(this,(function(e){return this._manager.markAsReadAll(),[2]}))}))},t.prototype.markAsReadWithChannelUrls=function(e){return Qe(this,void 0,void 0,(function(){return Ke(this,(function(t){return hs(ft("string",e)).throw(st.invalidParameters),this._manager.markAsReadWithChannelUrls(e),[2]}))}))},t.prototype.markAsDelivered=function(e){return Qe(this,void 0,void 0,(function(){return Ke(this,(function(t){switch(t.label){case 0:return hs(ct("string",e)).throw(st.invalidParameters),[4,this.getChannel(e)];case 1:return[4,t.sent().markAsDelivered()];case 2:return t.sent(),[2]}}))}))},t}(to);const Sm=t=>{let{children:n}=t;const{setSbClient:r}=(0,e.useContext)(l);return(0,e.useEffect)((()=>{r(Qf.init({appId:"1D5CD326-279E-4A2F-86B0-0FDF77AE3931",modules:[new Ap,new wm]}))}),[r]),n};const Tm=function(){return(0,i.jsx)("div",{className:"App",id:"app__wrap",children:(0,i.jsx)(d,{children:(0,i.jsx)(Sm,{children:(0,i.jsx)(Ve,{})})})})};r.createRoot(document.getElementById("root")).render((0,i.jsx)(Tm,{}))})()})();
//# sourceMappingURL=main.8a06dd1f.js.map